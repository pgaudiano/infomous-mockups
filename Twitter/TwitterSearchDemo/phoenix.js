twttr.templates={who_to_follow:'\u003Cdiv class="main-content"\u003E\n  {{#render_page_content}}\n    \u003Cdiv class="page-header who-to-follow-header"\u003E\n\n      {{#logged_in}}\n        \u003Cform class="who-to-follow-search" action="{{who_to_follow_search_form_path}}" method="GET"\u003E\n          \u003Cinput type="text" value="" name="q" placeholder="{{_i}}Search by name or topic{{/i}}" /\u003E\n          \u003Cdiv class="submit button"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\n        \u003C/form\u003E\n      {{/logged_in}}\n\n      \u003Ch1\u003E{{_i}}Who to follow{{/i}}\u003C/h1\u003E\n\n      \u003Cul class="stream-tabs"\u003E\n  {{#logged_in}}\n        \u003Cli class="stream-tab stream-tab-suggestions {{#active_tab_suggestions}}active{{/active_tab_suggestions}}"\u003E\n          \u003Ca class="tab-text" title=\'{{_i}}View Suggestions{{/i}}\' href="{{who_to_follow_suggestions_path}}"\u003E{{_i}}View Suggestions{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n  {{/logged_in}}\n        \u003Cli class="stream-tab stream-tab-interests {{#active_tab_interests}}active{{/active_tab_interests}}"\u003E\n          \u003Ca class="tab-text" title=\'{{_i}}Browse Interests{{/i}}\' href="{{who_to_follow_interests_path}}"\u003E{{_i}}Browse Interests{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n  {{#logged_in}}\n        \u003Cli class="stream-tab stream-tab-import {{#active_tab_import}}active{{/active_tab_import}}"\u003E\n          \u003Ca class="tab-text" title=\'{{_i}}Find Friends{{/i}}\' href="{{who_to_follow_import_path}}"\u003E{{_i}}Find Friends{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n  {{/logged_in}}\n      \u003C/ul\u003E\n    \u003C/div\u003E\n\n    \u003Cdiv class="who-to-follow-stream"\u003E\n      {{\u003Estream_manager}}\n    \u003C/div\u003E\n\n  {{/render_page_content}}\n\u003C/div\u003E\n\n\u003Cdiv class="dashboard"\u003E\n\u003C/div\u003E\n\n{{\u003Edetails_pane_container}}\n',thumbnail_viewer:'\u003Cdiv class="thumbnail-viewer"\u003E\n  \u003Ca href="#"\u003E\n    \u003Cdiv class="thumbnail-viewer-nav thumbnail-viewer-prev"\u003E\u003Cspan class="thumbnail-viewer-button thumbnail-viewer-back-button"\u003E\u003C/span\u003E\u003C/div\u003E\n  \u003C/a\u003E\n  \u003Cdiv class="thumbnail-viewer-container"\u003E\n    \u003Cdiv class="thumbnail-viewer-images"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n  \u003Ca href="#"\u003E\n    \u003Cdiv class="thumbnail-viewer-nav thumbnail-viewer-next"\u003E\u003Cspan class="thumbnail-viewer-button thumbnail-viewer-next-button"\u003E\u003C/span\u003E\u003C/div\u003E\n  \u003C/a\u003E\n\u003C/div\u003E',stream_tweet_box:'\u003Cdiv class="stream-tweet-box"\u003E\n  \u003Cdiv class="tweet-area"\u003E\u003C/div\u003E\n\n  \u003Cdiv class="tweet-button-container"\u003E\n    \u003Cspan class="tweet-counter"\u003E140\u003C/span\u003E\n    \u003Ca class="tweet-button button" href="#"\u003E{{_i}}Tweet{{/i}}\u003C/a\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',geo_disable_geo:'\u0026#32;\n\u003Ca href="#" class="geo_disable_webclient"\u003E\u003Cspan\u003E\u0026nbsp;\u003C/span\u003E\u003C/a\u003E',media_not_displayed:'\u003Cdiv class=\'media-not-displayed\'\u003E\n  \u003Ch2\u003E{{_i}}Media not displayed.{{/i}}\u003C/h2\u003E\n  \u003Cp\u003E{{_i}}This Tweet is from someone you\'re not following. The media they\'re mentioning could be anything, even something you might find offensive.{{/i}}\u003C/p\u003E\n  \u003Cbr/\u003E\n  \u003Cdiv class="button display-this-media"\u003E\n    {{_i}}Display media{{/i}}\n  \u003C/div\u003E\n  \u003Cbr/\u003E\n  {{#logged_in}}\n    \u003Cp\u003E{{_i}}or...{{/i}}\u003C/p\u003E\n    \u003Ca href="#" class="always-display-media"\u003E{{_i}}Always display media{{/i}}\u003C/a\u003E\n    \u003Cp\u003E{{_i}}(even from people you don\'t follow){{/i}}\u003C/p\u003E\n    \u003Csmall\u003E{{_i}}Tip: You can turn off auto-display anytime in Settings.{{/i}}\u003C/small\u003E\n  {{/logged_in}}\n\u003C/div\u003E\n',search_basic:'\u003Cdiv class="search basic-search"\u003E\n  \u003Ch1\u003E{{_i}}See what\u2019s happening \u003Cstrong\u003Eright now\u003C/strong\u003E{{/i}}\u003C/h1\u003E\n\n  \u003Cform action="{{form_search_results_path}}" method="GET"\u003E\n    \u003Cinput value="" name="q" type="text" placeholder="" /\u003E\n    \u003Cdiv\u003E\n      \u003Cdiv class="button submit selected"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\n\n      {{\u003Esearch_help_operators}}\n    \u003C/div\u003E\n  \u003C/form\u003E\n  \u003Cdiv class="trends-container"\u003E\u003C/div\u003E\n\u003C/div\u003E',link_list:'\u003Cul\u003E\n  {{#links}}\n    \u003Cli\u003E\n      {{#href}}\u003Ca href="{{href}}"\u003E{{text}}\u003C/a\u003E{{/href}}\n      {{^href}}\u003Cspan\u003E{{text}}\u003C/span\u003E{{/href}}\n    \u003C/li\u003E\n    {{#separator}}\n    \u003Cli class="link-separator"\u003E{{{separator}}}\u003C/li\u003E\n    {{/separator}}\n  {{/links}}\n\u003C/ul\u003E',geo_map_big:'\u003Cdiv class="tweet_geo_big"\u003E\n{{#place}}\n  \u003Cdiv class="geo_map_place_details"\u003E\n    \u003Cdiv class="geo_map_place_name"\u003E{{name}}\u003C/div\u003E\n    \u003Cdiv\u003E{{full_address}}\u003C/div\u003E\n    \u003Cdiv\u003E{{phone}}\u003C/div\u003E\n    {{#place_path}}\n    \u003Cdiv\u003E\n      \u003Ca class="geo_map_place_page_link" href="{{place_path}}"\u003E\n        {{_i}}View more about this place \u0026rarr;{{/i}}\n      \u003C/a\u003E\n    \u003C/div\u003E\n    {{/place_path}}\n  \u003C/div\u003E\n{{/place}}\n{{^place}}\n  {{#user}}\n  \u003Cdiv class="geo_map_place_details"\u003E\n    \u003Cdiv class="geo_map_place_name"\u003E{{_i}}@{{screen_name}}\'s Tweet location{{/i}}\u003C/div\u003E\n  \u003C/div\u003E\n  {{/user}}\n{{/place}}\n{{#show_map}}\n  \u003Cdiv class="map_canvas"\u003E\u003C/div\u003E\n{{/show_map}}\n\u003C/div\u003E\n',geo_autocomplete_item:'{{#is_poi}}\n\u003Cli\u003E\n  \u003Cspan class="place_icon"\u003E\u0026nbsp;\u003C/span\u003E{{formatted_name}}\n  \u003Cspan class="place_details"\u003E{{details}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}\n{{^is_poi}}\n\u003Cli\u003E\n  \u003Cspan class="place_noicon"\u003E{{formatted_name}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}',default_dropdown_divider:'\u003Chr class="dropdown-divider"/\u003E\n',recent_profile_activity:"{{#show_following}}\n  {{\u003Efollowing_list_small}}\n{{/show_following}}\n\n{{#show_followers}}\n  {{\u003Efollowers_list_small}}\n{{/show_followers}}\n\n{{#show_favorite}}\n  {{\u003Elatest_favorite_small}}\n{{/show_favorite}}\n\n{{#show_lists}}\n  {{\u003Elisted_list_small}}\n{{/show_lists}}\n\n{{#show_wtf_links}}\n  {{^following_nobody}}\n    {{#positive_nooblevel}}\n      {{\u003Ewho_to_follow_links}}\n    {{/positive_nooblevel}}\n  {{/following_nobody}}\n{{/show_wtf_links}}",bg_img_css:'\u003Cstyle id="user-style-{{screen_name}}-bg-img"\u003E\n  body.user-style-{{screen_name}} {\n    {{#profile_use_background_image}}\n      {{#profile_background_image_url}}\n        background-image: url({{profile_background_image_url}});\n      {{/profile_background_image_url}}\n    {{/profile_use_background_image}}\n  }\n\u003C/style\u003E',message_drawer:"\u003Cdiv class='message {{type}}'\u003E\u003Cdiv class='message-inside'\u003E\u003Cspan\u003E{{{text}}}\u003C/span\u003E{{#close_button}}\u003Ca class='dismiss' href='#'\u003E\u0026times;\u003C/a\u003E{{/close_button}}\u003C/div\u003E\u003C/div\u003E\n",mute_users:'\u003Cdiv class="muted-users"\u003E\n  \u003Cdiv class="input-autocomplete"\u003E\n    \u003Cinput type="text" size="20" class="mute-input"/\u003E \u003Ca href="#" class="button"\u003E{{_i}}Add{{/i}}\u003C/a\u003E\n  \u003C/div\u003E\n  \u003Cul class="muted-user-list"\u003E\u003C/ul\u003E\n\u003C/div\u003E',verify_email_banner:'\u003Cdiv class="banner-outer banner-border"\u003E\n  \u003Cdiv class="banner"\u003E\n    \u003Cdiv class="banner-inside verify-email-banner"\u003E\n      {{#pendingNew}}\n        \u003Cdiv class="first-banner-row"\u003E\n          \u003Cspan class="title"\u003E{{_i}}Confirm your email address to access all of Twitter\'s features.{{/i}}\u003C/span\u003E\n          \u003Cspan\u003E{{_i}}A confirmation message was sent to \u003Cstrong\u003E{{email}}\u003C/strong\u003E.{{/i}}\u003C/span\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="second-banner-row"\u003E\n          \u003Ca href="#" class=\'resend-confirmation-email-link\'\u003E{{_i}}Resend confirmation{{/i}}\u003C/a\u003E \u0026middot; \u003Ca href="{{change_email_path}}"\u003E{{_i}}Update email address{{/i}}\u003C/a\u003E \u0026middot; \u003Ca href="{{email_help_path}}"\u003E{{_i}}Learn more{{/i}}\u0026nbsp; \u0026rsaquo;\u003C/a\u003E\n        \u003C/div\u003E\n      {{/pendingNew}}\n      {{#pendingChanged}}\n        \u003Cdiv class="first-banner-row"\u003E\n          \u003Cspan class="title"\u003E{{_i}}You still need to confirm your email change.{{/i}}\u003C/span\u003E\n          \u003Cspan\u003E{{_i}}A confirmation email was sent to \u003Cstrong\u003E{{email}}\u003C/strong\u003E. Your email will not be changed until you complete this step!{{/i}}\u003C/span\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="second-banner-row"\u003E\n          \u003Ca href="#" class=\'resend-confirmation-email-link\'\u003E{{_i}}Resend confirmation{{/i}}\u003C/a\u003E \u0026middot; \u003Ca href="{{change_email_path}}"\u003E{{_i}}Cancel or update this email address{{/i}}\u003C/a\u003E\n        \u003C/div\u003E\n      {{/pendingChanged}}\n      {{#pendingBouncing}}\n        \u003Cdiv class="first-banner-row"\u003E\n          \u003Cspan class="title"\u003E{{_i}}Whoops, we haven\'t been able to send email to your new address!{{/i}}\u003C/span\u003E\n          \u003Cspan\u003E{{_i}}We\'ve tried sending confirmation emails to \u003Cstrong\u003E{{email}}\u003C/strong\u003E but they are not getting delivered.{{/i}}\u003C/span\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="second-banner-row"\u003E\n          {{_i}}You can \u003Ca href="{{change_email_path}}"\u003Echange to a different address\u003C/a\u003E or we can \u003Ca href=\'#\' class=\'resend-confirmation-email-link\'\u003Etry again\u003C/a\u003E.{{/i}}\n        \u003C/div\u003E\n      {{/pendingBouncing}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',geo_search_result_item:'{{#is_poi}}\n\u003Cli id="result_place_{{id}}"\u003E\n  \u003Cspan class="geo-place-search-result-icon"\u003E\u0026nbsp;\u003C/span\u003E\u003Ca href="#"\u003E{{name}}\u003C/a\u003E\u003Cbr\u003E\n  \u003Cspan class="geo-place-details"\u003E{{full_address}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}\n{{^is_poi}}\n\u003Cli id="result_place_{{id}}"\u003E\n  \u003Ca href="#"\u003E{{name}}\u003C/a\u003E\u003C/span\u003E\u003Cbr\u003E\n  \u003Cspan class="geo-place-details"\u003E{{full_address}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}\n',posting_tweet_box:'\u003Cform method="post" action="/status/update"\u003E\n  \u003Cdiv class="tweet-box"\u003E\n    \u003Ch2\u003E{{_i}}What\u2019s happening?{{/i}}\u003C/h2\u003E\n    \u003Cdiv class="text-area"\u003E\u003Ctextarea name="status" style="width: 482px; height: 36px;"\u003E\u003C/textarea\u003E\u003C/div\u003E\n    \u003Cdiv class="tweet-button-container"\u003E\u003Ca class="tweet-button button" href="#"\u003E\u003Cinput type="submit" value="{{_i}}Tweet{{/i}}" /\u003E\u003C/a\u003E\u003C/div\u003E\n  \u003C/div\u003E\n\u003C/form\u003E',stream_list:'\u003Cdiv class="stream-list"\u003E\n  {{#user}}\n  \u003Cdiv class="list-image"\u003E\n    \u003Cimg src="{{profile_image_url}}" width="36" height="36" /\u003E\n  \u003C/div\u003E\n  {{/user}}\n  \u003Cdiv class="list-content"\u003E\n    \u003Ca class="list-name" href="{{user_list_path}}"\u003E{{full_name}}\u003C/a\u003E\n    {{^is_public}}\n      \u003Cspan class="protected-icon"\u003E\u003C/span\u003E\n    {{/is_public}}\n    \u003Cspan class="list-description"\u003E{{description}}\u003C/span\u003E\n    {{#logged_in}}\n      \u003Cdiv class="list-buttons buttons"\u003E\n        {{#is_own_list}}\n          {{\u003Eedit_list_button}}\n          {{\u003Edelete_list_button}}\n        {{/is_own_list}}\n        {{^is_own_list}}\n          {{#following}}\n            \u003Cdiv class="button unfollow-list-button" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}"\u003E\u003Cspan class="you-follow"\u003E\u003C/span\u003E\u003C/div\u003E\n          {{/following}}\n          {{^following}}\n            \u003Cdiv class="button follow-list-button" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}"\u003E\u003Cspan class="plus"\u003E\u003C/span\u003E\u003C/div\u003E\n          {{/following}}\n        {{/is_own_list}}\n      \u003C/div\u003E\n    {{/logged_in}}\n  \u003C/div\u003E\n\u003C/div\u003E',user_recommendations_dropdown:'\u003Cdiv class="user-rec-dropdown profile-actions"\u003E\n  \u003Ca href="#" class="dismiss"\u003E\u0026times;\u003C/a\u003E\n  \u003Ch2\u003E\n    {{^is_narrow}}\n      {{_i}}Since you followed {{user}}, you might also want to follow:{{/i}}\n    {{/is_narrow}}\n    {{#is_narrow}}\n      {{_i}}You might also want to follow:{{/i}}\n    {{/is_narrow}}\n  \u003C/h2\u003E\n  \u003Cul class="recommended-followers user-rec-component"\u003E\n    {{#recommended_followers}}\n      {{\u003Euser_small_list}}\n    {{/recommended_followers}}\n  \u003C/ul\u003E\n\u003C/div\u003E',user:"\u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='thumb user-profile-link' data-user-id='{{id}}'/\u003E\n\u003Cspan class='user-name'\u003E\n  \u003Ca class='user-profile-link' data-user-id='{{id}}' href='#' title='{{name}}'\u003E\u003Cstrong\u003E{{screen_name}}\u003C/strong\u003E\u003C/a\u003E\n  \u003Cspan class='full-name'\u003E{{name}}\u003C/span\u003E\n\u003C/span\u003E\n",invite_friends:'\u003Cdiv class="invite-friends-component"\u003E\n\n  \u003Ch2\u003E\n    {{_i}}Invite Friends{{/i}}\n  \u003C/h2\u003E\n\n  \u003Cp\u003E\n    {{_i}}Not finding who you\'re looking for? Invite friends to Twitter via email.{{/i}}\u0026#32;\n    \u003Ca href="{{invitation_email_preview_path}}" class="popup" name="invitation_email_preview" data-popup="height=450,width=670"\u003E{{_i}}See what you\'ll send them.{{/i}}\u003C/a\u003E\n  \u003C/p\u003E\n\n  \u003Cform\u003E\n    \u003Ctextarea name="addresses" placeholder="{{_i}}Your friend\'s email address{{/i}}"\u003E\u003C/textarea\u003E\n    \u003Cdiv class="submit button"\u003E{{_i}}Invite{{/i}}\u003C/div\u003E\n    \u003Cp\u003E{{_i}}Lots of people to invite? Separate multiple email addresses with commas.{{/i}}\u003C/p\u003E\n  \u003C/form\u003E\n\n\u003C/div\u003E\n',pane_header:'\u003Cdiv class="header"\u003E\n  \u003Cem\u003E{{pane_header_text}}\u003C/em\u003E\n  \u003Cdiv class="back-button button"\u003E{{_i}}\u0026larr; Back{{/i}}\u003C/div\u003E\n\u003C/div\u003E',conversation_later:'\u003Cfieldset class="in-reply-to-border"\u003E\n  \u003Clegend class="in-reply-to-text"\u003E\n    {{_i}}replies{{/i}}\u0026nbsp;\u0026darr;\u003C/a\u003E\n  \u003C/legend\u003E\n\u003C/fieldset\u003E\n',contact_import_services_list:'\u003Cdiv class="service-links"\u003E\n  {{#services}}\n    \u003Ca class="service-button service-link {{#matched}}selected{{/matched}}" href="#"\n        data-url="{{url}}" data-popup="{{popup}}" data-name="{{name}}"\u003E\n      {{\u003Econtact_import_service_name}}\n    \u003C/a\u003E\n  {{/services}}\n\u003C/div\u003E',inline_media_icon:"\u003Cspan class='media {{icon}}' data-media-class='{{icon}}' data-media-type='{{media_name}}'\u003E\u003C/span\u003E",geo_progress:'{{^v3}}\n\u003Cspan class="crosshairs"\u003E\u0026nbsp;\u003C/span\u003E\n{{/v3}}\n\u003Cspan class="geo_progress"\u003E{{message}}\u003C/span\u003E\n{{\u003Egeo_disable_geo}}',contact_import_services:'{{#matched_service}}\n  \u003Cdiv class="matched-service"\u003E\n    {{#matched_email}}\n      \u003Cdiv class="matched-address"\u003E\n        {{_i}}Your email address:{{/i}}\u0026#32;\u003Cspan class="email"\u003E{{matched_email}}\u003C/span\u003E\n      \u003C/div\u003E\n    {{/matched_email}}\n\n    \u003Cdiv class="button service-button selected" data-url="{{url}}" data-popup="{{popup}}"\u003E\n      {{_i}}Find friends on {{\u003Econtact_import_service_long_name}}{{/i}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n{{/matched_service}}\n\n\n\u003Ch2\u003E\n  \u0026nbsp;{{#matched_service}}{{_i}}More services:{{/i}}{{/matched_service}}\u0026nbsp;\n\u003C/h2\u003E\n\n{{#services}}\n  {{^matched_email}}\n    \u003Cdiv class="button service-button service-button-small" data-url="{{url}}" data-popup="{{popup}}"\u003E\n      {{\u003Econtact_import_service_name}}\n    \u003C/div\u003E\n  {{/matched_email}}\n{{/services}}\n\n\u003Cp class=\'import-help\'\u003E\n  {{_i}}Choosing a service will open up a window for you to log in securely and authorize Twitter to see your contacts. You\'ll only see users who have allowed their accounts to be found by email address. \u003Cstrong\u003EDon\'t worry:\u003C/strong\u003E we won\'t share your contacts with anybody or email anyone without your consent.{{/i}}\n\u003C/p\u003E\n',search_advanced:'\u003Cdiv class="search advanced-search"\u003E\n  \u003Ch1\u003E{{_i}}Advanced \u003Cstrong\u003ESearch\u003C/strong\u003E{{/i}}\u003C/h1\u003E\n\n  \u003Cform\u003E\n\n    \u003Cfieldset\u003E\n      \u003Clegend\u003E\u003Cspan\u003E{{_i}}Words{{/i}}\u003C/span\u003E\u003C/legend\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}All of these words{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="ands" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}This exact phrase{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="phrase" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}Any of these words{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="ors" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}None of these words{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="nots" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}These hashtags{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="tag" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cfieldset\u003E\n      \u003Clegend\u003E\u003Cspan\u003E{{_i}}People{{/i}}\u003C/span\u003E\u003C/legend\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}From these accounts{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="from" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}To these accounts{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="to" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}Mentioning these accounts{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="ref" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cfieldset class="geo"\u003E\n      \u003Clegend\u003E\u003Cspan\u003E{{_i}}Places{{/i}}\u003C/span\u003E\u003C/legend\u003E\n      \u003Cdiv class="txt"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}Near this place{{/i}}\u003C/span\u003E\n          \u003Cinput type="text" name="near" /\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="sel"\u003E\n        \u003Clabel\u003E\n          \u003Cspan class="td"\u003E{{_i}}Within this distance{{/i}}\u003C/span\u003E\n          \u003Cselect name="within"\u003E\n            \u003Coption value="1"\u003E1\u003C/option\u003E\n            \u003Coption value="5"\u003E5\u003C/option\u003E\n            \u003Coption value="10"\u003E10\u003C/option\u003E\n            \u003Coption value="15" selected="selected"\u003E15\u003C/option\u003E\n            \u003Coption value="25"\u003E25\u003C/option\u003E\n            \u003Coption value="50"\u003E50\u003C/option\u003E\n            \u003Coption value="100"\u003E100\u003C/option\u003E\n            \u003Coption value="500"\u003E500\u003C/option\u003E\n            \u003Coption value="1000"\u003E1000\u003C/option\u003E\n          \u003C/select\u003E\n        \u003C/label\u003E\n        \u003Cspan class="rad"\u003E\n          \u003Clabel\u003E\u003Cinput name="units" type="radio" value="mi" checked="checked" /\u003E\u003Cspan\u003E{{_i}}miles{{/i}}\u003C/span\u003E\u003C/label\u003E\n          \u003Clabel\u003E\u003Cinput name="units" type="radio" value="km" /\u003E\u003Cspan\u003E{{_i}}kilometers{{/i}}\u003C/span\u003E\u003C/label\u003E\n        \u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cfieldset\u003E\n      \u003Clegend\u003E\u003Cspan\u003E{{_i}}Other{{/i}}\u003C/span\u003E\u003C/legend\u003E\n      \u003Cdiv class="chk"\u003E\n        \u003Cspan class="td"\u003E{{_i}}Select:{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E\n          \u003Clabel\u003E\u003Cinput name="attd" type="checkbox" value=":)" /\u003E\u003Cspan\u003E{{_i}}Positive :){{/i}}\u003C/span\u003E\u003C/label\u003E\n          \u003Clabel\u003E\u003Cinput name="attd" type="checkbox" value=":(" /\u003E\u003Cspan\u003E{{_i}}Negative :({{/i}}\u003C/span\u003E\u003C/label\u003E\n          \u003Clabel\u003E\u003Cinput name="attd" type="checkbox" value="?" /\u003E\u003Cspan\u003E{{_i}}Question ?{{/i}}\u003C/span\u003E\u003C/label\u003E\n          \u003Clabel\u003E\u003Cinput name="include" type="checkbox" value="retweets" /\u003E\u003Cspan\u003E{{_i}}Include retweets{{/i}}\u003C/span\u003E\u003C/label\u003E\n        \u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cdiv class="button submit selected"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\n\n  \u003C/form\u003E\n\n\u003C/div\u003E',welcome_to_phoenix_banner:'\u003Cdiv class="welcome-banner-outer banner-outer"\u003E\n  \u003Cdiv class="welcome-banner banner"\u003E\n    \u003Cdiv class="welcome-banner-inside banner-inside"\u003E\n      \u003Ca class=\'pane-close\' href=\'#\'\u003E{{_i}}Close{{/i}}\u0026nbsp;\u003Cspan\u003E\u0026times;\u003C/span\u003E\u003C/a\u003E\n      \u003Cspan\u003E\n        \u003Cform method="post" action="{{turn_phx_off_path}}" class="turn-phx-off-form"\u003E\u003Cinput type="hidden" name="setting" value="false"/\u003E\u003Cinput type="hidden" name="format" value="html"/\u003E\u003Cinput type=\'hidden\' value=\'{{form_authenticity_token}}\' name=\'authenticity_token\'/\u003E{{_i}}Welcome to \u003Ca href="{{welcome_search_results_path}}"\u003E#NewTwitter\u003C/a\u003E! Read up on \u003Ca target="_blank" href="{{whats_new_path}}"\u003Ewhat\u2019s new\u003C/a\u003E. You can still access \u003Cbutton type="submit" class="turn-phx-off-button"\u003Eold Twitter\u003C/button\u003E for a limited time.{{/i}}\u003C/form\u003E\n      \u003C/span\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',mentioned_in_tweet:'\u003Cdiv class="mentioned-in-tweet"\u003E\n  \u003Ch3\u003E{{_i}}Mentioned in this Tweet{{/i}}\u003C/h3\u003E\n  \u003Cul class="clearfix"\u003E\n  {{#mentioned_users}}\n    {{\u003Euser_detailed_list}}\n  {{/mentioned_users}}\n  \u003C/ul\u003E\n\u003C/div\u003E\n',mobile_gallery_download_dialog:'\u003Cdiv class="twttr-dialog-download-mobile"\u003E\n  \u003Cp\u003E\n    {{_i}}Give us your email address and we\'ll send a link to download the right Twitter app for your mobile device.{{/i}}\n  \u003C/p\u003E\n\n  \u003Cform class="dialog-form"\u003E\n    \u003Cfieldset class="common-form"\u003E\n      \u003Clabel class="field"\u003E\n        \u003Cspan class="label"\u003E{{_i}}Enter your email address:{{/i}}\u003C/span\u003E\n        \u003Cspan class="input-wrapper"\u003E\n          \u003Cinput type="email" name="email" /\u003E\n        \u003C/span\u003E\n      \u003C/label\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cdiv class="dialog-prompt"\u003E\n      \u003Cdiv class="button selected submit"\u003E{{_i}}Send link{{/i}}\u003C/div\u003E\n      \u003Ca href="#" class="cancel"\u003E{{_i}}cancel{{/i}}\u003C/a\u003E\n    \u003C/div\u003E\n  \u003C/form\u003E\n\u003C/div\u003E\n',tweet_user_image_48:"{{#user}}\n\u003Cimg height=\"48\" width=\"48\" src='{{profile_image_url}}' alt='{{name}}' class='user-profile-link' data-user-id='{{id}}'/\u003E\n{{/user}}\n",rss_feeds:'\u003Cdiv class="inner-feeds"\u003E\n{{#feeds}}\n\u003Cimg src="/phoenix/img/rss.gif" /\u003E\n\u003Ca type="application/rss+xml" rel="alternate" href="{{href}}"\u003E{{title}}\u003C/a\u003E\n{{/feeds}}\n\u003C/div\u003E',keyboard_shortcuts:'\u003Cdiv class="t-section t-tpl-33-67" id="keyboard-shortcut-menu"\u003E\n  \u003Cdiv class="t-unit t-first"\u003E\n    \u003Cdl\u003E\n      \u003Cdt\u003E{{_i}}Actions{{/i}}\u003C/dt\u003E\n      \u003Cdd\u003E\u003Cstrong\u003Ef :\u003C/strong\u003E \u003Cem\u003E{{_i}}favorite{{/i}}\u003C/em\u003E\u003C/dd\u003E\n      \u003Cdd\u003E\u003Cstrong\u003Er :\u003C/strong\u003E \u003Cem\u003E{{_i}}reply{{/i}}\u003C/em\u003E\u003C/dd\u003E\n      \u003Cdd\u003E\u003Cstrong\u003Et :\u003C/strong\u003E \u003Cem\u003E{{_i}}retweet{{/i}}\u003C/em\u003E\u003C/dd\u003E\n      \u003Cdd\u003E\u003Cstrong\u003Em :\u003C/strong\u003E \u003Cem\u003E{{_i}}direct message{{/i}}\u003C/em\u003E\u003C/dd\u003E\n      \u003Cdd\u003E\u003Cstrong\u003En :\u003C/strong\u003E \u003Cem\u003E{{_i}}new Tweet{{/i}}\u003C/em\u003E\u003C/dd\u003E\n      \u003Cdd\u003E\u003Cstrong\u003Eenter :\u003C/strong\u003E \u003Cem\u003E{{_i}}toggle details pane{{/i}}\u003C/em\u003E\u003C/dd\u003E\n    \u003C/dl\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="t-unit"\u003E\n\n    \u003Cdiv class="t-section t-tpl-50-50"\u003E\n\n      \u003Cdiv class="t-unit t-first"\u003E\n\n        \u003Cdl\u003E\n          \u003Cdt\u003E{{_i}}Navigation{{/i}}\u003C/dt\u003E\n          \u003Cdd\u003E\u003Cstrong\u003E? :\u003C/strong\u003E \u003Cem\u003E{{_i}}this menu{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Ej :\u003C/strong\u003E \u003Cem\u003E{{_i}}next Tweet{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Ek :\u003C/strong\u003E \u003Cem\u003E{{_i}}previous Tweet{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Espace :\u003C/strong\u003E \u003Cem\u003E{{_i}}page down{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003E/ :\u003C/strong\u003E \u003Cem\u003E{{_i}}search{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003E. :\u003C/strong\u003E \u003Cem\u003E{{_i}}refresh Tweets and back to top{{/i}}\u003C/em\u003E\u003C/dd\u003E\n        \u003C/dl\u003E\n\n      \u003C/div\u003E\n      \u003Cdiv class="t-unit"\u003E\n        \u003Cdl\u003E\n          \u003Cdt\u003E{{_i}}Timelines{{/i}}\u003C/dt\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg h :\u003C/strong\u003E \u003Cem\u003E{{_i}}\u003Cu\u003Eh\u003C/u\u003Eome{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg r :\u003C/strong\u003E \u003Cem\u003E{{_i}}\u003Cu\u003Er\u003C/u\u003Eeplies / mentions{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg p :\u003C/strong\u003E \u003Cem\u003E{{_i}}\u003Cu\u003Ep\u003C/u\u003Erofile{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg f :\u003C/strong\u003E \u003Cem\u003E{{_i}}\u003Cu\u003Ef\u003C/u\u003Eavorites{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg m :\u003C/strong\u003E \u003Cem\u003E{{_i}}\u003Cu\u003Em\u003C/u\u003Eessages{{/i}}\u003C/em\u003E\u003C/dd\u003E\n          \u003Cdd\u003E\u003Cstrong\u003Eg u :\u003C/strong\u003E \u003Cem\u003E{{_i}}go to \u003Cu\u003Eu\u003C/u\u003Eser{{/i}}\u003C/em\u003E\u003C/dd\u003E\n        \u003C/dl\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',user_thumb_list:"\u003Cul class='inline-list'\u003E\n  {{#items}}\n    {{\u003Euser_thumb_list_item}}\n  {{/items}}\n\u003C/ul\u003E\n",full_name:'\u003Cdiv class="full-name"\u003E\n  \u003Ch2\u003E{{name}}\u003C/h2\u003E\n  {{#verified}}\n    \u003Cspan class="verified-icon"\u003E\u003C/span\u003E\n  {{/verified}}\n  {{#protected}}\n    \u003Cspan class="protected-icon"\u003E\u003C/span\u003E\n  {{/protected}}\n\u003C/div\u003E',mobile_gallery_app:'\u003Cdiv class="gallery-link"\u003E\n  \u003Ca href="{{mobile_gallery_path}}"\u003E\u0026larr; {{_i}}Back to Mobile{{/i}}\u003C/a\u003E\n\u003C/div\u003E\n\n\u003Cdiv class="mobile-gallery-app mobile-gallery-{{app_id}}"\u003E\n  \u003Cdiv class="app-header"\u003E\n    \u003Ch2\u003E{{app_short_name}}\u003C/h2\u003E\n    \u003Cp class="compatibility"\u003E{{compatibility}}\u003C/p\u003E\n  \u003C/div\u003E\n\n  \u003Cdiv class="actions actions-single yes-script {{^no_camera}} qr-code-actions {{/no_camera}}"\u003E\n    \u003Cdiv class="app-download"\u003E\n      \u003Ca class="button promotional" href="{{url}}" target="_blank"\u003E{{_i}}Download now{{/i}}\u003C/a\u003E\n    \u003C/div\u003E\n    \u003Cform class="app-download-form dialog-form {{^no_camera}} qr-code {{/no_camera}}"\u003E\n      {{#no_camera}}\n        \u003Cp\u003E{{_i}}Or email a link to your {{device_noun}} to download:{{/i}}\u003C/p\u003E\n      {{/no_camera}}\n      {{^no_camera}}\n        \u003Cp\u003E{{_i}}Scan the QR code or email a link to your {{device_noun}} to download{{/i}}\u003C/p\u003E\n      {{/no_camera}}\n      \u003Cfieldset class="common-form"\u003E\n        \u003Cdiv class=\'field\'\u003E\n          \u003Cinput type="hidden" name="appId" value="{{app_id}}" /\u003E\n          \u003Cinput type="email" class="email" name="email" placeholder="{{_i}}Email address{{/i}}"\u003E\u003Cdiv class="button submit"\u003E{{_i}}Send link{{/i}}\u003C/div\u003E\n          \n          \u003Cdiv class=\'label\'\u003E\u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/fieldset\u003E\n    \u003C/form\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\n\u003Ctable class="mobile-footer" cellpadding="0"\u003E\n  \u003Ctbody\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}What\u2019s happening?{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          {{_i}}Discover what\u2019s happening right now, anywhere in the world, with the official {{app_long_name}} app.{{/i}}\n        \u003C/p\u003E\n      \u003C/td\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}What matters to you the most{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          {{_i}}Search, Top Tweets, trending topics, and maps show what\u2019s happening everywhere and nearby.{{/i}}\n        \u003C/p\u003E\n      \u003C/td\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}Communicate easily{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          {{_i}}Tweet, send DMs, share photos, videos, and links with your friends and the world.{{/i}}\n        \u003C/p\u003E\n      \u003C/td\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}It\u2019s free!{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          {{_i}}Don\'t have an account? Just sign up from the app!{{/i}}\u0026nbsp;{{_i}}Questions? See \u003Ca href="{{support_url}}"\u003ETwitter Support: {{app_long_name}}\u003C/a\u003E{{/i}}\n        \u003C/p\u003E\n      \u003C/td\u003E\n    \u003C/tr\u003E\n  \u003Ctbody\u003E\n\u003C/table\u003E\n',device_setup_dialog:"\u003Cdiv class='twttr-dialog-device-setup'\u003E\n  \u003Cdiv class='loading'\u003E\u003C/div\u003E\n\u003C/div\u003E\n",conversation_earlier:'\u003Cfieldset class="in-reply-to-border conversation-earlier-border"\u003E\n  \u003Clegend class="in-reply-to-text"\u003E\n    {{_i}}in reply to{{/i}}\u0026nbsp;\u0026uarr;\u003C/a\u003E\n  \u003C/legend\u003E\n\u003C/fieldset\u003E\n',blocking_controls:'\u003Cspan class="icon blocking-icon"\u003E\u003C/span\u003E\n\u003Cspan class="you-blocked"\u003E\n  {{#reported}}\n    {{_i}}Blocked and reported for spam{{/i}}\n  {{/reported}}\n  {{^reported}}\n    {{_i}}Blocked{{/i}}\n  {{/reported}}\n  \u0026#32;\u0026mdash;\u0026#32;\n  \u003Ca href="#" class="profile-unblock-link" data-user-id="{{id}}"\u003E{{_i}}Undo{{/i}}\u003C/a\u003E\n  {{#reported}}\n    \u003Ca href="{{spam_learn_more_path}}" target="_blank" class="spam-learn-more-link"\u003E{{_i}}Learn more{{/i}}\u003C/a\u003E\n  {{/reported}}\n\u003C/span\u003E',dashboard_getting_started:'\u003Cdiv class="getting-started"\u003E\n\n  \u003Ch2\u003E\n    {{title}}\n    {{#is_noob_level_5_6_7}}\n        \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E \u003Ca href="#" class="hidenextsteps"\u003E{{_i}}hide next steps{{/i}}\u003C/a\u003E\n    {{/is_noob_level_5_6_7}}\n  \u003C/h2\u003E\n\n  \u003Col\u003E\n\n    {{#is_noob_level_0}}\n      {{\u003Egetting_started_follow}}\n      {{\u003Egetting_started_mobile}}\n      {{\u003Egetting_started_profile}}\n      {{\u003Egetting_started_tweet}}\n    {{/is_noob_level_0}}\n\n    {{#is_noob_level_1_2_3}}\n      {{\u003Egetting_started_tweet}}\n      {{\u003Egetting_started_profile}}\n      {{\u003Egetting_started_mobile}}\n    {{/is_noob_level_1_2_3}}\n\n    {{#is_noob_level_4}}\n      {{\u003Egetting_started_follow}}\n      {{\u003Egetting_started_mobile}}\n      {{\u003Egetting_started_profile}}\n    {{/is_noob_level_4}}\n\n    {{#is_noob_level_5_6_7}}\n      {{\u003Egetting_started_mobile}}\n      {{\u003Egetting_started_profile}}\n    {{/is_noob_level_5_6_7}}\n\n  \u003C/ol\u003E\n\n\u003C/div\u003E\n\n',geo_failure_try_again:'{{message}}\n\u0026#32;\n\u003Ca href="#" class="geo_enable_webclient"\u003E{{_i}}Try again{{/i}}\u003C/a\u003E\n{{\u003Egeo_disable_geo}}',trend_item:"\u003Cli class=\"trend-item {{#promoted_content}}promoted-trend{{/promoted_content}}\"\u003E\n  \u003Ca href='{{trend_search_path}}' class='trend-link'\u003E{{name}}\u003C/a\u003E\n  {{#is_sponsored}}\n\n    {{#decider_new_tweet_labels}}\n      \u003Cspan class='new-tweet-label tweet-label-promoted-other'\u003E\n        \u003Ca href='{{trend_search_path}}'\u003E\n          \u003Ci\u003E\u003C/i\u003E\n          \u003Cspan\u003E\n            {{#promoted_content}}\n                {{#advertiser_name}}\n                  {{_i}}Promoted by {{advertiser_name}}{{/i}}\n                {{/advertiser_name}}\n                {{^advertiser_name}}\n                  {{_i}}Promoted{{/i}}\n                {{/advertiser_name}}\n            {{/promoted_content}}\n          \u003C/span\u003E\n        \u003C/a\u003E\n      \u003C/span\u003E\n    {{/decider_new_tweet_labels}}\n\n    {{^decider_new_tweet_labels}}\n      \u003Ca href='{{trend_search_path}}' class='tweet-label promoted-label'\u003E\n        {{#promoted_content}}\n            {{#advertiser_name}}\n              {{_i}}Promoted by {{advertiser_name}}{{/i}}\n            {{/advertiser_name}}\n            {{^advertiser_name}}\n              {{_i}}Promoted{{/i}}\n            {{/advertiser_name}}\n        {{/promoted_content}}\n      \u003C/a\u003E\n    {{/decider_new_tweet_labels}}\n\n  {{/is_sponsored}}\n\u003C/li\u003E",contact_import_service_long_name:'\n\n\u003Cstrong class="service-name service-{{id}}" data-service-id="{{id}}"\u003E\n  {{#long_html_name}}{{{long_html_name}}}{{/long_html_name}}\n  {{^long_html_name}}\u003Cspan\u003E\u003C/span\u003E{{name}}{{/long_html_name}}\n\u003C/strong\u003E\n',login_page:'\u003Cdiv class="main"\u003E\n\n  \u003Cform action="{{sessions_path}}" class="signin" method="post"\u003E\n    \u003Ch4\u003E{{_i}}Sign in to Twitter{{/i}}\u003C/h4\u003E\n    {{\u003Esignin_form_textbox}}\n    \u003Cdiv class="captcha"\u003E\u003C/div\u003E\n    {{\u003Esignin_form_subchck}}\n  \u003C/form\u003E\n\n  \u003Cdiv class="signup"\u003E\n    \u003Ca href="{{signup_path}}?context=login"\u003E{{_i}}New to Twitter? \u003Cem\u003EJoin Today!\u003C/em\u003E{{/i}}\u003C/a\u003E\n  \u003C/div\u003E\n\n  \u003Cdiv class="aside"\u003E\n    \u003Cp class="forgot"\u003E\n      \u003Cspan class="icon" /\u003E\n      {{_i}}Forgot your \u003Ca href="{{resend_password_path}}"\u003Epassword\u003C/a\u003E or \u003Ca href="{{resend_password_path}}"\u003Eusername\u003C/a\u003E?{{/i}}\n    \u003C/p\u003E\n    \u003Cp class="mobile"\u003E\n      \u003Cspan class="icon" /\u003E\n      {{_i}}Already using Twitter via SMS?{{/i}}\u003Cbr /\u003E\n      \u003Ca href="{{mobile_complete_path}}"\u003E{{_i}}Activate your account{{/i}}\u0026#32;\u0026raquo;\u003C/a\u003E\n    \u003C/p\u003E\n  \u003C/div\u003E\n\n\u003C/div\u003E\n\n\u003Cdiv class="bottompart"\u003E\u003C/div\u003E',related_tweets_data_attributes:'data-related-impression-id="{{related_impression_id}}" data-related-group-name="{{related_group_name}}" data-related-annotations="{{related_annotations}}"\n{{#ab_data_bucket}}\n  data-ab-data-bucket="{{ab_data_bucket}}" data-ab-data-experiment-key="{{ab_data_experiment_key}}" data-ab-data-version="{{ab_data_version}}"\n{{/ab_data_bucket}}',local_trends_new:'\u003Cdiv class="local-trends-breadcrumbs"\u003E{{\u003Elocal_trends_breadcrumbs}}\u003C/div\u003E\n\u003Cdiv\u003E\n  \u003Cul class="local-trends-list-new"\u003E\n    {{#locations0}}\n      {{\u003Elocal_trend_location_new}}\n    {{/locations0}}\n  \u003C/ul\u003E\n  \u003Cul class="local-trends-list-new"\u003E\n    {{#locations1}}\n      {{\u003Elocal_trend_location_new}}\n    {{/locations1}}\n  \u003C/ul\u003E\n  \u003Cul class="local-trends-list-new"\u003E\n    {{#locations2}}\n      {{\u003Elocal_trend_location_new}}\n    {{/locations2}}\n  \u003C/ul\u003E\n\u003C/div\u003E',profile_signup_call_out:'\u003Cdiv class="signup-call-out"\u003E\n  \u003Ch1\u003E\u003Cspan\u003E{{_i}}{{name}} is on Twitter{{/i}}\u003C/span\u003E\u003C/h1\u003E\n  \u003Ch2\u003E\n    {{_i}}Don\'t miss any updates from {{name}}. Get your account on Twitter today to stay up-to-date on what interests you!{{/i}}\n  \u003C/h2\u003E\n  {{\u003Esignup_button}}\n\u003C/div\u003E',mobile_gallery_page:'{{#render_page_content}}\n  {{#app_id}}\n    {{\u003Emobile_gallery_app}}\n  {{/app_id}}\n  {{^app_id}}\n    {{\u003Emobile_gallery_all}}\n  {{/app_id}}\n\n  \u003Cdiv class="logged-out"\u003E\n    \u003Cdiv class="bottompart"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n{{/render_page_content}}\n',welcome_footer_steps:'\u003Cdiv class="outerin"\u003E\u003Cul\u003E\n\n{{#step_starter}}\n  \u003Cli class="right next-step"\u003E\n    \u003Ca href="{{welcome_interests_path}}" class="button selected"\u003E\n      {{_i}}Next Step: \u003Cem\u003EInterests\u003C/em\u003E{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_starter}}\n\n{{#step_backto_starter}}\n  \u003Cli class="left prev-step"\u003E\n    \u003Ca href="{{welcome_starter_path}}" class="button"\u003E\n      {{_i}}Back to: \u003Cem\u003ESuggestions\u003C/em\u003E{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_backto_starter}}\n\n{{#step_interests}}\n  \u003Cli class="right next-step"\u003E\n    \u003Ca href="{{welcome_import_path}}" class="button selected"\u003E\n      {{_i}}Next Step: \u003Cem\u003EFriends\u003C/em\u003E{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_interests}}\n\n{{#step_backto_interests}}\n  \u003Cli class="left prev-step"\u003E\n    \u003Ca href="{{welcome_interests_path}}" class="button"\u003E\n      {{_i}}Back to: \u003Cem\u003EInterests\u003C/em\u003E{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_backto_interests}}\n\n{{#step_backto_import}}\n  \u003Cli class="left prev-step"\u003E\n    \u003Ca href="{{welcome_import_path}}" class="button"\u003E\n      {{_i}}Back to: \u003Cem\u003EFriends\u003C/em\u003E{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_backto_import}}\n\n{{#step_previous_interests}}\n\u003Cli class="left prev-step"\u003E\n  \u003Ca href="{{welcome_interests_path}}" class="button"\u003E\n    {{_i}}Previous step: \u003Cem\u003EInterests\u003C/em\u003E{{/i}}\n  \u003C/a\u003E\n\u003C/li\u003E\n{{/step_previous_interests}}\n\n{{#step_finish}}\n\u003Cli class="right next-step"\u003E\n  \u003Ca href="#" class="button selected"\u003E\n    {{_i}}Finish{{/i}}\n  \u003C/a\u003E\n\u003C/li\u003E\n{{/step_finish}}\n\n{{#step_skip}}\n  \u003Cli class="right next-step"\u003E\n    \u003Ca href="#" class="button"\u003E\n      {{_i}}Skip import{{/i}}\n    \u003C/a\u003E\n  \u003C/li\u003E\n{{/step_skip}}\n\u003C/ul\u003E\u003C/div\u003E',griffin_user_list:'\u003Cdiv\u003E\n  {{#sections}}\n    \u003Cdiv class="griffin-user-list-section"\u003E\n      {{#title}}\n        \u003Ch2\u003E{{title}}\u003C/h2\u003E\n      {{/title}}\n\n      \u003Cul\u003E\n        {{#users}}\n          {{\u003Euser_small_list_item}}\n        {{/users}}\n      \u003C/ul\u003E\n    \u003C/div\u003E\n  {{/sections}}\n\u003C/div\u003E',followers_list_small:'{{%TRANSLATION-HINT mode=user_stats}}\n\n\u003Cdiv class="your-activity new-followers-activity"\u003E\n  \u003Ch2\u003E\n    \u003Ca href="{{user_followers_path}}" class="title-link"\u003E\u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Followers{{/i}}\u003C/span\u003E\u003Cspan class=\'user-stat-link\'\u003E{{followers_count_commaized}}\u003C/span\u003E\u003C/a\u003E\n  \u003C/h2\u003E\n\u003C/div\u003E',list_actions:'\u003Cdiv class="list-actions list-actions-{{id}}"\u003E\n  {{#is_own_list}}\n    \u003Cdiv class="buttons"\u003E\n      {{\u003Eedit_list_button}}\n      {{\u003Edelete_list_button}}\n    \u003C/div\u003E\n  {{/is_own_list}}\n  {{^is_own_list}}\n    \u003Cdiv class="follow-state"\u003E\n      {{#following}}\n        \u003Cspan class="you-follow"\u003E{{_i}}Following{{/i}} \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\u003C/span\u003E\n        \u003Ca href=\'#\' class="unfollow-list-link" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}"\u003E{{_i}}Unfollow{{/i}}\u003C/a\u003E\n      {{/following}}\n      {{^following}}\n        \u003Cdiv class="button follow-list-button" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}"\u003E\n          \u003Cspan class="plus"\u003E\u003C/span\u003E \u003Cstrong\u003E{{_i}}Follow this list{{/i}}\u003C/strong\u003E\n        \u003C/div\u003E\n      {{/following}}\n    \u003C/div\u003E\n  {{/is_own_list}}\n\u003C/div\u003E\n',latest_tweet_timestamp:'\u003Ca href="{{permalink_path}}" class=\'latest-tweet-timestamp\' title="{{explicit_timestamp}}"\u003E\u003Cspan class="_timestamp" data-time="{{actual_timestamp}}" data-long-form="true"\u003E{{full_timestamp}}\u003C/span\u003E\u003C/a\u003E',retweeters:"\u003Ch3 class='retweets_count'\u003E{{{retweeted_by_count}}}\u003C/h3\u003E\n\u003Cdiv class=\"meta-links clearfix\"\u003E\n  \u003Cul class='retweeters'\u003E\n    {{#retweeters}}\n      {{\u003Euser_thumb_list_item}}\n    {{/retweeters}}\n  \u003C/ul\u003E\n\u003C/div\u003E\n",slideshow_tweet:'\u003Cdiv class="tweet slideshow-tweet" data-tweet-id="{{id}}" data-item-id="{{id}}" {{#current_user_retweet}}data-my-retweet-id="{{id}}"{{/current_user_retweet}} {{#was_retweeted}}{{#retweeting_status}}data-retweet-id="{{id}}"{{/retweeting_status}}{{/was_retweeted}} {{#user}}data-screen-name="{{screen_name}}" data-user-id="{{id}}"{{/user}}\u003E\n  \u003Cdiv class="tweet-image"\u003E\n      {{\u003Etweet_user_image_48}}\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-content"\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_user_name}}\n      \u003Cdiv class="tweet-corner"\u003E\n        {{\u003Etweet_meta}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_text}}\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{#decider_new_tweet_labels}}\n        {{\u003Etweet_labels}}\n      {{/decider_new_tweet_labels}}\n      {{\u003Etweet_timestamp}}\n      {{\u003Etweet_actions}}\n    \u003C/div\u003E\n    {{^decider_new_tweet_labels}}\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Etweet_labels}}\n      \u003C/div\u003E\n    {{/decider_new_tweet_labels}}\n  \u003C/div\u003E\n\u003C/div\u003E',geo_firefox_banner:'\u003Cdiv id="geo_browser_help_banner" class="geo_firefox"\u003E\n  \u003Cdiv\u003E{{_i}}Before Twitter can get your location...{{/i}}\u003C/div\u003E\n  \u003Cdiv\u003E\u003Cimg src="/images/geo_browser_help_banner_1.png" /\u003E{{_i}}Check "Remember for this site"{{/i}}\u003C/div\u003E\n  \u003Cdiv\u003E\u003Cimg src="/images/geo_browser_help_banner_2.png" /\u003E{{_i}}Click "Share Location"{{/i}}\u003C/div\u003E\n\u003C/div\u003E\n',new_tweets_bar:'\u003Cdiv id="new-tweets-bar"\u003E{{_i}}{{tweets_count_phrase}}{{/i}}\u003C/div\u003E\n',place_page_tweets_title:"{{_i}}Twitter / Tweets about {{{placeName}}}{{/i}}\n",no_list_members:'\u003Cp class="no-members"\u003E{{_i}}This list doesn\u2019t follow any users yet. It probably will soon, though.{{/i}}\u003C/p\u003E\n',tweet_text_large:"\u003Cdiv class='tweet-text tweet-text-large'\u003E{{{linkified_text}}}\u003C/div\u003E",following_list_small:'{{%TRANSLATION-HINT mode=user_stats}}\n\n\u003Cdiv class="your-activity following-activity"\u003E\n  \u003Ch2\u003E\n    {{^show_following_15_narrow}}\n      \u003Ca href="{{user_following_path}}" class="title-link"\u003E\u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Following{{/i}}\u003C/span\u003E\u003Cspan class=\'user-stat-link\'\u003E{{friends_count_commaized}}\u003C/span\u003E\u003C/a\u003E\n    {{/show_following_15_narrow}}\n    {{#show_following_15_narrow}}\n      \u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Following{{/i}}\u003C/span\u003E\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      \u003Ca href="{{user_following_path}}" class="view-all"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n    {{/show_following_15_narrow}}\n  \u003C/h2\u003E\n  {{#show_wtf_links}}\n    {{#following_nobody}}\n      {{\u003Ewho_to_follow_links}}\n    {{/following_nobody}}\n  {{/show_wtf_links}}\n\u003C/div\u003E',mobile_gallery_logged_out_header:'\u003Cdiv id="mobile-gallery-logged-out-header"\u003E\n  \u003Ch2\u003E{{_i}}You\u2019ve signed out of Twitter{{/i}} \u003Cspan class="check"\u003E\u003C/span\u003E\u003C/h2\u003E\n  \u003Ch1\u003E{{_i}}Now go mobile.{{/i}}\u003C/h1\u003E\n\u003C/div\u003E\n',media_gallery_controls:'\u003Cdiv class="media-gallery-controls"\u003E\n{{#is_search}}\n  \u003Cdiv class="media-gallery-title"\u003E\n    {{_i}}Popular {{mode}} for{{/i}} {{query}}\n  \u003C/div\u003E\n{{/is_search}}\n\n  \u003Cdiv class="media-gallery-buttons"\u003E\n    \u003Cdiv class="toggle-set"\u003E\n      \u003Cdiv class="toggle-button detailview {{#is_detail_view}}selected{{/is_detail_view}}"\u003E\n        \u003Cspan\u003E\u003C/span\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="divider"\u003E\u003C/div\u003E\n      \u003Cdiv class="toggle-button gridview {{#is_grid_view}}selected{{/is_grid_view}}"\u003E\n        \u003Cspan\u003E\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Ca class="media-gallery-close" href="#"\u003E{{_i}}close{{/i}} \u0026times;\u003C/a\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',getting_started_mobile:'\u003Cli class="mobile"\u003E\n  \u003Cspan\u003E{{_i}}Get Twitter on your phone{{/i}}\u003C/span\u003E\n  \u003Cul\u003E\n    \u003Cli\u003E\u003Ca href="{{devices_path}}"\u003E{{_i}}Set up mobile notifications{{/i}}\u003C/a\u003E\u003C/li\u003E\n    {{#decider_mobile_download_gallery}}\n    \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}"\u003E{{_i}}Download a Twitter application to your phone{{/i}}\u003C/a\u003E\u003C/li\u003E\n    {{/decider_mobile_download_gallery}}\n  \u003C/ul\u003E\n\u003C/li\u003E\n',stream_tweet:'\u003Cdiv class=\'more\'\u003E\u0026raquo;\u003C/div\u003E\n\u003Cdiv class="stream-item-content tweet stream-tweet {{css_classes}}" data-tweet-id="{{id}}" {{{tweet_impression_id}}} data-item-id="{{id}}" {{#current_user_retweet}}data-my-retweet-id="{{id}}"{{/current_user_retweet}} {{#was_retweeted}}{{#retweeting_status}}data-retweet-id="{{id}}"{{/retweeting_status}}{{/was_retweeted}} {{#user}}data-screen-name="{{screen_name}}" data-user-id="{{id}}"{{/user}}\u003E\n  {{\u003Etweet_dogear}}\n  \u003Cdiv class="tweet-image"\u003E\n      {{\u003Etweet_user_image_48}}\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-content"\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_user_name}}\n      \u003Cdiv class="tweet-corner"\u003E\n        {{\u003Etweet_meta}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_text}}\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{#decider_new_tweet_labels}}\n        {{\u003Etweet_labels}}\n      {{/decider_new_tweet_labels}}\n      {{\u003Etweet_timestamp}}\n      {{\u003Etweet_actions}}\n    \u003C/div\u003E\n    {{^decider_new_tweet_labels}}\n      {{#is_sponsored}}\n        \u003Cdiv class="tweet-row tweet-labels"\u003E\n          {{\u003Etweet_labels}}\n        \u003C/div\u003E\n      {{/is_sponsored}}\n\n      {{#is_top_tweet}}\n        \u003Cdiv class="tweet-row tweet-labels"\u003E\n          {{\u003Etweet_labels}}\n        \u003C/div\u003E\n      {{/is_top_tweet}}\n    {{/decider_new_tweet_labels}}\n\n  \u003C/div\u003E\n\u003C/div\u003E\n{{#is_sponsored}}\n  {{#decider_ptw_negative_feedback}}\n    {{\u003Etweet_feedback}}\n  {{/decider_ptw_negative_feedback}}\n{{/is_sponsored}}',permalink_tweet:'{{#can_view}}\n  \u003Cdiv class="tweet permalink-tweet {{css_classes}}" data-tweet-id="{{id}}" data-item-id="{{id}}" {{#current_user_retweet}}data-my-retweet-id="{{id}}"{{/current_user_retweet}} data-screen-name=\'{{#user}}{{screen_name}}{{/user}}\'\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{#user}}\n        {{\u003Etweet_user_block}}\n      {{/user}}\n      \u003Cdiv class="tweet-corner"\u003E\n        {{\u003Etweet_meta}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_text_large}}\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-media-container"\u003E\u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_timestamp}}\n      {{\u003Etweet_contributor}}\n      {{\u003Etweet_source}}\n      {{\u003Etweet_actions}}\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Etweet_geo_text}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n{{/can_view}}\n{{^can_view}}\n  {{_i}}This person has protected their Tweets.{{/i}}\n{{/can_view}}\n',invite_contacts:'\u003Cdiv class="invite-contacts-component"\u003E\n  {{#title}}\n    \u003Ch2\u003E{{title}}\u003C/h2\u003E\n  {{/title}}\n  \u003Cp\u003E\n    \u003Cspan\u003E{{_i}}These people are in your contacts, but aren\'t on Twitter yet. We can\n    invite the ones you select here.{{/i}}\u003C/span\u003E\n    {{{preview_link_html}}}\n  \u003C/p\u003E\n\n  \u003Cdiv class="people-chooser-list"\u003E\n    \u003Cdiv class="select-all-people"\u003E\n      \u003Cdiv class="checkbox"\u003E\n        \u003Cspan\u003E\u003Cinput type="checkbox" name="select_all" id="select-all-contacts"/\u003E\u003C/span\u003E\n      \u003C/div\u003E\n      \u003Cdiv\u003E\n        \u003Cspan\u003E\u003Clabel for="select-all-contacts"\u003E{{select_all_text}}\u003C/label\u003E\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cul class="contacts"\u003E\n      {{#contacts}}\n        \u003Cli\u003E\n          \u003Cdiv class="checkbox"\u003E\n            \u003Cspan\u003E\u003Cinput type="checkbox" name="emails[]" value="{{email}}" id="contact-box-{{index}}"/\u003E\u003C/span\u003E\n          \u003C/div\u003E\n          \u003Cdiv class="name" title="{{name}}"\u003E\n            \u003Cspan\u003E\u003Clabel for="contact-box-{{index}}"\u003E{{#truncate}}{{name}}{{/truncate}}\u003C/label\u003E\u003C/span\u003E\n          \u003C/div\u003E\n          \u003Cdiv class="about" title="{{email}}"\u003E\n            \u003Cspan\u003E\u0026lt;{{#truncate}}{{email}}{{/truncate}}\u0026gt;\u003C/span\u003E\n          \u003C/div\u003E\n        \u003C/li\u003E\n      {{/contacts}}\n    \u003C/ul\u003E\n  \u003C/div\u003E\n\n  \u003Cdiv class="list-editor"\u003E\n    \u003Cdiv class="save"\u003E\n      \u003Cdiv class="button invite-contacts-button"\u003E{{_i}}Invite these friends{{/i}}\u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',griffin_page:'\u003Cdiv class="main-content griffin"\u003E\n  {{{noscript}}}\n    {{#griffin}}\n      \u003Cdiv class="griffin-header"\u003E\n        \u003Ch2 class="griffin-title"\u003E{{name}} \u003Cstrong\u003E{{hashtag_with_hash}}\u003C/strong\u003E\u003C/h2\u003E\n        \u003Cdiv class="griffin-description"\u003E\u003Cem\u003E{{description}}\u003C/em\u003E\u003C/div\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="griffin-tweet-button"\u003E\u003C/div\u003E\n      \u003Cul class="stream-tabs"\u003E\n        \u003Cli class="stream-tab stream-tab-tweets {{#active_tab_tweets}}active{{/active_tab_tweets}}"\u003E\n          \u003Ca class="tab-text" href="{{griffin_path}}"\u003E{{_i}}Tweets{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n\n        \u003Cli class="stream-tab stream-tab-toptweets {{#active_tab_toptweets}}active{{/active_tab_toptweets}}"\u003E\n          \u003Ca class="tab-text" href="{{griffin_top_path}}"\u003E{{_i}}Top Tweets{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n\n        \u003Cli class="stream-tab stream-tab-peopleifollow {{#active_tab_peopleifollow}}active{{/active_tab_peopleifollow}}"\u003E\n          \u003Ca class="tab-text" href="{{griffin_social_path}}"\u003E{{_i}}People I Follow{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n\n        \u003Cli class="stream-tab stream-tab-hashtag {{#active_tab_hashtag}}active{{/active_tab_hashtag}}"\u003E\n          \u003Ca class="tab-text" href="{{griffin_hashtag_path}}"\u003E{{_i}}{{hashtag_with_hash}}{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n      \u003C/ul\u003E\n      {{\u003Estream_manager}}\n    {{/griffin}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n\u003Cdiv class="dashboard griffin-dashboard"\u003E\u003C/div\u003E\n{{\u003Edetails_pane_container}}',home_dashboard:'\u003Cdiv class="component"\u003E\n{{\u003Edashboard_your_profile}}\n\u003Chr/\u003E\n\u003C/div\u003E\n\n\u003Cdiv class="component"\u003E\n{{\u003Edashboard_footer}}\n\u003C/div\u003E',stream_whale_end:'\u003Cdiv class="stream-whale-end"\u003E\n  \u003Cdiv class="title"\u003E{{{text}}}\u003C/div\u003E\n  \u003Cdiv\u003E\n    {{_i}}Twitter may be over capacity or experiencing a momentary hiccup. \u003Ca href="#" class="try-again-after-whale"\u003ETry again\u003C/a\u003E or visit \u003Ca target="_blank" href="{{status_path}}"\u003ETwitter Status\u003C/a\u003E for more information.{{/i}}\n  \u003C/div\u003E\n\u003C/div\u003E\n',add_people:'\u003Cdiv class="no-members"\u003E\n  \u003Ch3\u003E{{_i}}Find people to add to your list:{{/i}}\u003C/h3\u003E\n  \u003Cform class="search-for-list-people" action="{{who_to_follow_search_form_path}}" method="GET"\u003E\n    \u003Cinput type="text" value="" name="q" placeholder="{{_i}}find users by name{{/i}}" /\u003E\n    \u003Cdiv class="submit button"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\n  \u003C/form\u003E\n  \u003Cp class="instruction"\u003E{{_i}}Search for a username, first or last name, business or brand{{/i}}\u003C/p\u003E\n  \u003Cp class="tip"\u003E{{_i}}You can also add people from your \u003Ca href="{{following_path}}"\u003EFollowing\u003C/a\u003E page or anyone\u2019s profile page.{{/i}}\u003C/p\u003E\n\u003C/div\u003E',first_time_dialog:'\u003Cdiv {{#container_id}}id="{{container_id}}" {{/container_id}}class="twttr-dialog-container" style="visibility: hidden;"\u003E\n  \u003Cdiv class="twttr-dialog" style="top: 142px !important;"\u003E\n    \u003Cdiv class="twttr-dialog-inside"\u003E\n      \u003Cdiv class="twttr-dialog-body clearfix"\u003E\n        \u003Cdiv class="twttr-dialog-content twttr-dialog-first-time"\u003E\n          \u003Cdiv\u003E\n            \u003Ch2 class="first-time"\u003E{{_i}}Everything in one place.{{/i}}\u003C/h2\u003E\n            \u003Cp class="first-time-text"\u003E\n              {{_i}}Preview \u003Cspan class="photo-icon icon"\u003E\u003C/span\u003E\u003Cstrong\u003Epictures\u003C/strong\u003E \u003Cspan class="video-icon icon"\u003E\u003C/span\u003E\u003Cstrong\u003Evideos\u003C/strong\u003E \u003Cspan class="reply-icon icon"\u003E\u003C/span\u003E\u003Cstrong class="text-replies"\u003Ereplies\u003C/strong\u003E right from Twitter!{{/i}}\n            \u003C/p\u003E\n            \u003Cp\u003E\n              {{_i}}Click on the arrow button in a Tweet to view rich media and related content in a details pane.{{/i}}\n            \u003C/p\u003E\n            \u003Cdiv class="image-container first-time"\u003E\n              \u003Cimg src="/phoenix/img/promo-screenshot.png"/\u003E\n            \u003C/div\u003E\n            \u003Cdiv class="button ok-thanks"\u003E\u003Cstrong\u003E{{_i}}OK, thanks!{{/i}}\u003C/strong\u003E\u003C/div\u003E\n          \u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',home_events:'\u003Cdiv class="home-events"\u003E\n  \u003Ch2\u003E{{_i}}What\u2019s on Twitter \u003Cstrong\u003Eright now\u003C/strong\u003E{{/i}}\u003C/h2\u003E\n  \u003Cdiv class="home-events-list"\u003E\n    \u003Ca href="/#!/search/%23NFLDraft" class="first"\u003E\n      \u003Cdiv class="caption"\u003E\n        \u003Ch3\u003E{{_i}}#NFLDraft{{/i}}\u003Cb\u003E\u0026raquo;\u003C/b\u003E\u003C/h3\u003E\n        \u003Cspan style="display:none"\u003E{{_i}}The 76th Annual NFL Draft. 32 teams. 7 rounds. Who will your team pick? Follow it here.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/a\u003E\n    \u003Ca href="/#!/search/%23RoyalWedding" class="second"\u003E\n      \u003Cdiv class="credits"\u003E{{_i}}\u00a9Clarence House, 2011{{/i}}\u003C/div\u003E\n      \u003Cdiv class="caption"\u003E\n        \u003Ch3\u003E{{_i}}#RoyalWedding{{/i}}\u003Cb\u003E\u0026raquo;\u003C/b\u003E\u003C/h3\u003E\n        \u003Cspan style="display:none"\u003E{{_i}}The world is watching Prince William and Kate Middleton. Follow the procession of Tweets here.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/a\u003E\n    \u003Ca href="/#!/search/%23STS134" class="third"\u003E\n      \u003Cdiv class="caption"\u003E\n        \u003Ch3\u003E{{_i}}#STS134{{/i}}\u003Cb\u003E\u0026raquo;\u003C/b\u003E\u003C/h3\u003E\n        \u003Cspan style="display:none"\u003E{{_i}}5... 4... 3... Don\'t miss @NASA\'s second-to-last space shuttle flight. Follow the mission here.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/a\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',tweet_modal_button:'\u003Cdiv class="tweet-modal-button"\u003E\n  \u003Ca class="button"\u003E{{_i}}Tweet{{/i}}\u003C/a\u003E\n\u003C/div\u003E',sms_codes:'\u003Ctable id="sms_codes" cellpadding="0" cellspacing="0"\u003E\n  \u003Cthead\u003E\n    \u003Ctr\u003E\n      \u003Cth\u003E{{_i}}Country{{/i}}\u003C/th\u003E\n      \u003Cth\u003E{{_i}}Code{{/i}}\u003C/th\u003E\n      \u003Cth\u003E{{_i}}For customers of{{/i}}\u003C/th\u003E\n    \u003C/tr\u003E\n  \u003C/thead\u003E\n  \u003Ctbody\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}Australia{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E0198089488\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}Telstra{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}Canada{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E21212\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}(any){{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}United Kingdom{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E86444\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}Vodafone, Orange, 3, O2{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}Indonesia{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E89887\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}AXIS, 3, Telkomsel{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}Ireland{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E51210\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}O2{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}India{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E53000\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}Bharti Airtel{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}New Zealand{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E8987\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}Vodafone, Telecom NZ{{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E{{_i}}United States{{/i}}\u003C/td\u003E\n      \u003Ctd\u003E40404\u003C/td\u003E\n      \u003Ctd\u003E{{_i}}(any){{/i}}\u003C/td\u003E\n    \u003C/tr\u003E\n  \u003C/tbody\u003E\n\u003C/table\u003E',dashboard_social_context_subcomponent:"\u003Cp\u003E{{{caption}}}\u003C/p\u003E\n{{{avatar_list}}}\n",web_search_results:'\u003Ch2\u003E{{_i}}Web results for \u003Cstrong\u003E{{query}}\u003C/strong\u003E{{/i}}\u003C/h2\u003E\n\u003Cul class="web-search-results"\u003E\n{{#results}}\n\u003Cli\u003E\n  \u003Ca href="{{Url}}" class="result-title" target="_blank"\u003E\u003Cspan class="result-title-text"\u003E{{{Title}}}\u003C/span\u003E\n  \u003Cspan class="result-link" target="_blank"\u003E{{DisplayUrl}}\u003C/span\u003E\u003C/a\u003E\n\u003C/li\u003E\n{{/results}}\n\u003C/ul\u003E\n\u003Ca href="{{more_results_url}}" target="_blank"\u003E{{_i}}More web results from Bing \u0026rarr;{{/i}}\u003C/a\u003E',stream_message:"\u003Cdiv\u003E{{screenName}}\u003C/div\u003E",recent_tweets:'\u003Cdiv class="recent-tweets"\u003E\n  \u003Ch3 class="profile-title"\u003E{{_i}}Recent Tweets{{/i}}\u003C/h3\u003E\n  {{#items}}\n    {{\u003Esimple_tweet}}\n  {{/items}}\n  \u003Ca href="{{profile_path}}" class="more-link" target="_blank"\u003E{{_i}}More Tweets from @{{screen_name}} \u0026rarr;{{/i}}\u003C/a\u003E\n\u003C/div\u003E',local_trend_location_icon:'\u003Cspan class="trend-location-icon"\u003E\u0026nbsp;\u003C/span\u003E',list_page:'\u003Cdiv class="main-content"\u003E\n  {{{noscript}}}\n    {{#list}}\n      \u003Cdiv class="list-header user-sidebar-color"\u003E\n        {{\u003Elist_header}}\n        \u003Cul class="stream-tabs"\u003E\n          \u003Cli class="stream-tab stream-tab-tweets {{#active_tab_tweets}}active{{/active_tab_tweets}}"\u003E\n            \u003Ca class="tab-text" href="{{user_list_path}}"\u003E{{_i}}Tweets{{/i}}\u003C/a\u003E\n          \u003C/li\u003E\n          \u003Cli class="stream-tab stream-tab-members {{#active_tab_members}}active{{/active_tab_members}}"\u003E\n            \u003Ca class="tab-text" href="{{list_members_path}}"\u003E{{_i}}Following: \u003Cstrong\u003E{{member_count}}\u003C/strong\u003E{{/i}}\u003C/a\u003E\n          \u003C/li\u003E\n          \u003Cli class="stream-tab stream-tab-followers {{#active_tab_followers}}active{{/active_tab_followers}}"\u003E\n            \u003Ca class="tab-text" href="{{list_subscribers_path}}"\u003E{{_i}}Followers: \u003Cstrong\u003E{{subscriber_count}}\u003C/strong\u003E{{/i}}\u003C/a\u003E\n          \u003C/li\u003E\n        \u003C/ul\u003E\n      \u003C/div\u003E\n      {{\u003Estream_manager}}\n    {{/list}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n\u003Cdiv class="dashboard"\u003E\u003C/div\u003E\n{{\u003Edetails_pane_container}}',local_trend_location_new:"\u003Cli\u003E\u003Ca href='#' data-woeid=\"{{woeid}}\"\u003E{{name}}\u003Cspan\u003E\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E",dashboard_contact_import:'\u003Cdiv class="contact-import-inner"\u003E\n  \u003Ch2 class="contact-import-component"\u003E\u003Ca class="title-link" href="{{who_to_follow_import_path}}"\u003E{{_i}}Find Friends{{/i}}\u003C/a\u003E\u003C/h2\u003E\n  \u003Ch3\u003E{{_i}}Use the services below to find people you know on Twitter{{/i}}\u003C/h3\u003E\n  \u003Cdiv class="contact-import-services {{#compact}}compact{{/compact}}"\u003E\n    {{#compact}}\n      {{\u003Econtact_import_services_icon_list}}\n    {{/compact}}\n    {{^compact}}\n      {{\u003Econtact_import_services_list}}\n    {{/compact}}\n  \u003C/div\u003E\n  \u003Chr class="component-spacer"/\u003E\n\u003C/div\u003E',user_static_list:"{{#items}}\n  {{\u003Euser_static_list_item}}\n{{/items}}",suspended_page:'\u003Cdiv class="four-oh-four"\u003E\n  {{#render_page_content}}\n    \u003Ch2\u003E{{_i}}Hold up!{{/i}}\u003C/h2\u003E\n    \u003Cp\u003E{{_i}}Sorry, the profile you are trying to view has been suspended.{{/i}}\u003C/p\u003E\n    \u003Cbr /\u003E\u003Cbr /\u003E\n    {{#logged_in}}\n      \u003Cp\u003E{{_i}}To visit your own account, \u003Ca href="{{home_path}}"\u003Eclick here\u003C/a\u003E.{{/i}}\u003C/p\u003E\n    {{/logged_in}}\n    {{^logged_in}}\n      \u003Cp\u003E{{_i}}To visit the homepage, \u003Ca href="{{home_path}}"\u003Eclick here\u003C/a\u003E.{{/i}}\u003C/p\u003E\n    {{/logged_in}}\n    \u003Cp\u003E{{_i}}\u0026hellip;or see \u003Ca href="http://search.twitter.com"\u003Ewhat else\u003C/a\u003E is happening on Twitter.{{/i}}\u003C/p\u003E\n    \u003Cp\u003E{{\u003Edashboard_footer}}\u003C/p\u003E\n  {{/render_page_content}}\n\u003C/div\u003E',mobile_gallery_all:'{{^logged_out}}\n  \u003Ch1\u003E{{_i}}Take Twitter with you. Get the app.{{/i}}\u003C/h1\u003E\n{{/logged_out}}\n\u003Cp class="m-twitter"\u003E{{_i}}Visit \u003Ca href="http://m.twitter.com"\u003Em.twitter.com\u003C/a\u003E on your mobile device.{{/i}}\u003C/p\u003E\n\n\u003Cul class="gallery"\u003E\n  \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}/iphone" class="mobile-app iphone"\u003E\u003Ci\u003E\u003C/i\u003E\u003Cbr/\u003E\u003Cspan\u003E{{_i}}iPhone{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n  \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}/android" class="mobile-app android"\u003E\u003Ci\u003E\u003C/i\u003E\u003Cbr/\u003E\u003Cspan\u003E{{_i}}Android{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n  \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}/ipad" class="mobile-app ipad"\u003E\u003Ci\u003E\u003C/i\u003E\u003Cbr/\u003E\u003Cspan\u003E{{_i}}iPad{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n  \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}/blackberry" class="mobile-app blackberry"\u003E\u003Ci\u003E\u003C/i\u003E\u003Cbr/\u003E\u003Cspan\u003E{{_i}}BlackBerry{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n  \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}/wp7" class="mobile-app wp7"\u003E\u003Ci\u003E\u003C/i\u003E\u003Cbr/\u003E\u003Cspan\u003E{{_i}}Windows Phone 7{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n\u003C/ul\u003E\n\n\u003Cdiv class="actions yes-script"\u003E\n  \u003Cdiv class="download-info"\u003E\n    \u003Cspan class="phrase"\u003E{{_i}}Have any of these devices?{{/i}}\u003C/span\u003E\n    {{_i}}\u003Ca class="promotional button download-now"\u003EDownload now\u003C/a\u003E \u003Cspan\u003Eor\u003C/span\u003E \u003Ca class="button activate-sms"\u003EUse via SMS\u003C/a\u003E \u003Cspan class="phrase second-phrase"\u003Eon any mobile phone\u003C/span\u003E{{/i}}\n  \u003C/div\u003E\n\u003C/div\u003E\n\n\u003Ctable class="mobile-footer mobile-footer-home" cellpadding="0"\u003E\n  \u003Ctbody\u003E\n    \u003Ctr\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}Have your device with you?{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          \u003Ca href="http://m.twitter.com"\u003E{{_i}}Visit m.twitter.com on your mobile browser{{/i}} \u0026raquo;\u003C/a\u003E\n        \u003C/p\u003E\n      \u003C/td\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}Questions about using Twitter mobile?{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\n          \u003Ca href="{{mobile_help_path}}"\u003E{{_i}}Visit our Mobile Help Center{{/i}} \u0026raquo;\u003C/a\u003E\n        \u003C/p\u003E\n      \u003C/td\u003E\n      \u003Ctd\u003E\n        \u003Ch4\u003E{{_i}}Privacy controls \u0026amp; notification settings?{{/i}}\u003C/h4\u003E\n        \u003Cp\u003E\u003Ca href="{{devices_path}}"\u003E{{_i}}Visit our Mobile Settings page{{/i}} \u0026raquo;\u003C/a\u003E\u003C/p\u003E\n      \u003C/td\u003E\n    \u003C/tr\u003E\n  \u003Ctbody\u003E\n\u003C/table\u003E\n',geo_similar_places:'\u003Cdiv\u003E{{_i}}This place may already exist{{/i}}\u003C/div\u003E\n\u003Cdiv class="geo-similar-places"\u003E\n  \u003Cdiv class="geo-map-canvas" /\u003E\n  \u003Cdiv class="geo-map-place-bubble"\u003E\n    \u003Cspan/\u003E\n    \u003Cdiv class="round"\u003E\n      \u003Cdiv class="geo-place-title" /\u003E\n      \u003Cdiv class="geo-place-details" /\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="geo-creation-actions"\u003E\n    \u003Cdiv\u003E{{_i}}Did you mean:{{/i}}\u003C/div\u003E\n    \u003Cul/\u003E\n    \u003Cdiv\u003E\n      \u003Cbutton type="button" class="btn btn-default geo-submit"\u003E{{_i}}No, just add my place{{/i}}\u003C/button\u003E\n      \u003Ca href="#" class="geo-go-back"\u003E{{_i}}Go Back{{/i}}\u003C/a\u003E\n      \u003Cspan class="geo-progress"\u003E\u0026nbsp;\u003C/span\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="geo-place-creation-error"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',tweet_user_image_32:"{{#user}}\n\u003Cimg height=\"32\" width=\"32\" src='{{profile_image_url}}' alt='{{name}}' class='user-profile-link' data-user-id='{{id}}'/\u003E\n{{/user}}\n",signin_form:'\u003Cform action="{{sessions_path}}" class="signin" method="post"\u003E\n  {{\u003Esignin_form_textbox}}\n  {{\u003Esignin_form_subchck}}\n  \u003Cp\u003E\n    \u003Ca class="forgot" href="{{resend_password_path}}"\u003E{{_i}}Forgot password?{{/i}}\u003C/a\u003E\u003Cbr /\u003E\n    \u003Ca class="mobile" href="{{mobile_complete_path}}"\u003E{{_i}}Already using Twitter on your phone?{{/i}}\u003C/a\u003E\n  \u003C/p\u003E\n\u003C/form\u003E',recent_list:'\u003Cli class="recent-list-item"\u003E\n  \u003Ca href="{{user_list_path}}" data-user-id="{{id}}"\u003E{{name}}\u003C/a\u003E\n\u003C/li\u003E\n',place_page_links_title:"{{#poi}}\n  {{_i}}Twitter / Tweets with links at {{{placeName}}}{{/i}}\n{{/poi}}\n{{^poi}}\n  {{_i}}Twitter / Tweets with links in {{{placeName}}}{{/i}}\n{{/poi}}",tweet_timestamp:'\u003Ca href="{{permalink_path}}" class=\'tweet-timestamp\' title="{{explicit_timestamp}}"\u003E{{#user}}{{#protected}}\u003Cspan class="protected-icon protected-icon-timeline"\u003E\u003C/span\u003E{{/protected}}{{/user}}\u003Cspan class="_timestamp" data-time="{{actual_timestamp}}" data-long-form="true"\u003E{{full_timestamp}}\u003C/span\u003E\u003C/a\u003E',contact_import_matches_stats:'\u003Cdiv class="contact-import-stats"\u003E\n  \u003Cdiv class="actions"\u003E\n    \u003Cdiv class="button button-default follow-all-button"\u003E\u003Cspan class="plus"\u003E\u003C/span\u003E \u003Cstrong\u003E{{follow_all_text}}\u003C/strong\u003E\u003C/div\u003E\u003Cbr/\u003E\n    {{^in_welcome_page}}\u003Ca href="#" class="save-as-list"\u003E{{_i}}Save as list{{/i}}\u003C/a\u003E{{/in_welcome_page}}\n  \u003C/div\u003E\n\n  \u003Ch3\u003E{{{found_contacts_text}}} \u0026middot; \u003Ca href="{{retry_service_path}}"\u003E{{_i}}Try another service{{/i}}\u003C/a\u003E\u003C/h3\u003E\n\n  \u003Cp\u003E\n    {{#others_count}}\n      \u003Cspan\u003E{{_i}}{{others_count}} of your {{service_name}} contacts aren\'t on Twitter yet.{{/i}}\u003C/span\u003E\n      \u003Ca href="#" class="invite-contacts"\u003E{{_i}}Invite them{{/i}}\u003C/a\u003E\n    {{/others_count}}\n  \u003C/p\u003E\n\u003C/div\u003E\n',simple_tweet:'\u003Cdiv class="stream-item"\u003E\n  \u003Cdiv class=\'more\'\u003E\u0026raquo;\u003C/div\u003E\n  \u003Cdiv class="stream-item-content tweet stream-tweet simple-tweet {{css_classes}}" data-tweet-id="{{id}}" {{{tweet_impression_id}}} {{#current_user_retweet}}data-my-retweet-id="{{id}}"{{/current_user_retweet}} data-item-id="{{id}}" {{#was_retweeted}}{{#retweeting_status}}data-retweet-id="{{id}}"{{/retweeting_status}}{{/was_retweeted}} {{#user}}data-screen-name="{{screen_name}}" data-user-id="{{id}}"{{/user}}\u003E\n    {{\u003Etweet_dogear}}\n    \u003Cdiv class="tweet-image simple-tweet-image"\u003E\n        {{\u003Etweet_user_image_32}}\n    \u003C/div\u003E\n    \u003Cdiv class="tweet-content simple-tweet-content"\u003E\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Etweet_user_name}}\n        \u003Cdiv class="tweet-corner"\u003E\n          {{\u003Etweet_meta}}\n        \u003C/div\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Etweet_text}}\n      \u003C/div\u003E\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Etweet_timestamp}}\n        {{\u003Etweet_actions}}\n      \u003C/div\u003E\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Etweet_labels}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',facet_media:'\u003Cdiv class="facets-inner"\u003E\n  \u003Ch2\u003E{{title}} \u0026middot; \u003Ca class="view-all" href="#"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\u003C/h2\u003E\n  \u003Cdiv class="facets-media-thumb-container"\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',geo_similar_place_item:'\u003Cli class="result-place-{{id}}"\u003E\n  \u003Ca href="#"\u003E{{formatted_name}}\u003C/a\u003E\u003Cbr\u003E\n  \u003Cspan class="geo-place-details"\u003E{{full_address}}\u003C/span\u003E\n\u003C/li\u003E\n\n',stream_follower_request:"\u003Cdiv data-user-id='{{id}}' class='user-content-medium clearfix'\u003E\n  \u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='user-content-image user-profile-link' data-user-id='{{id}}'/\u003E\n  \u003Cdiv class=\"user-content-rest\"\u003E\n    \u003Cspan class='user-name'\u003E\n      \u003Ca class='user-profile-link' data-user-id='{{id}}' href='#' title='{{name}}'\u003E\u003Cstrong\u003E{{screen_name}}\u003C/strong\u003E\u003C/a\u003E\n      \u003Cspan class='full-name'\u003E{{name}}\u003C/span\u003E\n      {{#verified}}\n        \u003Cspan class=\"verified-icon-small\"\u003E\u003C/span\u003E\n      {{/verified}}\n      {{#protected}}\n        \u003Cimg src=\"/phoenix/img/protected_small.gif\" /\u003E\n      {{/protected}}\n    \u003C/span\u003E\n    \u003Cdiv class=\"user-description\"\u003E{{{linkified_description}}}\u003C/div\u003E\n    \u003Cdiv class='user-meta'\u003E\u003C/div\u003E\n  \u003C/div\u003E\n  \u003Cdiv class=\"button-container\" style=\"float:right\"\u003E\n    \u003Cdiv class=\"button accept-follower-action\"\u003E\u003Cb\u003E{{_i}}Accept{{/i}}\u003C/b\u003E\u003C/div\u003E\n    \u003Cdiv class=\"button deny-follower-action\"\u003E{{_i}}Decline{{/i}}\u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n",tweet_geo_text:'{{#has_geo}}\n  {{^show_geo_map}}\n    \u003Ca class="tweet-geo-text"\n       data-tweet-id="{{id}}"\n       {{#place}}\n           data-place-id="{{id}}"\n       {{/place}}\u003E\n      {{_i}}from {{place_name}}{{/i}}\n    \u003C/a\u003E\n  {{/show_geo_map}}\n{{/has_geo}}\n',dashboard_trends_new:'\u003Cdiv class="trends-inner"\u003E\n  \u003Ch2\u003E{{_i}}Trends{{/i}}{{#logged_in}}\n  \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n  \u003Ca class="trend-location dropdown-link"\u003E{{_i}}Worldwide{{/i}}{{\u003Elocal_trend_location_icon}}\u003C/a\u003E{{/logged_in}}\u003C/h2\u003E\n\n  \u003Cul class=\'trends\'\u003E\u003C/ul\u003E\n\u003C/div\u003E',message_notification:"{{#message}}\n\u003Cdiv data-sender-id='{{sender_screen_name}}' data-message-id=\"{{id}}\" class='notification'\u003E\n  \u003Ca class='dismiss' href='#'\u003E\u0026times;\u003C/a\u003E\n  \u003Ch1\u003E{{_i}}New Message from {{{sender_screen_name}}}{{/i}}\u003C/h1\u003E\n  \u003Cdiv class='message-text'\u003E{{{text}}}\u003C/div\u003E\n  \u003Cdiv class=\"message-notification-reply-box\"\u003E\n    \u003Cdiv class=\"message-notification-reply-editor\"\u003E\u003C/div\u003E\n    \u003Cdiv class=\"message-notification-reply-button button\"\u003E{{_i}}Send{{/i}}\u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n{{/message}}",pill_css:".profile-style-{{screen_name}} a {\n  {{#profile_link_color}}\n    color: #{{profile_link_color}} !important;\n  {{/profile_link_color}}\n}\n\na:hover .geo-pin, body.user-style-{{screen_name}} .stream-item:hover .geo-pin, .place_link span.place_icon {\n  background-color: #{{profile_link_color}};\n}",language_dropdown:'\u003Cform action="{{change_locale_path}}" method="POST" class="language" onchange="this.submit()"\u003E\n  \u003Clabel\u003E\n    \u003Cspan\u003E{{_i}}Language:{{/i}}\u003C/span\u003E\n    \u003Cselect name="lang"\u003E\n      {{#languages}}\n        {{#current}}\n          \u003Coption value="{{code}}" selected\u003E{{name}}\u003C/option\u003E\n        {{/current}}\n        {{^current}}\n          \u003Coption value="{{code}}"\u003E{{name}} - {{name_own}}\u003C/option\u003E\n        {{/current}}\n      {{/languages}}\n    \u003C/select\u003E\n  \u003C/label\u003E\n\u003C/form\u003E\n',geo_add_location_geo_disabled:'{{^v3}}\n\u003Cspan class="crosshairs"\u003E\u0026nbsp;\u003C/span\u003E\n{{/v3}}\n\u003Ca class="show_geo_dialog" href="#"\u003E{{_i}}Add your location{{/i}}\u003C/a\u003E',checkbox_list_item:'\u003Cli class="{{className}}"\u003E\n  {{#icon}}\n    \u003Cspan class="{{icon}}"\u003E\u003C/span\u003E\n    {{{label}}}\n  {{/icon}}\n  {{^icon}}\n    \u003Cimg width="14" height="14" title="waiting" alt="{{_i}}waiting{{/i}}" style="display: none; float:left" src="/images/spinner.gif" class="loading-spinner"\u003E\n    \u003Cinput id="list_{{id}}" type="checkbox" style="float:left" {{#userIsMember}}data-is-checked="true" checked="checked"{{/userIsMember}}/\u003E\n    \u003Cspan class="checkbox-label"\u003E\n      {{{label}}}\n      {{#isPrivate}}\n        \u003Cspan title="{{_i}}Private List{{/i}}" class="lock-icon"\u003E\u003C/span\u003E\n      {{/isPrivate}}\n    \u003C/span\u003E\n  {{/icon}}\n\u003C/li\u003E',prompt:'\u003Cdiv class="twttr-prompt"\u003E\n  \u003Cdiv class="button twttr-prompt-ok"\u003E{{ok}}\u003C/div\u003E\n  \u003Cdiv class="button twttr-prompt-cancel"\u003E{{cancel}}\u003C/div\u003E\n\u003C/div\u003E',dashboard_trends:'\u003Cdiv class="trends-inner"\u003E\n  \u003Ch2\u003E{{_i}}Trends{{/i}}\n    {{#logged_in}}\n      {{#is_narrow}}\n        \u003Cspan class="trends-inline-controls"\u003E\n          \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n          \u003Cspan class="trend-location"\u003E{{_i}}Worldwide{{/i}}\u003C/span\u003E\n          \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n          \u003Cspan class=\'trend-toggle\'\u003E\u003Ca href=\'#\'\u003E{{_i}}change{{/i}}\u003C/a\u003E\u003C/span\u003E\n        \u003C/span\u003E\n      {{/is_narrow}}\n    {{/logged_in}}\n  \u003C/h2\u003E\n  {{#logged_in}}\n    {{^is_narrow}}\n      \u003Ch3\u003E\u003Cspan class="trend-location"\u003E{{_i}}Worldwide{{/i}}\u003C/span\u003E\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      \u003Cspan class=\'trend-toggle\'\u003E\u003Ca href=\'#\'\u003E{{_i}}change{{/i}}\u003C/a\u003E\u003C/span\u003E\u003C/h3\u003E\n    {{/is_narrow}}\n  {{/logged_in}}\n  \u003Cul class=\'trends\'\u003E\u003C/ul\u003E\n\u003C/div\u003E',user_small_list:"{{#items}}\n  {{\u003Euser_small_list_item}}\n{{/items}}",dashboard:"\u003Cdiv class='dashboard'\u003E\u003C/div\u003E",getting_started_profile:'\u003Cli class="profile"\u003E\n  \u003Cspan\u003E{{_i}}Set up your profile{{/i}}\u003C/span\u003E\n  \u003Cul\u003E\n    \u003Cli\u003E\u003Ca href="{{settings_profile_path}}"\u003E{{_i}}Upload a profile picture{{/i}}\u003C/a\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{settings_profile_path}}"\u003E{{_i}}Write a short bio{{/i}}\u003C/a\u003E\u003C/li\u003E\n  \u003C/ul\u003E\n\u003C/li\u003E',geo_dropdown_item:'{{#is_poi}}\n\u003Cli class="place_{{id}}"\u003E\n  \u003Cspan class="place_item_icon"\u003E\u0026nbsp;\u003C/span\u003E\n  \u003Cspan class="place_icon"\u003E\u0026nbsp;\u003C/span\u003E {{formatted_name}}\n  \u003Cspan class="place_details"\u003E{{details}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}\n{{^is_poi}}\n\u003Cli class="place_{{id}}"\u003E\n  \u003Cspan class="place_item_icon"\u003E\u0026nbsp;\u003C/span\u003E\n  \u003Cspan class="place_noicon"\u003E{{formatted_name}}\u003C/span\u003E\n\u003C/li\u003E\n{{/is_poi}}\n',profile_pane:'\u003Cdiv class=\'profile-pane\' {{{source_tweet_impression_id}}}\u003E\n  \u003Cstyle\u003E{{\u003Epill_css}}\u003C/style\u003E\n  \u003Cdiv class="profile-basics clearfix"\u003E\n    \u003Cdiv class="profile-text"\u003E\n      \u003Ca href="{{profile_path}}"\u003E\n        \u003Cimg src=\'{{right_image_size}}\' alt=\'{{name}}\' width=\'128\' class=\'thumb\' data-user-id=\'{{id}}\'/\u003E\n      \u003C/a\u003E\n      \u003Cdiv class="profile-info-wrapper"\u003E\n        {{\u003Efull_name}}\n        \u003Cdiv class="screen-name-and-location"\u003E\n          \u003Ca href="{{profile_path}}" class="screen-name screen-name-{{screen_name}} pill"\u003E\u003Cstrong\u003E@{{screen_name}}\u003C/strong\u003E \u003Cspan\u003E{{_i}}view full profile \u0026rarr;{{/i}}\u003C/span\u003E\u003C/a\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="location"\u003E{{#location}}{{location}}{{/location}}\u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="user-info"\u003E\n      \u003Cspan class="bio"\u003E{{{linkified_description}}}\u003C/span\u003E {{#url}}\u003Ca href="{{url}}" target="_blank"\u003E{{display_url_or_url}}\u003C/a\u003E{{/url}}\n    \u003C/div\u003E\n\n    {{\u003Euser_stats}}\n  \u003C/div\u003E\n\u003C/div\u003E',device_setup_dialog_create:"\u003Cdiv\u003E \n  \u003Cform class='dialog-form'\u003E\n    \u003Cp\u003E{{_i}}Twitter does not charge for this service. Standard message and data rates may apply.{{_i}}\u003C/p\u003E\n\n    \u003Cfieldset class='common-form'\u003E\n      \u003Cdiv class='field'\u003E\n        \u003Clabel\u003E\n          \u003Cspan class='label numbered'\u003E{{_i}}Select your country/region{{/i}}\u003C/span\u003E\n          \u003Cspan class='input-wrapper'\u003E\n            \u003Cselect class='country-or-region'\u003E\u003C/select\u003E\n          \u003C/span\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n\n      \u003Cdiv class='field' style=\"display: none;\"\u003E\n        \u003Cspan class='label'\u003E\u003C/span\u003E\n        \u003Cspan class='input-wrapper'\u003E\n          \u003Cselect class='country-in-region'\u003E\u003C/select\u003E\n        \u003C/span\u003E\n      \u003C/div\u003E\n\n      \u003Clabel class='field'\u003E\n        \u003Cspan class='label numbered'\u003E{{_i}}Enter your mobile phone number{{/i}}\u003C/span\u003E\n        \u003Cspan class='input-wrapper phone-wrapper'\u003E\n          \u003Cspan class='country-code'\u003E\u003C/span\u003E\u003Cinput class='phone' name='device[address]' type='tel' size='15' /\u003E\n        \u003C/span\u003E\n      \u003C/label\u003E\n      \u003Cdiv class='subfield'\u003E\n        \u003Clabel\u003E\n          \u003Cinput type='checkbox' name='user_mobile_discoverable' checked='checked' /\u003E\n          \u003Cspan\u003E{{_i}}Let others find me by my phone number{{/i}}\u003C/span\u003E\n        \u003C/label\u003E\n      \u003C/div\u003E\n\n      \u003Clabel class='field' style='display: none;'\u003E\n        \u003Cspan class='label numbered'\u003E{{_i}}Choose your carrier{{/i}}\u003C/span\u003E\n        \u003Cspan class='input-wrapper'\u003E\n          \u003Cselect class='carrier' name='device[carrier]'\u003E\u003C/select\u003E\n        \u003C/span\u003E\n      \u003C/label\u003E\n\n      \u003Clabel class='field' style='display: none;'\u003E\n        \u003Cspan class='label numbered'\u003E{{_i}}Choose a language for text messaging{{/i}}\u003C/span\u003E\n        \u003Cspan class='input-wrapper'\u003E\n          \u003Cselect class='language' name='mobile_locale'\u003E\u003C/select\u003E\n        \u003C/span\u003E\n      \u003C/label\u003E\n\n      \u003Cdiv class='field'\u003E\n        \u003Cspan class='label numbered'\u003E{{_i}}Verify your phone{{/i}}\u003C/span\u003E\n        \u003Cdiv class='input-wrapper'\u003E\n          \u003Cdiv class='button submit'\u003E{{_i}}Start{{/i}}\u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/fieldset\u003E\n\n    \u003Cinput name='device_type' type='hidden' value='phone' /\u003E\n  \u003C/form\u003E\n\u003C/div\u003E\n",in_reply_to:'\u003Cdiv class="in-reply-to" data-replied-tweet-id="{{id}}"\u003E\n  {{\u003Esimple_tweet}}\n  \u003Cfieldset class="in-reply-to-border"\u003E\n    \u003Clegend class="in-reply-to-text"\u003E\n      {{_i}}in reply to{{/i}}\u0026nbsp;\u003Ca class=\'user-profile-link\' data-user-id=\'{{#user}}{{id}}{{/user}}\' href="{{#user}}{{profile_path}}{{/user}}"\u003E@{{#user}}{{screen_name}}{{/user}}\u0026nbsp;\u0026uarr;\u003C/a\u003E\n    \u003C/legend\u003E\n  \u003C/fieldset\u003E\n\u003C/div\u003E\n',device_setup_dialog_source_address:'\u003Cdiv class="phone-instructions"\u003E\n  +{{country_code}} {{address_without_country_code}}\n  ({{country_name}}{{#carrier_name}} \u0026ndash; {{carrier_name}}{{/carrier_name}})\n\u003C/div\u003E\n',signin_or_signup:'\u003Cdiv id="signin-or-signup"\u003E\n\n  {{\u003Esignin_form}}\n\n  \u003Cdiv class="signup"\u003E\n    \u003Ch2\u003E{{_i}}Not on Twitter? Sign up, tune into the things you care about, and get updates as they happen.{{/i}}\u003C/h2\u003E\n    {{\u003Esignup_button}}\n  \u003C/div\u003E\n\n\u003C/div\u003E',geo_map_small:'\u003Cdiv class="tweet_geo_small"\u003E\n{{#place}}\n  {{#show_map}}\n    \u003Cdiv class="map_canvas geo_map_tweets_at_this_place_link"\n         data-tweet-id="{{tweet_id}}"\n         data-place-id="{{id}}"\n         data-place-name="{{full_name}}"\u003E\u003C/div\u003E\n  {{/show_map}}\n  \u003Cdiv class="geo_map_place_details"\u003E\n    \u003Cdiv class="geo_map_place_name"\u003E\n    {{#is_from}}\n      {{_i}}from {{name}}{{/i}}\n    {{/is_from}}\n    {{^is_from}}\n      {{_i}}{{name}}{{/i}}\n    {{/is_from}}\n    \u003C/div\u003E\n    \u003Cdiv\u003E{{address}}\u003C/div\u003E\n    \u003Cdiv\u003E{{container}}\u003C/div\u003E\n    \u003Cdiv\u003E{{phone}}\u003C/div\u003E\n    \u003Cdiv\u003E\n      \u003Ca class="geo_map_tweets_at_this_place_link" href="#"\n         data-tweet-id="{{tweet_id}}"\n         data-place-id="{{id}}"\n         data-place-name="{{full_name}}"\u003E\n        {{_i}}View Tweets about this place{{/i}}\n      \u003C/a\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n{{/place}}\n{{^place}}\n  {{#show_map}}\n    \u003Cdiv class="map_canvas geo_map_tweets_at_this_place_link"\n         data-tweet-id="{{tweet_id}}"\u003E\u003C/div\u003E\n  {{/show_map}}\n{{/place}}\n\u003C/div\u003E\n',latest_favorite:"\u003Cdiv class=\"latest-favorite-inner\" data-item-id=\"{{id}}\"\u003E\n  {{#user}}\n  \u003Cspan class='tweet-user-name'\u003E\n    \u003Ci\u003E\u003C/i\u003E\u003Ca class='tweet-screen-name user-profile-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\u003E{{screen_name}}\u003C/a\u003E\n  \u003C/span\u003E\n  {{/user}}\n  \u003Cdiv class='tweet-text'\u003E{{truncated_text}}\u003C/div\u003E\n\u003C/div\u003E",contact_import_loading:'\u003Cdiv class="stream-loading"\u003E\n  \u003Cspan class="spinner" title="{{_i}}Loading...{{/i}}"\u003E\u003C/span\u003E\n\n  \u003Cp\u003E\n    \u003Cstrong\u003E{{_i}}We\'re loading your contacts.{{/i}}\u003C/strong\u003E\n  \u003C/p\u003E\n\n  \u003Cp\u003E\n    {{_i}}(This can take a while if you\'ve got a large address book.){{/i}}\n  \u003C/p\u003E\n\u003C/div\u003E\n',list_stream_title:"\u003Cspan\u003E\n  {{full_name}}\n\u003C/span\u003E\n{{#showTitleLink}}\n  \u003Ca class='go-to-list-page' href='{{user_list_path}}'\u003E\n    {{_i}}View list page \u0026rarr;{{/i}}\n  \u003C/a\u003E\n{{/showTitleLink}}",message:"\u003Cdiv class='message' data-message-id=\"{{id}}\" data-thread-id=\"{{thread_id}}\"\u003E\n  \u003Cdiv class='message-inner'\u003E\n    {{#sender}}\n    \u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='thumb user-profile-link' data-user-id='{{id}}'/\u003E\n    \u003Cspan class='user-name'\u003E\n      \u003Ca class='user-profile-link' data-user-id='{{id}}' href='#' title='{{name}}'\u003E{{screen_name}}\u003C/strong\u003E\u003C/a\u003E\n    \u003C/span\u003E\n    {{/sender}}\n    \u003Cdiv class='message-content'\u003E\n      \u003Cdiv class='linked-text'\u003E{{{linkified_text}}}\u003C/div\u003E\n      \u003Cdiv class='message-footer'\u003E\n        \u003Cspan class='created-at'\u003E\u003Cspan class=\"_timestamp\" data-time=\"{{actual_timestamp}}\" data-long-form=\"true\" data-include-sec=\"true\"\u003E{{timestamp}}\u003C/span\u003E\u003C/span\u003E\n        \u003Ca class='delete-action' href=\"#\"\u003E\u003Cspan class=\"icon delete-icon\"\u003E\u003C/span\u003E \u003Cb\u003E{{_i}}Delete{{/i}}\u003C/b\u003E\u003C/a\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E",local_trends_breadcrumbs:"{{#first_breadcrumb_locations}}\n  {{\u003Elocal_trend_breadcrumb_location}}\n{{/first_breadcrumb_locations}}\n{{#last_breadcrumb_location}}\n  {{\u003Elocal_trend_last_breadcrumb_location}}\n{{/last_breadcrumb_location}}",britt_tweet:"{{_i}}Late night hacking on {{superlative}} things with @{{user}}.{{/i}}\n{{^is_before_midnight}}\n  {{_i}}Time to head home.{{/i}}\n{{/is_before_midnight}}\n{{something_about_addi}}\n",profile_similar_to_header:'\u003Cdiv class="profile-similar-to-header clearfix"\u003E\n  \u003Ca class="profile-back-link" href="{{profile_path}}"\u003E\u0026larr;\u0026nbsp;{{_i}}Back to{{/i}}\u0026nbsp;@{{screen_name}}\u003C/a\u003E\n  \u003Cdiv class="profile-similar-to-image-container component"\u003E\n    \u003Ca href="{{profile_path}}" class="user-profile-link user-thumb" target="_blank"\u003E\u003Cimg src="{{profile_image_url}}" alt="{{name}}" /\u003E\u003C/a\u003E\n    \u003Ch2 \u003E{{_i}}Similar to @{{screen_name}}{{/i}}\u003C/h2\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',stream_end:'\u003Cdiv class="stream-end"\u003E\n  \u003Cimg src="/phoenix/img/tiny-timeline-bird.png" class="stream-end-bird" /\u003E\n  {{{end_text}}}\n\u003C/div\u003E\n',user_css:'\u003Cstyle id="user-style-{{screen_name}}"\u003E\n  body.user-style-{{screen_name}} {\n    {{#profile_use_background_image}}\n      background-position: left 40px;\n      background-attachment: fixed;\n      {{^profile_background_tile}}\n        background-repeat: no-repeat;\n      {{/profile_background_tile}}\n    {{/profile_use_background_image}}\n    {{#profile_background_color}}\n      background-color: #{{profile_background_color}};\n    {{/profile_background_color}}\n    {{#profile_text_color}}\n      color: #{{profile_text_color}};\n    {{/profile_text_color}}\n  }\n\n  body.user-style-{{screen_name}} a,\n  body.user-style-{{screen_name}} ul.stream-tabs li,\n  body.user-style-{{screen_name}} .component .promo strong,\n  body.user-style-{{screen_name}} .message-thread-preview:hover .message-count,\n  body.user-style-{{screen_name}} .list-membership-container li.create-a-list {\n    {{#profile_link_color}}\n      color: #{{profile_link_color}};\n    {{/profile_link_color}}\n  }\n\n  body.user-style-{{screen_name}} .stream-item:hover .tweet-screen-name,\n  body.user-style-{{screen_name}} .stream-item:hover .tweet-timestamp,\n  body.user-style-{{screen_name}} .stream-item:hover .tweet-geo-text,\n  body.user-style-{{screen_name}} .stream-item:hover .user-profile-link,\n  body.user-style-{{screen_name}} div.latest-favorite .user-profile-link,\n  body.user-style-{{screen_name}} span.user-stat-link,\n  body.user-style-{{screen_name}} a.title-link:hover,\n  body.user-style-{{screen_name}} a.user-stats-count:hover span.user-stats-stat,\n  body.user-style-{{screen_name}} .dashboard .user-small-list-item:hover a.user-screen-name,\n  {{#is_narrow}}\n    body.user-style-{{screen_name}} .dashboard .user-small-list-item:hover .user-meta a,\n  {{/is_narrow}}\n  body.user-style-{{screen_name}} .user-detailed-list-item:hover a.user-screen-name,\n  body.user-style-{{screen_name}} .tweet-activity:hover a.latest-tweet-timestamp {\n    {{#profile_link_color}}\n      color: #{{profile_link_color}} !important;\n    {{/profile_link_color}}\n  }\n\n  body.user-style-{{screen_name}} .hovered-stream-item,\n  body.user-style-{{screen_name}} .stream-item:hover,\n  body.user-style-{{screen_name}} #new-tweets-bar,\n  body.user-style-{{screen_name}} #new-tweets-bar:active {\n    {{#rgba_tweet_background_color}}\n      background-color: {{rgba_tweet_background_color}};\n    {{/rgba_tweet_background_color}}\n    {{#rgba_tweet_border_color}}\n      border-color: {{rgba_tweet_border_color}};\n    {{/rgba_tweet_border_color}}\n  }\n\n  body.user-style-{{screen_name}} #new-tweets-bar:hover {\n    {{#rgba_newtweets_background_color}}\n      background-color: {{rgba_newtweets_background_color}};\n    {{/rgba_newtweets_background_color}}\n    {{#rgba_newtweets_border_color}}\n      border-color: {{rgba_newtweets_border_color}};\n    {{/rgba_newtweets_border_color}}\n  }\n\n  body.user-style-{{screen_name}} .dashboard .user-small-list-item .user-screen-name,\n  body.user-style-{{screen_name}} .profile-screenname,\n  body.user-style-{{screen_name}} .title-link,\n  body.user-style-{{screen_name}} div.latest-tweet .latest-tweet-timestamp,\n  body.user-style-{{screen_name}} a.user-stats-count span.user-stats-stat,\n  body.user-style-{{screen_name}} .welcome-steps li .active a strong {\n    {{#profile_text_color}}\n      color: #{{profile_text_color}};\n    {{/profile_text_color}}\n  }\n\n  body.user-style-{{screen_name}} .dashboard .user-small-list-item .user-full-name,\n  body.user-style-{{screen_name}} span.trend-location,\n  body.user-style-{{screen_name}} .your-activity h3,\n  body.user-style-{{screen_name}} .trends-inner h3,\n  body.user-style-{{screen_name}} .dashboard .user-rec-inner h3,\n  body.user-style-{{screen_name}} .recently-listed-in,\n  body.user-style-{{screen_name}} .latest-favorite-inner,\n  body.user-style-{{screen_name}} .latest-tweet,\n  body.user-style-{{screen_name}} .latest-tweet a.latest-tweet-timestamp,\n  {{#is_narrow}}\n    body.user-style-{{screen_name}} .dashboard .user-small-list-item .user-meta,\n    body.user-style-{{screen_name}} .dashboard .user-small-list-item .user-meta a,\n    body.user-style-{{screen_name}} .social-context div,\n  {{/is_narrow}}\n  body.user-style-{{screen_name}} .dashboard .dot,\n  body.user-style-{{screen_name}} .component .promo,\n  body.user-style-{{screen_name}} .component .promo a.definition,\n  body.user-style-{{screen_name}} .dashboard .user-small-list-item .dismiss,\n  body.user-style-{{screen_name}} .dashboard .user-small-list-item .ellip,\n  body.user-style-{{screen_name}} .dashboard .copyright {\n    {{#rgba_text_color}}\n      color: {{rgba_text_color}};\n    {{/rgba_text_color}}\n  }\n\n  body.user-style-{{screen_name}} #page-container,\n  body.user-style-{{screen_name}} .user-sidebar-color {\n    {{#profile_sidebar_fill_color}}\n      /* IE7/8 */\n      background: #{{profile_sidebar_fill_color}};\n    {{/profile_sidebar_fill_color}}\n    {{#rgba_sidebar_color}}\n      /* Modern browsers */\n      background: {{rgba_sidebar_color}};\n    {{/rgba_sidebar_color}}\n    {{#profile_sidebar_fill_color}}\n      /* IE6 */\n      _background-color: #{{profile_sidebar_fill_color}};\n    {{/profile_sidebar_fill_color}}\n  }\n\n{{\u003Epill_css}}\n\u003C/style\u003E\n\u003Cnoscript\u003E\n  {{\u003Ebg_img_css}}\n\u003C/noscript\u003E',recent_lists:"\u003Cdiv class='recently-listed-in'\u003E\n  \u003Ci\u003E\u003C/i\u003E{{_i}}Recently listed in:{{/i}}\n  \u003Cul class='recent-lists inline-list'\u003E\n    {{{list_names}}}\n  \u003C/ul\u003E\n\u003C/div\u003E",search_help_operators:'\u003Cp class="operators"\u003E\n  {{^decider_advanced_search}}\n    {{_i}}\u003Cstrong\u003ETip:\u003C/strong\u003E use \u003Ca href="#"\u003Eoperators\u003C/a\u003E for advanced search.{{/i}}\n  {{/decider_advanced_search}}\n  {{#decider_advanced_search}}\n    {{_i}}\u003Cstrong\u003ETip:\u003C/strong\u003E use \u003Ca href="#"\u003Eoperators\u003C/a\u003E for \u003Ca class="advanced-search" href="{{search_advanced_path}}"\u003Eadvanced search\u003C/a\u003E.{{/i}}\n  {{/decider_advanced_search}}\n\u003C/p\u003E',stream_user:"\u003Cdiv data-user-id='{{id}}' class='stream-item-content user-content-medium clearfix' data-screen-name=\"{{screen_name}}\" {{{feedback_token}}}\u003E\n  \u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='user-content-image user-profile-link' data-user-id='{{id}}'/\u003E\n\n  {{\u003Estream_user_buttons}}\n\n  \u003Cdiv class=\"user-content-rest\"\u003E\n    \u003Cspan class='user-name'\u003E\n      \u003Ca class='user-profile-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\u003E\u003Cstrong\u003E{{screen_name}}\u003C/strong\u003E\u003C/a\u003E\n      \u003Cspan class='full-name'\u003E{{name}}\u003C/span\u003E\n      {{#verified}}\n        \u003Cspan class=\"verified-icon-small\"\u003E\u003C/span\u003E\n      {{/verified}}\n      {{#protected}}\n        \u003Cspan class=\"protected-icon\"\u003E\u003C/span\u003E\n      {{/protected}}\n    \u003C/span\u003E\n    \u003Cdiv class=\"user-description\"\u003E{{{linkified_description}}}\u003C/div\u003E\n    \u003Cdiv class='user-meta'\u003E\n        {{#socialcontext}}\n            {{{socialcontext}}}\n        {{/socialcontext}}\n        {{^socialcontext}}\n            {{#following}}\n                \u003Cspan class=\"followed-by-you\"\u003E{{_i}}Followed by you!{{/i}}\u003C/span\u003E\n            {{/following}}\n        {{/socialcontext}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n",dashboard_related_services:'\u003Cdiv class="related-services"\u003E\n  \u003Ch2\u003E{{_i}}Related Services{{/i}}\u003C/h2\u003E\n  \u003Cul\u003E\n    {{#promos}}\n      \u003Cli\u003E{{{promo_contents}}}\u003C/li\u003E\n    {{/promos}}\n  \u003C/ul\u003E\n\u003C/div\u003E\n',similar_to_page:'\u003Cdiv class="main-content"\u003E\n  {{#render_page_content}}\n    {{^logged_in}}\n      {{#profile_user}}\n        {{\u003Esign_up_call_out}}\n      {{/profile_user}}\n    {{/logged_in}}\n    {{#profile_user}}\n      {{\u003Eprofile_similar_to_header}}\n    {{/profile_user}}\n    {{\u003Estream_manager}}\n  {{/render_page_content}}\n\u003C/div\u003E\n{{\u003Eprofile_dashboard}}\n{{\u003Edetails_pane_container}}\n',geo_add_location_geo_enabled:'{{^v3}}\n\u003Cspan class="crosshairs"\u003E\u0026nbsp;\u003C/span\u003E\n{{/v3}}\n\u003Ca class="geo_enable_webclient" href="#"\u003E{{_i}}Add your location{{/i}}\u003C/a\u003E',user_link:"{{^decider_phoenix_pretty_links}}\n  \u003Cspan class=\"user\"\u003E@\u003Ca class='user-profile-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\n    \u003E{{screen_name}}\u003C/a\u003E\u003C/span\u003E\n{{/decider_phoenix_pretty_links}}\n{{#decider_phoenix_pretty_links}}\n  \u003Cspan class=\"user\"\u003E\u003Ca class='user-profile-link pretty-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\n    \u003E\u003Cspan class=\"at\"\u003E@\u003C/span\u003E\u003Cspan class=\"at-text\"\u003E{{screen_name}}\u003C/span\u003E\u003C/a\u003E\u003C/span\u003E\n{{/decider_phoenix_pretty_links}}\n",tweet_user_block:"\u003Cdiv class=\"tweet-user-block\"\u003E\n  \u003Ca href='{{profile_path}}'\u003E\u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='tweet-user-block-image user-profile-link' data-user-id='{{id}}'/\u003E\u003C/a\u003E\n  \u003Cdiv class='tweet-user-block-name'\u003E\n    \u003Ca class='tweet-user-block-screen-name user-profile-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\u003E@{{screen_name}}\u003C/a\u003E\n    \u003Cspan class='tweet-user-block-full-name'\u003E{{name}}\u003C/span\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n",tweet_geo:"",device_setup_dialog_verified:'\n\u003Ch2\u003E{{_i}}Successful device verification for +{{country_code}} {{address_without_country_code}}!{{/i}}\u003C/h2\u003E\n\n\u003Cp\u003E\n  \u003Cstrong\u003E{{_i}}You can now text message your Tweets to {{address_for_sms}}.{{/i}}\u003C/strong\u003E\n  {{_i}}See the complete list of \u003Ca href="{{sms_help_path}}" target="_blank"\u003ETwitter mobile commands\u003C/a\u003E.{{/i}}\n\u003C/p\u003E\n\n\u003Cp\u003E\n  {{_i}}Set your mobile privacy controls and notification preferences on \u003Ca href="{{devices_path}}"\u003Eyour Mobile settings page\u003C/a\u003E.{{/i}}\u003C/p\u003E\n\u003C/p\u003E\n\n\u003Cp\u003E{{_i}}Twitter does not charge for this service. Standard message and data rates may apply.{{/i}}\u003C/p\u003E\n',stream_link:'\u003Cli class="stream-link" data-item-id="{{id}}"\u003E\n  \u003Ca title=\'{{name}}\' href="{{{href}}}"\u003E\n    {{#icon_class}}\n      \u003Cspan class="{{icon_class}}"\u003E\u003C/span\u003E\n    {{/icon_class}}\n    \u003Cb class="item-name"\u003E\n      {{name}}\n    \u003C/b\u003E\n    {{#show_delete}}\n      \u003Cspan title="{{delete_title}}" class="delete-icon"\u003E\u003C/span\u003E\n    {{/show_delete}}\n    {{#is_private}}\n      \u003Cspan title="{{_i}}Private List{{/i}}" class="lock-icon"\u003E\u003C/span\u003E\n    {{/is_private}}\n  \u003C/a\u003E\n\u003C/li\u003E\n',link_simple_list:'{{%IMPLICIT-ITERATOR iterator=link}}\n\u003Cul class="thumbs"\u003E\n  {{#links}}\n    \u003Cli\u003E\u003Ca href="{{link}}" target="_blank"\u003E{{link}}\u003C/a\u003E\u003C/li\u003E\n  {{/links}}\n\u003C/ul\u003E',the_grid:'\u003Cdiv class="the-grid"\u003E\n\u003C/div\u003E',welcome:'\u003Cdiv class="main-content"\u003E\n  {{#render_page_content}}\n    \u003Cdiv class="who-to-follow-header welcome-header"\u003E\n      \u003Cdiv class="welcome-steps"\u003E\n        \u003Col\u003E\n          {{#warm_signup}}\n            \u003Cli class="starter step1"\u003E\u003Cdiv class="prev-step"\u003E\u003Ca href="{{welcome_starter_path}}"\u003E\u003Cspan /\u003E\u003Cstrong\u003E{{_i}}Suggestions{{/i}}\u003C/strong\u003E\u003C/a\u003E\u003C/div\u003E\u003C/li\u003E\n          {{/warm_signup}}\n          \u003Cli class="interests {{#warm_signup}}step2{{/warm_signup}}{{^warm_signup}}step1{{/warm_signup}}"\u003E\u003Cdiv class="{{#warm_signup}}next-step{{/warm_signup}}{{^warm_signup}}prev-step{{/warm_signup}}"\u003E\u003Ca href="{{welcome_interests_path}}"\u003E\u003Cspan /\u003E\u003Cstrong\u003E{{_i}}Interests{{/i}}\u003C/strong\u003E\u003C/a\u003E\u003C/div\u003E\u003C/li\u003E\n          \u003Cli class="import {{#warm_signup}}step3{{/warm_signup}}{{^warm_signup}}step2{{/warm_signup}}"\u003E\u003Cdiv class="next-step"\u003E\u003Ca href="{{welcome_import_path}}"\u003E\u003Cspan /\u003E\u003Cstrong\u003E{{_i}}Friends{{/i}}\u003C/strong\u003E\u003C/a\u003E\u003C/div\u003E\u003C/li\u003E\n        \u003C/ol\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="welcome-search"\u003E\n        \u003Cform class="who-to-follow-search" action="{{welcome_search_form_path}}" method="GET"\u003E\n          \u003Cinput type="text" value="" name="q" placeholder="{{_i}}Find users by name or topic{{/i}}" /\u003E\n          \u003Cdiv class="submit button"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\n        \u003C/form\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="welcome-ambassador" /\u003E\n    \u003C/div\u003E\n\n    \u003Cdiv class="who-to-follow-stream"\u003E\n      {{\u003Estream_manager}}\n    \u003C/div\u003E\n\n  {{/render_page_content}}\n\u003C/div\u003E\n\n\u003Cdiv class="dashboard"\u003E\n  \u003Cdiv class="welcome-dashboard-header"\u003E\n    \u003Cdiv class="welcome-steps"\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\n{{\u003Edetails_pane_container}}\n\n\u003Cdiv class="welcome-footer" /\u003E\n\n',tipsy:'\u003Cdiv class="tooltip"\u003E\n  \u003Cb\u003E\n    {{title}}\n  \u003C/b\u003E\n\u003C/div\u003E',japanese_ad:'\u003Cdiv id="custom_49" class="eTologyToken"\u003E\u003C/div\u003E',empty_home:'\u003Cdiv class="empty-home"\u003E\n\n  \u003Ch2\u003E{{_i}}This is your homepage @\u003Cstrong\u003E{{screen_name}}\u003C/strong\u003E{{/i}}\u003C/h2\u003E\n\n  \u003Cp\u003E{{_i}}It\'s looking mighty bare right now. When you follow people their updates will appear here. So go \u003Ca href="{{who_to_follow_interests_path}}"\u003Efind some interesting people\u003C/a\u003E to follow!{{/i}}\u003C/p\u003E\n\n  \u003Cdiv class="tweeting"\u003E\n    \u003Cp\u003E\n      {{_i}}You can tell the world \u003Cstrong\u003Ewhat\'s happening\u003C/strong\u003E in the box above.{{/i}}\n    \u003C/p\u003E\n    \u003Cp class="protection"\u003E\n      {{#protected_account}}\n        \u003Cspan\u003E{{_i}}Your Tweets are protected and only available to your followers.{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E{{_i}}You can make your Tweets public on your  \u003Ca href="{{settings_path}}"\u003Eaccount page\u003C/a\u003E.{{/i}}\u003C/span\u003E\n      {{/protected_account}}\n      {{^protected_account}}\n        \u003Cspan\u003E{{_i}}Note that your Tweets will be available publicly.{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E{{_i}}You can make your Tweets private on your \u003Ca href="{{settings_path}}"\u003Eaccount page\u003C/a\u003E.{{/i}}\u003C/span\u003E\n      {{/protected_account}}\n    \u003C/p\u003E\n  \u003C/div\u003E\n\n\u003C/div\u003E\n\n\n',stream:'\u003Cdiv class="stream"\u003E\n  \u003Cdiv class="stream-items"\u003E\u003C/div\u003E\n\u003C/div\u003E',search_operators:'\u003Cdiv id="search_operators"\u003E\n  \u003Ctable celpadding="0" celspacing="0"\u003E\n    \u003Ctbody\u003E\u003Ctr\u003E\u003Cth\u003E{{_i}}Operator{{/i}}\u003C/th\u003E\u003Cth\u003E{{_i}}Finds tweets...{{/i}}\u003C/th\u003E\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Etwitter search\u003C/td\u003E\u003Ctd\u003Econtaining both "twitter" and "search". This is the default operator.\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003E"\u003C/b\u003Ehappy hour\u003Cb\u003E"\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining the exact phrase "happy hour".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Elove \u003Cb\u003EOR\u003C/b\u003E hate\u003C/td\u003E\u003Ctd\u003Econtaining either "love" or "hate" (or both).\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Ebeer \u003Cb\u003E-\u003C/b\u003Eroot\u003C/td\u003E\u003Ctd\u003Econtaining "beer" but not "root".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003E#\u003C/b\u003Ehaiku\u003C/td\u003E\u003Ctd\u003Econtaining the hashtag "haiku".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003Efrom:\u003C/b\u003Ealexiskold\u003C/td\u003E\u003Ctd\u003Esent from person "alexiskold".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003Eto:\u003C/b\u003Etechcrunch\u003C/td\u003E\u003Ctd\u003Esent to person "techcrunch".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003E@\u003C/b\u003Emashable\u003C/td\u003E\u003Ctd\u003Ereferencing person "mashable".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E"happy hour" \u003Cb\u003Enear:\u003C/b\u003E"san francisco"\u003C/td\u003E\u003Ctd\u003Econtaining the exact phrase "happy hour" and sent near "san francisco".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003E\u003Cb\u003Enear:\u003C/b\u003ENYC \u003Cb\u003Ewithin:\u003C/b\u003E15mi\u003C/td\u003E\u003Ctd\u003Esent within 15 miles of "NYC".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Esuperhero \u003Cb\u003Esince:\u003C/b\u003E2010-12-27\u003C/td\u003E\u003Ctd\u003Econtaining "superhero" and sent since date "2010-12-27" (year-month-day).\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Eftw \u003Cb\u003Euntil:\u003C/b\u003E2010-12-27\u003C/td\u003E\u003Ctd\u003Econtaining "ftw" and sent up to date "2010-12-27".\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Emovie -scary \u003Cb\u003E:)\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining "movie", but not "scary", and with a positive attitude.\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Eflight \u003Cb\u003E:(\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining "flight" and with a negative attitude.\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Etraffic \u003Cb\u003E?\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining "traffic" and asking a question.\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Ehilarious \u003Cb\u003Efilter:links\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining "hilarious" and linking to URLs.\u003C/td\u003E{{/i}}\u003C/tr\u003E\n      \u003Ctr\u003E{{_i}}\u003Ctd\u003Enews \u003Cb\u003Esource:twitterfeed\u003C/b\u003E\u003C/td\u003E\u003Ctd\u003Econtaining "news" and entered via TwitterFeed\u003C/td\u003E{{/i}}\u003C/tr\u003E\n    \u003C/tbody\u003E\u003C/table\u003E\n\u003C/div\u003E',contact_import_service_name:'\n\u003Cstrong class="service-name service-{{id}}" data-service-id="{{id}}"\u003E\n  {{#html_name}}{{{html_name}}}{{/html_name}}\n  {{^html_name}}\u003Cspan\u003E\u003C/span\u003E{{name}}{{/html_name}}\n\u003C/strong\u003E\n',dropdown:'\u003Cul class="drop-down" style="visibility: hidden"\u003E\n  {{{items}}}\n\u003C/ul\u003E',dashboard_friend_requests:'\u003Ca class="button follower-request-link" href="{{follower_requests_path}}"\u003E{{button_label}}\u003C/a\u003E',tweet_labels:'{{#decider_new_tweet_labels}}\n  \u003Cdiv class="tweet-labels"\u003E\n    {{#is_top_tweet}}\n      \u003Cspan class="new-tweet-label tweet-label-top-tweet"\u003E\n        \u003Ca href="{{top_tweets_path}}"\u003E\n          \u003Ci\u003E\u003C/i\u003E\n          \u003Cspan\u003E{{_i}}Top Tweet{{/i}}\u003C/span\u003E\n        \u003C/a\u003E\n      \u003C/span\u003E\n    {{/is_top_tweet}}\n\n    {{#is_sponsored}}\n      \u003Cspan class="new-tweet-label tweet-label-promoted-tweet"\u003E\n        \u003Ca href="{{help_promoted_tweets_path}}" target="_blank"\u003E\n          \u003Ci\u003E\u003C/i\u003E\n          \u003Cspan\u003E{{_i}}Promoted by {{advertiser_name}}{{/i}}\u003C/span\u003E\n        \u003C/a\u003E\n      \u003C/span\u003E\n    {{/is_sponsored}}\n  \u003C/div\u003E\n{{/decider_new_tweet_labels}}\n\n{{^decider_new_tweet_labels}}\n  {{#is_top_tweet}}\n    \u003Cspan class=\'tweet-label top-tweet-label\'\u003E{{_i}}Top Tweet{{/i}}\u003C/span\u003E\n  {{/is_top_tweet}}\n\n  {{#is_sponsored}}\n      \u003Ca href="{{help_promoted_tweets_path}}" target="_blank" class=\'tweet-label promoted-label\'\u003E{{_i}}Promoted by {{advertiser_name}}{{/i}}\u003C/a\u003E\n      {{#decider_ptw_negative_feedback}}\n        \u003Ca class="dismiss-action"\u003E\u003Ci\u003E\u003C/i\u003E {{_i}}Dismiss{{/i}}\u003C/a\u003E\n      {{/decider_ptw_negative_feedback}}\n  {{/is_sponsored}}\n{{/decider_new_tweet_labels}}',send_message_box:'\u003Cdiv class="tweet-box condensed"\u003E\n  \u003Ch2\u003E{{_i}}Send{{/i}}\u0026nbsp;{{screen_name}} {{_i}}a message{{/i}}\u003C/h2\u003E\n  \u003Cdiv class="send-message-box"\u003E\u003C/div\u003E\n\u003C/div\u003E',media_slideshow:'\u003Cdiv class="media-slideshow-wrapper"\u003E\n  \u003Cdiv class="media-slideshow-thumbnails"\u003E\u003C/div\u003E\n  \u003Cdiv class="media-slideshow-content"\u003E\n    \u003Cdiv class="media-slideshow-pictures"\u003E\n      \u003Cdiv class="media-slideshow-picture"\u003E\u003C/div\u003E\n      \u003Cdiv class="media-control-button prev"\u003E\n        \u003Cdiv class="media-control-button-arrow"\u003E\u003C/div\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="media-control-button next"\u003E\n        \u003Cdiv class="media-control-button-arrow"\u003E\u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="media-slideshow-tweet"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',user_stats:"\u003Cul class='user-stats clearfix'\u003E\n  {{#in_welcome_page}}\n    {{#abtest_welcome_profiles_24_hidden}}\n      {{#can_view}}\n        \u003Cli\u003E\u003Cspan class='user-stats-count'\u003E{{_i}}{{statuses_count_commaized}}\u003Cspan class='user-stats-stat'\u003ETweets\u003C/span\u003E{{/i}}\u003C/span\u003E\u003C/li\u003E\n      {{/can_view}}\n      \u003Cli\u003E\u003Cspan class='user-stats-count'\u003E{{_i}}{{friends_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowing\u003C/span\u003E{{/i}}\u003C/span\u003E\u003C/li\u003E\n      \u003Cli\u003E\u003Cspan class='user-stats-count'\u003E{{_i}}{{followers_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowers\u003C/span\u003E{{/i}}\u003C/span\u003E\u003C/li\u003E\n      \u003Cli\u003E\u003Cspan class='user-stats-count'\u003E{{_i}}{{listed_count_commaized}}\u003Cspan class='user-stats-stat'\u003EListed\u003C/span\u003E{{/i}}\u003C/span\u003E\u003C/li\u003E\n    {{/abtest_welcome_profiles_24_hidden}}\n    {{^abtest_welcome_profiles_24_any_bucket}}\n      {{#can_view}}\n        \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{profile_path}}\"\u003E{{_i}}{{statuses_count_commaized}}\u003Cspan class='user-stats-stat'\u003ETweets\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n      {{/can_view}}\n      \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{user_following_path}}\"\u003E{{_i}}{{friends_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowing\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n      \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{user_followers_path}}\"\u003E{{_i}}{{followers_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowers\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n      \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{memberships_path}}\"\u003E{{_i}}{{listed_count_commaized}}\u003Cspan class='user-stats-stat'\u003EListed\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n    {{/abtest_welcome_profiles_24_any_bucket}}\n  {{/in_welcome_page}}\n  {{^in_welcome_page}}\n    {{#can_view}}\n      \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{profile_path}}\"\u003E{{_i}}{{statuses_count_commaized}}\u003Cspan class='user-stats-stat'\u003ETweets\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n    {{/can_view}}\n    \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{user_following_path}}\"\u003E{{_i}}{{friends_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowing\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{user_followers_path}}\"\u003E{{_i}}{{followers_count_commaized}}\u003Cspan class='user-stats-stat'\u003EFollowers\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca class='user-stats-count' href=\"{{memberships_path}}\"\u003E{{_i}}{{listed_count_commaized}}\u003Cspan class='user-stats-stat'\u003EListed\u003C/span\u003E{{/i}}\u003C/a\u003E\u003C/li\u003E\n  {{/in_welcome_page}}\n\u003C/ul\u003E\n",media_type_container:"\u003Cdiv class='media-instance-container' data-url-id='{{url}}' data-media-type='{{media_type}}'\u003E\u003C/div\u003E",geo_city_search:'\u003Cform id="place_search_form"\u003E\n  \u003Ctable class="geo_place_search_table"\u003E\u003Ctr\u003E\n    \u003Ctd class="geo_place_search_col1 geo_place_search_place"\u003E{{_i}}City{{/i}}\u003C/td\u003E\n    \u003Ctd class="geo_place_search_place"\u003E\n      \u003Cinput id="place_search_query"\n             type="text"\n             autocomplete="off"\n             class="round-left help-focusable"\n             title="{{_i}}Enter a city, state{{/i}}"/\u003E\u003Cspan class="place_search_submit round-right" title="{{_i}}Search{{/i}}"\u003E\u0026nbsp;\u003C/span\u003E\n      \u003Cul class="round places_list place_search_dropdown"\u003E\u003C/ul\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd\u003E\u003C/td\u003E\n    \u003Ctd class="geo_place_search_hint"\u003E{{_i}}Example: San Francisco, CA{{/i}}\u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd\u003E\u003C/td\u003E\n    \u003Ctd\u003E\n       \u003Cdiv id="place_search_results"\u003E\u003C/div\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003C/table\u003E\n\u003C/form\u003E\n',profile_dashboard:'\u003Cdiv class="dashboard profile-dashboard"\u003E\n  {{#render_page_content}}\n    {{#rendering_on_server}}\n      {{#profile_user}}\n      \u003Cdiv class="component"\u003E\n        {{\u003Edashboard_profile_stats}}\n        \u003Chr/\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="component"\u003E\n        {{\u003Edashboard_footer}}\n      \u003C/div\u003E\n      {{/profile_user}}\n    {{/rendering_on_server}}\n  {{/render_page_content}}\n\u003C/div\u003E\n',latest_tweet:'\u003Cdiv class="tweet latest-tweet" data-tweet-id="{{id}}" data-item-id="{{id}}" data-screen-name=\'{{#user}}{{screen_name}}{{/user}}\'\u003E\n  {{^is_narrow}}\n    \u003Cdiv class="tweet-image"\u003E\n      \u003Ca href="{{#user}}{{profile_path}}{{/user}}"\u003E{{\u003Etweet_user_image_48}}\u003C/a\u003E\n    \u003C/div\u003E\n  {{/is_narrow}}\n  \u003Cdiv class="tweet-content"\u003E\n    \u003Cdiv class="tweet-row"\u003E\n      {{\u003Elatest_tweet_timestamp}}:\n      {{#was_retweeted}}\n        \u003Cspan class="retweet-icon"\u003E\u003C/span\u003E\n      {{{retweet_source_screen_name_link}}}\n      {{/was_retweeted}}\n      \u0026#32;{{\u003Etweet_text}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',place_business_claimed:'\u003Ch2\u003E{{_i}}\u003Cstrong\u003E{{place_name}}\u003C/strong\u003E has been claimed by{{/i}}\u003C/h2\u003E\n\u003Cdiv class="geo-place-page-owner"\u003E\n  {{#user_list}}\n    {{\u003Euser_small_list}}\n  {{/user_list}}\n\u003C/div\u003E\n{{#tweet}}\n  \u003Cdiv class="tweet latest-tweet geo-place-page-latest-tweet"\n       data-tweet-id="{{id}}"\n       data-item-id="{{id}}"\n       data-screen_name=\'{{#user}}{{screen_name}}{{/user}}\'\u003E\n    \u003Cdiv class="tweet-content"\u003E\n      \u003Cdiv class="tweet-row"\u003E\n        {{\u003Elatest_tweet_timestamp}}: {{\u003Etweet_text}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n{{/tweet}}\n',geo_detection_failed_set_manually:'{{_i}}We couldn\'t find you!{{/i}}\n\u0026#32;\n\u003Ca href="#" class="geo_add_manual"\u003E{{_i}}Add Location{{/i}}\u003C/a\u003E\n{{\u003Egeo_disable_geo}}',checkbox_dropdown:'\u003Cul class="drop-down" style="visibility:hidden"\u003E\n  {{{items}}}\n\u003C/ul\u003E',nudgeable_user:'\n\u003Cdiv class=\'unselectable-stream-item user-contact\' data-item-id="{{email}}"\u003E\n  \u003Cdiv class=\'stream-item-content user-content-medium clearfix\'\u003E\n    \u003Cdiv class="user-content-rest"\u003E\n      \u003Cspan class=\'user-name\'\u003E\n        \u003Cstrong\u003E{{email}}\u003C/strong\u003E\n      \u003C/span\u003E\n      \u003Cdiv class="user-description"\u003E\n        \u003Cspan\u003E{{_i}}This person is on Twitter, but isn\'t yet findable by email.{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E{{_i}}Let them know you\'d like to follow them.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="stream-user-buttons"\u003E\n      {{^sent_nudge}}\n        \u003Cdiv class="button email-nudge-button" data-email="{{email}}"\u003E\n            \u003Cspan class="plus"\u003E\u003C/span\u003E\u0026#32;{{_i}}Follow{{/i}}\n        \u003C/div\u003E\n      {{/sent_nudge}}\n      {{#sent_nudge}}\n          \u003Cspan class="sent-request"\u003E{{_i}}Request sent{{/i}}\u003C/span\u003E\n      {{/sent_nudge}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',geo_place_content:'\u003Cspan class="place_content"\u003E\u003C/span\u003E\n{{\u003Egeo_disable_geo}}',recently_viewed:'\u003Cdiv class="recently-viewed-users clearfix"\u003E\n\n  \u003Ch2\u003E\n    {{_i}}You recently viewed{{/i}}\n    \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n    \u003Ca class=\'clear-all\' href="#"\u003E{{_i}}clear{{/i}}\u003C/a\u003E\n  \u003C/h2\u003E\n\n  \u003Cul\u003E\n    {{\u003Euser_small_list}}\n  \u003C/ul\u003E\n\n\u003C/div\u003E\n',hidden_stream_items:'\u003Cdiv class="hidden-stream-items" hidden-id="{{hidden_id}}"\u003E\n  {{_i}}{{items_count}}\u0026nbsp;More Tweets from \u003Cspan class="user"\u003E@{{first_screen_name}}\u003C/span\u003E{{/i}}\n  \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n  \u003Cspan class="show-more"\u003E\u003Ca\u003E{{_i}}show all{{/i}}\u003C/a\u003E\u003C/span\u003E\n\u003C/div\u003E',front_radial_item:'\u003Cli data-item-offset="{{offset}}"\u003E\u003Ca data-user-id="{{id}}" href="/#!/{{screen_name}}" title="{{name}}"\u003E\u003Cimg src="{{^is_ssl}}{{profile_image_url}}{{/is_ssl}}{{#is_ssl}}{{secure_profile_image_url}}{{/is_ssl}}" alt="{{name}}" height="48" width="48" /\u003E\u003C/a\u003E\u003C/li\u003E',dashboard_promo:"\u003Cdiv class='definition'\u003E\n  {{#promo}}\n    \u003Cp class=\"promo\"\u003E{{{promo_contents}}}\u003C/p\u003E\n  {{/promo}}\n\u003C/div\u003E\n",profile_page:'\u003Cdiv class="main-content"\u003E\n  {{#render_page_content}}\n    {{#profile_user}}\n      {{\u003Eprofile_header}}\n    {{/profile_user}}\n    {{\u003Estream_manager}}\n  {{/render_page_content}}\n\u003C/div\u003E\n{{\u003Eprofile_dashboard}}\n{{\u003Edetails_pane_container}}\n',contact_import_service_icon:"\u003Cstrong class=\"service-name service-{{id}}\" data-service-id=\"{{id}}\"\u003E\n  {{#html_name}}\u003Cstrong class='service hotmail'\u003E\u003Cspan\u003E\u003C/span\u003E\u003C/strong\u003E \u0026nbsp;\u0026nbsp; \u003Cstrong class='service msn-messenger'\u003E\u003Cspan\u003E\u003C/span\u003E\u003C/strong\u003E{{/html_name}}\n  {{^html_name}}\u003Cspan\u003E\u003C/span\u003E{{/html_name}}\n\u003C/strong\u003E",new_signup_call_out:'\u003Cdiv class="signup-call-out"\u003E\n  \u003Ch1\u003E\u003Cspan\u003E{{_i}}New to Twitter?{{/i}}\u003C/span\u003E\u003C/h1\u003E\n  \u003Ch2\u003E\n    {{_i}}Twitter is a rich source of instantly updated information. Sign up to tune into the things you care about, and get updates as they happen.{{/i}}\n  \u003C/h2\u003E\n  {{\u003Esignup_button}}\n\u003C/div\u003E',latest_favorite_small:"{{%TRANSLATION-HINT mode=user_stats}}\n\n{{#favorites_count_commaized}}\n\u003Cdiv class=\"your-activity favorites-activity\"\u003E\n  \u003Ch2\u003E\n    \u003Ca href=\"{{user_favorites_path}}\" class=\"title-link\"\u003E\u003Cspan class='dashboard-component-title'\u003E{{_i}}Favorites{{/i}}\u003C/span\u003E \u003Cspan class='user-stat-link'\u003E{{favorites_count_commaized}}\u003C/span\u003E\u003C/a\u003E\n  \u003C/h2\u003E\n  \u003Cdiv class='latest-favorite'\u003E\u003C/div\u003E\n\u003C/div\u003E\n{{/favorites_count_commaized}}",dashboard_footer:'\u003Cdiv class="footer inline-list"\u003E\n  \u003Cul\u003E\n    \u003Cli\u003E\u003Ca href="{{about_path}}"\u003E{{_i}}About{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{support_path}}"\u003E{{_i}}Help{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{blog_path}}"\u003E{{_i}}Blog{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n{{#decider_mobile_download_gallery}}\n    \u003Cli\u003E\u003Ca href="{{mobile_gallery_path}}"\u003E{{_i}}Mobile{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n{{/decider_mobile_download_gallery}}\n    \u003Cli\u003E\u003Ca href="{{status_path}}"\u003E{{_i}}Status{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{jobs_path}}"\u003E{{_i}}Jobs{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{tos_path}}"\u003E{{_i}}Terms{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{privacy_path}}"\u003E{{_i}}Privacy{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n{{#logged_in}}\n    \u003Cli\u003E\u003Ca href="#" id="keyboard-shortcut-trigger"\u003E{{_i}}Shortcuts{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n{{/logged_in}}\n    \u003Cli\u003E\u003Ca href="{{advertisers_path}}"\u003E{{_i}}Advertisers{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{businesses_path}}"\u003E{{_i}}Businesses{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{partnerships_path}}"\u003E{{_i}}Media{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{developers_path}}"\u003E{{_i}}Developers{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{resources_path}}"\u003E{{_i}}Resources{{/i}}\u003C/a\u003E\u003Cspan class="dot"\u003E \u0026middot;\u003C/span\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Cspan class="copyright"\u003E\u0026copy; {{year}} Twitter\u003C/span\u003E\u003Cli\u003E\n  \u003Cul\u003E\n  {{#is_mobile}}\n    \u003Cp class="mobile-option"\u003E\n      {{_i}}View Twitter in:{{/i}}\u0026nbsp;{{_i}}Standard{{/i}}\u0026nbsp;- \u003Ca href="{{mobile_path}}"\u003E{{_i}}Mobile{{/i}}\u003C/a\u003E\n    \u003C/p\u003E\n  {{/is_mobile}}\n\u003C/div\u003E\n',signin_form_textbox:'\u003Cfieldset class="textbox"\u003E\n  \u003Clabel class="username"\u003E\n    \u003Cspan\u003E{{_i}}Username or email{{/i}}\u003C/span\u003E\n    \u003Cinput type="text" value="" name="session[username_or_email]" autocomplete="on" /\u003E\n  \u003C/label\u003E\n  \u003Clabel class="password"\u003E\n    \u003Cspan\u003E{{_i}}Password{{/i}}\u003C/span\u003E\n    \u003Cinput type="password" value="" name="session[password]" /\u003E\n  \u003C/label\u003E\n\u003C/fieldset\u003E',place_page_users_title:"{{_i}}Twitter / Recent people for {{{placeName}}}{{/i}}\n",user_small_list_item_sponsored:'{{#decider_new_tweet_labels}}\n  {{^is_narrow}}\n    \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n  {{/is_narrow}}\n  \u003Cspan class="new-tweet-label tweet-label-promoted-other"\u003E\n    \u003Ca href="{{profile_path}}"\u003E\n      \u003Ci\u003E\u003C/i\u003E\n      \u003Cspan\u003E{{_i}}Promoted{{/i}}\u003C/span\u003E\n    \u003C/a\u003E\n  \u003C/span\u003E\n{{/decider_new_tweet_labels}}\n\n{{^decider_new_tweet_labels}}\n  \u003Ca class="tweet-label promoted-label" href="{{profile_path}}"\u003E{{_i}}Promoted{{/i}}\u003C/a\u003E\n{{/decider_new_tweet_labels}}\n',user_detailed_list_item:'\u003Cli class="user-detailed-list-item" data-user-id="{{id}}" {{{feedback_token}}}\u003E\n  \u003Ca href="{{profile_path}}" data-user-id="{{id}}" class="user-profile-link user-thumb"\u003E\u003Cimg src=\'{{profile_image_url}}\' alt="{{screen_name}}" /\u003E\u003C/a\u003E\n  \u003Cdiv class="user-details {{lang}}"\u003E\n    \u003Cdiv class="user-name-info"\u003E\n      \u003Ca class="user-profile-link user-screen-name" data-user-id="{{id}}" href=\'{{profile_path}}\'\u003E{{screen_name}}\u003C/a\u003E\n      \u003Cspan class="user-full-name-and-action"\u003E\n        \u003Cspan class="user-full-name"\u003E{{name}}\u003C/span\u003E\n        {{#verified}}\n          \u003Cspan class="verified-icon-small"\u003E\u003C/span\u003E\n        {{/verified}}\n        {{#protected}}\n          \u003Cimg src="/phoenix/img/protected_small.gif" /\u003E\n        {{/protected}}\n        {{\u003Euser_item_action}}\n      \u003C/span\u003E\n    \u003C/div\u003E\n    {{#location}}\n      \u003Cdiv class="location"\u003E\n        {{_i}}Location:{{/i}}\u0026nbsp;\u003Cspan class="location"\u003E{{location}}\u003C/span\u003E\n      \u003C/div\u003E\n    {{/location}}\n    {{#linkified_description}}\n      \u003Cdiv class="bio"\u003E\n        \u003Cspan class="bio"\u003E{{{linkified_description}}}\u003C/span\u003E\n      \u003C/div\u003E\n    {{/linkified_description}}\n  \u003C/div\u003E\n\u003C/li\u003E',listed_list_small:'{{%TRANSLATION-HINT mode=user_stats}}\n\n{{#listed_count_commaized}}\n\u003Cdiv class="your-activity lists-activity"\u003E\n  \u003Ch2\u003E\n   \u003Ca href="{{memberships_path}}" class="title-link"\u003E\u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Listed{{/i}}\u003C/span\u003E \u003Cspan class=\'user-stat-link\'\u003E{{listed_count_commaized}}\u003C/span\u003E\u003C/a\u003E\n  \u003C/h2\u003E\n\u003C/div\u003E\n{{/listed_count_commaized}}',signin_form_subchck:'\u003Cfieldset class="subchck"\u003E\n  \u003Cbutton type="submit" class="submit button"\u003E{{_i}}Sign in{{/i}}\u003C/button\u003E\n  \u003Clabel class="remember"\u003E\n    \u003Cinput type="checkbox" value="1" name="remember_me" /\u003E\n    \u003Cspan\u003E{{_i}}Remember me{{/i}}\u003C/span\u003E\n  \u003C/label\u003E\n\u003C/fieldset\u003E\n\n{{#is_ssl}}\n  \u003Cinput type="hidden" name="return_to_ssl" value="true" /\u003E\n{{/is_ssl}}\n\n{{#redirect_after_login}}\n  \u003Cinput type="hidden" name="redirect_after_login" value="{{redirect_after_login}}" /\u003E\n{{/redirect_after_login}}',getting_started_follow:'\u003Cli class="follow"\u003E\n  \u003Cspan\u003E{{_i}}Follow your first 10 accounts{{/i}}\u003C/span\u003E\n  \u003Cul\u003E\n    \u003Cli\u003E\u003Ca href="{{who_to_follow_interests_path}}"\u003E{{_i}}Browse popular accounts by interest{{/i}}\u003C/a\u003E\u003C/li\u003E\n    \u003Cli\u003E\u003Ca href="{{who_to_follow_import_path}}"\u003E{{_i}}Look for your friends{{/i}}\u003C/a\u003E\u003C/li\u003E\n    \u003Cli class="search"\u003E\u003Cform class="who-to-follow-search" action="{{who_to_follow_search_form_path}}" method="GET"\u003E\u003Cinput type="text" value="" name="q" placeholder="{{_i}}find users by name{{/i}}" /\u003E\u0026nbsp;\u003Cdiv class="submit button"\u003E{{_i}}Search{{/i}}\u003C/div\u003E\u003C/form\u003E\u003C/li\u003E\n  \u003C/ul\u003E\n\u003C/li\u003E',what_the_trend:'\u003Cdiv class="what-the-trend"\u003E\n  \u003Cspan class="what-the-trending"\u003E{{_i}}TRENDING:{{/i}}\u003C/span\u003E {{#blurb}}{{text}}{{/blurb}}\n  \u003Cdiv class="what-the-trend-source"\u003E\n    \u0026nbsp; {{_i}}Source:\u0026nbsp;\u003Ca href="{{#links}}{{url}}{{/links}}" target="_blank"\u003EWhat\u0026nbsp;the\u0026nbsp;Trend?\u003C/a\u003E{{/i}}\n  \u003C/div\u003E\n\u003C/div\u003E',tweet_pane:"\u003Cdiv class='tweet-pane'\u003E\n  {{#tweet}}\n    {{\u003Edetails_pane_tweet}}\n  {{/tweet}}\n\u003C/div\u003E",search_page:'\u003Cdiv class="main-content"\u003E\n  {{{noscript}}}\n    {{#logged_in}}\n      \u003Cdiv class="search-header"\u003E\n        \u003Cdiv class="back-to-home"\u003E\n          \u003Ca href="{{index_path}}"\u003E{{_i}}\u0026larr; Back to Home{{/i}}\u003C/a\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="saved-search-container"\u003E\u003C/div\u003E\n      \u003C/div\u003E\n    {{/logged_in}}\n    \u003Cdiv class="search-title"\u003E\n      \u003Ch2\u003E{{_i}}Results for \u003Cstrong class="search-query"\u003E{{pretty_query}}\u003C/strong\u003E{{/i}}\u003C/h2\u003E\n      {{\u003Esearch_help_operators}}\n    \u003C/div\u003E\n    \u003Cul class="stream-tabs"\u003E\n      {{#has_relevance_search}}\n      \u003Cli class="stream-tab stream-tab-relevance {{#active_tab_relevance}}active{{/active_tab_relevance}}"\u003E\n        \u003Ca class="tab-text" href="{{search_results_path}}"\u003E{{_i}}Most relevant{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      {{/has_relevance_search}}\n      \u003Cli class="stream-tab stream-tab-tweets {{#active_tab_tweets}}active{{/active_tab_tweets}}"\u003E\n        {{#has_relevance_search}}\n          \u003Ca class="tab-text" href="{{search_realtime_path}}"\u003E{{_i}}All Tweets{{/i}}\u003C/a\u003E\n        {{/has_relevance_search}}\n        {{^has_relevance_search}}\n          \u003Ca class="tab-text" href="{{search_results_path}}"\u003E{{_i}}Tweets{{/i}}\u003C/a\u003E\n        {{/has_relevance_search}}\n      \u003C/li\u003E\n      \u003Cli class="stream-tab stream-tab-links {{#active_tab_links}}active{{/active_tab_links}}"\u003E\n        \u003Ca class="tab-text" href="{{search_links_path}}"\u003E{{_i}}Tweets with links{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      {{#logged_in}}\n        {{^is_place_search}}\n          \u003Cli class="stream-tab stream-tab-people {{#active_tab_people}}active{{/active_tab_people}}"\u003E\n            \u003Ca class="tab-text" href="{{user_search_path}}"\u003E{{_i}}People{{/i}}\u003C/a\u003E\n          \u003C/li\u003E\n        {{/is_place_search}}\n      {{/logged_in}}\n    \u003C/ul\u003E\n    {{\u003Estream_manager}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n\u003Cdiv class="dashboard search-dashboard"\u003E\u003C/div\u003E\n{{\u003Edetails_pane_container}}',local_trend_last_breadcrumb_location:'\u003Ca href=\'#\' class="trend-breadcrumb-location" data-woeid="{{woeid}}"\u003E{{name}}\u003Cspan\u003E\u003C/span\u003E\u003C/a\u003E',place_users_page:'\u003Cdiv class="main-content"\u003E\n  {{{noscript}}}\n    \u003Cdiv class="search-header"\u003E\n      \u003Cdiv class="back-to-home"\u003E\n        \u003Ca href="{{place_path}}"\u003E{{_i}}\u0026larr; Back to {{name}}{{/i}}\u003C/a\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="geo-place-page-title"\u003E\n      \u003Ch2\u003E\n      {{_i}}Recent people for \u003Cstrong\u003E{{name}}\u003C/strong\u003E{{/i}}\n      \u003C/h2\u003E\n      \u003Cdiv class="geo-place-page-details"\u003E\n        {{#location_service_down}}\n          {{_i}}Location service is temporarily unavailable{{/i}}\n        {{/location_service_down}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cul class="stream-tabs"\u003E\n      \u003Cli class="stream-tab stream-tab-all {{#active_tab_all}}active{{/active_tab_all}}"\u003E\n        \u003Ca class="tab-text" href="{{place_users_path}}"\u003E{{_i}}All{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      \u003Cli class="stream-tab stream-tab-following {{#active_tab_following}}active{{/active_tab_following}}"\u003E\n        \u003Ca class="tab-text" href="{{place_users_following_path}}"\u003E{{_i}}Following{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n    \u003C/ul\u003E\n    {{\u003Estream_manager}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n\u003Cdiv class="dashboard place-dashboard"\u003E\u003C/div\u003E\n{{\u003Edetails_pane_container}}',home_page:'\u003Cdiv class="main-content"\u003E\n  {{#render_page_content}}\n    \u003Cdiv class="page-header home-header"\u003E\n      \u003Cdiv class="main-tweet-box"\u003E\n        {{\u003Eposting_tweet_box}}\n      \u003C/div\u003E\n      \u003Cul class="stream-tabs"\u003E\n        \u003Cli class="stream-tab stream-tab-home {{#active_tab_home}}active{{/active_tab_home}}"\u003E\n          \u003Ca class="tab-text" title=\'{{_i}}All you follow{{/i}}\' href="{{index_path}}"\u003E{{_i}}Timeline{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n        \u003Cli class="stream-tab stream-tab-mentions {{#active_tab_mentions}}active{{/active_tab_mentions}}"\u003E\n          \u003Ca class="tab-text" title=\'{{_i}}Mentions{{/i}}\' href="{{mentions_path}}"\u003E@{{_i}}Mentions{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n        \u003C!-- here once stood an html comment fight btwn @ded and @k --\u003E\n        \u003Cli class="stream-tab stream-tab-retweets dropdown-link {{#active_tab_retweets}}active{{/active_tab_retweets}}"\u003E\n          \u003Ca class="tab-text" href="#"\u003E{{_i}}Retweets{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/a\u003E\n        \u003C/li\u003E\n        \u003Cli class="stream-tab stream-tab-searches dropdown-link {{#active_tab_searches}}active{{/active_tab_searches}}"\u003E\n          \u003Ca class="tab-text" href="#"\u003E{{_i}}Searches{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/a\u003E\n        \u003C/li\u003E\n        \u003Cli class="stream-tab stream-tab-lists dropdown-link {{#active_tab_lists}}active{{/active_tab_lists}}"\u003E\n          \u003Ca class="tab-text" href="#"\u003E{{_i}}Lists{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/a\u003E\n        \u003C/li\u003E\n      \u003C/ul\u003E\n    \u003C/div\u003E\n    {{\u003Estream_manager}}\n  {{/render_page_content}}\n\u003C/div\u003E\n\u003Cdiv class="dashboard"\u003E\n  {{#render_page_content}}\n    {{#current_user}}\n      {{\u003Ehome_dashboard}}\n    {{/current_user}}\n  {{/render_page_content}}\n\u003C/div\u003E\n\n{{\u003Edetails_pane_container}}\n',protected_user:'\u003Cdiv class="protected-box"\u003E\n  \u003Ch1 class="logged-out"\u003E{{_i}}@{{screen_name}}\'s Tweets are protected.{{/i}}\u003C/h1\u003E\n  \u003Cp\u003E{{_i}}Only confirmed followers have access to @{{screen_name}}\'s Tweets and complete profile. You need to send a request before you can start following this account.{{/i}}\u003C/p\u003E\n\u003C/div\u003E',reply_dialog_footer:'\u003Cdiv class="tweet twttr-dialog-reply-footer"\u003E\n  \u003Cimg src="{{profile_image_url}}" title="{{screen_name}}"/\u003E\n  \u003Cp\u003E\n    \u003Cspan class="twttr-reply-screenname"\u003E{{screen_name}}\u003C/span\u003E\n    {{{text}}}\n  \u003C/p\u003E\n\u003C/div\u003E\n',tweet_short_timestamp:'\u003Ca href="{{permalink_path}}" class=\'tweet-timestamp\' title="{{explicit_timestamp}}"\u003E\u003Cspan class="_timestamp" data-time="{{actual_timestamp}}"\u003E{{short_timestamp}}\u003C/span\u003E\u003C/a\u003E',tweet_box:'\u003Cdiv class="tweet-box condensed"\u003E\n  {{#show_title}}\n    \u003Cdiv class="tweet-box-title"\u003E\n      \u003Ch2\u003E{{title}}\u003C/h2\u003E\n    \u003C/div\u003E\n  {{/show_title}}\n  \u003Cdiv class="text-area"\u003E\n    \u003Cdiv class="text-area-editor"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-button-container"\u003E\n    {{#show_geo}}\n      \u003Cspan class="geo-control"\u003E\u003C/span\u003E\n    {{/show_geo}}\n    \u003Cimg src="/images/spinner.gif" class="tweet-spinner" style="display: none;" /\u003E\n    \u003Cinput class="tweet-counter" value="140" disabled="disabled"/\u003E\n    \u003Ca href="#" class="tweet-button button"\u003E{{button_text}}\u003C/a\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',tweet_actions:"\u003Cspan class='tweet-actions' data-tweet-id=\"{{id}}\"\u003E\n  {{#logged_in}}\n    {{^favorited}}\n      \u003Ca href='#' class='favorite-action' title=\"{{_i}}Favorite{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Favorite{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n    {{/favorited}}\n    {{#favorited}}\n      \u003Ca href='#' class='unfavorite-action' data-favorited=\"true\" title=\"{{_i}}Unfavorite{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Unfavorite{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n    {{/favorited}}\n\n    {{^current_user_retweet}}\n      {{#allowed_to_retweet}}\n        \u003Ca href='#' class='retweet-action' title=\"{{_i}}Retweet{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Retweet{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n      {{/allowed_to_retweet}}\n    {{/current_user_retweet}}\n    {{#current_user_retweet}}\n      \u003Ca href='#' class='unretweet-action' data-retweeted=\"true\" title=\"{{_i}}Undo Retweet{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Undo Retweet{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n    {{/current_user_retweet}}\n\n    \u003Ca href='#' class='reply-action' data-screen-name=\"{{#user}}{{screen_name}}{{/user}}\" title=\"{{_i}}Reply{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Reply{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n    {{#show_trashcan}}\n      \u003Ca href=\"#\" class='delete-action' title=\"{{_i}}Delete{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E{{^decider_new_tweet_labels}}\u003Cb\u003E{{_i}}Delete{{/i}}\u003C/b\u003E{{/decider_new_tweet_labels}}\u003C/span\u003E\u003C/a\u003E\n    {{/show_trashcan}}\n\n    {{#show_not_relevant_action}}\n      \u003Ca href=\"#\" class='not-relevant-action' title=\"{{_i}}Not relevant{{/i}}\"\u003E\u003Cspan\u003E\u003Ci\u003E\u003C/i\u003E\u003Cb\u003E{{_i}}Not relevant{{/i}}\u003C/b\u003E\u003C/span\u003E\u003C/a\u003E\n    {{/show_not_relevant_action}}\n  {{/logged_in}}\n\u003C/span\u003E",no_saved_searches:'\u003Cdiv class="empty-drop-down"\u003E\n  \u003Cdiv class="no-saved-searches title"\u003E{{_i}}You haven\'t saved any searches yet.{{/i}}\u003C/div\u003E\n  \u003Cp class="no-saved-searches info"\u003E\n    {{_i}}Click on "Save this search" from the results page to quickly access the latest Tweets about a topic or query, right from here. \u003Ca href="{{saved_searches_help_path}}" target="_blank"\u003ELearn More\u003C/a\u003E{{/i}}\n  \u003C/p\u003E\n\u003C/div\u003E',message_thread:'\u003Cdiv class="messages-pane" data-thread-id="{{thread_id}}"\u003E\n  {{#items}}\n    {{\u003Emessage}}\n  {{/items}}\n\u003C/div\u003E',conversation:'\u003Cdiv class="conversation"\u003E\n  \u003Cdiv class="related-tweets" {{\u003Erelated_tweets_data_attributes}}\u003E\n    {{#all_but_last_ancestor_tweet_views}}\n      {{\u003Esimple_tweet}}\n    {{/all_but_last_ancestor_tweet_views}}\n    {{#last_ancestor_tweet_view}}\n      {{\u003Econversation_last_ancestor_tweet}}\n    {{/last_ancestor_tweet_view}}\n    {{#has_earlier}}\n      {{\u003Econversation_earlier}}\n    {{/has_earlier}}\n  \u003C/div\u003E\n  {{#tweet_view}}\n    {{\u003Edetails_pane_tweet}}\n  {{/tweet_view}}\n\u003C/div\u003E',replies:'\u003Cdiv class="replies related-tweets" {{\u003Erelated_tweets_data_attributes}}\u003E\n  {{#has_tweets}}\n    {{\u003Econversation_later}}\n  {{/has_tweets}}\n  {{#descendant_tweet_views}}\n    {{\u003Esimple_tweet}}\n  {{/descendant_tweet_views}}\n  {{#fork_tweet_views}}\n    {{\u003Esimple_tweet}}\n  {{/fork_tweet_views}}\n\u003C/div\u003E',nothing:"\u003C!-- nothing! --\u003E",rate_limit_page:"\u003Cdiv class=\"four-twenty\"\u003E\n  {{#render_page_content}}\n    \u003Ch2\u003E{{_i}}Uh-oh! You're being rate-limited!{{/i}}\u003C/h2\u003E\n\n    \u003Cp class='rate-limit-message'\u003E\n      {{_i}}While we appreciate your enthusiasm, in order to control abuse, we limit how often you can search.{{/i}}\n    \u003C/p\u003E\n\n    \u003Cp class='rate-limit-message'\u003E\n      {{_i}}For locations where many people share the same IP address (e.g., corporations and conferences), our rate limits may be too strict. If you believe you are using Twitter normally, please \u003Ca href=\"{{support_path}}\"\u003Elet us know\u003C/a\u003E.{{/i}}\n    \u003C/p\u003E\n\n    \u003Cp\u003E{{\u003Edashboard_footer}}\u003C/p\u003E\n  {{/render_page_content}}\n\u003C/div\u003E",stream_manager:'\u003Cdiv class="stream-manager"\u003E\n  {{#tweets}}\n    \u003Cdiv class="stream-title"\u003E\u003C/div\u003E\n    \u003Cdiv class="stream"\u003E\n      {{{tweets}}}\n    \u003C/div\u003E\n  {{/tweets}}\n\u003C/div\u003E',geo_where_is_place:'\u003Cdiv\u003E{{_i}}Where is "{{place_name}}"?{{/i}}\u003C/div\u003E\n\u003Cdiv class="geo-query-map"\u003E\n  \u003Cinput type="text" title="{{_i}}Move map to...{{/i}}"/\u003E\u003Cspan title="{{_i}}Move map{{/i}}"\u003E\u0026nbsp;\u003C/span\u003E\n  \u003Cdiv class="geo-query-map-error"/\u003E\n\u003C/div\u003E\n\u003Cdiv class="geo-where-is-place"\u003E\n  \u003Cdiv class="geo-map-canvas" /\u003E\n  \u003Cdiv class="geo-move-pin-hint"\u003E\n    \u003Cdiv class="geo-creation-hint-arrow" /\u003E\n    \u003Cdiv class="geo-creation-hint-bubble"\u003E\n      {{_i}}Does this look right?\u003Cbr\u003EIf not, move the pin to edit the location.{{/i}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="geo-drop-pin-hint"\u003E\n    \u003Cdiv class="geo-creation-hint-bubble"\u003E\n      {{_i}}Move the pin onto the map to add this place.{{/i}}\n    \u003C/div\u003E\n    \u003Cdiv class="geo-creation-hint-arrow" /\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="geo-droppable-pin" /\u003E\n  \u003Cdiv class="geo-creation-actions"\u003E\n    \u003Cbutton type="button" class="btn btn-default btn-disabled geo-submit"\u003E{{_i}}Next{{/i}}\u003C/button\u003E\n    \u003Cspan class="geo-progress"\u003E\u0026nbsp;\u003C/span\u003E\n    \u003Cdiv class="geo-place-creation-error" /\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\n',details_pane_container:'\u003Cdiv id="details-pane-outer"\u003E\n  \u003Cdiv class="details-pane-shell"\u003E\n    \u003Cdiv class="details-pane"\u003E\n      {{{pane}}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',place_page:'\u003Cdiv class="main-content"\u003E\n  {{{noscript}}}\n    \u003Cdiv class="search-header"\u003E\n      \u003Cdiv class="back-to-home"\u003E\n        \u003Ca href="{{index_path}}"\u003E{{_i}}\u0026larr; Back to Home{{/i}}\u003C/a\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="geo-place-page-title"\u003E\n      \u003Ch2\u003E\n      \u003Cstrong\u003E{{name}}\u003C/strong\u003E\n      \u003C/h2\u003E\n      \u003Cdiv class="geo-place-page-details"\u003E\n        {{#full_address}}\n          {{full_address}}\u003Cspan class="geo_map_link_separator"\u003E|\u003C/span\u003E\n        {{/full_address}}\n        {{#map_link}}\n          \u003Ca target="_blank" href="{{map_link}}"\u003E{{_i}}full map{{/i}}\u003C/a\u003E\n        {{/map_link}}\n        \u003Cdiv\u003E{{phone}}\u003C/div\u003E\n        {{#location_service_down}}\n        {{_i}}Location service is temporarily unavailable{{/i}}\n        {{/location_service_down}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n    {{#show_map}}\n    \u003Cdiv class="geo-place-page-map-container"\u003E\n      \u003Cdiv id="geo_place_page_map_canvas"\u003E\u003C/div\u003E\n    \u003C/div\u003E\n    {{/show_map}}\n    \u003Cul class="stream-tabs"\u003E\n      \u003Cli class="stream-tab stream-tab-tweets {{#active_tab_tweets}}active{{/active_tab_tweets}}"\u003E\n        \u003Ca class="tab-text" href="{{place_path}}"\u003E{{_i}}All Tweets{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      \u003Cli class="stream-tab stream-tab-links {{#active_tab_links}}active{{/active_tab_links}}"\u003E\n        \u003Ca class="tab-text" href="{{place_links_path}}"\u003E{{_i}}Tweets with links{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n    \u003C/ul\u003E\n    {{\u003Estream_manager}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n\u003Cdiv class="geo-map-place-bubble"\u003E\n  \u003Cspan/\u003E\n  \u003Cdiv class="round"\u003E\n    \u003Cdiv class="geo-place-title" /\u003E\n    \u003Cdiv class="geo-place-details" /\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\u003Cdiv class="dashboard place-dashboard"\u003E\u003C/div\u003E\n{{\u003Edetails_pane_container}}',tweet_source:'\u003Cspan class="tweet-source"\u003E{{_i}}via {{{source}}}{{/i}}\u003C/span\u003E',detached_email_banner:'\u003Cdiv class="banner-outer banner-border"\u003E\n  \u003Cdiv class="banner"\u003E\n    \u003Cdiv class="banner-inside verify-email-banner"\u003E\n      \u003Cdiv class="first-banner-row"\u003E\n        \u003Cspan class="title"\u003E{{_i}}New email address required.{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E{{_i}}Twitter has removed the email address from your account, by request of the email owner.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="second-banner-row"\u003E\n        \u003Cp\u003E{{_i}}Please \u003Ca href="{{change_email_path}}"\u003Eenter a new email address\u003C/a\u003E where you can be reached.{{/i}}\u0026nbsp;\u003Ca href="{{email_help_path}}"\u003E{{_i}}Learn more{{/i}}\u0026nbsp; \u0026rsaquo;\u003C/a\u003E\u003C/p\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',local_trend_location:"\u003Cdd\u003E\u003Ca href='#' data-woeid=\"{{woeid}}\"\u003E{{name}}\u003Cspan\u003E\u003C/span\u003E\u003C/a\u003E\u003C/dd\u003E","404_page":'\u003Cdiv class="four-oh-four"\u003E\n  {{#render_page_content}}\n    \u003Ch2\u003E{{_i}}Sorry, that page doesn\u2019t exist!{{/i}}\u003C/h2\u003E\n    {{#logged_in}}\n      \u003Cform class="user-search-form" method="GET" action="{{who_to_follow_search_form_path}}"\u003E\n        \u003Clabel for="fof-user-search-field"\u003E{{_i}}Search for a username, first or last name:{{/i}}\u003C/label\u003E\n        \u003Cinput type="text" class="user-search-query" name="q" id="fof-user-search-field" /\u003E\u003Cinput type="submit" value="{{_i}}Search{{/i}}" class="user-search-button button" /\u003E\n      \u003C/form\u003E\n    {{/logged_in}}\n    {{^logged_in}}\n      \u003Cp class="gohome"\u003E\u0026larr;\u0026#32;\u003Ca href="{{home_path}}"\u003E{{_i}}Go to the homepage{{/i}}\u003C/a\u003E\u003C/p\u003E\n    {{/logged_in}}\n    \u003Cp\u003E{{\u003Edashboard_footer}}\u003C/p\u003E\n  {{/render_page_content}}\n\u003C/div\u003E',local_trend_breadcrumb_location:'{{\u003Elocal_trend_last_breadcrumb_location}}\u003Cspan class="trend-breadcrumb-connector"\u003E\u0026rarr;\u003C/span\u003E',welcome_ambassador:'\u003Cdiv class="user-details clearfix {{lang}}"\u003E\n  \u003Cimg src="{{reasonably_small_profile_image_url}}" alt="{{name}}" data-user-id="{{id}}"/\u003E\n  \u003Ch4\u003E\n    {{_i}}You are now following \u003Cstrong\u003E{{name}}\u003C/strong\u003E{{/i}}\n    {{#verified}}\n      \u003Cspan class="verified-icon"\u003E\u003C/span\u003E\n    {{/verified}}\n  \u003C/h4\u003E\n  \u003Cdiv\u003E\n    \u003Cspan class="user-screen-name"\u003E@{{screen_name}}\u003C/span\u003E\n    \u003Cspan class="location"\u003E{{location}}\u003C/span\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',tweet_meta:"\u003Cdiv class='tweet-meta'\u003E\n  \u003Cspan class='icons'\u003E\n    {{#is_sponsored}}\n      {{#retweet_count}}\n        \u003Cspan class='retweet-icon'\u003E\u003C/span\u003E \u003Cem\u003E{{retweet_count_text}}\u003C/em\u003E\n      {{/retweet_count}}\n    {{/is_sponsored}}\n    {{^is_sponsored}}\n      {{#was_retweeted}}\n        {{#retweeting_status}}\n          \u003Cspan class='retweet-icon'\u003E\u003C/span\u003E {{#user}}\u003Cem\u003E{{_i}}by {{screen_name}}{{/i}}\u003C/em\u003E{{/user}}\n        {{/retweeting_status}}\n      {{/was_retweeted}}\n    {{/is_sponsored}}\n    \u003Cdiv class=\"extra-icons\"\u003E\n      {{#is_reply}}\n        \u003Cspan class='reply-icon icon'\u003E@\u003C/span\u003E\n      {{/is_reply}}\n      \u003Cspan class=\"inlinemedia-icons\"\u003E\u003C/span\u003E\n      {{#show_geo_icon}}\u003Cspan class=\"geo-pin\"\u003E\u003C/span\u003E{{/show_geo_icon}}\n    \u003C/div\u003E\n  \u003C/span\u003E\n\u003C/div\u003E",brought_back_dialog:'\u003Cdiv {{#container_id}}id="{{container_id}}" {{/container_id}}class="twttr-dialog-container" style="visibility: hidden;"\u003E\n  \u003Cdiv class="twttr-dialog" style="top: 142px !important;"\u003E\n    \u003Cdiv class="twttr-dialog-inside"\u003E\n      \u003Cdiv class="twttr-dialog-body clearfix"\u003E\n        \u003Cdiv class="twttr-dialog-content twttr-dialog-brought-back"\u003E\n          \u003Cdiv class="brought-back-top"\u003E\n            \u003Cdiv class="brought-back-image"\u003E\u0026nbsp;\u003C/div\u003E\n            \u003Ch2 class="brought-back"\u003E{{_i}}Give New Twitter another try!{{/i}}\u003C/h2\u003E\n            \u003Cp class="brought-back-text"\u003E\n              {{_i}}New Twitter is now faster and more reliable. We\'d love for you to try it again!{{/i}}\n            \u003C/p\u003E\n          \u003C/div\u003E\n          \u003Cdiv class="brought-back-bottom"\u003E\n            \u003Cinput type="button" class="promotional button switch-back" value="{{_i}}Try New Twitter!{{/i}}" /\u003E\n            \u003Cp class="brought-back-switch-back"\u003E{{_i}}To access old Twitter, click on your username at the top and choose the option to switch back.{{/i}}\u003C/div\u003E\n          \u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',permalink_page:'\u003Cdiv class="permalink"\u003E\n  \u003Cdiv class="components-above"\u003E\u003C/div\u003E\n  \u003Cdiv class="components-middle"\u003E\n    {{#render_page_content}}\n      {{#tweet}}\n        {{\u003Epermalink_tweet}}\n      {{/tweet}}\n    {{/render_page_content}}\n  \u003C/div\u003E\n  \u003Cdiv class="components-below"\u003E\u003C/div\u003E\n\u003C/div\u003E',search_stream_title:"\u003Cdiv class='delete-saved-search'\u003E\n  \u003Ca href='#' class='delete-saved-search-x'\u003E\u003C/a\u003E\n  \u003Ca href='#'\u003E{{_i}}Remove saved search{{/i}}\u003C/a\u003E\n\u003C/div\u003E\n\u003Cspan\u003E\n  {{_i}}Search results for \u003Cstrong\u003E{{query}}\u003C/strong\u003E{{/i}}\n\u003C/span\u003E\n",more_lists:'\u003Cdiv class="more-lists"\u003E\n  {{#user}}\n    \u003Ch2\u003E\n      {{_i}}More lists by @{{screen_name}}{{/i}}\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      \u003Ca href="{{user_lists_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n    \u003C/h2\u003E\n  {{/user}}\n  {{#lists}}\n  \u003Cul class="list-of-lists clearfix"\u003E\n    {{#items}}\n    \u003Cli\u003E\u003Ca href="{{user_list_path}}"\u003E\u003Cspan class="icon list-icon"\u003E\u003C/span\u003E\u003Cspan class="name"\u003E{{name}}\u003C/span\u003E\u003C/a\u003E\u003C/li\u003E\n    {{/items}}\n  \u003C/ul\u003E\n  {{/lists}}\n\u003C/div\u003E',discovery_dialog:'\u003Cdiv {{#container_id}}id="{{container_id}}" {{/container_id}}class="twttr-dialog-container" style="visibility: hidden;"\u003E\n  \u003Cdiv class="twttr-dialog twttr-dialog-discovery"\u003E\n    \u003Cdiv class="twttr-dialog-inside"\u003E\n      \u003Cdiv class="twttr-dialog-body clearfix"\u003E\n        \u003Cdiv class="twttr-dialog-content"\u003E\n          \u003Cdiv\u003E\n            \u003Ch2 class="discoverability-header"\u003E{{_i}}Be found on Twitter{{/i}}\u003C/h2\u003E\n            \u003Cp\u003E\n              {{_i}}We were hoping you could help us make it easier for people to discover their friends and colleagues on Twitter. Review your settings below to make sure the people you care about can easily find you.{{/i}}\n            \u003C/p\u003E\n            \u003Cform action="#" class="dialog-form"\u003E\n              \u003Cfieldset class="common-form"\u003E\n                \u003Cul\u003E\n                  \u003Cli\u003E\n                    \u003Clabel for="discoverable_name"\u003E{{_i}}Name{{/i}}\u003C/label\u003E\n                    \u003Cinput type="text" name="name" id="discoverable_name" maxlength="20" value="{{name}}"/\u003E\n                  \u003C/li\u003E\n                  \u003Cli\u003E\n                    \u003Clabel for="discoverable_description"\u003E{{_i}}Bio{{/i}}\u003Cbr/\u003E\n                      \u003Csmall\u003E{{_i}}optional{{/i}}\u003C/small\u003E\n                    \u003C/label\u003E\n                    \u003Ctextarea name="description" class="discovery-description" id="discoverable_description"\u003E{{description}}\u003C/textarea\u003E\n                  \u003C/li\u003E\n                  \u003Cli\u003E\n                    \u003Clabel for="discoverable_location"\u003E{{_i}}Location{{/i}}\u003Cbr/\u003E\n                      \u003Csmall\u003E{{_i}}optional{{/i}}\u003C/small\u003E\n                    \u003C/label\u003E\n                    \u003Cinput type="text" name="location" id="discoverable_location" maxlength="100" value="{{location}}"/\u003E\n                  \u003C/li\u003E\n                \u003C/ul\u003E\n                \u003Cul class="discoverability-settings"\u003E\n                  \u003Cli\u003E\n                    \u003Clabel for="discoverable_by_email"\u003E{{_i}}Email{{/i}}\u003C/label\u003E\n                    \u003Cspan class="input-wrapper"\u003E\n                      \u003Cstrong\u003E{{email_address}}\u003C/strong\u003E\n                      \u003Cinput type="checkbox" name="discoverable_by_email" id="discoverable_by_email" {{#email_checked}}checked="checked"{{/email_checked}} value="1" /\u003E\n                      \u003Cspan class="discover-label"\u003E{{_i}}Let others find me by my email address{{/i}}\u003C/span\u003E\n                      \u003Ca href="{{help_url}}" target="_blank" class="help-discover"\u003E\u003C/a\u003E\n                      \u003Cinput type="hidden" name="email_discoverability_set" value="1" /\u003E\n                    \u003C/span\u003E\n                  \u003C/li\u003E\n                  {{#device_setup}}\n                  \u003Cli\u003E\n                    \u003Clabel for="discoverable_by_mobile_phone"\u003E{{_i}}Phone{{/i}}\u003C/label\u003E\n                    \u003Cspan class="input-wrapper"\u003E\n                      \u003Cstrong\u003E{{device_address}}\u003C/strong\u003E\n                      \u003Cinput type="checkbox" name="discoverable_by_mobile_phone" id="discoverable_by_mobile_phone" {{#phone_checked}}checked="checked"{{/phone_checked}} value="1" /\u003E\n                      \u003Cspan class="discover-label"\u003E{{_i}}Let others find me by my phone number{{/i}}\u003C/span\u003E\n                      \u003Ca href="{{help_url}}" target="_blank" class="help-discover"\u003E\u003C/a\u003E\n                      \u003Cinput type="hidden" name="mobile_phone_discoverability_set" value="1" /\u003E\n                    \u003C/span\u003E\n                  \u003C/li\u003E\n                  {{/device_setup}}\n                  \u003Cli\u003E\n                    \u003Cspan class="input-wrapper privacy-statement"\u003E\n                      {{#device_setup}}\n                        {{_i}}Your email and phone \u003Ca href="{{help_url}}" target="_blank"\u003Ewill not be publicly displayed\u003C/a\u003E. You can change your settings anytime.{{/i}}\n                      {{/device_setup}}\n                      {{^device_setup}}\n                        {{_i}}Your email \u003Ca href="{{help_url}}" target="_blank"\u003Ewill not be publicly displayed\u003C/a\u003E. You can change your settings anytime.{{/i}}\n                      {{/device_setup}}\n                    \u003C/span\u003E\n                  \u003C/li\u003E\n                \u003C/ul\u003E\n                \u003Cdiv class="discover-buttons"\u003E\n                  \u003Cdiv class="button submit"\u003E{{_i}}Good to go!{{/i}}\u003C/div\u003E\n                  \u003Cdiv class="button cancel"\u003E{{_i}}Ask me later{{/i}}\u003C/div\u003E\n                \u003C/div\u003E\n              \u003C/fieldset\u003E\n            \u003C/form\u003E\n          \u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',delete_list_button:'\u003Cdiv class="button delete-list-button" title="{{_i}}Delete{{/i}}" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}"\u003E\u003Cspan class="trashcan"\u003E\u003C/span\u003E\u003Cb class="label"\u003E{{_i}}Delete{{/i}}\u003C/b\u003E\u003C/div\u003E\n',stream_loading:'\u003Cdiv class="stream-loading"\u003E\n  \u003Cspan class="spinner" title="{{_i}}Loading...{{/i}}"\u003E\u003C/span\u003E\n\u003C/div\u003E\n',verify_email_dialog:'\u003Cdiv {{#container_id}}id="{{container_id}}" {{/container_id}}class="twttr-dialog-container" style="visibility: hidden;"\u003E\n  \u003Cdiv class="twttr-dialog" style="top: 142px"\u003E\n    \u003Cdiv class="twttr-dialog-inside"\u003E\n      \u003Cdiv class="twttr-dialog-body clearfix"\u003E\n        \u003Cdiv class="twttr-dialog-content twttr-dialog-verify-email"\u003E\n          {{#abtest_email_verification_18_modal_dialog}}\n            \u003Ch2 class="verify-email"\u003E{{_i}}Please verify your email address{{/i}}\u003C/h2\u003E\n          {{/abtest_email_verification_18_modal_dialog}}\n          {{#abtest_email_verification_18_overlay}}\n            \u003Ch2 class="verify-email"\u003E{{_i}}Almost there!{{/i}}\u003C/h2\u003E\n          {{/abtest_email_verification_18_overlay}}\n          \u003Cp class="verify-email-text"\u003E\n            {{_i}}Twitter has sent an email to \u003Cstrong\u003E{{email}}\u003C/strong\u003E to verify your email address. You must \u003Cstrong\u003Eclick the link in the email\u003C/strong\u003E in order to verify your address and finish signing up on Twitter.{{/i}}\n          \u003C/p\u003E\n          \u003Cp\u003E\n            {{_i}}If you do not receive this message in the next hour, you can \u003Ca href="#" class="send-verify-email"\u003Erequest another verification email\u003C/a\u003E or \u003Ca href="{{change_email_path}}" class="change-email"\u003Echange your email address\u003C/a\u003E.{{/i}}\n          \u003C/p\u003E\n          \u003Cdiv class="button ok-thanks"\u003E\u003Cstrong\u003E{{_i}}OK, thanks!{{/i}}\u003C/strong\u003E\u003C/div\u003E\n        \u003C/div\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E',place_people:'\u003Ch2 class="place-component"\u003E\n  {{_i}}Recent people{{/i}}\n  \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n  \u003Ca class="view-all" href="{{place_users_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n\u003C/h2\u003E\n{{#user_thumbs}}\n  {{\u003Euser_thumb_list}}\n{{/user_thumbs}}\n\u003Cdiv style="clear:both;"\u003E\u003C/div\u003E',dialog:'\u003Cdiv {{#container_id}}id="{{container_id}}" {{/container_id}}class="twttr-dialog-container" style="visibility: hidden;"\u003E\n  \u003Cdiv class="twttr-dialog"\u003E\n    \u003Cdiv class="twttr-dialog-header"\u003E\n      \u003Ch3\u003E{{{title}}}\u003C/h3\u003E \u003Cdiv class="twttr-dialog-close"\u003E\u003Cb\u003E\u0026times;\u003C/b\u003E\u003C/div\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="twttr-dialog-inside"\u003E\n      \u003Cdiv class="twttr-dialog-body clearfix"\u003E\n        \u003Cdiv class="twttr-dialog-content"\u003E\n          {{{content}}}\n        \u003C/div\u003E\n      \u003C/div\u003E\n      \u003Cdiv class="twttr-dialog-footer clearfix"\u003E\n        {{{footer}}}\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',edit_list_button:'\u003Cdiv class="button edit-list-button" data-screen-name="{{#user}}{{screen_name}}{{/user}}" data-list-id="{{id}}" title="{{_i}}Edit{{/i}}"\u003E\u003Cspan class="edit-list"\u003E\u003C/span\u003E\u003Cb class="label"\u003E{{_i}}Edit{{/i}}\u003C/b\u003E\u003C/div\u003E\n',tweet_text:"\u003Cdiv class='tweet-text{{#decider_phoenix_pretty_links}} pretty-link{{/decider_phoenix_pretty_links}}'\u003E{{{linkified_text}}}\u003C/div\u003E\n",messages_page:'\u003Cdiv class="main-content messages-main-content"\u003E\n  {{{noscript}}}\n    \u003Cdiv class="messages-header header"\u003E\n      \u003Ch1\u003E{{_i}}Messages{{/i}}\u003C/h1\u003E\u003Cdiv class="new-message-button button"\u003E{{_i}}New Message{{/i}}\u003C/div\u003E\n    \u003C/div\u003E\n    {{\u003Estream_manager}}\n  {{{end_noscript}}}\n\u003C/div\u003E\n{{\u003Edetails_pane_container}}\n',geo_chrome_banner:'\u003Cdiv id="geo_browser_help_banner" class="geo_chrome"\u003E\n  \u003Cdiv\u003E{{_i}}Click "Allow" to let Twitter get your location.{{/i}}\u003C/div\u003E\n\u003C/div\u003E\n',place_business_unclaimed:"\u003Ch2\u003E{{_i}}Are you the owner of \u003Cstrong\u003E{{place_name}}\u003C/strong\u003E?{{/i}}\u003C/h2\u003E\n{{_i}}See who's visiting your place and what they're saying about it! Promote your presence and increase traffic to your profile.{{/i}}\n\u003Cbr\u003E\n\u003Ca href=\"#\"\u003E{{_i}}Claim this place \u0026rarr;{{/i}}\u003C/a\u003E",profile_header:'{{%TRANSLATION-HINT mode=profile_tabs}}\n\n\u003Cdiv class="profile-header"\u003E\n  {{#antisocial}}\n    {{\u003Eantisocial_banner}}\n  {{/antisocial}}\n  \u003Cdiv class="profile-info clearfix"\u003E\n    \u003Cdiv class="profile-image-container"\u003E\n      \u003Ca href="{{bigger_profile_image_url}}" class=\'profile-picture\' target="_blank"\u003E\u003Cimg src="{{reasonably_small_profile_image_url}}" alt="{{name}}" /\u003E\u003C/a\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="profile-details"\u003E\n      {{\u003Efull_name}}\n      \u003Cdiv class="screen-name-and-location"\u003E\u003Cspan class="screen-name screen-name-{{screen_name}} pill"\u003E@{{screen_name}}\u003C/span\u003E {{location}}\u003C/div\u003E\n      \u003Cdiv class="bio"\u003E{{{linkified_description}}}\u003C/div\u003E\n      \u003Cdiv class="url"\u003E\u003Ca target="_blank" rel="me nofollow" href="{{url}}"\u003E{{{display_url_or_url}}}\u003C/a\u003E\u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="profile-actions-container"/\u003E\n    \u003Cul class="stream-tabs"\u003E\n      \u003Cli class="stream-tab stream-tab-tweets {{#active_tab_tweets}}active{{/active_tab_tweets}}"\u003E\n        \u003Ca class="tab-text" href="{{profile_path}}"\u003E{{_i}}Timeline{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      {{#can_view}}\n        \u003Cli class="stream-tab stream-tab-favorites {{#active_tab_favorites}}active{{/active_tab_favorites}}"\u003E\n          \u003Ca class="tab-text" href="{{user_favorites_path}}"\u003E{{_i}}Favorites{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n      {{/can_view}}\n      {{#social_context}}\n      \u003Cli class="stream-tab stream-tab-following dropdown-link {{#active_tab_following}}active{{/active_tab_following}}"\u003E\n        \u003Cp class="tab-text"\u003E{{_i}}Following{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/p\u003E\n      \u003C/li\u003E\n      \u003Cli class="stream-tab stream-tab-followers dropdown-link {{#active_tab_followers}}active{{/active_tab_followers}}"\u003E\n        \u003Cp class="tab-text"\u003E{{_i}}Followers{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/p\u003E\n      \u003C/li\u003E\n      {{/social_context}}\n      {{^social_context}}\n      \u003Cli class="stream-tab stream-tab-following {{#active_tab_following}}active{{/active_tab_following}}"\u003E\n        \u003Ca class="tab-text" href="{{user_following_path}}"\u003E{{_i}}Following{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      \u003Cli class="stream-tab stream-tab-followers {{#active_tab_followers}}active{{/active_tab_followers}}"\u003E\n        \u003Ca class="tab-text" href="{{user_followers_path}}"\u003E{{_i}}Followers{{/i}}\u003C/a\u003E\n      \u003C/li\u003E\n      {{/social_context}}\n      {{#has_pending_requests}}\n        \u003Cli class="stream-tab stream-tab-pending {{#active_tab_pending}}active{{/active_tab_pending}}"\u003E\n          \u003Ca class="tab-text pending-follow" title=\'{{_i}}Follower requests{{/i}}\' href="{{follower_requests_path}}"\u003E{{_i}}Requests{{/i}}\u003C/a\u003E\n        \u003C/li\u003E\n      {{/has_pending_requests}}\n      \u003Cli class="stream-tab stream-tab-lists dropdown-link {{#active_tab_lists}}active{{/active_tab_lists}}"\u003E\n        \u003Cp class="tab-text"\u003E{{_i}}Lists{{/i}}\u003Ci\u003E\u003C/i\u003E\u003C/p\u003E\n      \u003C/li\u003E\n    \u003C/ul\u003E\n\u003C/div\u003E\n',profile_actions:'{{%TRANSLATION-HINT mode=actions}}\n\n\u003Cdiv class="profile-actions profile-actions-{{id}} clearfix"\u003E\n\n  {{^logged_in}}\n    {{#show_sms_prompt}}\n      \u003Cdiv class="logged-out-mobile"\u003E\n        \u003Cspan class="icon"\u003E\u003C/span\u003E {{{sms_follow_text}}}\n      \u003C/div\u003E\n    {{/show_sms_prompt}}\n  {{/logged_in}}\n\n  {{#in_welcome_page}}\n    {{^abtest_welcome_profiles_24_any_bucket}}\n      \u003Cdiv class="buttons"\u003E\n        {{#show_mute}}\n          \u003Cdiv title="Employees Only" class="button mute-action {{#is_muted}}is-muted{{/is_muted}}"\u003E{{#is_muted}}{{_i}}Unmute{{/i}}{{/is_muted}}{{^is_muted}}{{_i}}Mute{{/i}}{{/is_muted}}\u003C/div\u003E\n        {{/show_mute}}\n        {{#is_admin}}\n          \u003Cdiv class="button direct-message-action"\u003E{{^is_narrow}}{{_i}}Message{{/i}}{{/is_narrow}}{{#is_narrow}}\u003Cspan class="direct-message-icon"\u003E\u003C/span\u003E{{/is_narrow}}\u003C/div\u003E\n        {{/is_admin}}\n        {{^is_admin}}\n          {{#can_dm}}\u003Cdiv class="button direct-message-action"\u003E{{^is_narrow}}{{_i}}Message{{/i}}{{/is_narrow}}{{#is_narrow}}\u003Cspan class="direct-message-icon"\u003E\u003C/span\u003E{{/is_narrow}}\u003C/div\u003E{{/can_dm}}\n        {{/is_admin}}\n\n        {{^is_narrow}}\n          {{#logged_in}}\n            {{#show_list_options}}\n              \u003Cdiv class="button list-action-button" data-user-id="{{id}}"\u003E\n                \u003Cspan class="list"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n              \u003C/div\u003E\n            {{/show_list_options}}\n            {{^is_current_user}}\n              \u003Cdiv class="button profile-actions-button" data-user-id="{{id}}"\u003E\n                \u003Cspan class="gear"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n              \u003C/div\u003E\n            {{/is_current_user}}\n          {{/logged_in}}\n        {{/is_narrow}}\n\n        {{#is_narrow}}\n          {{#logged_in}}\n            {{^is_current_user}}\n              \u003Cdiv class="button user-profile-actions-button" data-user-id="{{id}}"\u003E\n                \u003Cspan class="user-actions"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n              \u003C/div\u003E\n            {{/is_current_user}}\n          {{/logged_in}}\n        {{/is_narrow}}\n\n      \u003C/div\u003E\n    {{/abtest_welcome_profiles_24_any_bucket}}\n  {{/in_welcome_page}}\n  {{^in_welcome_page}}\n    \u003Cdiv class="buttons"\u003E\n      {{#show_mute}}\n        \u003Cdiv title="Employees Only" class="button mute-action {{#is_muted}}is-muted{{/is_muted}}"\u003E{{#is_muted}}{{_i}}Unmute{{/i}}{{/is_muted}}{{^is_muted}}{{_i}}Mute{{/i}}{{/is_muted}}\u003C/div\u003E\n      {{/show_mute}}\n      {{#is_admin}}\n        \u003Cdiv class="button direct-message-action"\u003E{{^is_narrow}}{{_i}}Message{{/i}}{{/is_narrow}}{{#is_narrow}}\u003Cspan class="direct-message-icon"\u003E\u003C/span\u003E{{/is_narrow}}\u003C/div\u003E\n      {{/is_admin}}\n      {{^is_admin}}\n        {{#can_dm}}\u003Cdiv class="button direct-message-action"\u003E{{^is_narrow}}{{_i}}Message{{/i}}{{/is_narrow}}{{#is_narrow}}\u003Cspan class="direct-message-icon"\u003E\u003C/span\u003E{{/is_narrow}}\u003C/div\u003E{{/can_dm}}\n      {{/is_admin}}\n\n      {{^is_narrow}}\n        {{#logged_in}}\n          {{#show_list_options}}\n            \u003Cdiv class="button list-action-button" data-user-id="{{id}}"\u003E\n              \u003Cspan class="list"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n            \u003C/div\u003E\n          {{/show_list_options}}\n          {{^is_current_user}}\n            \u003Cdiv class="button profile-actions-button" data-user-id="{{id}}"\u003E\n              \u003Cspan class="gear"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n            \u003C/div\u003E\n          {{/is_current_user}}\n        {{/logged_in}}\n      {{/is_narrow}}\n      {{#is_narrow}}\n        {{#logged_in}}\n          {{^is_current_user}}\n            \u003Cdiv class="button user-profile-actions-button" data-user-id="{{id}}"\u003E\n              \u003Cspan class="user-actions"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n            \u003C/div\u003E\n          {{/is_current_user}}\n        {{/logged_in}}\n      {{/is_narrow}}\n\n    \u003C/div\u003E\n  {{/in_welcome_page}}\n\n  \u003Cdiv class="follow-state"\u003E\n    {{#can_view}}\n      {{#is_current_user}}\n        \u003Cspan class="thats-you"\u003E\u003Ca href="{{settings_path}}"\u003E{{_i}}Edit your profile{{/i}}\u0026nbsp;\u0026rarr;\u003C/a\u003E\u003C/span\u003E\n      {{/is_current_user}}\n\n      {{^is_current_user}}\n        {{#following}}\n          \u003Ca href=\'#\' class="button profile-unfollow-link" data-user-id="{{id}}"\u003E\n            \u003Cspan class="you-follow"\u003E\u003C/span\u003E\n            \u003Cem class="wrapper"\u003E\n              \u003Cb\u003E{{_i}}Following{{/i}}\u003C/b\u003E\n              \u003Cb class="unfollow"\u003E{{_i}}Unfollow{{/i}}\u003C/b\u003E\n            \u003C/em\u003E\n          \u003C/a\u003E\n        {{/following}}\n        {{^following}}\n          {{#blocking}}\n            {{\u003Eblocking_controls}}\n          {{/blocking}}\n          {{^blocking}}\n            \u003Cdiv class="button profile-follow-button" data-user-id="{{id}}"\u003E\n              \u003Cspan class="plus"\u003E\u003C/span\u003E \u003Cstrong\u003E{{_i}}Follow{{/i}}\u003C/strong\u003E\n            \u003C/div\u003E\n          {{/blocking}}\n        {{/following}}\n      {{/is_current_user}}\n    {{/can_view}}\n\n    {{^can_view}}\n      {{#follow_request_sent}}\n        \u003Cspan class="you-requested"\u003E{{_i}}Your follow request has been sent{{/i}} \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\u003C/span\u003E\n        \u003Ca href=\'#\' class="cancel-request-link" data-user-id="{{id}}"\u003E{{_i}}Cancel request{{/i}}\u003C/a\u003E\n      {{/follow_request_sent}}\n      {{^follow_request_sent}}\n        {{#logged_in}}\n          {{#blocking}}\n            {{\u003Eblocking_controls}}\n          {{/blocking}}\n          {{^blocking}}\n            \u003Cdiv class="button follow-request-button" data-user-id="{{id}}"\u003E\n              \u003Cspan class="plus"\u003E\u003C/span\u003E \u003Cstrong\u003E{{_i}}Send follow request{{/i}}\u003C/strong\u003E\n            \u003C/div\u003E\n          {{/blocking}}\n        {{/logged_in}}\n      {{/follow_request_sent}}\n    {{/can_view}}\n  \u003C/div\u003E\n\n  {{#show_device_notifications}}\n    \u003Cspan class="icon device-notifications {{#notifications_on_for_user}}notifying{{/notifications_on_for_user}}" data-user-id="{{id}}"\u003E\u003C/span\u003E\n  {{/show_device_notifications}}\n  {{#following}}\n    \u003Cspan class="icon retweet-setting {{#want_retweets}}including{{/want_retweets}}" data-user-id="{{id}}"\u003E\u003C/span\u003E\n  {{/following}}\n\u003C/div\u003E\n',profile_list_tags:'\u003Cdiv class="list-tags"\u003E\n  \u003Chr/\u003E\n  \u003Cspan class="your-lists"\u003E{{_i}}Your Lists:{{/i}}\u003C/span\u003E\n  {{#items}}\n    \u003Cspan class="{{class}}"\u003E\n      \u003Ca href={{uri}}\u003E\n        {{{name}}}\n        {{#isPrivate}}\n          \u003Cspan title="{{_i}}Private List{{/i}}" class="lock-icon"\u003E\u003C/span\u003E\n        {{/isPrivate}}\n      \u003C/a\u003E\n    \u003C/span\u003E\n  {{/items}}\n\u003C/div\u003E',no_lists:'\u003Cdiv class="empty-drop-down"\u003E\n  \u003Cdiv class="no-lists title"\u003E{{_i}}You don\'t have any lists yet.{{/i}}\u003C/div\u003E\n  \u003Cp class="no-lists info"\u003E\n    {{_i}}Create a custom timeline of Tweets by adding users to a list (\u003Ca href="{{lists_help_path}}" target="_blank"\u003Esee how\u003C/a\u003E). You can also follow lists curated by others.{{/i}}\n  \u003C/p\u003E\n\u003C/div\u003E',recently_followed:'\u003Cdiv class="recently-followed-users"\u003E\n\n  \u003Cdiv class="followed clearfix {{#following_10}}following-10{{/following_10}}"\u003E\n    {{#welcome_flow}}\n      \u003Ch2\u003E{{_i}}Welcome To Twitter @{{screen_name}}!{{/i}}\u003C/h2\u003E\n      \u003Cp class="welcome-few-followers"\u003E{{_i}}To get the most out of Twitter follow your first \u003Cstrong\u003E10 accounts\u003C/strong\u003E that are of interest to you.{{/i}}\u003C/p\u003E\n      \u003Cp class="welcome-many-followers"\u003E{{_i}}Awesome, you\'ve followed your first 10! As you follow more users, your timeline of updates will get better and better.{{/i}}\u003C/p\u003E\n      \u003Ch2 class="welcome-follow-count"\u003E{{_i}}You follow \u003Cspan\u003E{{following_count}}\u003C/span\u003E{{/i}}\u003C/h2\u003E\n    {{/welcome_flow}}\n    {{^welcome_flow}}\n        \u003Ch2\u003E\n          {{_i}}You recently followed{{/i}}\n          {{#user}}\n            \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n            \u003Ca class=\'view-all\' href="{{user_following_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n          {{/user}}\n        \u003C/h2\u003E\n    {{/welcome_flow}}\n\n    {{#latest_friends}}\n      {{\u003Euser_thumb_list}}\n    {{/latest_friends}}\n\n  \u003C/div\u003E\n\n  {{#latest_friend}}\n    \u003Cdiv class="suggestions clearfix"\u003E\n        \u003Chr /\u003E\n        \u003Cp\u003E{{_i}}Similar to \u003Cspan\u003E{{latest_friend}}\u003C/span\u003E{{/i}}\u003C/p\u003E\n        \u003Cul /\u003E\n    \u003C/div\u003E\n  {{/latest_friend}}\n\n\u003C/div\u003E',machine_translated_tweet:'\u003Cdiv class="machine-translated-tweet"\u003E\n  \u003Cdiv class="machine-translated-meta"\u003E{{{attribution}}}\u003C/div\u003E\n  \u003Cdiv class="machine-translated-text"\u003E{{{translated_text}}}\u003C/div\u003E\n\u003C/div\u003E\n',device_setup_dialog_waiting:'\u003Cdiv class=\'twttr-dialog-device-setup-waiting\'\u003E\n  \u003Cp\u003E\n    {{_i}}Using the mobile phone you gave us:{{/i}}\n  \u003C/p\u003E\n\n  {{\u003Edevice_setup_dialog_source_address}}\n\n  \u003Cp\u003E\n    {{_i}}Send a text message to Twitter:{{/i}}\n  \u003C/p\u003E\n\n  \u003Cdiv class="phone-instructions"\u003E\n    {{_i}}Text \'{{go_command}}\' to {{address_for_sms}}{{/i}}\n  \u003C/div\u003E\n\n  \u003Cp\u003E\n    {{_i}}Twitter does not charge for this service. Standard message and data rates may apply.{{/i}}\n  \u003C/p\u003E\n\n  \u003Cdiv class="waiting-instructions"\u003E\n    \u003Cp\u003E\n      \u003Cstrong\u003E{{_i}}Twitter is waiting for you to send your verification code...{{/i}}\u003C/strong\u003E\n    \u003C/p\u003E\n\n    \u003Cp\u003E\n      {{_i}}Already sent the verification code?  Wait a minute or two for Twitter to receive the message from your mobile carrier.{{/i}}\n    \u003C/p\u003E\n\n    \u003Cp class="refresh"\u003E\n      {{_i}}Still nothing? \u003Ca href="#"\u003ECheck again\u003C/a\u003E.{{/i}}\n    \u003C/p\u003E\n  \u003C/div\u003E\n\n  \u003Cp class="cancel-instructions"\u003E\n    {{_i}}\u003Ca href="#"\u003ECancel verification\u003C/a\u003E and start over.{{/i}}\n  \u003C/p\u003E\n\u003C/div\u003E',email_already_verified_banner:'\u003Cdiv class="banner-outer"\u003E\n  \u003Cdiv class="banner"\u003E\n    \u003Cdiv class="banner-inside email-already-verified-banner"\u003E\n      \u003Ca class=\'pane-close\' href=\'#\'\u003E{{_i}}close{{/i}} \u003Cspan\u003E\u0026times;\u003C/span\u003E\u003C/a\u003E\n      \u003Cspan class="warning"\u003E\u003C/span\u003E\n      \u003Ch5\u003E{{already_verified_message}}\u003C/h5\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',user_thumb_list_item:'\u003Cli class="user-thumb-list-member"\u003E\n  \u003Ca href="{{profile_path}}" class="user-profile-link" data-user-id="{{id}}"\u003E\u003Cimg src="{{mini_profile_image_url}}" height="24" width="24" title="{{screen_name}}" /\u003E\u003C/a\u003E\n\u003C/li\u003E\n',user_dropdown_item:'\u003Cli class="{{className}} profactions"\u003E\n  {{#checkbox}}\n    \u003Cinput id="{{id}}" type="checkbox" style="float:left" {{#isChecked}}checked{{/isChecked}}/\u003E\n  {{/checkbox}}\n  {{#icon}}\n    \u003Cspan class="list {{icon}}"\u003E\u003C/span\u003E\n  {{/icon}}\n  \u003Cb class="item-name"\u003E{{{label}}}\u003C/b\u003E\n\u003C/li\u003E\n',tweet_user_name:"{{#user}}\n\u003Cspan class='tweet-user-name'\u003E\n  \u003Ca class='tweet-screen-name user-profile-link' data-user-id='{{id}}' href='{{profile_path}}' title='{{name}}'\u003E{{screen_name}}\u003C/a\u003E\n  \u003Cspan class='tweet-full-name'\u003E{{name}}\u003C/span\u003E\n\u003C/span\u003E\n{{/user}}",stream_suggestion_category:'\u003Cdiv class="stream-suggestion-category"\u003E\n\n{{^abtest_wtf_interest_design_29_any_bucket}}\n\u003Ch3\u003E\n  {{category_name}}\n  \u003Ca href="{{category_link}}"\u003E{{_i}}\u003Cstrong\u003E{{size}}\u003C/strong\u003E suggestions{{/i}}\u003C/a\u003E\n  \u003Ca class="view-all" href="{{category_link}}"\u003E{{_i}}View all \u0026rarr;{{/i}}\u003C/a\u003E\n\u003C/h3\u003E\n{{#user_sample}}\n\u003Cul\u003E\n  {{\u003Euser_static_list}}\n\u003C/ul\u003E\n{{/user_sample}}\n{{/abtest_wtf_interest_design_29_any_bucket}}\n\n{{#abtest_wtf_interest_design_29_two_column}}\n\u003Ch3\u003E\n  {{category_name}}\n  \u003Ca href="{{category_link}}"\u003E{{_i}}\u003Cstrong\u003E{{size}}\u003C/strong\u003E suggestions{{/i}}\u003C/a\u003E\n\u003C/h3\u003E\n{{/abtest_wtf_interest_design_29_two_column}}\n\n{{#abtest_wtf_interest_design_29_two_column_w_follow}}\n\u003Ch3\u003E\n  {{#category_top_tweets_user_id}}\n    {{^following_category_top_tweets}}\n    \u003Cdiv class="button follow-button top-tweets-topic-button" data-user-id="{{category_top_tweets_user_id}}"\u003E\u003Cspan class="plus"\u003E\u003C/span\u003E\u0026#32;\u003Cb\u003E{{_i}}Follow{{/i}}\u003C/b\u003E\u003C/div\u003E\n    {{/following_category_top_tweets}}\n    {{#following_category_top_tweets}}\n    \u003Cdiv class="button unfollow-button top-tweets-topic-button" data-user-id="{{category_top_tweets_user_id}}"\u003E{{_i}}Unfollow{{/i}}\u003C/div\u003E\n    {{/following_category_top_tweets}}\n  {{/category_top_tweets_user_id}}\n  {{category_name}}\n  \u003Ca href="{{category_link}}"\u003E{{_i}}\u003Cstrong\u003E{{size}}\u003C/strong\u003E suggestions{{/i}}\u003C/a\u003E\n\u003C/h3\u003E\n{{/abtest_wtf_interest_design_29_two_column_w_follow}}\n\n\u003C/div\u003E',social_context_narrow:'{{#following_followers_of}}\n  {{^is_plural}}\n    {{_i}}You follow an account that follows @{{screen_name}}{{/i}}\n  {{/is_plural}}\n  {{#is_plural}}\n    {{_i}}You follow accounts that follow @{{screen_name}}{{/i}}\n  {{/is_plural}}\n{{/following_followers_of}}\n{{^following_followers_of}}\n  {{^is_plural}}\n    {{_i}}You both follow this account{{/i}}\n  {{/is_plural}}\n  {{#is_plural}}\n    {{_i}}You both follow these accounts{{/i}}\n  {{/is_plural}}\n{{/following_followers_of}}\n\u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E \u003Ca href="{{{view_all}}}" class="view-all"\u003E{{_i}}view{{/i}}\u003C/a\u003E',geo_promo_dialog:'\u003Cdiv id="geo_promo_dialog_content"\u003E\n  \u003Cdiv class="tiny-map"\u003E\u003Cimg src="/images/tiny-map.gif"\u003E\u003C/div\u003E\n  \u003Cdiv id="geo_dialog_descr"\u003E\n    {{_i}}Ever had something you wanted to share ("fireworks!", "party!", "ice cream truck!", or "quicksand...") that would be better with a location?{{/i}}\u0026#32;\n    {{_i}}By turning on this feature, you can include location information like neighborhood, town, or exact point when you tweet.{{/i}}\u003Cbr\u003E\u003Cbr\u003E\n    {{_i}}When you tweet with a location, Twitter stores that location.{{/i}}\u0026#32;\n    {{_i}}You can switch location on/off before each Tweet and always have the option to delete your location history.{{/i}}\u0026#32;\n    \u003Ca id="geo_learn_more" href="http://support.twitter.com/forums/26810/entries/78525" target="_blank"\u003E{{_i}}Learn more{{/i}}\u003C/a\u003E\n  \u003C/div\u003E\n  \u003Cdiv\u003E\n    \u003Cbutton id="geo_turn_location_on" class="btn btn-default"\u003E{{_i}}Turn location on{{/i}}\u003C/button\u003E\n    \u003Ca href="#" id="geo_not_now" class="geo_dialog_close"\u003E{{_i}}Not now{{/i}}\u003C/a\u003E\n    \u003Cspan class="geo-progress"\u003E\u0026nbsp;\u003C/span\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="geo-unable-to-turn-location-on"\u003E\n    {{_i}}Unable to turn location on at this time. Please try again later.{{/i}}\n  \u003C/div\u003E\n\u003C/div\u003E',signup_button:'\u003Cform action="{{signup_path}}" class="signup signup-btn" method="get"\u003E\n  {{#screen_name}}\n    \u003Cinput name="follow" type="hidden" value="{{screen_name}}" /\u003E\n  {{/screen_name}}\n  {{#signup_source}}\n    \u003Cinput type="hidden" name="context" value="{{signup_source}}" /\u003E\n  {{/signup_source}}\n  \u003Cinput class="promotional" type="submit" value="{{_i}}Sign up \u0026raquo;{{/i}}" /\u003E\n\u003C/form\u003E',suspended_banner:'\u003Cdiv class="banner-outer warning"\u003E\n  \u003Cdiv class="banner"\u003E\n    \u003Cdiv class="banner-inside verify-email-banner"\u003E\n      \u003Cdiv class="first-banner-row"\u003E\n        \u003Cspan class="title"\u003E{{_i}}This account is currently suspended.{{/i}}\u003C/span\u003E\n        \u003Cspan\u003E{{_i}}If we have suspended your account by mistake, please let us know by visiting \u003Ca href="{{suspended_help_path}}"\u003ESuspended Accounts\u003C/a\u003E.{{/i}}\u003C/span\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',bouncing_email_banner:'\u003Cdiv class="banner-outer banner-border"\u003E\n  \u003Cdiv class="banner"\u003E\n    \u003Cdiv class="banner-inside verify-email-banner"\u003E\n      {{#stacked}}\n        \u003Cdiv class="first-banner-row"\u003E\n          \u003Cspan class="title"\u003E{{_i}}Whoops, we\'re having problems sending you email!{{/i}}\u003C/span\u003E\n          \u003Cspan\u003E{{_i}}We\'ve tried sending emails to \u003Cstrong\u003E{{email}}\u003C/strong\u003E but they are not getting delivered. You will not receive important account emails unless you update your email address.{{/i}}\u003C/span\u003E\n        \u003C/div\u003E\n      {{/stacked}}\n      {{^stacked}}\n        \u003Cdiv class="first-banner-row"\u003E\n          \u003Cspan class="title"\u003E{{_i}}Is your email address active?{{/i}}\u003C/span\u003E\n          \u003Cspan\u003E{{_i}}We\'ve tried to send emails to \u003Cstrong\u003E{{email}}\u003C/strong\u003E but they are not getting delivered.{{/i}}\u003C/span\u003E\n        \u003C/div\u003E\n        \u003Cdiv class="second-banner-row"\u003E\n          \u003Cp\u003E{{_i}}Please \u003Ca href="{{change_email_path}}"\u003Eupdate your email settings\u003C/a\u003E or \u003Ca href="#" class=\'reset-bounce-link\'\u003Etry sending a message again\u003C/a\u003E to your current address.{{/i}}\u003C/p\u003E\n        \u003C/div\u003E\n      {{/stacked}}\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',local_trends:'\u003Cdl class="local-trends-list"\u003E\n  \u003Cdt\u003E{{_i}}Countries{{/i}}\u003C/dt\u003E\n  {{#country_locations}}\n    {{\u003Elocal_trend_location}}\n  {{/country_locations}}\n\u003C/dl\u003E\n\u003Cdl class="local-trends-list"\u003E\n  \u003Cdt\u003E{{_i}}Cities{{/i}}\u003C/dt\u003E\n  {{#city_locations}}\n    {{\u003Elocal_trend_location}}\n  {{/city_locations}}\n\u003C/dl\u003E\n',user_static_list_item:'\u003Cli class="user-static-list-item" data-user-id="{{id}}"\u003E\n  \u003Cspan class="user-thumb"\u003E\u003Cimg src=\'{{profile_image_url}}\' alt="{{screen_name}}" /\u003E\u003C/span\u003E\n  \u003Cdiv class="user-name-info"\u003E\n    \u003Cspan class="user-full-name" href=\'{{profile_path}}\' data-user-id="{{id}}"\u003E{{name}}\u003C/span\u003E\n    {{#verified}}\n      \u003Cspan class="verified-icon-small"\u003E\u003C/span\u003E\n    {{/verified}}\n    {{#protected}}\n      \u003Cspan class="protected-icon"\u003E\u003C/span\u003E\n    {{/protected}}\n    \u003Cspan class="user-screen-name"\u003E@{{screen_name}}\u003C/span\u003E\n  \u003C/div\u003E\n\u003C/li\u003E\n',user_item_action:'\u003Cspan class="user-follow-state" data-user-id="{{id}}" {{{account_impression_id}}}\u003E\n  {{^is_current_user}}\n    {{^following}}\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      {{^protected}}\n        \u003Ca href="#" class="user-follow-link follow-action" data-user-id="{{id}}" {{{account_impression_id}}}\u003E{{_i}}Follow{{/i}}\u003C/a\u003E\n      {{/protected}}\n      {{#protected}}\n        {{^follow_request_sent}}\n          \u003Ca href="#" class="follow-request-button" data-user-id="{{id}}" {{{account_impression_id}}} title="{{_i}}Send follow request{{/i}}"\u003E{{_i}}Follow{{/i}}\u003C/a\u003E\n        {{/follow_request_sent}}\n        {{#follow_request_sent}}\n          \u003Ca href=\'#\' class="cancel-request-link" data-user-id="{{id}}" {{{account_impression_id}}} title="{{_i}}Cancel follow request{{/i}}"\u003E{{_i}}Cancel{{/i}}\u003C/a\u003E\n        {{/follow_request_sent}}\n      {{/protected}}\n    {{/following}}\n    {{#recently_followed}}\n       \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n       \u003Ca href="#" class="user-unfollow-link unfollow-action" data-user-id="{{id}}" {{{account_impression_id}}}\u003E{{_i}}Unfollow{{/i}}\u003C/a\u003E\n    {{/recently_followed}}\n  {{/is_current_user}}\n\u003C/span\u003E\n',place_mention_button:'\u003Ca href="#" class="button geo-insert-place-button"\n  title="{{_i}}Mention a place in your Tweet{{/i}}"\u003E\n  \u003Cspan\u003E\u003C/span\u003E\u003C/a\u003E\n\u003Cspan class="geo-separator"\u003E\u0026nbsp;\u003C/span\u003E\n\u003Cspan class="geo-status"\u003E{{{status_html}}}\u003C/span\u003E',follower_request_stream_controls:'\u003Cspan class="accept-all-follower-requests-button"\u003E{{_i}}Accept all{{/i}}\u003C/span\u003E\n|\n\u003Cspan class="decline-all-follower-requests-button"\u003E{{_i}}Decline all{{/i}}\u003C/span\u003E\n',logout_page:'\u003Cdiv class="main"\u003E\n\n  \u003Cform action="{{logout_action_path}}" class="signout" method="post"\u003E\n    \u003Cinput type=\'hidden\' value=\'{{form_authenticity_token}}\' name=\'authenticity_token\'/\u003E\n\n    \u003Ch2\u003E{{_i}}\u003Cstrong\u003ESign out\u003C/strong\u003E of Twitter?{{/i}}\u003C/h2\u003E\n\n    \u003Cdiv class="buttons-arrow"\u003E\u003C/div\u003E\n\n    \u003Cdiv class="buttons"\u003E\n      \u003Cdiv class="button cancel"\u003E{{_i}}Cancel{{/i}}\u003C/div\u003E\n      \u003Cdiv class="button submit"\u003E{{_i}}Sign out{{/i}}\u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/form\u003E\n\n  \u003Cdiv class="aside"\u003E\n    \u003Cp\u003E\n      {{_i}}You can always sign back in at any time.{{/i}}\n    \u003C/p\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\n\u003Cdiv class="logged-out"\u003E\n\u003Cdiv class="bottompart"\u003E\u003C/div\u003E\n\u003C/div\u003E',user_small_list_item_full_name:'\u003Cspan class="user-full-name"\u003E\n  {{name}}\n  {{#verified}}\n    \u003Cspan class="verified-icon-small"\u003E\u0026nbsp;\u003C/span\u003E\n  {{/verified}}\n  {{#protected}}\n    \u003Cspan class="protected-icon"\u003E\u0026nbsp;\u003C/span\u003E\n  {{/protected}}\n\u003C/span\u003E\n',getting_started_tweet:'\u003Cli class="tweet"\u003E\n  \u003Cspan\u003E{{_i}}Write your first Tweet!{{/i}}\u003C/span\u003E\n  \u003Cul\u003E\n    \u003Cli\u003E\u003Ca href="#" class="new-tweet"\u003E{{_i}}Tell the world what\'s happening in 140 characters or less{{/i}}\u003C/a\u003E\u003C/li\u003E\n  \u003C/ul\u003E\n\u003C/li\u003E',stream_item:'\u003Cdiv class=\'stream-item {{#item_hidden_id}}item-hidden{{/item_hidden_id}}\' data-item-id="{{item_id}}" data-item-type="{{item_type}}"  {{#item_hidden_id}}hidden-id="{{item_hidden_id}}"{{/item_hidden_id}}\u003E\n  {{{item_html}}}\n\u003C/div\u003E',place_page_users_following_title:"{{_i}}Twitter / Recent people you are following who mentioned {{{placeName}}}{{/i}}\n",phone_setup_prompt:"\u003Cdiv\u003E{{_i}}Before you can receive @{{screen_name}}'s Tweets as text messages, you need to activate your phone. Do this now?{{/i}}\u003Cdiv\u003E\n{{\u003Eprompt}}\n",language_links:'\u003Cdiv class="language inline-list"\u003E\n  \u003Cform action="{{change_locale_path}}" method="POST"\u003E\n    \u003Cinput type="hidden" name="lang" value="" /\u003E\n    \u003Cstrong\u003E{{_i}}Languages{{/i}}\u003C/strong\u003E\n    {{#languages}}\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      {{#current}}\n        \u003Cem class="current"\u003E{{name}}\u003C/em\u003E\n      {{/current}}\n      {{^current}}\n        \u003Ca href="?lang={{code}}" hreflang="{{code}}"\u003E{{name_own}}\u003C/a\u003E\n      {{/current}}\n    {{/languages}}\n  \u003C/form\u003E\n\u003C/div\u003E',default_dropdown_item:'\u003Cli class="{{class}}" {{data}}\u003E\u003Cspan class="{{icon}}"\u003E\u003C/span\u003E\u003Cb class="item-name"\u003E{{{label}}}\u003C/b\u003E\u003C/li\u003E\n',details_pane:"\u003Cdiv class=\"inner-pane\"\u003E\n  \u003Cdiv class='pane-toolbar pane-built-in'\u003E\n    {{#popable}}\n      \u003Ca class='pane-back toolbar-control' href='#'\u003E\u003Cspan\u003E\u0026larr;\u003C/span\u003E {{back_label}}\u003C/a\u003E\n    {{/popable}}\n    {{#closable}}\n      \u003Ca class='pane-close toolbar-control' href='#'\u003E{{_i}}close{{/i}} \u003Cspan\u003E\u0026times;\u003C/span\u003E\u003C/a\u003E\n    {{/closable}}\n    \u003Cbr style='clear: both' /\u003E\n  \u003C/div\u003E\n  \u003Cdiv class=\"pane-components\"\u003E\n    \u003Cdiv class=\"pane-components-inner\"\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n",list_header:'\u003Cdiv class="list-info"\u003E\n  \u003Ch2 class="full-name"\u003E{{name}}\u003C/h2\u003E\n  \u003Cp class="description"\u003E{{description}}\u003C/p\u003E\n  \u003Chr/\u003E\n  \u003Cdiv class="things-below-the-hr"\u003E\n    \u003Cdiv class=\'list-creator clearfix\'\u003E\n      {{#user}}\n        \u003Cimg id=\'profile-picture\' src="{{profile_image_url}}" alt="{{name}}"/\u003E\n      {{/user}}\n      \u003Cp\u003E\n        {{#is_public}}\n          {{_i}}A \u003Cstrong\u003Epublic\u003C/strong\u003E list{{/i}}\n        {{/is_public}}\n        {{^is_public}}\n          {{_i}}A \u003Cstrong\u003Eprivate\u003C/strong\u003E list{{/i}}\n        {{/is_public}}\n        \u003Cbr /\u003E\n        {{#user}}\n          \u003Cspan\u003E{{_i}}Curated by \u003Ca href="{{profile_path}}"\u003E{{name}}\u003C/span\u003E\u003C/a\u003E{{/i}}\n        {{/user}}\n      \u003C/p\u003E\n    \u003C/div\u003E\n    \u003Cdiv class="list-actions-component"\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n\u003C!-- todo: put the list actions here with display:none rather than appending them in js ( twttr.components.pages.List.renderListInfo() ) --\u003E',newest_list_members:'\u003Cdiv class="newest-list-members"\u003E\n  \u003Ch2\u003E{{_i}}Recently Following{{/i}}\u003C/h2\u003E\n  {{#list}}\n    \u003Ch3 class="recently-followed"\u003E\n      {{_i}}This list\'s most recently followed accounts{{/i}}\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      \u003Ca href="{{list_members_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n    \u003C/h3\u003E\n  {{/list}}\n  \u003Cul class=\'list-members clearfix\'\u003E\n    {{#members}}\n      {{\u003Euser_small_list}}\n    {{/members}}\n  \u003C/ul\u003E\n\u003C/div\u003E',geo_confirm_place_creation:'\u003Cdiv\u003E{{_i}}Add this place{{/i}}\u003C/div\u003E\n\u003Cdiv class="geo-confirm-place-creation"\u003E\n  \u003Cdiv class="geo-map-canvas" /\u003E\n  \u003Ctable class="geo-creation-actions" cellspacing="0" cellpadding="0"\u003E\u003Ctr\u003E\n    \u003Ctd class="geo-place-creation-col1"\u003E{{_i}}Name{{/i}}\u003C/td\u003E\n    \u003Ctd\u003E\n      \u003Cinput class="geo-place-creation-name" type="text"\n        title="{{_i}}Type the name of a place{{/i}}"/\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd class="geo-place-creation-col1 geo-place-creation-row2"\u003E{{_i}}Address{{/i}}\u003C/td\u003E\n    \u003Ctd class="geo-place-creation-row2"\u003E\n      \u003Cinput class="geo-place-creation-address help-focusable" type="text"\n        title="{{_i}}Optional{{/i}}"/\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd\u003E\u003C/td\u003E\n    \u003Ctd\u003E\n      \u003Cdiv class="geo-place-creation-hint"\u003E{{_i}}"795 Folsom St" or "24th St and Noe"{{/i}}\u003C/div\u003E\n      \u003Cdiv class="geo-place-creation-city"\u003E{{city_name}}\u003C/div\u003E\n      \u003Cbutton type="button" class="btn btn-default geo-submit"\u003E{{_i}}Add this place{{/i}}\u003C/button\u003E\n      \u003Ca href="#" class="geo-go-back"\u003E{{_i}}Back{{/i}}\u003C/a\u003E\n      \u003Cspan class="geo-progress"\u003E\u0026nbsp;\u003C/span\u003E\n      \u003Cdiv class="geo-place-creation-error"\u003E\u003C/div\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003C/table\u003E\n\u003C/div\u003E\n',contact_import_services_icon_list:'\u003Cdiv class="service-links"\u003E\n  {{#services}}\n    \u003Ca class="service-button service-link {{#matched}}selected{{/matched}}" href="#"\n        data-url="{{url}}" data-popup="{{popup}}" data-name="{{name}}" title="{{name}}"\u003E\n      {{\u003Econtact_import_service_icon}}\n    \u003C/a\u003E\n  {{/services}}\n\u003C/div\u003E',add_to_list_dialog:"\u003Cdiv class='add-to-list-prompt'\u003E{{_i}}Include @{{screen_name}} in:{{/i}}\u003C/div\u003E\n\u003Cul class='list-membership-container'\u003E\u003C/ul\u003E",dashboard_user:"\u003Cdiv class='home-dashboard dashboard'\u003E\n  {{\u003Euser_stats}}\n  \u003Chr class=\"user-rec-component\"/\u003E\n  {{\u003Ewho_to_follow}}\n  \u003Cdiv class='definition'\u003E\n    \u003Cp id=\"promo\"\u003E\u003C/p\u003E\n  \u003C/div\u003E\n\u003C/div\u003E",tweet_feedback:'\u003Cdiv class="stream-item-feedback" style="display: none;"\u003E\n  \u003Cform class="feedback-options"\u003E\n    \u003Ca href="#" class="cancel-feedback"\u003E\u003Ci\u003E\u003C/i\u003E {{_i}}Cancel{{/i}}\u003C/a\u003E\n    \u003Cp\u003E\u003Cstrong\u003E{{_i}}Please tell us why:{{/i}}\u003C/strong\u003E\u003C/p\u003E\n    \u003Cp\u003E\n        \u003Ca href="#" class="btn feedback-uninteresting"\u003E{{_i}}Uninteresting{{/i}}\u003C/a\u003E\n        \u003Ca href="#" class="btn feedback-repetitive"\u003E{{_i}}Repetitive{{/i}}\u003C/a\u003E\n        \u003Ca href="#" class="btn feedback-spam"\u003E{{_i}}Spam{{/i}}\u003C/a\u003E\n    \u003C/p\u003E\n  \u003C/form\u003E\n  \u003Cdiv class="feedback-confirmation" style="display: none;"\u003E\n    \u003Ca href="#" class="close-feedback"\u003E\u003Ci\u003E\u003C/i\u003E {{_i}}Close{{/i}}\u003C/a\u003E\n    \u003Cp\u003E\n      \u003Cstrong\u003E{{_i}}Great, got it!{{/i}}\u003C/strong\u003E\u003Cbr /\u003E\n      {{_i}}Thanks for your feedback. We\'ll use it to improve the Promoted Tweets experience for you and other Twitter users.{{/i}}\n    \u003C/p\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n',tweet_contributor:'{{#contributor}}\n  \u003Cspan class="tweet-contributors"\u003E{{_i}}by \u003Ca href="{{profile_path}}" class="user-profile-link" data-screen-name="{{screen_name}}"\u003E{{screen_name}}\u003C/a\u003E{{/i}}\u003C/span\u003E\n{{/contributor}}',follow_list:"\u003Ch3\u003E{{header}}\u003C/h3\u003E\n{{#follow_list}}\n  {{{follow_list}}}\n{{/follow_list}}",list_dialog:'{{%TRANSLATION-HINT mode=lists}}\n\u003Cdiv class="list-editor"\u003E\n  \u003Cdiv class="field"\u003E\n    \u003Clabel for="list-name"\u003E{{_i}}List name{{/i}}\u003C/label\u003E\n    \u003Cinput type="text" class="text" name="name" value="{{name}}" /\u003E\n  \u003C/div\u003E\n  \u003Cdiv class="field" style="display:none"\u003E\n    \u003Clabel for="list-link"\u003E{{_i}}List link{{/i}}\u003C/label\u003E\n    \u003Cspan\u003E{{full_name}}\u003C/span\u003E\n  \u003C/div\u003E\n  \u003Chr/\u003E\n\n  \u003Cdiv class="field"\u003E\n    \u003Clabel for="description"\u003E{{_i}}Description{{/i}}\u003C/label\u003E\n    \u003Ctextarea name="description"\u003E{{description}}\u003C/textarea\u003E\n    \u003Cspan class="help-text"\u003E{{_i}}Under 100 characters, optional{{/i}}\u003C/span\u003E\n  \u003C/div\u003E\n  \u003Chr/\u003E\n\n  \u003Cdiv class="field"\u003E\n    \u003Clabel for="mode"\u003E{{_i}}Privacy{{/i}}\u003C/label\u003E\n    \u003Cdiv class="options"\u003E\n      \u003Clabel for="list-public-radio"\u003E\n        \u003Cinput class="radio" type="radio" name="mode" id="list-public-radio" value="public" {{#is_public}}checked="checked"{{/is_public}} /\u003E\n        \u003Cb\u003E{{_i}}Public{{/i}}\u003C/b\u003E \u0026middot; {{_i}}Anyone can follow this list{{/i}}\n      \u003C/label\u003E\n      \u003Clabel for="list-private-radio"\u003E\n        \u003Cinput class="radio" type="radio" name="mode" id="list-private-radio" value="private" {{^is_public}}checked="checked"{{/is_public}} /\u003E\n        \u003Cb\u003E{{_i}}Private{{/i}}\u003C/b\u003E \u0026middot; {{_i}}Only you can access this list{{/i}}\n      \u003C/label\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n  \u003Chr/\u003E\n\n  \u003Cdiv class="save"\u003E\n    \u003Cdiv class="button update-list-button" data-list-id="{{id}}"\u003E{{_i}}Save list{{/i}}\u003C/div\u003E\n  \u003C/div\u003E\n\n\u003C/div\u003E',user_small_list_item:'\u003Cli class="user-small-list-item {{#promoted_content}}promoted-account{{/promoted_content}}" data-user-id="{{id}}" {{{feedback_token}}} {{{account_impression_id}}}\u003E\n  \u003Ca href="{{profile_path}}" class="user-profile-link user-thumb" data-user-id="{{id}}"\u003E\u003Cimg src=\'{{profile_image_url}}\' alt="{{screen_name}}" /\u003E\u003C/a\u003E\n  {{#dismissable}}\n    \u003Ca class="dismiss" href="#" title="{{_i}}Hide{{/i}}"\u003E\u0026times;\u003C/a\u003E\n  {{/dismissable}}\n  \u003Cdiv class="user-name-info"\u003E\n    \u003Ca class="user-profile-link user-screen-name" href=\'{{profile_path}}\' data-user-id="{{id}}"\u003E{{screen_name}}\u003C/a\u003E\n    {{#is_narrow}}\n      \u003Cspan class="user-name-and-actions"\u003E\n        {{\u003Euser_small_list_item_full_name}}\n        {{\u003Euser_item_action}}\n      \u003C/span\u003E\n      \u003Cdiv class=\'user-meta\'\u003E\n        {{#is_sponsored}}\n          {{\u003Euser_small_list_item_sponsored}}\n        {{/is_sponsored}}\n        {{^is_sponsored}}\n          {{#socialcontext}}\n            {{{socialcontext}}}\n          {{/socialcontext}}\n          {{^socialcontext}}\n            \u003Cdiv class=\'bio\'\u003E{{{description}}}\u003C/div\u003E\n          {{/socialcontext}}\n        {{/is_sponsored}}\n      \u003C/div\u003E\n    {{/is_narrow}}\n    {{^is_narrow}}\n      {{\u003Euser_item_action}}\n      \u003Cdiv class="user-full-name-and-label"\u003E\n        {{\u003Euser_small_list_item_full_name}}\n        {{#is_sponsored}}\n          {{\u003Euser_small_list_item_sponsored}}\n        {{/is_sponsored}}\n      \u003C/div\u003E\n    {{/is_narrow}}\n  \u003C/div\u003E\n\u003C/li\u003E\n',tweet_dogear:'\u003Cdiv class="tweet-dogear {{dogear_css_classes}}"\u003E\u003C/div\u003E',thumbnail:'\u003Ca href="{{url}}" data-url="{{url}}" class="media-thumbnail" style="width:{{width}}px; height:{{height}}px; line-height:{{lineHeight}}px;"\u003E\n  \u003Cdiv class=\'thumbnail-wrapper\' data-url="{{url}}"\u003E\n  \u003C/div\u003E\n\u003C/a\u003E',dashboard_user_recommendations:'\u003Cdiv class="user-rec-inner {{#screen_name}}user-rec-inner-similarities{{#self_sims}}-self{{/self_sims}}{{/screen_name}}"\u003E\n  {{^screen_name}}\n    {{#is_narrow}}\n      \u003Ch2 class="user-rec-component"\u003E\n        \u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Who to follow{{/i}}\u003C/span\u003E\n        \u003Cspan class="dashboard-component-subtitle"\u003E\n          \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n          \u003Ca href="#" class="refresh-suggestions"\u003E{{_i}}refresh{{/i}}\u003C/a\u003E\n          \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n          \u003Ca href="{{who_to_follow_suggestions_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n        \u003C/span\u003E\n      \u003C/h2\u003E\n    {{/is_narrow}}\n    {{^is_narrow}}\n      \u003Ch2 class="user-rec-component"\u003E\u003Ca class="title-link" href="{{who_to_follow_suggestions_path}}"\u003E\u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Who to follow{{/i}}\u003C/span\u003E\u003C/a\u003E\u003C/h2\u003E\n      \u003Ch3\u003E{{_i}}Suggestions for you{{/i}}\n        \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n        \u003Ca href="{{who_to_follow_suggestions_path}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n      \u003C/h3\u003E\n    {{/is_narrow}}\n  {{/screen_name}}\n  {{#screen_name}}\n    \u003Ch2 class="user-rec-component"\u003E\n      {{^is_narrow}}\n        \u003Ca class="title-link" href="{{similar_to_link}}"\u003E\n      {{/is_narrow}}\n      {{#self_sims}}\n        {{_i}}Similar to you{{/i}}\n      {{/self_sims}}\n      {{^self_sims}}\n        {{_i}}Similar to @{{screen_name}}{{/i}}\n      {{/self_sims}}\n      {{^is_narrow}}\n        \u003C/a\u003E\n      {{/is_narrow}}\n      \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n      \u003Ca class="view-all" href="{{similar_to_link}}"\u003E{{_i}}view all{{/i}}\u003C/a\u003E\n    \u003C/h2\u003E\n  {{/screen_name}}\n  \u003Cul class=\'recommended-followers user-rec-component\'\u003E\n    {{#recommended_followers}}\n      {{\u003Euser_small_list}}\n    {{/recommended_followers}}\n  \u003C/ul\u003E\n  {{^screen_name}}\n    {{^is_narrow}}\n      \u003Cdiv class="user-rec-links"\u003E\u003Ca href="#" class="refresh-suggestions"\u003E{{_i}}Refresh suggestions{{/i}}\u003C/a\u003E\u003Cbr /\u003E\n        \u003Ca href="{{who_to_follow_interests_path}}"\u003E{{_i}}Browse interests{{/i}}\u003C/a\u003E\n        \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n        \u003Ca href="{{who_to_follow_import_path}}"\u003E{{_i}}Find friends{{/i}}\u003C/a\u003E\n      \u003C/div\u003E\n    {{/is_narrow}}\n  {{/screen_name}}\n\u003C/div\u003E',place_tweets:'\u003Cdiv class="related-tweets"\u003E\n  \u003Ch3\u003E{{_i}}Tweets about {{place_name}}{{/i}}\u003C/h3\u003E\n  {{#tweets}}\n    {{\u003Esimple_tweet}}\n  {{/tweets}}\n  {{#place_path}}\n  \u003Ca class="place-tweets-footer-link more-link" href="{{place_path}}"\u003E\n    {{_i}}View all Tweets about this place \u0026rarr;{{/i}}\n  {{/place_path}}\n  \u003C/a\u003E\n\u003C/div\u003E\n',dashboard_social_context:'{{%TRANSLATION-HINT mode=social_context}}\n\u003Cdiv class="social-context"\u003E\n  {{#is_narrow}}\n    \u003Ch2\u003E{{_i}}You and @{{screen_name}}{{/i}}\u003C/h2\u003E\n    {{#accounts_in_common}}\n      \u003Cdiv class="you-both-follow clearfix"\u003E\n        {{\u003Edashboard_social_context_subcomponent}}\n      \u003C/div\u003E\n    {{/accounts_in_common}}\n  {{/is_narrow}}\n  {{^is_narrow}}\n    \u003Ch2\u003E{{_i}}Connections{{/i}}\u003C/h2\u003E\n    {{#followers_you_follow}}\n      \u003Cdiv class="followers-you-follow clearfix"\u003E\n        {{\u003Edashboard_social_context_subcomponent}}\n      \u003C/div\u003E\n    {{/followers_you_follow}}\n    {{#you_both_follow}}\n      \u003Cdiv class="you-both-follow clearfix"\u003E\n        {{\u003Edashboard_social_context_subcomponent}}\n      \u003C/div\u003E\n    {{/you_both_follow}}\n  {{/is_narrow}}\n\u003C/div\u003E\n',message_thread_preview:"\u003Cdiv class='message-thread-preview stream-item-content' data-screen-name=\"{{#other_person}}{{screen_name}}{{/other_person}}\"\u003E\n  \u003Cdiv class=\"more\"\u003E{{_i}}\u00bb{{/i}}\u003C/div\u003E\n  \u003Cdiv class='message-inner'\u003E\n    {{#other_person}}\n    \u003Cimg src='{{profile_image_url}}' alt='{{name}}' class='thumb' data-user-id='{{id}}'/\u003E\n    \u003Cspan class='user-name'\u003E\u003Cstrong\u003E{{screen_name}}\u003C/strong\u003E \u003Cb class='full-name'\u003E{{name}}\u003C/b\u003E\u003C/span\u003E\n    {{/other_person}}\n    \u003Cdiv class='message-content'\u003E\n      {{#last_message}}\n        \u003Cspan class='created-at'\u003E\u003Cspan class=\"_timestamp\" data-time=\"{{actual_timestamp}}\" data-long-form=\"true\" data-include-sec=\"true\"\u003E{{timestamp}}\u003C/span\u003E\u003C/span\u003E\n      {{/last_message}}\n      \u003Cdiv class=\"message-count\"\u003E{{message_count}}\u003C/div\u003E\n    \u003C/div\u003E\n  \u003C/div\u003E\n\u003C/div\u003E\n",malware_error_message:'{{_i}}Oops! A URL in your tweet appears to link to a page that has spammy or unsafe content.{{/i}}\n\u003Ca href="{{malware_learn_more_path}}" target="_blank" class="malware-learn-more-link"\u003E{{_i}}Learn more{{/i}}\u003C/a\u003E\n',geo_ie_google_toolbar_banner:'\u003Cdiv id="geo_browser_help_banner" class="geo_ie_gtb"\u003E\n  \u003Cdiv\u003E{{_i}}Before Twitter can get your location...{{/i}}\u003C/div\u003E\n  \u003Cdiv\u003E\u003Cimg src="/images/geo_browser_help_banner_1.png" /\u003E{{_i}}Check "Remember for this site"{{/i}}\u003C/div\u003E\n  \u003Cdiv\u003E\u003Cimg src="/images/geo_browser_help_banner_2.png" /\u003E{{_i}}Click "Share my location"{{/i}}\u003C/div\u003E\n\u003C/div\u003E\n',search_home:'\u003Cdiv class="main"\u003E\n\n  {{#is_advanced}}\n    {{\u003Esearch_advanced}}\n  {{/is_advanced}}\n  {{^is_advanced}}\n    {{\u003Esearch_basic}}\n  {{/is_advanced}}\n\n  \u003Cdiv class="logged-out"\u003E\n    \u003Cdiv class="bottompart"\u003E\u003C/div\u003E\n  \u003C/div\u003E\n\n\u003C/div\u003E',user_detailed_list:"{{#items}}\n  {{\u003Euser_detailed_list_item}}\n{{/items}}",stream_user_buttons:'{{%TRANSLATION-HINT mode=actions}}\n\u003Cdiv class="stream-user-buttons"\u003E\n  {{^is_current_user}}\n    {{^following}}\n      {{#follow_request_sent}}\n        \u003Cdiv class="pending-request"\u003E\n          \u003Cspan\u003E{{_i}}pending{{/i}}\u003C/span\u003E\n          \u003Ca href="#"\u003E{{_i}}(cancel){{/i}}\u003C/a\u003E\n        \u003C/div\u003E\n      {{/follow_request_sent}}\n      {{^follow_request_sent}}\n        \u003Cdiv class="button follow-button" data-user-id="{{id}}"\u003E\u003Cspan class="plus"\u003E\u003C/span\u003E\u0026#32;\u003Cb\u003E{{_i}}Follow{{/i}}\u003C/b\u003E\u003C/div\u003E\n      {{/follow_request_sent}}\n    {{/following}}\n    {{#following}}\n      \u003Cdiv class="button unfollow-button" data-user-id="{{id}}"\u003E\n        \u003Cspan class="you-follow" /\u003E\n        \u003Cem class="wrapper"\u003E\n          \u003Cb\u003E{{_i}}Following{{/i}}\u003C/b\u003E\n          \u003Cb class="unfollow"\u003E{{_i}}Unfollow{{/i}}\u003C/b\u003E\n        \u003C/em\u003E\n      \u003C/div\u003E\n    {{/following}}\n  {{/is_current_user}}\n\n  {{#logged_in}}\n    {{^is_narrow}}\n      \u003Cdiv class="button list-action-button" data-user-id="{{id}}"\u003E\n        \u003Cspan class="list"\u003E\u003C/span\u003E\n        \u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n      \u003C/div\u003E\n    {{/is_narrow}}\n    {{#is_narrow}}\n      {{^is_current_user}}\n        \u003Cdiv class="button user-profile-actions-button" data-user-id="{{id}}"\u003E\n          \u003Cspan class="user-actions"\u003E\u003C/span\u003E\u003Cspan class="down-arrow"\u003E\u003C/span\u003E\n        \u003C/div\u003E\n      {{/is_current_user}}\n    {{/is_narrow}}\n    {{#dismissable}}\n      \u003Cdiv class="dismiss"\u003E\n        \u003Ca class="dismiss" href="#" title="{{_i}}Hide this suggestion{{/i}}"\u003E\u0026times; {{_i}}Hide{{/i}}\u003C/a\u003E\n      \u003C/div\u003E\n    {{/dismissable}}\n  {{/logged_in}}\n\u003C/div\u003E\n',details_pane_tweet:'\u003Cdiv class="tweet details-pane-tweet {{css_classes}}" data-tweet-id="{{id}}" {{{tweet_impression_id}}} {{#current_user_retweet}}data-my-retweet-id="{{id}}"{{/current_user_retweet}}  data-screen-name="{{#user}}{{screen_name}}{{/user}}"\u003E\n  {{\u003Etweet_dogear}}\n  \u003Cdiv class="tweet-row"\u003E\n    {{#user}}\n      {{\u003Etweet_user_block}}\n    {{/user}}\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-row"\u003E\n    {{\u003Etweet_text_large}}\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-media-container"\u003E\u003C/div\u003E\n  \u003Cdiv class="tweet-row"\u003E\n    {{\u003Etweet_timestamp}}\n    {{\u003Etweet_contributor}}\n    {{\u003Etweet_source}}\n    {{\u003Etweet_actions}}\n  \u003C/div\u003E\n  \u003Cdiv class="tweet-row"\u003E\n    {{\u003Etweet_geo_text}}\n  \u003C/div\u003E\n\u003C/div\u003E\n',conversation_last_ancestor_tweet:'\u003Cdiv class="conversation-last-ancestor-tweet"\u003E\n  {{\u003Esimple_tweet}}\n\u003C/div\u003E',phoenix_media_container:"\u003Cdiv class='media-instance-container' data-url-id='{{url}}' data-media-type='{{media_type}}'\u003E\u003C/div\u003E",geo_place_search:'\u003Cform id="place_search_form"\u003E\n  \u003Ctable class="geo_place_search_table"\u003E\u003Ctr\u003E\n    \u003Ctd class="geo_place_search_col1 geo_place_search_city"\u003E{{_i}}Near{{/i}}\u003C/td\u003E\n    \u003Ctd class="geo_place_search_city"\u003E{{city}}\u0026#32;\u0026nbsp;\u003Ca href="#" id="change_city"\u003E{{_i}}Change{{/i}}\u003C/a\u003E\u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd class="geo_place_search_col1 geo_place_search_place"\u003E{{_i}}Place Name{{/i}}\u003C/td\u003E\n    \u003Ctd class="geo_place_search_place"\u003E\n      \u003Cinput id="place_search_query"\n             type="text"\n             autocomplete="off"\n             class="round-left help-focusable"\n             {{#are_poi_allowed}}\n               title="{{_i}}Type the name of a place{{/i}}"\n             {{/are_poi_allowed}}\n             {{^are_poi_allowed}}\n               title="{{_i}}Type the name of a neighborhood or city{{/i}}"\n             {{#are_poi_allowed}}\n             /\u003E\u003Cspan class="place_search_submit round-right" title="{{_i}}Search{{/i}}"\u003E\u0026nbsp;\u003C/span\u003E\n      \u003Cul class="round places_list place_search_dropdown"\u003E\u003C/ul\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd\u003E\u003C/td\u003E\n    \u003Ctd class="geo_place_search_hint"\u003E{{_i}}Leave blank to just select nearby city{{/i}}\u003C/td\u003E\n  \u003C/tr\u003E\u003Ctr\u003E\n    \u003Ctd\u003E\u003C/td\u003E\n    \u003Ctd\u003E\n       \u003Cdiv id="place_search_results"\u003E\u003C/div\u003E\n       \u003Cbutton type="button" class="btn btn-default" id="place_search_done"\u003E{{_i}}Done{{/i}}\u003C/button\u003E\n       \u003Cbutton type="button" class="btn" id="place_search_cancel" style="display:none"\u003E{{_i}}Cancel{{/i}}\u003C/button\u003E\n    \u003C/td\u003E\n  \u003C/tr\u003E\u003C/table\u003E\n\u003C/form\u003E\n',dashboard_your_profile:'\u003Cdiv class="tweet-activity"\u003E\n\u003Cdiv class="follower-request"\u003E\u003C/div\u003E\n\u003Ch2\u003E\u003Ca href="{{profile_path}}" class="title-link"\u003E\u003Cspan class=\'dashboard-component-title\'\u003E{{_i}}Your Tweets{{/i}}\u003C/span\u003E\u003Cspan class="tweet-count user-stat-link"\u003E{{statuses_count_commaized}}\u003C/span\u003E\u003C/a\u003E\u003C/h2\u003E\n{{#status}}\n  {{\u003Elatest_tweet}}\n{{/status}}\n\u003C/div\u003E',people_results:"\u003Ch2\u003E{{_i}}People results for\u0026nbsp;\u003Cstrong\u003E{{query}}\u003C/strong\u003E{{/i}}\u003C/h2\u003E\n\u003Cul class='people-results clearfix'\u003E\n  {{#found_people}}\n    {{\u003Euser_small_list}}\n  {{/found_people}}\n\u003C/ul\u003E\n\u003Ca href=\"{{who_to_follow_search_path}}\" class='more-people-results'\u003E{{_i}}More people results \u0026rarr;{{/i}}\u003C/a\u003E\n",saved_search_button:'\u003Cdiv class="saved-search-container"\u003E\n  {{#show_trashcan}}\n    \u003Cdiv class="delete-search"\u003E\n      \u003Cdiv class="button delete-search-button"\u003E\n        \u003Cspan class="trashcan"\u003E\u003C/span\u003E \u003Cstrong\u003E{{_i}}Delete this saved search{{/i}}\u003C/strong\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  {{/show_trashcan}}\n  {{^show_trashcan}}\n    \u003Cdiv class="save-search"\u003E\n      \u003Cdiv class="button save-search-button"\u003E\n        \u003Cspan class="plus"\u003E\u003C/span\u003E \u003Cstrong\u003E{{_i}}Save this search{{/i}}\u003C/strong\u003E\n      \u003C/div\u003E\n    \u003C/div\u003E\n  {{/show_trashcan}}\n\u003Cdiv\u003E',who_to_follow_links:'\u003Cp class="wtf-links"\u003E\n  \u003Cspan\u003E{{_i}}Find accounts to follow:{{/i}}\u003C/span\u003E\n  \u003Ca href="{{who_to_follow_interests_path}}"\u003E{{_i}}Browse interests{{/i}}\u003C/a\u003E\n  \u003Cspan class="dot"\u003E\u0026middot;\u003C/span\u003E\n  \u003Ca href="{{who_to_follow_import_path}}"\u003E{{_i}}Find friends{{/i}}\u003C/a\u003E\n\u003C/p\u003E\n',google_analytics:"\u003Cscript type=\"text/javascript\"\u003E\n\n  var _gaq = _gaq || [];\n  _gaq.push(['_setAccount', 'UA-30775-6']);\n  _gaq.push(\n    ['_trackPageview'],\n    ['_setDomainName', 'twitter.com']\n  );\n\n  (function() {\n    var ga = document.createElement('script');\n    ga.type = 'text/javascript';\n    ga.async = true;\n    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n    var s = document.getElementsByTagName('script')[0];\n    s.parentNode.insertBefore(ga, s);\n  }());\n\n  twttr.trackPageView = function(pathName) {\n    var event = ['_trackPageview'];\n    if (pathName) {\n      event.push(pathName);\n    }\n    _gaq.push(event);\n  };\n\n\u003C/script\u003E",device_setup_dialog_duplicate:'\u003Cdiv class=\'twttr-dialog-device-setup-duplicate\'\u003E\n  \u003Cdiv class="error"\u003E\n    \u003Cp\u003E\n      {{_i}}The phone number you gave us is currently used by another Twitter account. Only one account can be used with a mobile phone at a time.{{/i}}\n    \u003C/p\u003E\n\n    {{\u003Edevice_setup_dialog_source_address}}\n  \u003C/div\u003E\n\n  \u003Cp\u003E\n    \u003Cstrong\u003E{{_i}}To fix this, you need to reset your phone\'s link to Twitter{{/i}}\u003C/strong\u003E\u003Cbr /\u003E\n    {{_i}}Send this message to Twitter:{{/i}}\n  \u003C/p\u003E\n\n  \u003Cdiv class="phone-instructions"\u003E\n    {{_i}}Text \'{{stop_command}}\' to {{address_for_sms}}{{/i}}\n  \u003C/div\u003E\n\n  \u003Cp\u003E\n    {{_i}}Once you\'ve sent the message, try to verify your phone again.{{/i}}\n  \u003C/p\u003E\n\n  \u003Cdiv class="submit button retry"\u003E{{_i}}Retry verification{{/i}}\u003C/div\u003E\n\n  \u003Cp class="cancel-instructions"\u003E\n    {{_i}}\u003Ca href="#"\u003ECancel verification\u003C/a\u003E and start over.{{/i}}\n  \u003C/p\u003E\n\u003C/div\u003E',dashboard_profile_stats:'\u003Cdiv class=\'dashboard-profile-annotations clearfix\'\u003E\n  \u003Ch2 class="dashboard-profile-title"\u003E\u003Cimg src="{{profile_image_url}}" alt="{{name}}" width="24" class="profile-dashboard"/\u003E{{profile_stats_title}}\u003C/h2\u003E\n  {{#is_translator}}\n    \u003Ca class=\'dashboard-profile-translator\' href=\'{{translator_profile_path}}\'\u003E\n      \u003Cem\u003E{{_i}}Translator{{/i}}\u003C/em\u003E\n    \u003C/a\u003E\n  {{/is_translator}}\n\u003C/div\u003E\n\n{{\u003Euser_stats}}\n'};using(">base_bundle_evaled",">phoenix_plugins_bundle_evaled",function(){twttr.provide("twttr.util",{supplant:function(){var reg=/\{([^\{\}]*)\}/g;return function(s,o){return s.replace(reg,function(a,b){var r=o[b];return twttr.is.string(r)||twttr.is.number(r)?r:a})}}(),defaulted:function(value,defaultValue){return twttr.is.def(value)?value:defaultValue},create:function(parent){function childConstructor(){}childConstructor.prototype=parent;childConstructor.constructor=childConstructor;return new childConstructor()},params:function(optQueryString){var o={};var search=optQueryString||this._getQueryStringFromWindow();if(!search){return o}if(search.charAt(0)==="?"){search=search.slice(1)}twttr.each(search.split("&"),function(pair){pair=pair.split("=");var k=pair.shift();var v=decodeURIComponent(pair.join("="));o[k]=v.replace(/\+/," ")});return o},_getQueryStringFromWindow:function(){return window.location.search},underscore:function(s){if(s.toUpperCase()===s){return s}return s.replace(/([a-zA-Z0-9])([A-Z])/g,function(m,m1,m2){return(m1+"_"+m2)}).toLowerCase()},camelize:function(s){return s.replace(/_(.)/g,function(m,m1){return m1.toUpperCase()})},camelizeObject:function(o){if(!twttr.is.object(o)){throw new Error("The carmelizeObject() method only accepts apples.")}var o2={};for(var prop in o){o2[twttr.util.camelize(prop)]=o[prop]}return o2},capitalize:function(s){return s.charAt(0).toUpperCase()+s.substr(1)},addCommas:function(n,optDelim){optDelim=optDelim||",";return parseInt(n,10).toString().replace(/(.)(?=(.{3})+$)/g,"$1"+optDelim)},_numberFormats:{de:{grouping_separator:"."},en:{grouping_separator:","},es:{grouping_separator:"."},fr:{grouping_separator:" "},it:{grouping_separator:"."},ja:{grouping_separator:","},pt:{grouping_separator:"."},tr:{grouping_separator:"."}},formatNumber:function(n,optLocale){var d=",";if(twttr.is.def(optLocale)&&twttr.util._numberFormats[optLocale]){d=twttr.util._numberFormats[optLocale]["grouping_separator"]}return twttr.util.addCommas(n,d)},diff:function(apple,orange,comparator){var difference={};if(!twttr.is.object(apple)||!twttr.is.object(orange)){throw new Error("twttr.util.diff currently supports only single-level object comparison")}for(var key in apple){if(comparator){if(!comparator(apple[key],orange[key])){difference[key]=[apple[key],orange[key]]}}else{if(apple[key]!==orange[key]){difference[key]=[apple[key],orange[key]]}}}for(var key in orange){if(!difference[key]){if(comparator){if(!comparator(orange[key],apple[key])){difference[key]=[apple[key],orange[key]]}}else{if(apple[key]!==orange[key]){difference[key]=[apple[key],orange[key]]}}}}return difference},trim:function(str){return str.replace(/(^\s*|\s*$)/g,"")},lazyBind:(function(){var callbacks={};var makeTimer=function(){return setInterval(function(){$.each(callbacks,function(key,pending){pending.callback.call(pending.node,pending.event)});callbacks={}},1000)};var lazyBindTimer=null;var lastCallbackId=0;var nodeId=0;return function(node,event,callback){var $node=$(node);if(!callback.id){callback.id=++lastCallbackId}if(!$node.data("lazy-id")){$node.data("lazy-id",nodeId++)}$node.bind(event,function(e){callbacks[$node.data("lazy-id")+event+callback.id]={callback:callback,event:e,node:node}});if(!lazyBindTimer){lazyBindTimer=makeTimer();if(!$.browser.msie){$(window).bind("blur",function(e){if(lazyBindTimer){clearInterval(lazyBindTimer);lazyBindTimer=null}});$(window).bind("focus",function(){if(!lazyBindTimer){lazyBindTimer=makeTimer()}})}}}})(),displayLength:function(string){if(typeof string!=="string"){throw new Error("displayLength() requires a single input of type string")}var i=0,length=0;var getWholeChar=function(str,i){var code=str.charCodeAt(i);var next="",prev="";if(55296<=code&&code<=56319){if(str.length<=(i+1)){throw"High surrogate without following low surrogate"}next=str.charCodeAt(i+1);if(56320>next||next>57343){throw"High surrogate without following low surrogate"}return str.charAt(i)+str.charAt(i+1)}else{if(56320<=code&&code<=57343){if(i===0){throw"Low surrogate without preceding high surrogate"}prev=str.charCodeAt(i-1);if(55296>prev||prev>56319){throw"Low surrogate without preceding high surrogate"}return false}}return str.charAt(i)};for(i=0,length=0;i<string.length;i++){if(getWholeChar(string,i)===false){continue}length++}return length},objKeys:function(obj){var arr=[];for(var prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){arr.push(prop)}}return arr},arrayMap:function(ar,fn){var a=[];for(var i=0,j=ar.length;i<j;++i){a.push(fn.call(ar[i],ar[i],i,ar))}return a},missingTranslation:function(phrase,context){var reportedStringCache=new twttr.cache.LocalProvider("i18n");if(!reportedStringCache.get(phrase)){scribble("i18n_untranslated",twttr.merge(context,{phrase:phrase,location:twttr.Router.getCurrentPath()}));reportedStringCache.set(phrase,true)}},requestedTranslation:function(phrase,context){scribble("i18n_displayed",twttr.merge(context,{phrase:phrase,location:twttr.Router.getCurrentPath()}))},getTranslation:function(original,mode){var result=original;if(!twttr.i18n){console.log("The twttr.i18n array was not configured properly for your locale.")}else{var trans=undefined;if(mode){trans=(twttr.i18n[mode+":"+original]||twttr.i18n[original])}else{trans=twttr.i18n[original]}if(trans){result=trans}else{if(twttr.decider.isAvailable("i18n_collect_untranslated")){twttr.util.missingTranslation(original,{mode:mode})}}if(twttr.decider.isAvailable("i18n_collect_viewed")){twttr.util.requestedTranslation(original,{mode:mode})}}return result},linkifyEntities:function(text,tweet){if(tweet.entities&&tweet.entities.urls){twttr.each(tweet.entities.urls,function(url){if(url.display_url){text=text.replace(new RegExp(">"+url.url+"<\\/a>"),">"+url.display_url+"</a>")}if(url.expanded_url){text=text.replace(new RegExp("(href=[\"']"+url.url+"[\"'])"),'$1 data-expanded-url="'+h(url.expanded_url)+'" title="'+h(url.expanded_url)+'"')}})}return text},inspect:function($target){console.clear();var $el=$($target);var o=$el.data("events");var len=0;var totalevents=0;var keys=[];var s=[];for(key in o){keys.push(key);len++;s.push("\n*******************\n");s.push("Events for "+key+"\n\n");for(fn in o[key]){var f=o[key][fn];totalevents++;s.push(f.toSource()+"\n")}}console.log("************* Summary *************");console.log("for target",$el);console.log(len+" types of events",keys);console.log(totalevents,"Total Event Listeners");console.log("Event listeners assigned to target");console.log(s.join(" "))},regexSupplant:function(regex,flags){flags=flags||"";if(typeof regex!=="string"){if(regex.global&&flags.indexOf("g")<0){flags+="g"}if(regex.ignoreCase&&flags.indexOf("i")<0){flags+="i"}if(regex.multiline&&flags.indexOf("m")<0){flags+="m"}regex=regex.source}return new RegExp(regex.replace(/#\{(\w+)\}/g,function(match,name){var newRegex=twttr.regexps[name]||"";if(typeof newRegex!=="string"){newRegex=newRegex.source}return newRegex}),flags)},leven:function(s1,s2){var si,c;var n=s1.length;var m=s2.length;if(!n){return m}if(!m){return n}var mx=[];for(var i=0;i<=n;i++){mx[i]=[];mx[i][0]=i}for(var j=0;j<=m;j++){mx[0][j]=j}for(var i=1;i<=n;i++){si=s1.charAt(i-1);for(var j=1;j<=m;j++){mx[i][j]=Math.min(mx[i-1][j]+1,mx[i][j-1]+1,mx[i-1][j-1]+(si==s2.charAt(j-1)?0:1))}}return mx[n][m]}});twttr.klass("twttr.util.Location",function(url){if(url.match(/^\/\//)){url="http:"+url}else{if(!url.match(/^[a-z]+:\/\//)){url="http://"+url}}var m=url.match(/^([a-z]+:)\/\/([\w\-\.]+)(\:\d+)?(.+)?/);this.href=url;this.protocol=m[1];this.hostname=m[2];this.host=m[2]+(m[3]||"");this.port=m[3]?m[3].slice(1):m[1]==="https:"?"443":"80";var ext=m[2].match(/\.(\w+)$/);if(ext){this.extension=ext[1]}else{this.ext=""}if(!m[4]){this.hash="";this.search="";this.pathname="/"}else{if(!m[4].match(/^\//)){m[4]="/"+m[4]}var query=m[4].split("?");var hash=m[4].split("#");this.pathname=query[0];if(!((/\/$/).test(this.pathname))){this.pathname=this.pathname+"/"}this.search=query.length>1?"?"+(function(){query.shift();return query.join("").replace(/#.+$/,"")}()):"";this.hash=hash.length>1?"#"+hash[1]:""}}).methods({query:function(key){if(!this.search){return""}return twttr.util.params(this.search)[key]||""}});twttr.klass("twttr.util.WaitQueue",function(){this._methods=[];this._response=null;this._flushed=false}).methods({add:function(fn){if(this._flushed){fn(this._response)}else{this._methods.push(fn)}},flush:function(resp){if(this._flushed){return }this._response=resp;this._flushed=true;while(this._methods[0]){this._methods.shift()(resp)}}});twttr.constants={sessionPollInterval:10000,defaultScribeCategory:"webclient",scribeHostName:"scribe.twitter.com",maxUrlLength:2083,tcoLength:19,japaneseAdUrl:"//pages.quantumads.com/transformer/async.js?callback=twttr.components.JapaneseAd.callbacks.",keyCodes:{enter:13,escape:27,esc:27,tab:9,spacebar:32,upArrow:38,downArrow:40,leftArrow:37,rightArrow:39},which:{period:46},charCodes:{space:32,questionMark:63},placeTypes:{city:7},emailStatus:{GRAND_FATHERED:0,EXCUSED:1,UNCONFIRMED:2,CONFIRMED:3},promotedContent:{linkType:{URL:1,PROFILE_PIC:2,SCREEN_NAME:3,HASHTAG:4,USER_NAME:5,DISPLAYED:27,DETAIL:28,DISMISS_WITHOUT_REASON:31,DISMISS_UNINTERESTING:32,DISMISS_REPETITIVE:33,DISMISS_SPAM:34,DISMISS_OTHER:35}},videos:{widescreen:"16:9",fullscreen:"4:3"},jQueryEvents:("blur hover focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error").split(" "),errorCodes:{notFollowing:"notfollowing",duplicateTweet:"duplicatetweet",malwareTweet:"malwareTweet",overDailyLimitTweet:"overDailyLimitTweet",tooLongTweet:"tooLongTweet",whale:"whale"},regexps:{username:/^[@]?([a-zA-Z0-9_]{1,20})$/,usernameWithAt:/^[@]{1}([a-zA-Z0-9_]{1,20}) /,usernameWithSpace:/^[@]{1}(\w{1,20})\s*$/,suggestionCategoryPath:/\/(who_to_follow|welcome)\/interests\/([^\/]+)/,userSearchPath:/(\/(who_to_follow|welcome)\/search\/|\/search\/users\/)([^\/]+)/,email:/\w[^\s]*?\@\w[-\w\.]*\.[a-z]{2,4}/i},noob:{dismissed:-2,notNoob:-1,total:0,invited:1,friendless:2,silent:3,talking:4,popular:5,lonely:6,struggling:7},imageSizes:{small:"small",medium:"medium",large:"large",original:"original"}};twttr.provide("twttr.cache");twttr.provide("twttr.caches");twttr.klass("twttr.cache.Simple",function(){this._cache={}}).methods({set:function(k,v,optTtl){this._cache[k]={value:v,expire:twttr.is.number(optTtl)?this._getTime()+optTtl:null};var successfulWriteThrough=this._writeThrough();if(successfulWriteThrough===false){this.remove(k)}return v},get:function(k){this._checkExpiry(k);return this._cache[k]?this._cache[k].value:undefined},remove:function(k){delete this._cache[k];this._writeThrough()},clear:function(){this._cache={};this._writeThrough()},_checkExpiry:function(k){if(this._cache[k]&&this._cache[k].expire&&this._cache[k].expire<this._getTime()){this.remove(k)}},_getTime:function(){return(new Date()).getTime()},_writeThrough:function(){return true}});(function(){var hasLocalStorage,html5=false;try{hasLocalStorage=("localStorage" in window)&&window.localStorage!==null;html5=true}catch(ex){hasLocalStorage=false;html5=false}try{if(document.documentElement.addBehavior){html5=false;hasLocalStorage=true;var dataStore=document.documentElement;dataStore.addBehavior("#default#userData");dataStore.load("phoenix");var xmlDoc=dataStore.xmlDocument;var xmlDocEl=xmlDoc.documentElement;function getNodeByName(name){var childNodes=xmlDocEl.childNodes,node,returnVal=null;for(var i=0,len=childNodes.length;i<len;i++){node=childNodes.item(i);if(node.getAttribute("key")==name){returnVal=node;break}}return returnVal}function getUserData(name){var node=getNodeByName(name);var returnVal=null;if(node){returnVal=node.getAttribute("value")}return returnVal}function setUserData(name,value){var node=getNodeByName(name);if(!node){node=xmlDoc.createNode(1,"item","");node.setAttribute("key",name);node.setAttribute("value",value);xmlDocEl.appendChild(node)}else{node.setAttribute("value",value)}dataStore.save("phoenix");return value}function deleteUserData(name){var node=getNodeByName(name);if(node){xmlDocEl.removeChild(node)}dataStore.save("phoenix")}function clearUserData(){while(xmlDocEl.firstChild){xmlDocEl.removeChild(xmlDocEl.firstChild)}dataStore.save("phoenix")}}}catch(ex){hasLocalStorage=false}function html5getLocalStorage(k){return window.localStorage.getItem(k)}function html5setLocalStorage(k,v){return window.localStorage.setItem(k,v)}function html5deleteLocalStorage(k){return window.localStorage.removeItem(k)}function noop(){}var setLocalStorage=noop,getLocalStorage=noop,deleteLocalStorage=noop,clearLocalStorage=noop;if(hasLocalStorage){setLocalStorage=html5?html5setLocalStorage:setUserData;getLocalStorage=html5?html5getLocalStorage:getUserData;deleteLocalStorage=html5?html5deleteLocalStorage:deleteUserData;clearLocalStorage=html5?html5deleteLocalStorage:clearUserData}twttr.klass("twttr.cache.LocalProvider",function(ns){twttr.cache.Simple.call(this);this._namespace=ns;this._cache=JSON.parse(getLocalStorage(ns)||"{}")}).subclassOf(twttr.cache.Simple).statics({hasLocalStorage:hasLocalStorage}).methods({_writeThrough:function(){try{setLocalStorage(this._namespace,JSON.stringify(this._cache));return true}catch(ex){return false}}})}());twttr.klass("twttr.cache.local.User",function(user){this.name=user;this.cache=new twttr.cache.LocalProvider(":USER:");this.user=this.cache.get(user)||this.cache.set(user,{login:(new Date()).getTime(),store:{}});this.clean()}).methods({_getTime:function(){return(new Date()).getTime()},clean:function(){this.user.login=(new Date()).getTime();var users=0;var lastLogin=(new Date).getTime();var u=null;for(var k in this.cache._cache){users++;var user=this.cache._cache[k];var login=user.value.login;if(login<lastLogin){lastLogin=login;u=k}}if(users>3){this.cache.remove(u)}},remove:function(k){delete this.user.store[k];this.save()},get:function(k){var objectStore=this.user.store[k];if(!twttr.is.def(objectStore)){return undefined}var now=this._getTime();if(objectStore.expire&&objectStore.expire<now){return undefined}else{return objectStore.value}},set:function(k,v,optTtl){var objectToStore={value:v,expire:twttr.is.number(optTtl)?this._getTime()+optTtl:null};this.user.store[k]=objectToStore;this.save();return v},save:function(){this.cache.set(this.name,this.user)}});twttr.klass("twttr.ScribeBuffer",function(){if(twttr.ScribeBuffer.instance){throw"This is a singleton, yo"}twttr.ScribeBuffer.instance=this;this.reset()}).methods({data:"",maxLength:null,reset:function(){this.data="";var cacheBuster="q="+(+new Date).toString().slice(-4);this.url="/scribe?beacon=true&"+cacheBuster;if(window.location.hostname.match(/^(www\.|[A-Z]{2}\.|^)twitter.com$/i)){this.url=window.location.protocol+"//"+twttr.constants.scribeHostName+this.url}this.maxLength=twttr.constants.maxUrlLength-this.url.length},_isEmpty:function(){return this.data.length===0},send:function(){if(this._isEmpty()){return }(new Image()).src=this.url+this.data;this.reset()},addDataString:function(dataString){if((this.url.length+this.data.length+dataString.length)>this.maxLength){this.send()}this.data+="&"+dataString;if($.cookie("phx_scribe_now")=="1"){this.send()}}});twttr.klass("twttr.Scribbler",function(component,contextData,category,eventPrefix,options){this.expectedToHaveComponent=(arguments.length>0);this.component=component||"";this.contextData=contextData||{};this.category=category||twttr.constants.defaultScribeCategory;this.eventPrefix=eventPrefix||"";this.options=options||{}}).methods({DECIDERED_CATEGORIES:{client_event:1},spawn:function(contextualData,eventPrefixer){var context=twttr.merge({},this.contextData,(contextualData||{}));return new this.constructor(this.component,context,this.category,(eventPrefixer||this.eventPrefix),this.options)},_truncateData:function(data){var truncated={};for(var key in data){if(data.hasOwnProperty(key)&&typeof data[key]!=="object"){truncated[key]=data[key]}}truncated._truncated_for_scribe=true;return truncated},_contextData:function(){var data=twttr.merge({},this.contextData);if(this.component){for(var key in data){if(twttr.is.fn(data[key])){data[key]=data[key].call(this.component)}}}return data},_mapAPIObjectData:function(data){var mapped={};for(var key in data){if(data[key]&&data[key].array&&twttr.is.array(data[key].array)){mapped[key]=data[key].array}else{mapped[key]=data[key]}}return mapped},_encodeData:function(data){return"log%5B%5D="+encodeURIComponent(JSON.stringify(data))},_isCategoryAvailable:function(category){return !this.DECIDERED_CATEGORIES[category]||twttr.decider.isAvailable("scribe_"+category)},scribe:function(eventName,data,category,options){if(this.expectedToHaveComponent&&!this.component){return }if(!twttr.decider.isAvailable("phoenix_scribe")||!this._isCategoryAvailable(category||this.category)){return }options=options||{};data=data||{};data.page=twttr.app.currentPageName();data._category_=category||this.category;data.ts=(new Date()).getTime();if(filter=(options.filter||this.options.filter)){data._filter_=options.filter}data=twttr.merge(this._contextData(),data);if(eventName){if(twttr.is.fn(this.eventPrefix)){eventName=this.eventPrefix.call(this.component,eventName)}else{eventName=this.eventPrefix+eventName}var eventData=twttr.merge({event_name:eventName},data);var dataString=this._encodeData(this._mapAPIObjectData(eventData));if(dataString.length>twttr.ScribeBuffer.instance.maxLength){dataString=this._encodeData(this._truncateData(eventData))}twttr.ScribeBuffer.instance.addDataString(dataString)}}});(function(){twttr.ScribeBuffer.instance=new twttr.ScribeBuffer();twttr.Scribbler.global=new twttr.Scribbler();window.scribble=twttr.scribble=function(){return twttr.Scribbler.global.scribe.apply(twttr.Scribbler.global,arguments)};$(window).bind("unload",function(){var options={};if($.browser.safari||$.browser.msie){options.xhr=true;options.async=false}twttr.ScribeBuffer.instance.send()});if(!$.browser.msie){$(window).blur(function(){twttr.ScribeBuffer.instance.send()})}else{document.onfocusout=function(){twttr.ScribeBuffer.instance.send()}}}());twttr.provide("twttr.app",twttr.merge({init:function(){twttr.banners.display();this.trigger("init")},switchToPage:function(pageName){this.trigger("switchToPage");if(this.currentPageName()!==pageName){var oldPage=this.currentPage();this._currentPageName=pageName;var className=twttr.util.capitalize(twttr.util.camelize(pageName)),pageConstructor=twttr.components.pages[className];if(!pageConstructor.isAvailable()){twttr.app.switchToPage("404").notFound();return null}var firstSwitch=false,page=this.pages[pageName];if(!page){page=this.pages[pageName]=new pageConstructor();page.bind("loginRequired",function(){twttr.app.switchToPage("404").loginRequired()});page.bind("notFound",function(){twttr.app.switchToPage("404").notFound()});page.bind("suspended",function(){twttr.app.switchToPage("Suspended").suspended()});firstSwitch=true}if(oldPage){oldPage.onSwitchAway();oldPage.$node.detach();$("#page-container").empty().append(page.$node)}else{page._renderCallback=function(){$("#page-container").empty().append(page.$node)}}page.highlightGlobalNav();page.onSwitchTo();if(firstSwitch){page.onFirstSwitch();if(!page.noAutoRender){page.render()}}}else{this.currentPage().initializeProfiler()}if(twttr.util.Profiler.isEnabled()&&!this.firstPageProfiler){this.firstPageProfiler=this.currentPage().profiler;this.firstPageProfiler.profilerType=twttr.util.Profiler.types.FIRST_PAGE_LOAD;this.firstPageProfiler.bind("complete",function(e,profiler){twttr.appLoadTime=profiler.endTime;if(twttr.util.Profiler.verboseProfiling){console.log("Initial page load took %d ms",twttr.appLoadTime-twttr.appStartTime)}})}return this.currentPage()},currentPage:function(){return this.pages[this._currentPageName]},currentPageName:function(){return this._currentPageName},getPage:function(pageName){return this.pages[pageName]},isOnPage:function(name){return name===this.currentPageName()},pages:{},caches:{deletedTweets:new twttr.cache.LocalProvider("deleted_tweets")}},twttr.EventProvider));twttr.klass("twttr.Router",function(){this._routes=[];this.routeMethodsForMustache={};this.routeMethods={};this.viewedPagesCount=0;this.pageViewsPerRefresh=50;this.routingEnabled=true}).statics(twttr.EventProvider).statics({match:function(path,route){path=this.normalizePath(path);route=this.normalizePath(route);var tokens={};if(path===route){return tokens}else{if(path===""){return false}}var splitPath=path.split("/"),splitRoute=route.split("/");if(splitPath.length!==splitRoute.length){return false}for(var i=0;i<splitPath.length;i++){if(splitRoute[i].charAt(0)===":"){if(splitPath[i].match(/^\s*$/)){return false}tokens[splitRoute[i].slice(1)]=decodeURIComponent(splitPath[i])}else{if(splitPath[i]!==splitRoute[i]){return false}}}return tokens},generatePathFunction:function(routePath){var that=this;return function(params){var path=that.supplantPath(routePath,params);if(path===false&&!twttr.isTestEnv){console.error("Failed to generate a path",routePath,params)}return path}},supplantPath:function(routePath,params){var splitRoute=routePath.split("#").join("/#").split("/"),splitPath=[];for(var i=0;i<splitRoute.length;i++){var part=splitRoute[i],hasHash=false;if(part.charAt(0)==="#"){part=part.slice(1);hasHash=true}if(part.charAt(0)===":"){var tokenName=part.slice(1);if(typeof params[tokenName]==="undefined"){return false}else{part=params[tokenName];if(typeof part==="function"){part=part.call(params)}part=encodeURIComponent(part)}}if(hasHash){part="#"+part}splitPath.push(part)}return splitPath.join("/").split("/#").join("#")},sanitizeRedirectUrl:function(path){return path.replace(/javascript:/ig,"")},performRedirect:function(destinationPath){window.location=this.sanitizeRedirectUrl(destinationPath)},getCurrentPath:function(){return this.getPathFromHref(window.location.href)},getPathFromHref:function(href){var path=href.split("/").slice(2).join("/");if(path.indexOf("#")===-1){path=path+"#"}var splitPath=path.split("#");var preHash=splitPath[0];var hash=splitPath[1];if(preHash.indexOf("/")===-1){preHash=preHash+"/"}var pathName=preHash.split("/").slice(1).join("/");if(pathName.indexOf("?")>=0){pathName=pathName.slice(0,pathName.indexOf("?"))}if(hash.indexOf("?")>=0){hash=hash.slice(0,hash.indexOf("?"))}return"/"+pathName+"#"+hash},getCurrentQueryStringParams:function(){return this.getQueryStringParamsFromHref(window.location.href)},getQueryStringParamsFromHref:function(href){var bits=href.split("#"),beforeHashQueryString=bits[0].split("?")[1]||"",afterHashQueryString=(bits[1]||"").split("?")[1]||"";return twttr.merge(this.parseQueryString(beforeHashQueryString),this.parseQueryString(afterHashQueryString))},parseQueryString:function(queryString){var params=queryString.split("&"),out={};for(var i=0;i<params.length;i++){if(params[i]){var vals=params[i].split("=");out[decodeURIComponent(vals[0])]=vals[1]?decodeURIComponent(vals[1]):true}}return out},getHashUpdate:function(from,to){var normalizedFrom=this.normalizePath(from),normalizedTo=this.normalizePath(to);if(normalizedFrom===normalizedTo){return false}from=from.split("/#").join("#");to=to.split("/#").join("#");if(from.indexOf("#")===-1){from+="#"}if(to.indexOf("#")===-1){to+="#"}var splitFrom=from.split("#"),splitTo=to.split("#");if(splitFrom[0]===splitTo[0]){return"#"+splitTo[1]}if(splitFrom[1]===""&&splitTo[1]===""){return"#"+splitTo[0].slice(from.length)}return"#"+normalizedTo},normalizePath:function(path){return this.trimSlashes(path.replace(/\/?#(!|%21)?\/?/g,"/"))},shouldRedirect:function(currentPath,destinationPath){var destinationSplit=destinationPath.split("#"),currentSplit=currentPath.split("#");if(this.trimSlashes(destinationSplit[0])===this.trimSlashes(currentSplit[0])){return false}if(this.trimSlashes(destinationSplit[1])===this.trimSlashes(currentSplit[0])){return false}return true},trimSlashes:function(str){if(!str){return str}return str.replace(/^\/*/,"").replace(/\/*$/,"")},detectHistorySupport:function(){return !!(window.history&&history.pushState)}}).methods(twttr.EventProvider).methods({startRouting:function(){this._callCurrentRoutingAction();this._listenToUrl()},route:function(name,path,fn){this._addRouteMethods(name,path);this._routes.push({name:name,path:path,fn:fn})},staticRoute:function(name,url){var that=this;this.route(name,url,function(){that.constructor.performRedirect(url)})},redirectRoute:function(name,path,redirect){var that=this;this.route(name,path,function(params,query){that.routeTo(that.routeMethods[redirect](params,query))})},routeTo:function(destinationPath){if(!this.routingEnabled){return }if(this.pageViewsPerRefresh<=this.viewedPagesCount){return this.constructor.performRedirect(destinationPath)}this.viewedPagesCount++;if(!this._useHistory()&&this.constructor.shouldRedirect(this.constructor.getCurrentPath(),destinationPath)){return this.constructor.performRedirect(destinationPath)}this._changeUrlAndCallAction(destinationPath)},shouldRedirectTo:function(destinationPath){if(this._useHistory()){return false}return this.constructor.shouldRedirect(this.constructor.getCurrentPath(),destinationPath)},findMatchingRoute:function(path){for(var i=0;i<this._routes.length;i++){var match=this.constructor.match(path,this._routes[i].path);if(match){return{name:this._routes[i].name,fn:this._routes[i].fn,args:match}}}return false},getCurrentRoute:function(){return this.findMatchingRoute(this.constructor.getCurrentPath())},_changeUrlAndCallAction:function(destinationPath){if(!this.routingEnabled){return }var actionCalled=false,urlChanged=false,route=this.findMatchingRoute(destinationPath);if(this._useHistory()){window.history.pushState(null,null,destinationPath);urlChanged=true}var hashUpdate=this.constructor.getHashUpdate(this.constructor.getCurrentPath(),destinationPath);if(hashUpdate){window.location.hash=hashUpdate;actionCalled=true;urlChanged=true}if(!actionCalled){this._callRoutingActionFor(route)}this.trigger("routed",[route,destinationPath]);if(urlChanged){this.trigger("urlChanged",[route])}},_callRoutingActionForPath:function(path){var route=this.findMatchingRoute(path);if(route){this.trigger("routeFollowed",[route,path])}return this._callRoutingActionFor(route)},_callCurrentRoutingAction:function(){return this._callRoutingActionForPath(this.constructor.getCurrentPath())},_callRoutingActionFor:function(route){if(!this.routingEnabled){return }if(!route){this.trigger("routeNotFound");return }return route.fn.call(null,route.args,this.constructor.getCurrentQueryStringParams())},lookupAndNormalizeRoute:function(path){var route=this.findMatchingRoute(path);if(route){return this.routeMethods[route.name](route.args)}return path},_addRouteMethods:function(name,path){var pathFn=this.constructor.generatePathFunction(path),pathFnName=name+"Path";this[pathFnName]=pathFn;this.routeMethods[name]=pathFn;this.trigger("routeAdded",[pathFnName,pathFn])},_listenToUrl:function(){var that=this;$(window).hashchange(function(e){that._callCurrentRoutingAction()});if(this.constructor.detectHistorySupport()){$(window).bind("popstate",function(e){if(that._useHistory()){that._callCurrentRoutingAction()}})}},_useHistory:function(){return twttr.secrets&&twttr.secrets.html5Routing&&this.constructor.detectHistorySupport()}});twttr.klass("twttr.Decider",function(features,refreshInterval){features=features||{};this._updateFeatures(features);refreshInterval=refreshInterval||this.constructor.DEFAULT_REFRESH_INTERVAL;setInterval(twttr.bind(this,this.updateFeatures),refreshInterval)}).statics({DECIDER_URL:"/account/available_features",DEFAULT_REFRESH_INTERVAL:180000}).methods(twttr.EventProvider).methods({features:function(){return this._features||{}},isAvailable:function(featureName){if(this._features){return !!this._features[featureName]}return false},featureUrl:function(params){var country=(params&&params.spoof_country);if(country){return this.constructor.DECIDER_URL+"?spoof_country="+country}else{return this.constructor.DECIDER_URL}},updateFeatures:function(){var cachedFeatures=twttr.API._requestCache.get("account/available_features",{});if(cachedFeatures){this._updateFeatures(cachedFeatures)}else{this._makeRemoteRequest()}},_makeRemoteRequest:function(cb){$.getJSON(this.featureUrl(twttr.util.params()),twttr.bind(this,function(features){if(features){this._updateFeatures(features)}if(cb){cb()}}))},_updateFeatures:function(features){var oldFeatures=this._features||{};this._features=features;var pretty=twttr.util.params().pretty;if(twttr.is.def(pretty)){this._features.phoenix_pretty_links=(pretty==="1"||pretty==="true")?1:0}var difference=twttr.util.diff(oldFeatures,this._features);for(var key in difference){var change={key:key,previous:difference[key][0],current:difference[key][1]};this.trigger("keyChanged",change)}},goodAtCss:function(){return $.support.boxModel&&!($.browser.msie&&parseFloat($.browser.version)<=6)}});twttr.decider=new twttr.Decider();provide(">decider");twttr.klass("twttr.AbDecider",function(experiments,refreshInterval){this._impressions={};this._updateExperiments(experiments||{});refreshInterval=refreshInterval||this.constructor.DEFAULT_REFRESH_INTERVAL;if(refreshInterval>0){var that=this;setTimeout(function(){setInterval(twttr.bind(that,that.updateExperiments),refreshInterval)},(refreshInterval/2))}}).statics({AB_TEST_SCRIBE_CATEGORY:"www_ab_testing",AB_IMPRESSION_EVENT:"ab_test_impression",ABDECIDER_URL:"/account/available_ab_buckets",LOG_EVENTS:false,DEFAULT_REFRESH_INTERVAL:-1}).methods(twttr.EventProvider).methods({experiments:function(){return this._experiments||{}},choose:function(experimentName,noImpression){if(!this._experiments){return""}var bucketInfo=this._experiments[experimentName];if(!bucketInfo||!bucketInfo.bucket){return""}var bucketName=bucketInfo.bucket;if(!noImpression&&this._impressions[experimentName]!=bucketName){this._trackInternal(experimentName,this.constructor.AB_IMPRESSION_EVENT);this._impressions[experimentName]=bucketName}return bucketName},track:function(experimentName,eventName,opt_data){if(eventName==this.constructor.AB_IMPRESSION_EVENT){return }this._trackInternal(experimentName,eventName,opt_data)},updateExperiments:function(){$.getJSON(this.constructor.ABDECIDER_URL,twttr.bind(this,function(experiments){if(experiments){this._updateExperiments(experiments)}}))},_updateExperiments:function(experiments){var oldExperiments=this._experiments||{};this._experiments=experiments;var difference=twttr.util.diff(oldExperiments,this._experiments,function(oldExperiment,newExperiment){if(!oldExperiment||!newExperiment){return false}return oldExperiment.bucket===newExperiment.bucket&&oldExperiment.version===newExperiment.version});for(var key in difference){var change={key:key,previous:difference[key][0],current:difference[key][1]};this.trigger("keyChanged",change)}},set:function(experimentName,bucketName){if(!this._experiments||!this._experiments[experimentName]){return }this._experiments[experimentName]=twttr.merge({},this._experiments[experimentName],{bucket:bucketName})},remove:function(experimentName){this._experiments[experimentName]=null},_trackInternal:function(experimentName,eventName,optData){if(!this._experiments){return }var experimentInfo=this._experiments[experimentName];if(!experimentInfo){return }var data=twttr.merge(optData||{},{bucket:experimentInfo.bucket,experiment_key:experimentInfo.experiment_key,version:experimentInfo.version});if(this.constructor.LOG_EVENTS){console.log(experimentName+": "+eventName)}scribble(eventName,data,twttr.AbDecider.AB_TEST_SCRIBE_CATEGORY)}});twttr.abdecider=new twttr.AbDecider();provide(">ab_decider");twttr.stream=function(namespace,fn){var klass=twttr.klass(namespace,fn);return klass};twttr.klass("twttr.streams.Stream",function(params,initialItems){this.params=params||{};initialItems=initialItems||[];if(initialItems instanceof twttr.API.util.BaseCollection){initialItems=initialItems.array}this.items=initialItems;this.hiddenStreamItems={};this.screenName=this.params.screenName;this.newItemsCount=this.items.length;this.oldItemsCount=0;this._page=1;this.focusedItemId=null;this.highlightedItemId=null;this.scribbler=this.params.scribbler||new twttr.Scribbler();this.$node=new twttr.views.Stream({}).$html()}).methods(twttr.EventProvider).methods({NEW_ITEMS_COUNT_MAX:100,NEW_ITEMS_COUNT_CUTOFF:40,_shouldCache:true,itemViewClass:null,afterSwitchingToAgain:function(callback){callback?callback():$.noop},afterFirstSwitchingTo:function(callback){callback?callback():$.noop},beforeSwitchingAway:function(){},_setTitle:function(){},_getHeaderComponent:function(){},_useCollapsing:function(items){return false},hasPromotedContent:function(){return false},getMoreOldItems:function(callback){var that=this;if(this._getMoreOldItemsLock||this.noMoreOldItems||this._errorComponent){return }this._getMoreOldItemsLock=true;this.isLoadingMore();this._fetchItems(twttr.bind(this,function(stream,status){if(status!==twttr.streams.SUCCESS){this._showError(status)}else{var oldItems=this.items.slice(this.items.length-this.oldItemsCount);this.onGotOldItems(oldItems);this._showOldItems();this._page++}this.doneLoadingMore();if(!this.header){if(this.header=stream._getHeaderComponent()){stream.$find(".stream-items").prepend(this.header.$node.addClass("stream-header"))}}this._getMoreOldItemsLock=false;if(callback){callback(stream,status)}}))},getCurrentlyFocusedItem:function(){return this.focusedItemId?this.$streamItems().find(this.itemSelector(this.focusedItemId)):null},getCurrentlyHighlightedItem:function(){return this.highlightedItemId?this.$streamItems().find(this.itemSelector(this.highlightedItemId)):null},getFirstItem:function(){return this.$streamItems().find(".stream-item:first")},focusItem:function($item){this.focusedItemId=$item.attr("data-item-id");$item.focus()},unfocusItem:function($item){this.focusedItemId=null;$item.blur()},highlightItem:function($item){var $currentlyHighlightedItem=this.getCurrentlyHighlightedItem();if($currentlyHighlightedItem){$currentlyHighlightedItem.removeClass("hovered-stream-item")}this.highlightedItemId=$item.attr("data-item-id");$item.addClass("hovered-stream-item")},highlightNext:function(){this.shiftHighlight(false)},highlightPrevious:function(){this.shiftHighlight(true)},shiftHighlight:function(isPrevious){var $currentlyHighlightedItem=this.getCurrentlyHighlightedItem();if(!$currentlyHighlightedItem){this.highlightItem(this.getFirstItem());return }var $newItem=isPrevious?$currentlyHighlightedItem.prev():$currentlyHighlightedItem.next();if($newItem.length){this.highlightItem($newItem);this.scrollStreamTo($newItem)}},scrollStreamTo:function($item){var itemTop=$item.offset().top,scrollTop=Math.round(itemTop-(twttr.$win.height()/2));twttr.$win.scrollTop(scrollTop)},dom:function(){return this.$node},$streamItems:function(){return this.$find(".stream-items")},$find:function(){var $dom=this.dom();return $dom.find.apply($dom,arguments)},itemSelector:function(itemId){return".stream-item[data-item-id="+itemId+"]"},selectedItem:function(itemId){return this.$streamItems().find(this.itemSelector(itemId))},unshift:function(items){if(twttr.is.array(items)){this.newItemsCount+=items.length;this.items.unshift.apply(this.items,items)}else{this.newItemsCount+=arguments.length;this.items.unshift(arguments)}this.trigger("newItemsCountChanged",[this.newItemsCount])},push:function(items){if(twttr.is.array(items)){this.oldItemsCount+=items.length;this.items.push.apply(this.items,items)}else{this.oldItemsCount+=arguments.length;this.items.push(arguments)}},isDuplicate:function(item){var itemId=this.streamItemId?this.streamItemId(item):item.id;this.itemIds=this.itemIds||{};return !!this.itemIds[itemId]},_renderItemHtml:function(item){this.itemIds=this.itemIds||{};var itemId=this.streamItemId?this.streamItemId(item):item.id;this.itemIds[itemId]=1;var view=new twttr.views[this.itemViewClass](item);view.query=this.params.query;return new twttr.views.StreamItem({item_html:view.html(),item_id:itemId,item_type:this.streamItemType,item_hidden_id:item.hidden_id}).html()},_renderItemsHtml:function(items){var that=this;return twttr.inject(items,"",function(acc,i,item){if(item instanceof twttr.views.HiddenStreamItems){that.hiddenStreamItems[item.hidden_id()]=item;acc+=item.html()}else{if(!that.isDuplicate(item)){acc+=that._renderItemHtml(item)}}return acc})},_renderItems:function(items){if(this._useCollapsing(items)){items=this._collapseItems(items)}return $(this._renderItemsHtml(items))},remove:function(itemId){this.selectedItem(itemId).remove()},rerenderItem:function(itemId,item){this.selectedItem(itemId).replaceWith(this._renderItemHtml(item))},_showNewItems:function(forRender){var profiler=new twttr.util.Profiler(this.constructor._namespace+"._showNewItems");var $streamItems=this.$streamItems();this.beforeShowNewItems();if(this.newItemsCount>this.NEW_ITEMS_COUNT_MAX){$streamItems.empty();this.items=this.items.slice(0,this.NEW_ITEMS_COUNT_CUTOFF);this.newItemsCount=this.NEW_ITEMS_COUNT_CUTOFF}var newItems=this.items.slice(0,this.newItemsCount);var $newItemsHtml=this._renderItems(newItems);if(!forRender&&this.newItemsCount>0){scribble("stream-refreshed",{stream:this._cacheKey,tweet_count:this.newItemsCount});this.onGotNewItems(newItems);if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","refresh_from_home_timeline",{tweet_count:this.newItemsCount})}}if(forRender){this.onGotInitialResults()}$streamItems.prepend($newItemsHtml);this.newItemsCount=0;this.onShowNewItems($newItemsHtml);this.trigger("newItemsCountChanged",[0]);profiler.done()},_showOldItems:function(){var profiler=new twttr.util.Profiler(this.constructor._namespace+"._showOldItems");var $streamItems=this.$streamItems();var oldItems=this.items.slice(this.items.length-this.oldItemsCount);var $oldItemsHtml=this._renderItems(oldItems);$streamItems.append($oldItemsHtml);this.oldItemsCount=0;this.onShowOldItems($oldItemsHtml);profiler.done()},render:function(){this._showNewItems(true);this._showOldItems()},isEmpty:function(){return this.items.length===0},reachedTheEnd:function(){if(!this.noMoreOldItems){this.noMoreOldItems=true;this.markStreamEnd();this.trigger("streamEnd")}},markStreamEnd:function(){if(this._alreadyMarkedEnd){return }this._alreadyMarkedEnd=true;var component=this.isEmpty()?this._getEmptyStreamComponent():this._getStreamEndComponent();component.$node.appendTo(this.dom())},_showError:function(status){var that=this;if(this._errorComponent){this._errorComponent.destroy();delete this._errorComponent}var component=this._getStreamErrorComponent(status);component.bind("tryAgain",function(e){component.destroy();delete that._errorComponent;that.getMoreOldItems()});this._errorComponent=component;component.$node.appendTo(this.dom())},_getStreamEndComponent:function(){return new twttr.components.StreamEnd(this._getStreamEndHtml())},_getEmptyStreamComponent:function(){return new twttr.components.StreamEnd(this._getEmptyStreamHtml())},_getStreamErrorComponent:function(status){if(status===twttr.streams.DECIDER){return new twttr.components.StreamEnd(this._getStreamErrorHtml(status))}else{return new twttr.components.StreamWhaleEnd(this._getStreamWhaleText())}},_getStreamLoadingComponent:function(){return new twttr.views.StreamLoading()},_getStreamWhaleText:function(){return _("Loading seems to be taking a while.")},_getEmptyStreamHtml:function(){},_getStreamEndHtml:function(){if(this.items.length<20){return""}else{return _("<a href='#' class='back-to-top'>Back to top &uarr;</a>")}},_getStreamErrorHtml:function(status){return _("This feature is temporarily unavailable.")},isLoadingMore:function(){var $stream=this.dom();if($stream.find(".stream-loading").length===0){this._getStreamLoadingComponent().render($stream,"append")}},stream_user_is_current_user:function(){return twttr.currentUser&&this.screenName&&twttr.currentUser.screenName===this.screenName},doneLoadingMore:function(){this.dom().find(".stream-loading").remove();this.trigger("doneLoadingMore")},beforeShowNewItems:function(){},onGotInitialResults:function(){},onGotNewItems:function(newItems){},onShowNewItems:function($newItemsHtml){},onGotOldItems:function(oldItems){},onShowOldItems:function($oldItemsHtml){}});twttr.aug(twttr.streams,{SUCCESS:1,ERROR:2,PROTECTED:3,DECIDER:4,WHALE:5,TIMEOUT:6});twttr.augmentString("twttr.scribbles",{logViewProfileDetails:function(e){var $this=$(this);var scribeData={};var $target=$(e.target);var eventName="view-profile";if($target.is("img")){scribeData.target="image"}else{if($target.is("a")){scribeData.target="link"}}if($this.is("div.dashboard .user-profile-link")){scribeData.component="dashboard";if($this.is(".new-followers .user-profile-link")){scribeData.subcomponent="new-followers"}}else{if($this.is("div.details-pane .user-profile-link, div.details-pane .twitter-atreply")){scribeData.component="details-pane";if($this.is(".related-tweets .user-profile-link, .related-tweets .twitter-atreply")){var $tweet=$this.closest(".tweet");twttr.viewHelpers.addRelatedTweetsLogging($tweet,scribeData,eventName)}}else{if($this.is(".stream-tweet .user-profile-link, .stream-tweet .twitter-atreply")){scribeData.component="stream"}else{if($this.is(".twttr-dialog .user-profile-link")){scribeData.component="dialog";scribeData.dialog_type=$this.closest(".twttr-dialog").attr("type")}}}}scribeData.input="click";scribeData.tweet_id=$this.closest(".tweet").attr("data-tweet-id")||"";scribeData.user_id=$this.attr("data-user-id");scribble(eventName,scribeData);if(scribeData.component=="stream"&&twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","view_profile_from_home_timeline",{tweet_id:scribeData.tweet_id,user_id:scribeData.user_id})}}});(function(){twttr.Scribbler.clientAppDefaultTerms=function(){return{client:"web",page:twttr.util.underscore(twttr.audit.currentPage()),section:twttr.util.underscore(twttr.audit.currentAction())}};twttr.Scribbler.clientAppEventNameGenerator=function(eventTerms,prefixTerms){prefixTerms=prefixTerms||twttr.Scribbler.clientAppDefaultTerms();eventTerms=twttr.merge(prefixTerms,eventTerms);return[eventTerms.client,eventTerms.page,eventTerms.section,eventTerms.component,eventTerms.action].join(":")};twttr.Scribbler.clientEvent=new twttr.Scribbler({},{noob_level:function(){var noobLevel=twttr.loggedIn?twttr.helpers.userNoobLevel(twttr.currentUser):-1;return noobLevel>=0?noobLevel:null}},"client_event",twttr.Scribbler.clientAppEventNameGenerator);window.trackClient=twttr.trackClient=function(eventTerms,data){if(arguments[1]&&typeof (arguments[1])==="string"){arguments[1]={context:arguments[1]}}return twttr.Scribbler.clientEvent.scribe.apply(twttr.Scribbler.clientEvent,arguments)}})();twttr.app.bind("init",function(event){var eventToScribeAction={follow:"follow",follow_request:"follow",view_profile_pane:"profile_click"};var getSearchQuery=function(path){var searchMatches=twttr.constants.regexps.userSearchPath.exec(path);if(searchMatches&&searchMatches[3]){return decodeURIComponent(searchMatches[3])}};var trackGlobalEvents=function(event,eventObj){var page=twttr.audit.currentPage(),action=twttr.audit.currentAction(),path=twttr.audit.currentPath();var data={item_ids:[eventObj.id],item_count:1};if(page=="welcome"||page=="who_to_follow"){data.context=(page=="welcome"?twttr.components.pages.Welcome.ROUTES_TO_STEP[action]:twttr.components.pages.WhoToFollow.ROUTES_TO_STEP[action]);if(action=="category"){var categoryMatches=twttr.constants.regexps.suggestionCategoryPath.exec(path);if(categoryMatches&&categoryMatches[2]){data.query=decodeURIComponent(categoryMatches[2])}}else{if(action=="search"){data.query=getSearchQuery(path)}}}else{if(page=="search"&&action=="people"){data.context="user_search";data.query=getSearchQuery(path)}else{if(page=="similar_to"){data.context="similar_to";if(twttr.profileUser){data.profile_id=twttr.profileUser.id}}}}if(!twttr.loggedIn){if(page=="profile"||page=="list"){data.context=page;if(twttr.profileUser){data.profile_id=twttr.profileUser.id}}}if(data.context){var scribeAction=eventToScribeAction[event.type];var component=event.type=="view_profile_pane"?"stream":"";trackClient({component:component,action:scribeAction},data)}};twttr.API.User.bind("follow follow_request",trackGlobalEvents);twttr.app.bind("view_profile_pane",trackGlobalEvents)});twttr.klass("twttr.MessageThread",function(threadId,messages){this.threadId=threadId;this.messages=messages});twttr.klass("twttr.MessageManager",function(){if(!twttr.loggedIn){return }var that=this;this._fetchMessages(function(){that._sort();that.trigger("firstMessagesReceived")})}).methods(twttr.EventProvider).methods({setupContinuousPoll:function(){var that=this;if(this._pollId){return }if(this.threads){setupPoll.call(this)}else{this.one("firstMessagesReceived",function(){setupPoll.call(that)})}function setupPoll(){this._pollInterval=90000;this.bind("messagesArrived",function(e,messages){messages.each(function(message){that.addMessage(message)})});this._pollId=setInterval((function(that){return function(){that._fetchMessages()}})(this),this._pollInterval)}},isContinuouslyPolling:function(){return !!this._pollId},stopContinuousPoll:function(){if(this.isContinuouslyPolling()){clearInterval(this._pollId);delete this._pollId}},getAllThreads:function(callback){var that=this;if(this.threads){callback(this.threads)}else{this.one("firstMessagesReceived",function(){callback(that.threads)})}},getThread:function(threadId,callback){for(var i=0;i<this.threads.length;i++){if(this.threads[i].threadId===threadId){return callback(this.threads[i])}}return callback()},addMessage:function(message){var that=this;this.getThread(message.threadId,function(thread){if(thread){if(message.sender.screenName===twttr.currentUser.screenName){for(var i=0,m=thread.messages,l=m.length;i<l;i++){var checkId=m[i].id;if(checkId<message.id){break}else{if(checkId===message.id){return }}}}thread.messages.unshift(message)}else{thread=new twttr.MessageThread(message.threadId,[message]);that.threads.unshift(thread)}that.trigger("updatedThread",[thread,"prepend"]);that.trigger("newMessage."+message.threadId,[message])})},deleteMessage:function(messageId,threadId){var that=this;this.getThread(threadId,function(thread){if(thread){for(var i=0,m=thread.messages,l=m.length;i<l;i++){if(m[i].id===messageId){var message=m.splice(i,1)[0];message.destroy({error:function(){that.addMessage(message)},success:function(message){}});break}}if(thread.messages.length===0){for(var j=0;j<that.threads.length;j++){if(that.threads[j].threadId===threadId){that.threads.splice(j,1);break}}that.trigger("deletedThread",[threadId])}else{that.trigger("updatedThread",[thread,"delete"])}}that.trigger("deletedMessage."+threadId,[messageId])})},_fetchMessages:function(callback){var that=this;var returned=0;function checkReceivedAllMessages(){returned++;if(returned===2&&callback){callback()}}var newMessages;var receivedOptions={count:50,success:function(messages){if(messages.length()>0){if(!that.receivedMessages){that.receivedMessages=messages}else{that.receivedMessages.concat(messages)}that.trigger("messagesArrived",[messages]);that._receivedSinceID=messages.first().id}newMessages=messages;checkReceivedAllMessages()},cancel:function(){},error:function(err,req){if(err.status===502){req.retry()}}};if(that._receivedSinceID){receivedOptions.since_id=that._receivedSinceID}twttr.currentUser.receivedMessages(receivedOptions);var sentOptions={count:50,success:function(messages){if(messages.length()>0){if(!that.sentMessages){that.sentMessages=messages}else{that.sentMessages.concat(messages)}that.trigger("messagesArrived",[messages]);that._sentSinceID=messages.first().id}checkReceivedAllMessages()},cancel:function(){},error:function(err,req){if(err.status===502){req.retry()}}};if(that._sentSinceID){sentOptions.since_id=that._sentSinceID}twttr.currentUser.sentMessages(sentOptions)},_sort:function(){this.allMessages=[];if(this.sentMessages){this.allMessages=this.allMessages.concat(this.sentMessages.array)}if(this.receivedMessages){this.allMessages=this.allMessages.concat(this.receivedMessages.array)}this.allMessages.sort(function(a,b){return twttr.util.natcompare(b.id,a.id)});var threads={};var threadsOrder=[];for(var i=0;i<this.allMessages.length;i++){var message=this.allMessages[i],pivot=message.threadId;if(!threads[pivot]){threads[pivot]=[];threadsOrder.push(pivot)}threads[pivot].push(message)}this.threads=[];for(var i=0;i<threadsOrder.length;i++){this.threads.push(new twttr.MessageThread(threadsOrder[i],threads[threadsOrder[i]]))}}});twttr.stream("twttr.streams.UserStream",function(params,initialItems){var that=this;twttr.streams.Stream.apply(this,arguments);if(this.isCursorPagination()){this.cursor=-1}else{this.page=0}var updateFollowState=twttr.bind(this,function(user,following){this.rerenderItem(user.id,user)});twttr.API.User.bind("follow",function(event,user){updateFollowState(user,true)});twttr.API.User.bind("follow_request",function(event,user){updateFollowState(user,null)});twttr.API.User.bind("unfollow",function(event,user){updateFollowState(user,false)});this.dom().delegate(".pending-request a","click",function(e){var userId=parseInt($(this).closest(".stream-item").attr("data-item-id"),10);twttr.API.User.find(userId).unfollow({error:function(e){twttr.showError(JSON.parse(e.reason).error)}});e.preventDefault()})}).subclassOf(twttr.streams.Stream).methods({itemViewClass:"StreamUser",streamItemType:"user"}).methods({update:function(options){},_fetchItems:function(cb){var that=this;if(!twttr.decider.isAvailable("people_streams")||(this.constructor._deciderKey&&!twttr.decider.isAvailable(this.constructor._deciderKey))){cb(this,twttr.streams.DECIDER);return }var opts={success:function(users,data){var cpage=that.isCursorPagination();that.push(users.array);if(cpage){that.cursor=data.response.next_cursor}else{if(users.length()==that.PAGE_SIZE){that.page=that.page+1}else{that.page=-1}}if((cpage&&!that.cursor)||(!cpage&&that.page===-1)){that.reachedTheEnd()}that._scribbleUsers(users);cb(that,twttr.streams.SUCCESS)},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}},timeout:function(request){request.retry()},cancel:function(){cb(that,twttr.streams.TIMEOUT)}};opts=twttr.merge(opts,this.isCursorPagination()?{cursor:this.cursor}:{page:this.page+1});this.update(opts)},afterFirstSwitchingTo:function(callback){this.getMoreOldItems(callback)},PAGE_SIZE:20,isCursorPagination:function(){return true},_getStreamErrorComponent:function(status){if(status===twttr.streams.PROTECTED){return new twttr.components.ProtectedUser({screen_name:this.params.screenName})}else{return twttr.streams.Stream.prototype._getStreamErrorComponent.apply(this,arguments)}},_scribbleUsers:function(users){var scribeData={item_ids:users.map(function(user,i){return user.id}),item_count:users.length()};if(this.page){scribeData.cursor_or_page=this.page}if(this.cursor){scribeData.cursor_or_page=this.cursor}this.scribbler.scribe({component:"stream",action:"results"},scribeData)}});twttr.stream("twttr.streams.PlaceUsers",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;var originalSuccess=options.success;options.rpp=100;options.success=function(tweetCollection,data){var userIds={};var users=[];tweetCollection.each(function(tweet){if(tweet.user&&!(tweet.user.id in userIds)&&(!that.params.onlyFollowing||tweet.user.following)){userIds[tweet.user.id]=true;users.push(tweet.user)}});originalSuccess(new twttr.anywhere.api.util.BaseCollection(users),data)};twttr.API.Status.search("place:"+this.params.placeId,options)},_getEmptyStreamHtml:function(){return this.params.onlyFollowing?_("No recent tweets from people you follow."):_("No recent tweets.")}}).statics({_deciderKey:"place_users_stream"});twttr.stream("twttr.streams.Friends",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments);var that=this;function updateFollowingCount(didFollow){var val=didFollow?1:-1;var $el=that.$node.parent().siblings(".stream-title").find("h2");var newFollowTitle=that._countString(parseInt($el.html().match(/\d+/)[0],10)+val);$el.html(newFollowTitle)}twttr.API.User.bind("follow.FriendsStream",function(e,user){updateFollowingCount(true)});twttr.API.User.bind("unfollow.FriendsStream",function(e,user){updateFollowingCount(false)})}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;var profiler=new twttr.util.Profiler(this.constructor._namespace+".update");twttr.API.User.find(this.screenName,function(user){if(!twttr.helpers.canViewUser(user)){that._showError(twttr.streams.PROTECTED);that.doneLoadingMore();profiler.done();return }user.friends(profiler.doneAfterCallback(options))})},_countString:function(count){if(count===1){return _("You follow 1 person")}else{return _("You follow {{friendsCount}} people",{friendsCount:twttr.util.formatNumber(count,twttr.pageLocale)})}},_setTitle:function(callback){if(this.stream_user_is_current_user()){var count=twttr.currentUser.friendsCount;var title;callback(this._countString(count))}else{twttr.API.User.find(this.screenName,twttr.bind(this,function(user){var title;if(user.friendsCount===1){title=_("{{username}} follows 1 person",{username:"@"+this.screenName})}else{title=_("{{username}} follows {{friendsCount}} people",{username:"@"+this.screenName,friendsCount:twttr.util.formatNumber(user.friendsCount,twttr.pageLocale)})}callback(title)}))}},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You aren't following anyone yet.")}else{return _("@{{screen_name}} isn't following anyone yet.",{screen_name:this.screenName})}}}).statics({_deciderKey:"people_stream_friends"});twttr.stream("twttr.streams.FollowerRequests",function(params,initialItems){var that=this;this.constructor.uber.constructor.apply(this,arguments);this.cursor=0;this.oldItemsCount=-1;this.pending_users=[];this.getFollowerRequestCount=function(cb){var that=this;if(that.oldItemsCount==-1){twttr.currentUser.friends.pending(function(list,data){that.oldItemsCount=list.length;that.pending_users=list;cb(that.oldItemsCount)})}else{that.oldItemsCount=that.pending_users.length;cb(that.oldItemsCount)}}}).subclassOf(twttr.streams.UserStream).methods({itemViewClass:"StreamFollowerRequest",streamItemType:"user",update:function(options){},_fetchItems:function(cb){var that=this;that.getFollowerRequestCount(function(count){var options={success:function(users,data){that.push(users.array);that.cursor=that.cursor+that.constructor.PAGE_SIZE;if(that.cursor>=count){that.reachedTheEnd()}cb(that,twttr.streams.SUCCESS)},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}},timeout:function(request){request.retry()},cancel:function(){cb(that,twttr.streams.TIMEOUT)}};sliced_list=that.pending_users.slice(that.cursor,that.cursor+that.constructor.PAGE_SIZE);twttr.API.User.findAll(sliced_list,options)})},_setTitle:function(cb){cb(_("Your pending follower requests"))}}).statics({PAGE_SIZE:20,_deciderKey:"people_stream_follower_requests"});twttr.stream("twttr.streams.Followers",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;twttr.API.User.find(this.screenName,function(user){if(!twttr.helpers.canViewUser(user)){that._showError(twttr.streams.PROTECTED);that.doneLoadingMore();return }user.followers(options)})},_setTitle:function(callback){if(this.stream_user_is_current_user()){var title=_("Your {{followersCount}} followers",{followersCount:twttr.util.formatNumber(twttr.currentUser.followersCount,twttr.pageLocale)});callback(title)}else{twttr.API.User.find(this.screenName,twttr.bind(this,function(user){var title=_("{{username}}'s {{followersCount}} followers",{username:this.screenName,followersCount:twttr.util.formatNumber(user.followersCount,twttr.pageLocale)});callback(title)}))}},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You don't have any followers yet.")}else{return _("@{{screen_name}} doesn't have any followers yet.",{screen_name:this.screenName})}}}).statics({_deciderKey:"people_stream_followers"});twttr.stream("twttr.streams.SocialContextStream",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments);this.params=params;var socialContextType=params.socialContextType=="followsInCommonWith"?"following_social_context":"followers_social_context";this.$node.delegate(".user-profile-link","click",function(e){this.scribbler.scribe({component:"stream",action:"profile_click"},{item_ids:[parseInt($(this).attr("data-user-id"))],item_count:1,event_info:socialContextType})})}).subclassOf(twttr.streams.UserStream).methods({update:function(options){twttr.currentUser[this.params.socialContextType](twttr.profileUser.id,options)},_getEmptyStreamHtml:function(){var strParams={user:twttr.profileUser.screenName};if(this.params.socialContextType=="followsInCommonWith"){return _("You and @{{user}} don't follow anyone in common.",strParams)}else{return _("You don't follow anyone who follows @{{user}}.",strParams)}},_setTitle:function(cb){cb(_((this.params.socialContextType=="followsInCommonWith")?"You both follow":"Followers you follow"))}}).statics({_deciderKey:"social_context"});twttr.klass("twttr.streams.PeopleSearch",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({scribeData:function(){return twttr.merge(twttr.streams.Stream.prototype.scribeData.apply(this),{name:"Search",query:this.params.query,type:"people"})},update:function(options){twttr.API.User.search(this.params.query,options)},_getEmptyStreamHtml:function(){return _("No people results for <strong>{{query}}</strong>.",{query:this.params.query})},getStreamEndHtml:function(){return _("No more people results for <strong>{{query}}</strong>.",{query:this.params.query})},_setTitle:function(cb){cb(_("Results for: <strong>{{query}}</strong>",{query:this.params.query}))}}).statics({_deciderKey:"people_stream_people_search"});twttr.stream("twttr.streams.ListFollowers",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;twttr.API.User.find(this.screenName).lists(function(lists){lists.find(function(list){return list.slug===that.params.listSlug}).followers(options)})},_setTitle:function(cb){cb(_("People following this list"))}}).statics({_deciderKey:"people_stream_list_followers"});twttr.stream("twttr.streams.ListMembers",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;twttr.API.User.find(this.screenName).lists(function(lists){lists.find(function(list){return list.slug===that.params.listSlug}).members(options)})},_setTitle:function(cb){cb(_("People this list follows"))}}).statics({_deciderKey:"people_stream_list_members"});twttr.klass("twttr.streams.MessageStream",function(params,initialItems){twttr.streams.Stream.apply(this,arguments)}).subclassOf(twttr.streams.Stream).methods({itemViewClass:"MessageThreadPreview",streamItemType:"message_thread",streamItemId:function(item){return item.threadId}}).methods({_fetchItems:function(cb){var that=this;if(!twttr.decider.isAvailable("message_stream")){cb(this,twttr.streams.DECIDER);return }twttr.messageManager.getAllThreads(function(threads){that.push(threads);cb(that,twttr.streams.SUCCESS);that.reachedTheEnd()})},afterFirstSwitchingTo:function(callback){this.getMoreOldItems(callback)},updateThread:function(thread,action){var $streamItem=this.$find(".stream-item[data-item-id="+thread.threadId+"]"),newHtml=new twttr.views.MessageThreadPreview(thread).html();if(!$streamItem.length){$streamItem=new twttr.views.StreamItem({item_html:newHtml,item_id:this.streamItemId(thread),item_type:this.streamItemType}).$html()}else{$streamItem.find(".message-thread-preview").replaceWith(newHtml)}if(action==="prepend"){this.dom().find(".stream-items").prepend($streamItem)}},removeThread:function(threadId){var $thread=this.$find(".stream-item[data-item-id="+threadId+"]");if($thread.hasClass("focused-stream-item")){if($thread.prev().length){$thread.prev().focus()}else{if($thread.next().length){$thread.next().focus()}}}$thread.remove()},_getEmptyStreamHtml:function(){return _("You can privately message someone on Twitter by sending a direct message.")}});twttr.klass.mixin("twttr.mixins.streamablePage",function(klass){klass.click({".stream .tweet-actions":function(e,$target){e.stopPropagation();e.preventDefault();return false},".hidden-stream-items":function(event,$target){var currentStream=this.streamManager.getCurrent();var hiddenId=$target.attr("hidden-id");var hiddenItems=currentStream.hiddenStreamItems[hiddenId].items;var $streamItems=$target.parent();$target.hide();$hiddenItems=$(currentStream._renderItemsHtml(hiddenItems));currentStream.onShowOldItems($hiddenItems);$streamItems.find(".last-new-tweet").removeClass("last-new-tweet");$target.prev().addClass("last-new-tweet");$target.after($hiddenItems);$hiddenItems.last().addClass("last-new-tweet");$hiddenItems.fadeIn(600);twttr.abdecider.track("home_timeline_collapsing-36","unhide_tweets",{unhidden_user_id:hiddenItems[0].user.id,unhidden_items_size:hiddenItems.length});delete currentStream.hiddenStreamItems[hiddenId];return false},"div.details-pane div.stream-item":function(event,$target){if($(event.target).is(".twitter-timeline-link")){return }var $tweet=$target.find(".tweet");var tweetId=$tweet.attr("data-tweet-id");var scribeData={component:"details-pane"};if($target.is(".related-tweets .stream-item")){twttr.viewHelpers.addRelatedTweetsLogging($tweet,scribeData,"tweet-click")}else{if($target.is(".in-reply-to .stream-item")){scribeData.subcomponent="in-reply-to"}}scribeData.embedded_media_types=$tweet.find(".icons .media").map(function(i,el){return[el.getAttribute("data-media-type"),el.getAttribute("data-media-class")]}).get();var impressionId=$tweet.attr("data-impression-id");this.loadItemInDetailsPane(tweetId,"tweet",{log:scribeData,push:true,impressionId:impressionId})},"div.details-pane .user-detailed-list-item .user-screen-name":function(event,$target){var id=parseInt($target.attr("data-user-id"),10);this.loadItemInDetailsPane(id,"user",{push:true});event.stopPropagation();event.preventDefault();return false},".stream .stream-item":function(event,$target){var isTimestamp=$(event.target).is("div.stream-item a.tweet-timestamp, div.stream-item a.tweet-timestamp *");var isLink=$(event.target).is("div.stream-item a.twitter-timeline-link");var isButton=$(event.target).is("div.stream-user-buttons *");var isFeedback=$(event.target).parents("div.stream-item").is("div.feedback-shown");if(isTimestamp||isLink||isButton||isFeedback){return }this.toggleFocus($target)},".stream .user-profile-link, .stream .twitter-atreply, div.details-pane .user-profile-link, div.details-pane .twitter-atreply":function(event,$target){var userId=twttr.helpers.getUserIdentifier($target);var options={};var scribeData={component:"stream"};options.log=scribeData;if($target.is("div.details-pane .user-profile-link, div.details-pane .twitter-atreply")){options.push=true;scribeData.component="details-pane"}var impressionId=$target.closest(".promoted-tweet").attr("data-impression-id");if($target.is("div.details-pane .user-profile-link, .stream .user-profile-link")){options.impressionId=impressionId}else{if($target.is(".stream .twitter-atreply, div.details-pane .twitter-atreply")){if(impressionId){twttr.API.util.PromotedContent.logUserMentionClick(impressionId,$target.text())}}}if(twttr.app.isOnPage("search")&&$target.is(".stream .user-profile-link, .stream .twitter-atreply")){options.searchClick=$target.closest(".stream-tweet")}twttr.scribbles.logViewProfileDetails.call($target,event);this.loadItemInDetailsPane(userId,"user",options);event.stopPropagation();event.preventDefault();return false},".stream .twitter-place, div.details-pane .twitter-place":function(event,$target){var tweetId=$target.closest(".tweet").attr("data-tweet-id");var options={placeId:$target.attr("data-place-id")};if($target.is("div.details-pane .geo_map_tweets_at_this_place_link")){options.push=true}this.loadItemInDetailsPane(tweetId,"tweet_geo",options);return false},".stream .twitter-hashtag, div.details-pane .twitter-hashtag":function(event,$target){var impressionId=$target.closest(".promoted-tweet").attr("data-impression-id");if(impressionId){twttr.API.util.PromotedContent.logHashtagClick(impressionId,$target.text())}trackClient({section:"",component:"tweet",action:"search"},{query:$target.text()})},".stream .twitter-timeline-link, div.details-pane .twitter-timeline-link":function(event,$target){var impressionId=$target.closest(".promoted-tweet").attr("data-impression-id");if(impressionId){twttr.API.util.PromotedContent.logUrlClick(impressionId,$target.text())}},".stream .twitter-listname":function(event,$target){twttr.router.routeTo(twttr.router.lookupAndNormalizeRoute($this.attr("href")));event.stopPropagation();event.preventDefault();return false},".tweet-geo-text, div.details-pane .geo_map_tweets_at_this_place_link":function(event,$target){var tweetId=$target.attr("data-tweet-id");var options={placeId:$target.attr("data-place-id")};if($target.is("div.details-pane .geo_map_tweets_at_this_place_link, div.details-pane .tweet-geo-text")){options.push=true}this.loadItemInDetailsPane(tweetId,"tweet_geo",options);event.stopPropagation();event.preventDefault();return false},".pane-toolbar a.pane-close":function(event,$target){this.unfocusStreamItem();event.stopPropagation();event.preventDefault();return false},".pane-toolbar a.pane-back":function(event,$target){this.panes.pop();event.stopPropagation();event.preventDefault();return false}}).focus({".stream .tweet-actions":function(e,$target){e.stopPropagation();return false}}).methods({_detailsPaneDisabled:function(){return !twttr.decider.goodAtCss()},toggleFocus:function($target){if($target.hasClass("focused-stream-item")&&this.panes.size()<=1){this.streamManager.getCurrent().unfocusItem($target);this.unfocusStreamItem()}else{this.streamManager.getCurrent().focusItem($target);this.focusStreamItem($target)}},focusStreamItem:function($target){$target.addClass("focused-stream-item").siblings().removeClass("focused-stream-item").removeClass("light");var itemId,itemType=$target.attr("data-item-type");if(itemType==="list"||itemType==="message_thread"||itemType==="tweet"){itemId=$target.attr("data-item-id")}else{itemId=parseInt($target.attr("data-item-id"),10)}var scribeData={component:"stream",page_number:this.streamManager.getCurrent()._page};var impressionId=$target.find(".tweet").attr("data-impression-id");if(itemType==="tweet"){scribeData.embedded_media_types=$target.find(".icons .media").map(function(i,el){return[[el.getAttribute("data-media-type"),el.getAttribute("data-media-class")]]}).get()}$target.addClass("focused-stream-item").siblings().removeClass("focused-stream-item");this.loadItemInDetailsPane(itemId,itemType,{log:scribeData,impressionId:impressionId,searchClick:twttr.app.isOnPage("search")&&$target.is(".stream .stream-item")?$target.children(".stream-tweet"):null})},unfocusStreamItem:function(){if(this.closeDetailsPane()!==false){this.$node.find(".stream-item").removeClass("focused-stream-item")}},loadItemInDetailsPane:function(itemId,itemType,options){var that=this,data={},options=options||{};if(options.log){twttr.merge(data,options.log)}this.dpProfiler=new twttr.util.Profiler(this.constructor._namespace+".loadItemInDetailsPane."+twttr.util.camelize(itemType));if(itemType==="tweet"){this.loadTweetInDetailsPane(itemId,options);this.openDetailsPane()}else{if(itemType==="user"){this.loadUserInDetailsPane(itemId,options);this.openDetailsPane()}else{if(itemType==="tweet_geo"){this.loadTweetGeoInDetailsPane(itemId,options);this.openDetailsPane()}else{if(itemType==="list"){twttr.router.routeTo(twttr.router.lookupAndNormalizeRoute(itemId))}else{if(itemType==="message_thread"){options.profiler=new twttr.util.Profiler(this.constructor._namespace+".loadItemInDetailsPane.MessageThreadInner");if(this.$node.find(".details-pane").hasClass("closed")){this.profiler.waitFor(options.profiler)}this.loadMessageThreadInDetailsPane(itemId,options);this.resizeDetailsPane()}}}}}if(options.searchClick){twttr.components.pages.Search.addSearchClickLogging(options.searchClick,data)}data.details_type=itemType;data.item_id=itemId;data.input="click";scribble("load-details-pane",data);if(itemType=="tweet"&&twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","tweet_click_from_home_timeline",{tweet_id:itemId})}$(".tipsy").remove()},viewId:function(prefix,id,impressionId){return prefix+id+(impressionId?"_"+impressionId:"")},loadTweetInDetailsPane:function(tweetId,options){var that=this,impressionId=options.impressionId,viewId=this.viewId("tweet_pane_",tweetId,impressionId),paneView=new twttr.views.DetailsPane(viewId),cached=this.panes.cached(viewId);var pushedView=options.push?this.panes.push(paneView):this.panes.reset(paneView);var $pane=pushedView.$dom;if(!cached){if(twttr.isNarrow){this.$find(".pane-components-inner").addClass("tweet-components")}twttr.API.Status.find(tweetId,function(tweet){pushedView._backLabel=_("@{{screen_name}}'s Tweet",{screen_name:tweet.user.screenName});if(impressionId){tweet=twttr.API.util.PromotedStore.getPromotedStatusInstance(tweet,impressionId);twttr.API.util.PromotedContent.logShowDetails(impressionId)}var currentStream=that.streamManager.getCurrent();new twttr.components.Conversation(tweet,currentStream,function(tweetComponent){tweetComponent.bind("deleted",function(){if(that.panes.contains(pushedView)){that.panes.remove(pushedView);that.panes.reset();that.closeDetailsPane()}});var components=[];var $component=$pane.find(".component:visible:first"),detailsPaneWidth=$pane.width();if($component.length!==0){detailsPaneWidth=$component.width()}detailsPaneWidth-=55;var mediaComponent=new twttr.components.Media(tweet,detailsPaneWidth);components=components.concat([tweetComponent,new twttr.components.TweetGeoSmall(tweet),new twttr.components.MachineTranslatedTweet(tweet),new twttr.components.Replies(tweet,currentStream,tweetComponent.resultGroups),new twttr.components.Retweeters(tweet,twttr.isNarrow?10:15),new twttr.components.MentionedInTweet(tweet)]);that.addComponentsToDetailsPane($pane,components);mediaComponent.$node.appendTo($pane.find(".tweet-media-container"))})})}else{$pane.find(".map_canvas:visible").trigger("refreshMap")}this.profiler&&this.profiler.done()},loadUserInDetailsPane:function(userId,options){var prefix=twttr.is.string(userId)?"user_pane_by_screen_name_":"user_pane_by_id_";var that=this,impressionId=options.impressionId,viewId=this.viewId(prefix,userId,impressionId),paneView=new twttr.views.DetailsPane(viewId),cached=this.panes.cached(viewId);var pushedView=options.push?this.panes.push(paneView):this.panes.reset(paneView);var $pane=pushedView.$dom;if(!cached){twttr.ui.toggleSpinner($pane,true);twttr.API.User.find(userId,{success:function(user){twttr.ui.toggleSpinner($pane);twttr.app.trigger("view_profile_pane",user);pushedView._backLabel=_("@{{screen_name}}'s profile",{screen_name:user.screenName});if(impressionId){user=twttr.API.util.PromotedStore.getPromotedUserInstance(user,impressionId)}that.addComponentsToDetailsPane($pane,[new twttr.components.ProfilePane(user),new twttr.components.RecentTweets(user)])},error:function(resp){that.addComponentsToDetailsPane($pane,[new twttr.components.NoUserExists()])}})}},loadTweetGeoInDetailsPane:function(tweetId,options){var that=this,viewId=this.viewId("tweet_geo_pane_",tweetId,options.placeId),paneView=new twttr.views.DetailsPane(viewId),cached=this.panes.cached(viewId);var pushedView=options.push?this.panes.push(paneView):this.panes.reset(paneView);var $pane=pushedView.$dom;if(!cached){twttr.API.Status.find(tweetId,function(tweet){var placeId=options.placeId||(tweet.place?tweet.place.id:null);pushedView._backLabel=_("@{{screen_name}}'s Tweet location",{screen_name:tweet.user.screenName});var finish=function(place){var components=[new twttr.components.TweetGeoBig(tweet,placeId)];if(place){components.push(new twttr.components.PlaceTweets(place))}that.addComponentsToDetailsPane($pane,components);this.profiler&&this.profiler.done()};if(placeId){if(tweet.place&&tweet.place.id==placeId){finish(tweet.place)}else{twttr.API.Place.find(placeId,{success:function(apiPlace){finish(apiPlace.data())},error:function(){finish()}})}}else{finish()}})}else{$pane.find(".map_canvas:visible").trigger("refreshMap")}},loadMessageThreadInDetailsPane:function(screenName,options){if(!twttr.loggedIn){throw"Something went wrong. You're not supposed to be able to load a message pane while logged out..."}var that=this,viewId=this.viewId("message_thread_pane_",screenName),paneView=new twttr.views.DetailsPane(viewId,{closable:false}),cached=that.panes.cached(viewId),pushedView=that.panes.reset(paneView),$pane=pushedView.$dom;if(cached&&options.profiler){options.profiler.done()}else{twttr.messageManager.getThread(screenName,function(thread){if(twttr.isNarrow){var width=522}else{var width=($("#page-container").width()-$("#page-container .main-content").width());width=Math.min(618,Math.max(522,width))}var sendMessageBox=new twttr.components.SendMessageBox(screenName,width),messageThread=new twttr.components.MessageThread(thread);pushedView._backLabel=_("Conversation with {{screen_name}}",{screen_name:thread.threadId});sendMessageBox.bind("sentMessage",function(e,message){twttr.messageManager.addMessage(message)});sendMessageBox.$node.appendTo($pane.find(".pane-toolbar"));that.addComponentsToDetailsPane($pane,[messageThread]);if(options.profiler){options.profiler.done()}})}},focusStreamTab:function(tab){if(tab){this.$node.find(".stream-tabs li.stream-tab-"+tab).addClass("active").siblings().removeClass("active")}else{this.$node.find(".stream-tabs li.stream-tab").removeClass("active")}this._activeTab=tab;scribble("subnav",{item:tab})},openDetailsPane:function(){if(this._detailsPaneDisabled()){return false}var $detailsPane=this.$node.find("div.details-pane");if(!$detailsPane.hasClass("opened")){$detailsPane.show();this._slideDetailsPaneTo(this.$node.find(".main-content").width());this.$node.find("div.dashboard").hide();$detailsPane.addClass("opened")}this.repositionDetailsPane();this.resizeDetailsPane()},_slideDetailsPaneTo:function(left,cb){this.$find("div.details-pane")[Modernizr.csstransitions?"animateWithCss":"animate"]({left:left-10},250,Modernizr.csstransitions?"ease-out":"linear",cb)},closeDetailsPane:function(){if(this._detailsPaneDisabled()){return false}var $detailsPane=this.$node.find("div.details-pane");if($detailsPane.hasClass("opened")){this.panes.top().hide();this.$node.find("div.dashboard").show();this._slideDetailsPaneTo(0,function(){$(this).hide()});$detailsPane.removeClass("opened");scribble("close-details-pane",{input:"click",current_tweet_id:this.streamManager.getCurrent().focusedItemId})}},resizeDetailsPane:function(){var $detailsPane=this.$find("div.details-pane"),$pageOuter=$("#page-outer"),pagePaddingTop=parseInt($pageOuter.css("padding-top"),10);if($detailsPane.length>0){var $pageContainer=$("#page-container"),$mainContent=this.$find(".main-content"),pageWidth=$("#page-container").width(),mainContentWidth=$mainContent.width(),paneWidth=pageWidth-mainContentWidth,contentHeight=twttr.$win.height()-pagePaddingTop,dpHeight=contentHeight-$detailsPane[0].offsetTop-8;$mainContent.css("min-height",contentHeight);$detailsPane.height(dpHeight);$detailsPane.width(paneWidth);$detailsPane.find(".pane-components").height(dpHeight-$detailsPane.find(".inner-pane.active .pane-toolbar").outerHeight())}},repositionDetailsPane:function(){if(!twttr.decider.goodAtCss()||!this.$detailsPaneOuter){return }if(this.windowHasHorizontalScroll()){var scrollTop=twttr.$win.scrollTop();this.$detailsPaneOuter.addClass("tracking-vertically");this.$detailsPaneOuter.css({"margin-top":scrollTop,top:0})}else{var pagePaddingTop=parseInt(twttr.$elements.page.css("padding-top"),10);this.$detailsPaneOuter.removeClass("tracking-vertically");this.$detailsPaneOuter.css({"margin-top":null,top:pagePaddingTop})}},windowHasHorizontalScroll:function(){return twttr.$win.width()<1000},addComponentToDetailsPane:function($pane,component,operation){operation=operation||"append";if(this.dpProfiler&&component.profiler){this.dpProfiler.waitFor(component)}$pane.find(".pane-components-inner")[operation](component.$node)},addComponentsToDetailsPane:function($pane,components){for(var i=0;i<components.length;i++){this.addComponentToDetailsPane($pane,components[i])}this.dpProfiler.done()},onListFollowingChange:function(list){var streamList=new twttr.views.StreamList(list);this.$node.find(".stream-item[data-item-id=/"+list.user.screenName+"/"+list.slug+"]").html(streamList.html())}}).addViewData(function(){var ret={};ret["active_tab_"+this._activeTab]=1;return ret}).addAfterRender(function(){this.$detailsPaneOuter=this.$find("#details-pane-outer");this.resizeDetailsPane();if(!this.streamManager){this.streamManager=new twttr.streams.StreamManager();this.streamManager.bind("newItemsCountChanged",twttr.bind(this,function(e,itemCount){this.hasNewItems(itemCount)}));this.streamManager.bind("notFound",twttr.bind(this,function(e){this.trigger("notFound")}));this.streamManager.bind("switchTo",twttr.bind(this,function(e){this.closeDetailsPane()}))}this.$node.find("div.stream-manager").append(this.streamManager.$node);this.panes=new twttr.ViewStack(this.$node.find("div.details-pane"),"append")}).addOnSwitchAway(function(){if(this.streamManager){this.streamManager.onSwitchAway()}}).addOnSwitchTo(function(){this.resizeDetailsPane()}).keydown({f:function(e){if($(e.target).is(":not(input)")){e.preventDefault();var currentStream=this.streamManager.getCurrent();if(!currentStream.focusedItemId){return }currentStream.tweetActionFavorite(currentStream.getCurrentlyFocusedItem().find(".tweet"),"keyboard")}},r:function(e){if($(e.target).is(":not(input)")){e.preventDefault();var currentStream=this.streamManager.getCurrent();if(!currentStream.focusedItemId){return }currentStream.tweetActionReply(currentStream.getCurrentlyFocusedItem().find(".tweet"),"keyboard")}},t:function(e){if($(e.target).is(":not(input)")){e.preventDefault();var currentStream=this.streamManager.getCurrent();if(!currentStream.focusedItemId){return }currentStream.tweetActionRetweet(currentStream.getCurrentlyFocusedItem().find(".tweet"),"keyboard")}}}).keypress({"return":function(event){var currentStream=this.streamManager.getCurrent();event.preventDefault();var $target=this.$find(".stream-item[data-item-id="+currentStream.highlightedItemId+"]");this.toggleFocus($target)},period:function(e){twttr.$win.scrollTop(0);var stream=this.streamManager.getCurrent();stream.fetchTweets(twttr.bind(this,function(stream){if(stream.newItemsCount>0){stream._showNewItems();stream.restartFetcher()}var firstItem=stream.getFirstItem();stream.highlightItem(firstItem);stream.scrollStreamTo(firstItem);twttr.$win.scrollTop(0)}));twttr.components.JapaneseAd.refreshAds()}}).keypress({k:function(event){this.streamManager.getCurrent().highlightPrevious();event.preventDefault()},j:function(event){this.streamManager.getCurrent().highlightNext();event.preventDefault()}});return klass});twttr.klass.mixin("twttr.mixins.userActionable",function(klass){klass.methods({_doUserActionAndUpdateView:function(event,$target,action){var userId=twttr.helpers.getUserIdentifier($target);var impressionId=$target.attr("data-impression-id");twttr.API.User.find(userId,function(user){if(twttr.loggedIn){if(action=="follow"&&user["protected"]&&$target.parents(".user-small-list-item, user-detailed-list-item").length){twttr.showMessage(_("A follow request has been sent to {{user}}.",{user:(user.name||user.screenName)}))}user.reload()[action]({impression_id:impressionId})}else{if(action=="follow"){twttr.dialogs.signinOrSignup({follow:user}).open()}}});event.stopPropagation();$target.tipsy({stopThat:true});return false},_getUserActionsDropdown:function(user,element,data){var that=this;var items=[];items.push({label:_("Mention {{screen_name}}",data),icon:"mention",handlers:{click:function(){new twttr.widget.TweetDialog({template:{title:"Mention "+user.screenName},draggable:true,defaultContent:"@"+user.screenName+" ",origin:"profile-actions-dropdown-metion"}).open().focus()}}});items.push({label:_("Add to list"),icon:"user-list",handlers:{click:function(){new twttr.widget.ListMembershipDialog(user).open()}}});if(data.blocking){items.push({label:_("Unblock {{screen_name}}",data),icon:"block",handlers:{click:function(){user.unblock({before:function(){$('.stream .stream-tweet[data-user-id="'+user.id+'"]').closest(".stream-item").show()}})}}})}else{items.push({label:_("Block {{screen_name}}",data),icon:"block",handlers:{click:function(){user.block({timeout:function(request){request.retry()},error:function(){twttr.showError(_("Whoops! We weren't able to block that user. Try again in a minute"))}})}}})}if(!data.blocking){items.push({label:_('Report <span class="truncate">{{screen_name}}</span> for spam',data),icon:"spam",handlers:{click:function(){user.report({before:function(){$('.stream .stream-tweet[data-user-id="'+user.id+'"]').closest(".stream-item").hide()}})}}})}return new twttr.control.Dropdown(element,{itemView:twttr.views.UserDropdownItem,items:items,direction:"right"})}}).click({".follow-button, .follow-action, .follow-request-button":function(event,$target){return this._doUserActionAndUpdateView(event,$target,"follow")},".unfollow-link, .unfollow-action, .unfollow-button":function(event,$target){return this._doUserActionAndUpdateView(event,$target,"unfollow")},".cancel-request-link":function(event,$target){var userId=twttr.helpers.getUserIdentifier($target);var impressionId=$target.attr("data-impression-id");twttr.currentUser.friends.cancel(userId,{impression_id:impressionId});if($target.parents(".user-small-list-item, user-detailed-list-item").length){twttr.API.User.find(userId,function(user){twttr.showMessage(_("Your follow request to {{user}} has been cancelled.",{user:(user.name||user.screenName)}))})}event.stopPropagation();return false},".deny-follower-action":function(event,$target){var userId=parseInt($target.closest(".stream-item").attr("data-item-id"),10);twttr.currentUser.friends.deny(userId,function(user){$target.closest(".stream-item").remove()});event.stopImmediatePropagation();return false},".accept-follower-action":function(event,$target){var userId=parseInt($target.closest(".stream-item").attr("data-item-id"),10);twttr.currentUser.friends.accept(userId,function(user){new twttr.views.StreamUser(user).render($target.closest(".user-content-medium"),"replaceWith")});event.stopImmediatePropagation();return false},".stream .user-profile-actions-button":function(event,$target){var that=this;var userId=twttr.helpers.getUserIdentifier($target);if($target.attr("data-opened")){return }$target.attr("data-opened",true);twttr.API.User.find(userId,function(user){twttr.currentUser.relationshipWith(user,twttr.bind(this,function(relationship){var data={user:user,id:user.id,screen_name:user.screenName,notifications:relationship.notifications,following:relationship.following,followed_by:relationship.followedBy,blocking:relationship.blocking,follow_request_sent:user.followRequestSent,want_retweets:relationship.wantRetweets,reported:false};that.userProfileActionsDropdown=that._getUserActionsDropdown(user,$target,data);that.userProfileActionsDropdown.render($target,"after").open()}))});event.stopPropagation();return false}}).addAfterRender(function(){var updateFollowState=twttr.bind(this,function(userId,followKey,trueOrFalse){var that=this;twttr.API.User.find(userId,function(user){user.data(followKey,trueOrFalse);if(followKey=="following"&&trueOrFalse){user.data("recently_followed",true)}var $user=that.$find(".user-small-list-item[data-user-id="+user.id+"]");var impressionId=$user.attr("data-impression-id");if(impressionId){user=twttr.anywhere.api.util.PromotedStore.getPromotedUserInstance(user,impressionId)}var userItemActionView=new twttr.views.UserItemAction(user);that.$find(".user-follow-state[data-user-id="+user.id+"]").replaceWith(userItemActionView.html());user.data("recently_followed",null)})});var beforeAndErrorHandlers=function(followKey,trueOrFalse){return{before:function(event,request){var requestParameters=request.requestParameters[0];var userId=requestParameters.user_id;updateFollowState(userId,followKey,trueOrFalse)},error:function(event,response,request){var requestParameters=request.requestParameters[0],userId=requestParameters.user_id;updateFollowState(userId,followKey,!trueOrFalse)}}};twttr.API.User.bind("follow",beforeAndErrorHandlers("following",true));twttr.API.User.bind("unfollow",beforeAndErrorHandlers("following",false));twttr.API.User.bind("follow_request",beforeAndErrorHandlers("follow_request_sent",true));twttr.API.User.bind("cancel_request",beforeAndErrorHandlers("follow_request_sent",false))});return klass});twttr.klass.mixin("twttr.mixins.listActionable",function(klass){klass.methods({listDeleted:function(){},listUpdated:function(){},_setListFollowing:function(screenName,id,state){var action=state?"subscribe":"unsubscribe";var that=this;twttr.API.User.find(screenName,function(user){user.lists.find(id,function(list){list[action]({success:function(){list.following=state;list.attributes.following=state;that.onListFollowingChange(list)},error:function(){twttr.showError(_("There was an error "+(state?"":"un")+"subscribing to the list"));list.following=!state;list.attributes.following=!state;that.onListFollowingChange(list)}})})})},unfollowList:function(screenName,id){this._setListFollowing(screenName,id,false)},followList:function(screenName,id){this._setListFollowing(screenName,id,true)},onListFollowingChange:function(){}}).click({".stream .list-action-button":function(event,$target){if(!twttr.isNarrow){var that=this;var userId=twttr.helpers.getUserIdentifier($target);if($target.attr("data-opened")){return }$target.attr("data-opened",true);twttr.API.User.find(userId,function(user){twttr.viewHelpers.openListDropDown(user,$target,function(dropdown){dropdown.render($target,"after",{id:user.id,key:"lists"}).open()})});event.stopPropagation();return false}},".delete-list-button":function(event,$target){new twttr.widget.Prompt({modal:true,template:{title:_("Are you sure you want to delete this list?")},callback:function(okCancel){if(okCancel){twttr.currentUser.lists.find(parseInt($target.attr("data-list-id"),10),function(list){twttr.app.currentPage().listDeleted(list);list.destroy({error:function(){twttr.showError(_("There was an error deleting the list"))},success:function(){twttr.app.currentPage().listDeleted(list)}})})}}}).open();event.stopPropagation();return false},".edit-list-button":function(event,$target){twttr.currentUser.lists.find(parseInt($target.attr("data-list-id"),10),function(list){new twttr.widget.ListDialog({list:list,onSuccess:function(updatedList){twttr.app.currentPage().listUpdated(updatedList)}}).open()});event.stopPropagation();return false},".unfollow-list-button, .unfollow-list-link, .unfollow-list-action":function(event,$target){this.unfollowList($target.attr("data-screen-name"),$target.attr("data-list-id"));event.stopPropagation();return false},".follow-list-button, .follow-list-action":function(event,$target){this.followList($target.attr("data-screen-name"),$target.attr("data-list-id"));event.stopPropagation();return false}});return klass});twttr.klass.mixin("twttr.mixins.tweetActionable",function(klass){klass.methods({deletedTweetCacheDuration:1000*60*10,_updateTweetDisplay:function(tweetId,action){var that=this;this._deregisterTipsy();if(action==="delete"){twttr.showMessage(_("Your tweet has been deleted."));that.onTweetActionDelete(tweetId)}else{twttr.API.Status.find(tweetId,function(tweet){var $tweets=that.$find(".tweet[data-tweet-id="+tweetId+"]");switch(action){case"favorite":tweet.sync("favorited",true);$tweets.addClass("tweet-favorited");break;case"unfavorite":tweet.sync("favorited",false);$tweets.removeClass("tweet-favorited");break;case"retweet":tweet.sync("current_user_retweet",true);$tweets.addClass("tweet-retweeted");break;case"unretweet":tweet.sync("current_user_retweet",false);$tweets.removeClass("tweet-retweeted");break;case"hide":that.onTweetActionHide(tweetId);break;case"show":that.onTweetActionShow(tweetId);break}var tweetDogearView=new twttr.views.TweetDogear(tweet),tweetActionsView=new twttr.views.TweetActions(tweet);if(action==="unretweet"){tweetDogearView.retweeted=false;tweetActionsView.retweeted=false}$tweets.find(".tweet-dogear").replaceWith(tweetDogearView.html());$tweets.find(".tweet-actions").replaceWith(tweetActionsView.html())})}},onTweetActionDelete:function(tweetId){this.$find(".tweet[data-tweet-id="+tweetId+"]").remove()},onTweetActionHide:function(tweetId){this.$find(".tweet[data-tweet-id="+tweetId+"]").hide()},onTweetActionShow:function(tweetId){this.$find(".tweet[data-tweet-id="+tweetId+"]").show()},getTweetId:function($tweet){return $tweet.attr("data-tweet-id")},getScreenName:function($tweet){return $tweet.attr("data-screen-name")},getImpressionId:function($tweet){return $tweet.attr("data-impression-id")},getScribeComponent:function($tweet){return $tweet.is("div.details-pane .tweet")?"details-pane":$tweet.is("div.stream .tweet")?"stream":"generic-component"},tweetActionFavorite:function($tweet,inputSource){if(!$tweet||$tweet.length===0||!twttr.loggedIn){return }var tweetId=this.getTweetId($tweet),favorited=$tweet.hasClass("tweet-favorited"),apiMethod=favorited?"unfavorite":"favorite",impressionId=this.getImpressionId($tweet);twttr.API.Status[apiMethod](tweetId,{impression_id:impressionId,cacheOptions:{skipOverwrite:true}});var scribeData={input:inputSource,tweet_id:tweetId,favorited:!favorited,component:this.getScribeComponent($tweet)};if(!favorited){twttr.viewHelpers.addExtraLogging($tweet,scribeData,"favorite-tweet")}scribble("favorite-tweet",scribeData)},tweetActionRetweet:function($tweet,inputSource){if(!$tweet||$tweet.length===0||!twttr.loggedIn){return }var tweetId=this.getTweetId($tweet),screenName=this.getScreenName($tweet),impressionId=this.getImpressionId($tweet),retweeted=$tweet.hasClass("tweet-retweeted"),component=this.getScribeComponent($tweet);var protectedTweet=$tweet.find(".protected-icon").length;if(twttr.helpers.isCurrentUser(screenName)||(protectedTweet&&!retweeted)){return }if(retweeted){var myRetweetId=$tweet.attr("data-my-retweet-id");if(myRetweetId){twttr.API.Status.unretweet(myRetweetId)}}else{var tweetText=$tweet.find(".tweet-text").html();twttr.dialogs.retweet(tweetId,tweetText,function(shouldRetweet){if(shouldRetweet){twttr.API.Status.retweet(tweetId,{impression_id:impressionId});scribble("tweet",{tweet_type:"retweet",origin:"tweet-action-retweet",input:inputSource,component:component})}}).open()}var scribeData={input:inputSource,tweet_id:tweetId,component:component};twttr.viewHelpers.addExtraLogging($tweet,scribeData,"retweet-tweet-opened");scribble("retweet-tweet-opened",scribeData);if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","retweet_from_home_timeline",{tweet_id:tweetId})}},tweetActionReply:function($tweet,inputSource){if(!$tweet||$tweet.length===0||!twttr.loggedIn){return }var tweetId=this.getTweetId($tweet),impressionId=this.getImpressionId($tweet),screenName=$tweet.attr("data-screen-name"),component=this.getScribeComponent($tweet);twttr.dialogs.reply({$tweet:$tweet,tweetId:tweetId,impressionId:impressionId,screenName:screenName,origin:"tweet-action-reply",input:inputSource,component:component}).open();var scribeData={input:inputSource,tweet_id:tweetId,component:component};twttr.viewHelpers.addExtraLogging($tweet,scribeData,"reply-to-tweet-opened");scribble("reply-to-tweet-opened",scribeData);if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","reply_from_home_timeline",{tweet_id:tweetId})}},tweetActionDismiss:function($tweet,inputSource){$tweet.hide().siblings(".stream-item-feedback").show();$tweet.siblings(".more").hide();$tweet.parents(".stream-item").addClass("feedback-shown");if($tweet.parents(".stream-item").hasClass("focused-stream-item")){twttr.app.currentPage().closeDetailsPane()}},tweetActionUnDismiss:function($tweet){$tweet.siblings(".stream-item-feedback").hide();$tweet.show();$tweet.siblings(".more").css("display","");$tweet.parents(".stream-item").removeClass("feedback-shown")},tweetActionNotRelevant:function($tweet){var scribeData={query:$tweet.closest(".stream-items").attr("data-search-query"),tweet_id:this.getTweetId($tweet),stream_index:String($tweet.closest(".stream-item").parent().find(".stream-tweet:not(.promoted-tweet)").index($tweet))};scribble("not-relevant-tweet",scribeData)},tweetActionDelete:function($tweet,inputSource){var that=this;if(!$tweet||$tweet.length===0||!twttr.loggedIn){return }var tweetId=this.getTweetId($tweet),$tweet=$tweet.closest(".stream-item");new twttr.widget.Prompt({template:{title:_("Are you sure you want to delete this tweet?")},callback:function(ok){if(ok){twttr.API.Status.find(tweetId).destroy({success:function(){twttr.app.caches.deletedTweets.set(tweetId,true,that.deletedTweetCacheDuration)},error:function(resp){if(resp.reason&&JSON.parse(resp.reason)){reason=JSON.parse(resp.reason);twttr.showError(reason.error)}else{twttr.showError(_("An error occurred deleting that tweet."))}}})}}}).open();var scribeData={input:inputSource,tweet_id:tweetId,component:this.getScribeComponent($tweet)};scribble("delete-tweet-opened",scribeData)},_registerTweetActionAPIListeners:function(){var that=this;twttr.API.Status.bind("favorite",{before:function(event,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"favorite")},error:function(event,response,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"unfavorite");twttr.showError(JSON.parse(response.reason).error)}});twttr.API.Status.bind("unfavorite",{before:function(event,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"unfavorite")},error:function(event,response,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"favorite");twttr.showError(_("Whoops, we couldn't unfavorite that Tweet."))}});twttr.API.Status.bind("retweet",{before:function(event,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"retweet")},error:function(event,response,request){var tweetId=request.requestParameters[0];that._updateTweetDisplay(tweetId,"unretweet");twttr.showError(JSON.parse(response.reason).error)},success:function(event,retweet){var retweetId=retweet.retweetingStatus.id,tweetId=retweet.id;retweet.sync("current_user_retweet",{id:retweetId});that.$find(".tweet[data-tweet-id="+tweetId+"]").attr("data-my-retweet-id",retweetId)}});twttr.API.Status.bind("unretweet",{before:function(event,request){var myRetweetId=request.requestParameters[0].id;var $tweet=that.$find(".tweet[data-my-retweet-id="+myRetweetId+"]");var tweetId=$tweet.attr("data-tweet-id");that._updateTweetDisplay(tweetId,"unretweet")},error:function(event,response,request){var myRetweetId=request.requestParameters[0].id;var $tweet=that.$find(".tweet[data-my-retweet-id="+myRetweetId+"]");var tweetId=$tweet.attr("data-tweet-id");that._updateTweetDisplay(tweetId,"retweet")},success:function(event,response,request){var tweetId=response.id;var myRetweetId=response.retweetingStatus.id;that._updateTweetDisplay(tweetId,"unretweet");that.$find(".tweet[data-tweet-id="+tweetId+"]").attr("data-my-retweet-id",null)}});twttr.API.Status.bind("delete",{before:function(event,request){var tweetId=request.requestParameters[0].id;that._updateTweetDisplay(tweetId,"hide")},error:function(event,response,request){var tweetId=request.requestParameters[0].id;that._updateTweetDisplay(tweetId,"show")},success:function(event,response,request){var tweetId=response.id;that._updateTweetDisplay(tweetId,"delete")}})},registerTweetActionEvents:function(){var that=this;this.$node.delegate(".promoted-tweet .tweet-image","click",function(event){var $t=$(this).closest(".promoted-tweet");var impressionId=$t.attr("data-impression-id");twttr.API.util.PromotedContent.logProfileImageClick(impressionId)});this.$node.delegate(".promoted-tweet .tweet-screen-name","click",function(event){var $t=$(this).closest(".promoted-tweet");var impressionId=$t.attr("data-impression-id");twttr.API.util.PromotedContent.logScreenNameClick(impressionId)});this.$node.delegate(".tweet-actions .favorite-action, .tweet-actions .unfavorite-action","click",function(event){that.tweetActionFavorite($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".tweet-actions .reply-action","click",function(event){that.tweetActionReply($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".dismiss-action","click",function(event){that.tweetActionDismiss($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".tweet-actions .delete-action","click",function(event){that.tweetActionDelete($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".tweet-actions .retweet-action, .tweet-actions .unretweet-action","click",function(event){that.tweetActionRetweet($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".tweet-actions .not-relevant-action","click",function(event){that.tweetActionNotRelevant($(this).closest(".tweet"),"click");event.preventDefault();event.stopPropagation();return false});this._registerTipsy();this._registerTweetActionAPIListeners()},tweetFeedbackConfirmation:function($feedback){$feedback.find(".feedback-options").hide().siblings(".feedback-confirmation").show()},registerTweetFeedbackEvents:function(){var that=this;var logAndConfirm=function($this,linkType){var $feedback=$this.closest(".stream-item-feedback");var $tweet=$feedback.siblings(".tweet");switch(linkType){case"uninteresting":twttr.API.util.PromotedContent.logDismissUninteresting(that.getImpressionId($tweet));break;case"repetitive":twttr.API.util.PromotedContent.logDismissRepetitive(that.getImpressionId($tweet));break;case"spam":twttr.API.util.PromotedContent.logDismissSpam(that.getImpressionId($tweet));break;case"other":twttr.API.util.PromotedContent.logDismissOther(that.getImpressionId($tweet));break}that.tweetFeedbackConfirmation($feedback)};this.$node.delegate(".cancel-feedback","click",function(event){var $tweet=$(this).parents(".stream-item").find(".tweet");that.tweetActionUnDismiss($tweet);event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".close-feedback","click",function(event){var tweetId=$(this).parents(".stream-item").find(".tweet").attr("data-tweet-id");that.onTweetActionDelete(tweetId);event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".feedback-uninteresting","click",function(event){logAndConfirm($(this),"uninteresting");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".feedback-repetitive","click",function(event){logAndConfirm($(this),"repetitive");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".feedback-spam","click",function(event){logAndConfirm($(this),"spam");event.preventDefault();event.stopPropagation();return false});this.$node.delegate(".feedback-other","click",function(event){logAndConfirm($(this),"other");event.preventDefault();event.stopPropagation();return false})},_registerTipsy:function(){if(twttr.decider.isAvailable("new_tweet_labels")){$(".tweet-actions a",this.$node[0]).tipsy({gravity:"s",live:true})}},_deregisterTipsy:function(){this.$find(".tweet-actions a").tipsy({stopThat:true})}});return klass});twttr.klass.mixin("twttr.mixins.i18nTweet",function(){var rtlThreshold=0.3;var rtlCharRegex=new RegExp("([\u0600-\u06FF]|[\u0750-\u077F]|[\u0590-\u05FF]|[\uFE70-\uFEFF])","mg");var leftToRightElementRegex=/((@?<a[^>+]+>\S+<\/a>|[ ^]RT:|:-?[DP\$\)\(])+)/g;this.methods({updateI18nDisplay:function(){var that=this;if(twttr.decider.isAvailable("rtl_display")){this.$find(".tweet").each(function(){that._updateRtlDisplay($(this))})}},_updateRtlDisplay:function($tweet){var that=this;var $tweetText=$tweet.find(".tweet-text");if($tweetText.hasClass("tweet-text-rtl")){return }var matchedRtlChars=$tweetText.text().match(rtlCharRegex);if(matchedRtlChars!=undefined&&(matchedRtlChars.length/$tweetText.text().length)>rtlThreshold){$tweetText.addClass("tweet-text-rtl");$tweetText.html($tweetText.html().replace(leftToRightElementRegex,"\u200E$1\u200F"));$tweetText.addClass("tweet-rtl")}}})});twttr.klass.mixin("twttr.mixins.userRecommendationsHelper",function(klass){klass.methods({INTERESTING_RATING:6,BLOCK_RATING:5,USEFUL_RATING:1,userRecommendationsAvailable:function(isProfile){if(twttr.loggedIn){return isProfile?twttr.decider.isAvailable("whotofollow_similarities"):twttr.decider.isAvailable("whotofollow_recommendations")}else{return twttr.decider.isAvailable("whotofollow_logged_out_similarities")}},trackImpressions:function(users,eventName,data,swapForUserId){if(users&&users.length()){var userIds=users.map(function(u,i){return u.id});if(swapForUserId){this.currentRecommendations=this.currentRecommendations.map(function(id,i){if(id==swapForUserId){return userIds.first()}else{return id}})}else{this.currentRecommendations=userIds}var trackingData={recommended_users:userIds.toArray(),recommended_users_count:userIds.length(),tokens:users.map(function(u,i){return u.feedback||"0"}).toArray()};twttr.merge(trackingData,data||{});scribble(eventName,this.mergeSimilarUserId(trackingData),"whotofollow")}},logPromotedImpressions:function(users){users.each(function(user){if(user.promotedContent){twttr.API.util.PromotedContent.logImpression(user.promotedContent.impression_id);twttr.abdecider.track("wtf_rotation-28","promoted_account_impression")}twttr.abdecider.track("wtf_rotation-28","account_impression")})},mergeSimilarUserId:function(data){if(this.screenName){var similarUserId=this.similarUser&&this.similarUser.id||twttr.profileUser.id;$.extend(data,{to_user_id:similarUserId})}data.phoenix_enabled=true;return data},recsToUsers:function(recs){return recs.map(twttr.bind(this,function(rec,i){var isInStream=(this._namespace=="twttr.streams.UserRecommendationsStream");return rec.user.clone({feedback:rec.token,dismissable:!this.screenName||(isInStream&&twttr.currentUser.id==twttr.profileUser.id),socialcontext:this.makeSocialContextHtml(rec,isInStream)})}))},makeSocialContextHtml:function(rec,isInStream){var connections=rec.attributes.connections;var output="";if(!this.screenName&&connections&&connections.length){var userHtml=function(k){return(new twttr.views.UserLink(connections[k])).html()},other=null;if(isInStream){switch(connections.length){case 1:output+=_("Followed by {{{user}}}.",{user:userHtml(0)});break;case 2:output+=_("Followed by {{{first}}} and {{{second}}}.",{first:userHtml(0),second:userHtml(1)});break;case 3:output+=_("Followed by {{{first}}}, {{{second}}} and {{{third}}}.",{first:userHtml(0),second:userHtml(1),third:userHtml(2)});break;case 4:other=userHtml(3);default:output+=_("Followed by {{{first}}}, {{{second}}}, {{{third}}} and {{{other}}}.",{first:userHtml(0),second:userHtml(1),third:userHtml(2),other:other||_("{{count}} others",{count:connections.length>13?"10+":connections.length-3})})}}else{switch(connections.length){case 1:output+=_("Followed by {{{user}}}.",{user:userHtml(0)});break;default:output+=_('Followed by {{{user}}} and <a href="{{url}}">others</a>.',{user:userHtml(0),url:twttr.router.followersYouFollowPath({screen_name:rec.user.screenName})})}}}return output},fetch:function(options){if(this.screenName){twttr.profileUser.similarUsers(options)}else{twttr.currentUser.recommendedUsers(options)}},attachUserRecommendationProfileEvents:function(eventName,$node){var that=this;var profileSelector=".user-small-list-item .user-profile-link, .user-detailed-list-item .user-profile-link,.stream-item-content";$node.delegate(profileSelector,"click",function(e){var $this=$(this);if($this.is(".stream-item-content")){if($(e.target).closest("div").is(".dismiss, .follow-button")){return }var $targetItem=$this}else{var $targetItem=$this.closest(".user-small-list-item, .user-detailed-list-item")}var feedback=$targetItem.attr("data-feedback-token")||"0",recId=parseInt($targetItem.attr("data-user-id")),impressionId=$targetItem.attr("data-impression-id"),data=that.mergeSimilarUserId({rating:that.INTERESTING_RATING,recommended_user_id:recId,token:feedback});if(!recId){return }that.updateTwttrPromotedAccount(recId,impressionId);if($this.hasClass("user-screen-name")){if(impressionId){twttr.abdecider.track("wtf_rotation-28","promoted_screen_name_click")}twttr.abdecider.track("wtf_rotation-28","screen_name_click");twttr.API.util.PromotedContent.logScreenNameClick(impressionId)}else{if($this.hasClass("user-thumb")){if(impressionId){twttr.abdecider.track("wtf_rotation-28","promoted_profile_click")}twttr.abdecider.track("wtf_rotation-28","profile_click");twttr.API.util.PromotedContent.logProfileImageClick(impressionId)}}twttr.API.UserRecommendation.rate(data);scribble(eventName,data,"whotofollow");scribble("view-profile",{profile_user_id:recId,component:that._namespace.indexOf(".stream.")?"stream":"dashboard",subcomponent:"who-to-follow",target:$(e.target).is("a")?"link":"image"})})},attachUserRecommendationFollowEvents:function(eventName,$node){var that=this;$node.delegate(".user-follow-link, .follow-button","click",function(e){var $targetItem=$(this).closest(".user-small-list-item, .stream-item-content, .user-detailed-list-item"),recId=parseInt($targetItem.attr("data-user-id")),data=that.mergeSimilarUserId({rating:that.USEFUL_RATING,recommended_user_id:recId,token:$targetItem.attr("data-feedback-token")||"0"});twttr.API.UserRecommendation.rate(data);scribble(eventName,data,"whotofollow");scribble("follow-user",{profile_user_id:recId,component:that._namespace.indexOf(".stream.")?"stream":"dashboard",subcomponent:"who-to-follow"});if($targetItem.attr("data-impression-id")){twttr.abdecider.track("wtf_rotation-28","promoted_follow_click")}twttr.abdecider.track("wtf_rotation-28","follow_click")})},attachUserRecommendationDismissEvents:function(eventName,$node){var that=this;$node.delegate(".user-small-list-item .dismiss, .stream-item-content a.dismiss","click",function(e){var $targetItem=$(this).closest(".user-small-list-item, .stream-item-content");var hiddenRecId=parseInt($targetItem.attr("data-user-id"));var impressionId=$targetItem.attr("data-impression-id");var feedback=$targetItem.attr("data-feedback-token")||"0";$targetItem.animate({opacity:0},200);twttr.API.util.PromotedContent.logDismissUser(impressionId);if(impressionId){twttr.abdecider.track("wtf_rotation-28","promoted_block")}twttr.abdecider.track("wtf_rotation-28","block");var hideOK=function(userRecs){var users;if($targetItem.hasClass("user-small-list-item")){if(userRecs&&userRecs.length()&&!twttr.is.inArray(userRecs.first().user.id,that.currentRecommendations.toArray())){users=that.recsToUsers(userRecs);var nextUser=users.first();if(nextUser){var $nextRec=$((new twttr.views.UserSmallListItem(nextUser)).html());$nextRec.css({opacity:0});$targetItem.replaceWith($nextRec);$nextRec.animate({opacity:1},300);that.trackImpressions(users,"whotofollow_sidebar_replace_dismissed",twttr.merge({recommended_user_id:hiddenRecId},data),hiddenRecId)}}else{$targetItem.fadeOut(200,function(){$targetItem.animate({height:1},100,null,function(){$targetItem.remove();if(that.$find("ul.recommended-followers > li.user-small-list-item").length==0){that.trigger("notRendered","noMoreRecommendations");that.$node.empty()}})})}}else{var $targetItemParent=$targetItem.parent(".stream-item");$targetItemParent.slideUp(100,function(){$targetItemParent.remove()})}if($targetItem.find(".follow-action, .follow-button").length||that.screenName){scribble(eventName,that.mergeSimilarUserId({token:feedback,recommended_user_id:hiddenRecId,rating:that.BLOCK_RATING}),"whotofollow")}};var hideFail=function(){twttr.showError(_("Whoops! Something went wrong. Please try again!"));$targetItem.css({opacity:1})};var data=that.mergeSimilarUserId({excluded:that.currentRecommendations.join(","),success:hideOK,error:hideFail,pc:!!impressionId});var apiData=twttr.merge({user_id:data.to_user_id},data);if($targetItem.find(".unfollow-action").length){that.fetch(twttr.merge(apiData,{limit:1}))}else{if($targetItem.find(".unfollow-button").length&&twttr.audit.currentPage()!="similar_to"){hideOK()}else{apiData=twttr.merge({connections:true},apiData);twttr.API.UserRecommendation.hide(hiddenRecId,feedback,apiData)}}})},attachUserRecommendationHideEvents:function(){this.$find(".profile-actions > .dismiss").click(twttr.bind(this,function(){this.$find(".user-rec-dropdown").fadeOut(300)}))},updateTwttrPromotedAccount:function(recId,impressionId){if(impressionId){twttr.promotedAccount={id:recId,impressionId:impressionId}}else{twttr.promotedAccount=null}}});return klass});twttr.klass.mixin("twttr.mixins.discoveryHelper",function(klass){klass.methods({pagePathFor:function(pathRoot,action,params){return twttr.router[pathRoot+(action||"")+"Path"](params)},routePageTo:function(pathRoot,action,params){twttr.router.routeTo(this.pagePathFor(pathRoot,action,params))}});return klass});twttr.klass.mixin("twttr.mixins.componentEvents",function(klass){$.each(twttr.constants.jQueryEvents,function(which,eventType){klass[eventType]=function(handlers){if(twttr.is.inArray(eventType,["keypress","keydown","keyup"])){$.each(handlers,function(whichHandler,handler){handlers[whichHandler]=function(e){return e.ctrlKey||e.metaKey?undefined:handler.apply(this,arguments)}})}if(!this.prototype.hasOwnProperty("_"+eventType)){if(this.uberclass&&this.uberclass.prototype["_"+eventType]){this.prototype["_"+eventType]=twttr.util.create(this.uberclass.prototype["_"+eventType])}else{this.prototype["_"+eventType]={}}}twttr.augmentObject(this.prototype["_"+eventType],handlers);return this}});klass.methods({initComponentEvents:function(){var that=this;$.each(twttr.constants.jQueryEvents,function(which,eventType){if(twttr.is.inArray(eventType,["keypress","keydown","keyup"])){return }$.each(that["_"+eventType]||{},function(selector,handler){var args=[selector,eventType];var handlers=$.isArray(handler)?handler:[handler];$.each(handlers,function(which,handler){args.push(function(event){if(!event.isImmediatePropagationStopped()){return handler.call(that,event,$(this))}})});that.$node.delegate.apply(that.$node,args)})})}});return klass});twttr.klass.mixin("twttr.mixins.usesRelatedResults",function(klass){klass.methods({_conversationRoleFor:function(result){return result.annotations.ConversationRole},tweetsForConversationRole:function(conversationGroup,role){var that=this;var results=twttr.filter(conversationGroup.results.array,function(ea){return that._conversationRoleFor(ea)===role});return twttr.map(results,function(ea){return ea.value})},_groupNamed:function(resultGroups,name){return twttr.filter(resultGroups.array,function(ea){return ea.groupName===name})[0]},conversationGroupFor:function(resultGroups){return this._groupNamed(resultGroups,"TweetsWithConversation")},repliesGroupFor:function(resultGroups){return this._groupNamed(resultGroups,"TweetsWithReply")},withRelatedResults:function(tweet,currentStream,options){var that=this;twttr.API.Status.related(tweet.id,{include_entities:1,success:function(resultGroups){that._logResultGroups(resultGroups,tweet);options.success(resultGroups)},error:options.error||function(){}})},_logResultGroups:function(resultGroups,tweet){var that=this;var relatedImpressionId=(new Date()).getTime()+"-"+(twttr.currentUser?twttr.currentUser.id:"guest")+"-"+tweet.id;var groups=[];var scribeData={related_impression_id:relatedImpressionId,groups:groups};var abData;$.each(resultGroups.array,function(i,resultGroup){var annotations=[];var tweets=[];groups.push(that._scribeDataFor(resultGroup,i));if(!abData){abData=that._abDataFor(resultGroup)}resultGroup.sync("relatedImpressionId",relatedImpressionId)});scribble("show-related-tweets",scribeData);if(abData){scribble("show-related-tweets",abData,"www_ab_testing")}},_scribeDataFor:function(resultGroup,index){var moduleData={pos:index,groupName:resultGroup.groupName,resultType:resultGroup.resultType,annotations:this._annotationsFor(resultGroup),tweets:this._tweetsFor(resultGroup)};resultGroup.sync("relatedGroupName",resultGroup.groupName);return moduleData},_abDataFor:function(resultGroup){var abData;for(var k in resultGroup.annotations){if(k=="abData"){if(!abData){abData=resultGroup.annotations[k]}}}if(abData){for(var key in abData){resultGroup.sync("ab_data_"+key,abData[key])}}return abData},_annotationsFor:function(resultGroup){var annotations=[],annotationValue="";for(var i in resultGroup.annotations){if(i!="abData"){var ele={type:i,value:resultGroup.annotations[i]};annotations.push(ele);annotationValue+=resultGroup.annotations[i]+" "}}if(annotationValue.length>0){annotationValue=annotationValue.substring(0,annotationValue.length-1)}resultGroup.sync("relatedAnnotations",annotationValue);return annotations},_tweetsFor:function(resultGroup){var tweets=[];$.each(resultGroup.results.array,function(index,result){if(resultGroup.resultType=="Tweet"){tweets.push(result.value.id)}else{}});return tweets}});return klass});twttr.klass.mixin("twttr.mixins.profileHelper",function(klass){klass.methods({getUserInfo:function(screenName,cb){this._screenName=screenName;twttr.API.User.find(this._screenName,{success:twttr.bind(this,function(profileUser){this.profileUser=twttr.profileUser=profileUser;if(cb){cb()}}),error:twttr.bind(this,function(e){this.trigger("notFound")})})},noAutoRender:true}).addViewData(function(){return{profile_user:new twttr.views.ProfileUser(twttr.profileUser)}});return klass});twttr.klass.mixin("twttr.mixins.commonDashboardClickHandlers",function(klass){klass.click({".title-link":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:klass._name,target:"dashboard_title",item:$target.find(".dashboard-component-title").html()};scribble("dashboard_click",logData)},".user-profile-link":function(e,$target){var isImage=$target.is("img")||$target.find("img")[0];var userId=$target.attr("data-user-id")||$target.closest("a").attr("data-user-id");var logData={input:"click",component:"dashboard",subcomponent:klass._name,target:"user_profile_link",target_type:isImage?"image":"link",user_id:userId};scribble("dashboard_click",logData)}});return klass});twttr.klass("twttr.streams.StarterList",function(params,initialItems){twttr.streams.ListMembers.apply(this,arguments)}).subclassOf(twttr.streams.ListMembers).mixin(twttr.mixins.discoveryHelper).methods({update:function(options){this.params.list.members(options)},_setTitle:function(cb){cb(_("{{name}} suggests you also follow these accounts:",this.params.list.user.attributes))},_getEmptyStreamHtml:function(){return _("Sorry, {{name}} doesn't recommend anybody in particular.<br />Find users by <a href='{{url}}'>Interests</a>.",{url:this.pagePathFor(this.params.pathRoot,"Interests"),name:this.params.list.user.name})}});twttr.stream("twttr.streams.StarterFriends",function(){twttr.streams.UserStream.apply(this,arguments)}).subclassOf(twttr.streams.UserStream).methods({update:function(options){var that=this;twttr.API.User.find(this.screenName,function(user){if(!twttr.helpers.canViewUser(user)){that._showError(twttr.streams.PROTECTED);that.doneLoadingMore();return }user.friends(options)})},_setTitle:function(cb){cb(_("@{{screen_name}} follows these accounts:",{screen_name:this.screenName}))}}).statics({_deciderKey:"people_stream_friends"});twttr.klass("twttr.streams.UserRecommendationsStream",function(params,initialItems){twttr.streams.UserStream.apply(this,arguments);this.attachUserRecommendationProfileEvents("whotofollow_stream_profile_click",this.$node);this.attachUserRecommendationFollowEvents("whotofollow_stream_follow",this.$node);this.attachUserRecommendationDismissEvents("whotofollow_stream_block",this.$node)}).subclassOf(twttr.streams.UserStream).mixin(twttr.mixins.userRecommendationsHelper).methods({update:function(options){var that=this,oldSuccess=options.success;var eventName,trackingContext;if(that.params.screenName!=null){eventName="whotofollow_view_all_similar_users";trackingContext="similar_to"}else{eventName="whotofollow_view_all_recommended_users";trackingContext="find_users"}var sulFallback=function(){var opts={success:oldSuccess};if(that.params.lang){opts.lang=that.params.lang}if(that.params.country){opts.country=that.params.country}if(that.params.city){opts.city=that.params.city}twttr.API.SuggestionCategory.randomSample(opts);that.sulFallback=true;that._streamManager.setTitle(that)};options.success=function(userRecs,data){if(that.params.screenName||!twttr.decider.isAvailable("whotofollow_random_sample")||userRecs.length()){that.sulFallback=false;var users=that.recsToUsers(userRecs);that.trackImpressions(users,eventName,{tracking_context:trackingContext});oldSuccess(users,data)}else{sulFallback()}};options.connections=!that.params.screenName;this.params.screenName?twttr.profileUser.similarUsers(options):twttr.currentUser.recommendedUsers(options)},setStreamManager:function(streamManager){this._streamManager=streamManager},_setTitle:function(cb){if(this.params.screenName){cb(_("Accounts similar to @{{screen_name}}:",{screen_name:twttr.profileUser.screenName}))}else{if(this.sulFallback){cb(_('We\'re building a list of personalized suggestions for you. In the meantime, here are some other <a href="{{url}}">interesting accounts</a> to follow.',{url:twttr.router.whoToFollowInterestsPath()}))}else{cb(_("Twitter accounts suggested for you based on who you follow and more."))}}},_getEmptyStreamHtml:function(){return _("Sorry, we've temporarily run out of recommendations for you. We're out there looking for more right now. Please check back soon!")}});twttr.klass("twttr.streams.ContactImportMatches",function(params,initialItems){params.pathRoot=params.pathRoot||"whoToFollow";twttr.streams.UserStream.apply(this,arguments);this.$node.addClass("contact-import-matches");this._loadedMatches=false;this._loadingCount=this.constructor._retryCount;this._loadingComponent=new twttr.views.ContactImportLoading();var that=this;this.$node.delegate(".email-nudge-button","click",function(e){var email=$(this).attr("data-email");that._nudge(email,$(this));e.preventDefault();return false})}).subclassOf(twttr.streams.UserStream).mixin(twttr.mixins.userRecommendationsHelper).mixin(twttr.mixins.discoveryHelper).methods({afterSwitchingToAgain:function(){this.afterFirstSwitchingTo()},beforeSwitchingAway:function(){if(this._timeout){window.clearTimeout(this._timeout);this._timeout=null}},update:function(options){this._loadingError=false;var that=this;var oldSuccess=options.success;var oldError=options.error;options.success=function(users,data){that._loadedMatches="users" in data.response;if(that._loadedMatches){delete that._loadingComponent;if(data.response.count){that.showInviteesPopup=!!data.response.others_count&&that.params.pathRoot=="welcome";var componentData=twttr.merge(data.response,{retry_service_path:that.pagePathFor(that.params.pathRoot,"Import")});that._matchesHeaderComponent=new twttr.components.ContactImportMatchesStats(that,componentData);users.array.push.apply(users.array,data.response.undiscoverable_users)}else{if(data.response.others_count){that._inviteOthersInline()}else{window.setTimeout(function(){that.routePageTo(that.params.pathRoot,"Import");twttr.showMessage(_("There was no one in your address book"))},0)}}}oldSuccess(users,data);if(!that._loadedMatches){if(that._loadingCount-->0){that._scheduleRetry()}else{that._loadingCount=that.constructor._retryCount;that._showError(twttr.streams.TIMEOUT)}}};options.error=function(e,data){if(e.error=="denied"){that.routePageTo(that.params.pathRoot,"Import");twttr.showMessage(_("Authorization to access your contacts was denied"));return }if(e.error){that._loadingError=true}oldError(e,data)};twttr.API.AddressBook.contactsMatches(options)},_scribbleUsers:function(users){var userIds=[],nonUserEmails=[];users.each(function(user){if(user.screenName){userIds.push(user.id)}else{nonUserEmails.push(user.email)}});var userData={item_ids:userIds,item_count:userIds.length};var nonUserData={item_names:nonUserEmails,item_count:nonUserEmails.length};if(this.page){userData.cursor_or_page=nonUserData.cursor_or_page=this.page}if(this.cursor){userData.cursor_or_page=nonUserData.cursor_or_page=this.cursor}this.scribbler.scribe({component:"stream",action:"found_results"},userData);this.scribbler.scribe({component:"stream",action:"not_found_results"},nonUserData)},_nudge:function(email,$button){var that=this;if($button.hasClass("disabled")){return }$button.addClass("disabled");options={success:function(){$button.removeClass("disabled");for(var i=0;i<that.items.length;++i){var user=that.items[i];if(user.email==email){user.sent_nudge=true;that.rerenderItem(user.email,user);that.scribbler.scribe({component:"stream",action:"nudge"},{event_info:user.email});break}}},error:function(){$button.removeClass("disabled");twttr.showError(_("There was an error sending that request."))}};twttr.API.AddressBook.nudgeUndiscoverableContact(email,options)},_followAll:function($button){var that=this;if($button.hasClass("disabled")){return }$button.addClass("disabled");var options={success:function(response,data){$button.removeClass("disabled");var message="";switch(response.followed_ids.length){case 0:message=_("Requests were sent to everybody.");break;case 1:message=_("Congratulations! You are now following 1 more user.");break;default:message=_("Congratulations! You are now following {{count}} more users.",{count:response.followed_ids.length})}twttr.showMessage(message);twttr.API.User.findAllCached(response.followed_ids).each(function(user){user.data("following",true);var fakeRequest={requestParameters:[{user_id:user.id}]};twttr.anywhere.api.models.User.trigger("follow_before",fakeRequest);twttr.anywhere.api.models.User.trigger("follow_success",user)});twttr.API.User.findAllCached(response.requested_ids).each(function(user){user.data("follow_request_sent",true);eventName="follow_request";var fakeRequest={requestParameters:[{user_id:user.id}]};twttr.anywhere.api.models.User.trigger("follow_request_before",fakeRequest);twttr.anywhere.api.models.User.trigger("follow_request_success",user)});that.scribbler.scribe({component:"stream_header",action:"follow"},{event_value:response.followed_ids.length,context:"import"});that.scribbler.scribe({component:"stream_header",action:"follow_all"},{item_count:response.followed_ids.length,context:"import"})},error:function(err){$button.removeClass("disabled");twttr.showError(_("There was an error following your contacts."))}};twttr.API.AddressBook.followAllContacts(options)},_saveAsList:function(){var that=this;new twttr.widget.ListDialog({template:{content:new twttr.views.ListDialog({name:_("Friends"),mode:"private"}).html()},onSuccess:function(list){options={success:function(user_ids,data){twttr.API.User.findAllCached(user_ids).each(function(user){if(that.isDuplicate(user)){that.rerenderItem(user.id,user)}});that.scribbler.scribe({component:"stream_header",action:"save_list"},{event_value:user_ids.length,item_count:user_ids.length})},error:function(){twttr.showError(_("There was an error adding your contacts to the list."))}};twttr.API.AddressBook.addContactsToList(list.id,options)}}).open()},inviteOthers:function(routeToHome){this.showInviteesPopup=false;var that=this;var options={success:function(contacts,data){that.scribbler.scribe({component:"invite_contacts_dialog",action:"open"});that.inviteDialog=new twttr.widget.InviteContactsDialog(data.response,{css:{},onSuccess:function(){this.close()},scribbler:that.scribbler,routeToHome:routeToHome}).open()}};twttr.API.AddressBook.contactsOthers(options)},_inviteOthersInline:function(){this.showInviteesPopup=false;this._suppressStreamEnd=true;var that=this;var options={success:function(contacts,data){that.doneLoadingMore();var response=twttr.merge(data.response,{title:_("{{count}} of your contacts aren't yet on Twitter. Invite them.",{count:contacts.length})});var inviteContactsComponent=new twttr.components.InviteContacts(response,{scribbler:that.scribbler});that.scribbler.scribe({component:"invite_contacts",action:"impression"});that.$node.find(".stream-items").append(inviteContactsComponent.$node);that.reachedTheEnd()},error:function(error){that.doneLoadingMore();that._loadingError=true;that._showError(twttr.streams.ERROR)}};twttr.API.AddressBook.contactsOthers(options);window.setTimeout(function(){that._loadingComponent=new twttr.views.ContactImportLoading();that.isLoadingMore()},0)},_scheduleRetry:function(){var that=this;this._timeout=window.setTimeout(function(){that._timeout=null;that._loadingComponent=new twttr.views.ContactImportLoading();that.getMoreOldItems()},3000);this.isLoadingMore()},_renderItemHtml:function(item){this.itemIds=this.itemIds||{};var itemId=this.streamItemId?this.streamItemId(item):item.id;this.itemIds[itemId]=1;if(item instanceof twttr.anywhere.api.models.User){return new twttr.views.StreamItem({item_html:new twttr.views.StreamUser(item).html(),item_id:itemId,item_type:"user"}).html()}else{return new twttr.views.NudgeableUser(item).html()}},_renderItemsHtml:function(items){var prefix="";if(items.length){prefix='<div class="fake-first-child"></div>'}return prefix+this.constructor.uber._renderItemsHtml.call(this,items)},itemSelector:function(itemId){return".stream-item[data-item-id="+itemId+"],.unselectable-stream-item[data-item-id="+itemId+"]"},getStreamItemType:function(item){if(item.constructor==twttr.anywhere.api.models.User){return"user"}else{return"nudgeable-user"}},_getStreamLoadingComponent:function(){return this._loadingComponent||this.constructor.uber._getStreamLoadingComponent.call(this)},_getStreamErrorComponent:function(status){if(this._loadingError){var component=new twttr.components.ContactImportErrorEnd();var that=this;component.bind("tryImportAgain",function(e){that.routePageTo(that.params.pathRoot,"Import")});return component}else{return this.constructor.uber._getStreamErrorComponent.apply(this,arguments)}},_setTitle:function(cb){cb(_("Search the services you use to discover which of your friends are already using Twitter. Follow any of the friends you find to add their Tweets to your timeline."))},_getHeaderComponent:function(){return this._matchesHeaderComponent}}).statics({_deciderKey:"contact_import_stream",_retryCount:5});twttr.klass("twttr.streams.ContactImportServices",function(params,initialItems){params.pathRoot=params.pathRoot||"whoToFollow";twttr.streams.Stream.apply(this,arguments);var that=this;this.$node.addClass("contact-import-services");this.$node.delegate("div.service-button","click",function(e){var $this=$(this);var serviceName=$this.find("strong.service-name").attr("data-service-id");var data={query:serviceName};if($this.hasClass("selected")){data.event_info="selected"}that.scribbler.scribe({component:"stream",action:"launch_service"},data);var url=$this.attr("data-url");if(url){var newWindow;if($this.attr("data-popup")=="true"){var sep=url.indexOf("?")==-1?"?":"&";url+=sep+"callback_hash="+encodeURIComponent(that.pagePathFor(params.pathRoot,"ImportMatches"));var $window=$(window),parentTop=window.screenY||window.screenTop||0,parentLeft=window.screenX||window.screenLeft||0;var popupTop=($window.height()-500)/2+parentTop,popupLeft=($window.width()-500)/2+parentLeft;var options=["width=500","height=500","top="+popupTop,"left="+popupLeft,"toolbar=no","location=yes"];newWindow=window.open(url,"twitter_oauth",options.join(","))}else{newWindow=window.open(url,"_blank")}newWindow.focus();that._streamManager.clearFromCache(twttr.streams.ContactImportMatches,{pathRoot:params.pathRoot})}e.preventDefault()})}).subclassOf(twttr.streams.Stream).mixin(twttr.mixins.discoveryHelper).methods({setStreamManager:function(streamManager){this._streamManager=streamManager},update:function(options){if(this.params.lang){options.lang=this.params.lang}if(this.params.country){options.country=this.params.country}twttr.API.AddressBook.contactsServices(options)},afterFirstSwitchingTo:function(callback){this.getMoreOldItems();callback&&callback()},_fetchItems:function(cb){var that=this;if(this.constructor._deciderKey&&!twttr.decider.isAvailable(this.constructor._deciderKey)){cb(this,twttr.streams.DECIDER);return }var opts={success:function(services,data){that.push(services);that.reachedTheEnd();var matchedEmail;var serviceNames=twttr.map(services,function(service,idx){if(service.matched_email){matchedEmail=service.matched_email}return service.id});var scribeData={item_names:serviceNames,item_count:serviceNames.length};if(matchedEmail){scribeData.event_info=matchedEmail}that.scribbler.scribe({component:"stream",action:"results"},scribeData);cb(that,twttr.streams.SUCCESS)},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}}};this.update(opts)},_renderItemsHtml:function(services){var matchedService=null;for(var i=0;i<services.length;++i){if(services[i].matched_email){matchedService=services[i]}}return new twttr.views.ContactImportServices({services:services,matched_service:matchedService,matched_service_name:(matchedService||{}).name}).html()},_setTitle:function(cb){cb(_("Search the services you use to discover which of your friends are already using Twitter. Follow any of the friends you find to add their Tweets to your timeline."))},_getStreamEndComponent:function(){return new twttr.components.Base()}}).statics({_deciderKey:"contact_import_stream"});twttr.klass("twttr.StoredUserStack",function(ns){this.storageKey=ns;var initialData=twttr.caches.User.get(this.storageKey);this.cache=initialData?initialData.index:{};this.stack=initialData?initialData.stack:[]}).methods(twttr.EventProvider).statics({MAX_SIZE:10}).methods({push:function(u){if(!twttr.helpers.isCurrentUser(u)){var k=u.id||u.toString();if(twttr.is.def(this.cache[k])){this.stack=twttr.filter(this.stack,function(q){return q!=k})}this.cache[k]=this.stack.push(k);if(this.size()>this.MAX_SIZE){delete this.cache[this.stack.shift()]}this.trigger("push",k)}return this.save()},save:function(){twttr.caches.User.set(this.storageKey,{index:this.cache,stack:this.stack});return this.size()},clear:function(){this.cache={};this.stack=[];this.save()},size:function(){return this.stack.length},getLatestUserId:function(){var s=this.size();return s?this.stack[s-1]:null},findAll:function(cb){twttr.API.User.findAll(this.stack.reverse(),cb)}});twttr.augmentString("twttr.util.natcompare",function(){var isWhitespaceChar=function(a){var charCode;charCode=a.charCodeAt(0);if(charCode<=32){return true}else{return false}};var isDigitChar=function(a){var charCode;charCode=a.charCodeAt(0);if(charCode>=48&&charCode<=57){return true}else{return false}};var compareRight=function(a,b){var bias=0;var ia=0;var ib=0;var ca;var cb;for(;;ia++,ib++){ca=a.charAt(ia);cb=b.charAt(ib);if(!isDigitChar(ca)&&!isDigitChar(cb)){return bias}else{if(!isDigitChar(ca)){return -1}else{if(!isDigitChar(cb)){return +1}else{if(ca<cb){if(bias==0){bias=-1}}else{if(ca>cb){if(bias==0){bias=+1}}}}}}}};return function(a,b){if(typeof a==="number"){a=a.toString()}if(typeof b==="number"){b=b.toString()}var ia=0,ib=0;var nza=0,nzb=0;var ca,cb;var result;while(true){nza=nzb=0;ca=a.charAt(ia);cb=b.charAt(ib);while(isWhitespaceChar(ca)||ca=="0"){if(ca=="0"){nza++}else{nza=0}ca=a.charAt(++ia)}while(isWhitespaceChar(cb)||cb=="0"){if(cb=="0"){nzb++}else{nzb=0}cb=b.charAt(++ib)}if(isDigitChar(ca)&&isDigitChar(cb)){if((result=compareRight(a.substring(ia),b.substring(ib)))!=0){return result}}if(ca==0&&cb==0){return nza-nzb}if(ca<cb){return -1}else{if(ca>cb){return +1}}++ia;++ib}}}());
/*
 * twitter-text-js 1.3.4
 *
 * Copyright 2010 Twitter, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
if(!window.twttr){window.twttr={}}(function(){twttr.txt={};twttr.txt.regexen={};var HTML_ENTITIES={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#32;"};twttr.txt.htmlEscape=function(text){return text&&text.replace(/[&"'><]/g,function(character){return HTML_ENTITIES[character]})};function regexSupplant(regex,flags){flags=flags||"";if(typeof regex!=="string"){if(regex.global&&flags.indexOf("g")<0){flags+="g"}if(regex.ignoreCase&&flags.indexOf("i")<0){flags+="i"}if(regex.multiline&&flags.indexOf("m")<0){flags+="m"}regex=regex.source}return new RegExp(regex.replace(/#\{(\w+)\}/g,function(match,name){var newRegex=twttr.txt.regexen[name]||"";if(typeof newRegex!=="string"){newRegex=newRegex.source}return newRegex}),flags)}function stringSupplant(str,values){return str.replace(/#\{(\w+)\}/g,function(match,name){return values[name]||""})}var fromCode=String.fromCharCode;var UNICODE_SPACES=[fromCode(32),fromCode(133),fromCode(160),fromCode(5760),fromCode(6158),fromCode(8232),fromCode(8233),fromCode(8239),fromCode(8287),fromCode(12288)];for(var i=9;i<=13;i++){UNICODE_SPACES.push(String.fromCharCode(i))}for(var i=8192;i<=8202;i++){UNICODE_SPACES.push(String.fromCharCode(i))}twttr.txt.regexen.spaces=regexSupplant("["+UNICODE_SPACES.join("")+"]");twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~/;twttr.txt.regexen.atSigns=/[@]/;twttr.txt.regexen.extractMentions=regexSupplant(/(^|[^a-zA-Z0-9_])(#{atSigns})([a-zA-Z0-9_]{1,20})(?=(.|$))/g);twttr.txt.regexen.extractReply=regexSupplant(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/);twttr.txt.regexen.listName=/[a-zA-Z][a-zA-Z0-9_\-\u0080-\u00ff]{0,24}/;twttr.txt.regexen.latinAccentChars=regexSupplant("\\303\\277");twttr.txt.regexen.latenAccents=regexSupplant(/[#{latinAccentChars}]+/);twttr.txt.regexen.endScreenNameMatch=regexSupplant(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/);twttr.txt.regexen.hashtagAlpha=regexSupplant(/[a-z_#{latinAccentChars}]/i);twttr.txt.regexen.hashtagAlphaNumeric=regexSupplant(/[a-z0-9_#{latinAccentChars}]/i);twttr.txt.regexen.autoLinkHashtags=regexSupplant(/(^|[^0-9A-Z&\/\?]+)(#|)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi);twttr.txt.regexen.autoLinkUsernamesOrLists=/(^|[^a-zA-Z0-9_]|RT:?)([@]+)([a-zA-Z0-9_]{1,20})(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?/g;twttr.txt.regexen.autoLinkEmoticon=/(8\-\#|8\-E|\+\-\(|\`\@|\`O|\&lt;\|:~\(|\}:o\{|:\-\[|\&gt;o\&lt;|X\-\/|\[:-\]\-I\-|\/\/\/\/\\\\\\\\|\(\|:\|\/\)|:\*\)|\( \| \))/g;twttr.txt.regexen.validPrecedingChars=regexSupplant(/(?:[^-\/"':!=A-Za-z0-9_@]|^|\:)/);twttr.txt.regexen.validSubdomain=regexSupplant(/(?:[^#{punct}\s](?:[_-]|[^#{punct}\s])*)?[^#{punct}\s]\./);twttr.txt.regexen.validDomainName=regexSupplant(/(?:[^#{punct}\s](?:[-]|[^#{punct}\s])*)?[^#{punct}\s]/);twttr.txt.regexen.validDomain=regexSupplant(/(#{validSubdomain})*#{validDomainName}\.[a-z]{2,}(?::[0-9]+)?/i);twttr.txt.regexen.validGeneralUrlPathChars=/[a-z0-9!\*';:=\+\$\/%#\[\]\-_,~\.]/i;twttr.txt.regexen.wikipediaDisambiguation=regexSupplant(/(?:\(#{validGeneralUrlPathChars}+\))/i);twttr.txt.regexen.validUrlPathChars=regexSupplant(/(?:#{wikipediaDisambiguation}|@#{validGeneralUrlPathChars}+\/|[\.,]?#{validGeneralUrlPathChars})/i);twttr.txt.regexen.validUrlPathEndingChars=regexSupplant(/(?:[\+\-a-z0-9=_#\/]|#{wikipediaDisambiguation})/i);twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!\*'\(\);:&=\+\$\/%#\[\]\-_\.,~]/i;twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i;twttr.txt.regexen.validUrl=regexSupplant("((#{validPrecedingChars})((https?:\\/\\/)(#{validDomain})(\\/(?:#{validUrlPathChars}+#{validUrlPathEndingChars}|#{validUrlPathChars}+#{validUrlPathEndingChars}?|#{validUrlPathEndingChars})?)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi");var DEFAULT_URL_CLASS="tweet-url";var DEFAULT_LIST_CLASS="list-slug";var DEFAULT_USERNAME_CLASS="username";var DEFAULT_HASHTAG_CLASS="hashtag";var HTML_ATTR_NO_FOLLOW=' rel="nofollow"';function clone(o){var r={};for(var k in o){if(o.hasOwnProperty(k)){r[k]=o[k]}}return r}twttr.txt.autoLink=function(text,options){options=clone(options||{});return twttr.txt.autoLinkUsernamesOrLists(twttr.txt.autoLinkUrlsCustom(twttr.txt.autoLinkHashtags(text,options),options),options)};twttr.txt.autoLinkUsernamesOrLists=function(text,options){options=clone(options||{});options.urlClass=options.urlClass||DEFAULT_URL_CLASS;options.listClass=options.listClass||DEFAULT_LIST_CLASS;options.usernameClass=options.usernameClass||DEFAULT_USERNAME_CLASS;options.usernameUrlBase=options.usernameUrlBase||"http://twitter.com/";options.listUrlBase=options.listUrlBase||"http://twitter.com/";if(!options.suppressNoFollow){var extraHtml=HTML_ATTR_NO_FOLLOW}var newText="",splitText=twttr.txt.splitTags(text);for(var index=0;index<splitText.length;index++){var chunk=splitText[index];if(index!==0){newText+=((index%2===0)?">":"<")}if(index%4!==0){newText+=chunk}else{newText+=chunk.replace(twttr.txt.regexen.autoLinkUsernamesOrLists,function(match,before,at,user,slashListname,offset,chunk){var after=chunk.slice(offset+match.length);var d={before:before,at:at,user:twttr.txt.htmlEscape(user),slashListname:twttr.txt.htmlEscape(slashListname),extraHtml:extraHtml,preChunk:"",chunk:twttr.txt.htmlEscape(chunk),postChunk:""};for(var k in options){if(options.hasOwnProperty(k)){d[k]=options[k]}}if(slashListname&&!options.suppressLists){var list=d.chunk=stringSupplant("#{user}#{slashListname}",d);d.list=twttr.txt.htmlEscape(list.toLowerCase());return stringSupplant('#{before}#{at}<a class="#{urlClass} #{listClass}" href="#{listUrlBase}#{list}"#{extraHtml}>#{chunk}</a>',d)}else{if(after&&after.match(twttr.txt.regexen.endScreenNameMatch)){return match}else{d.chunk=twttr.txt.htmlEscape(user);d.dataScreenName=!options.suppressDataScreenName?stringSupplant('data-screen-name="#{chunk}" ',d):"";return stringSupplant('#{before}#{at}<a class="#{urlClass} #{usernameClass}" #{dataScreenName}href="#{usernameUrlBase}#{chunk}"#{extraHtml}>#{preChunk}#{chunk}#{postChunk}</a>',d)}}})}}return newText};twttr.txt.autoLinkHashtags=function(text,options){options=clone(options||{});options.urlClass=options.urlClass||DEFAULT_URL_CLASS;options.hashtagClass=options.hashtagClass||DEFAULT_HASHTAG_CLASS;options.hashtagUrlBase=options.hashtagUrlBase||"http://twitter.com/search?q=%23";if(!options.suppressNoFollow){var extraHtml=HTML_ATTR_NO_FOLLOW}return text.replace(twttr.txt.regexen.autoLinkHashtags,function(match,before,hash,text){var d={before:before,hash:twttr.txt.htmlEscape(hash),preText:"",text:twttr.txt.htmlEscape(text),postText:"",extraHtml:extraHtml};for(var k in options){if(options.hasOwnProperty(k)){d[k]=options[k]}}return stringSupplant('#{before}<a href="#{hashtagUrlBase}#{text}" title="##{text}" class="#{urlClass} #{hashtagClass}"#{extraHtml}>#{hash}#{preText}#{text}#{postText}</a>',d)})};twttr.txt.autoLinkUrlsCustom=function(text,options){options=clone(options||{});if(!options.suppressNoFollow){options.rel="nofollow"}if(options.urlClass){options["class"]=options.urlClass;delete options.urlClass}delete options.suppressNoFollow;delete options.suppressDataScreenName;return text.replace(twttr.txt.regexen.validUrl,function(match,all,before,url,protocol,domain,path,queryString){var tldComponents;if(protocol){var htmlAttrs="";for(var k in options){htmlAttrs+=stringSupplant(' #{k}="#{v}" ',{k:k,v:options[k].toString().replace(/"/,"&quot;").replace(/</,"&lt;").replace(/>/,"&gt;")})}options.htmlAttrs||"";var d={before:before,htmlAttrs:htmlAttrs,url:twttr.txt.htmlEscape(url)};return stringSupplant('#{before}<a href="#{url}"#{htmlAttrs}>#{url}</a>',d)}else{return all}})};twttr.txt.extractMentions=function(text){var screenNamesOnly=[],screenNamesWithIndices=twttr.txt.extractMentionsWithIndices(text);for(var i=0;i<screenNamesWithIndices.length;i++){var screenName=screenNamesWithIndices[i].screenName;screenNamesOnly.push(screenName)}return screenNamesOnly};twttr.txt.extractMentionsWithIndices=function(text){if(!text){return[]}var possibleScreenNames=[],position=0;text.replace(twttr.txt.regexen.extractMentions,function(match,before,atSign,screenName,after){if(!after.match(twttr.txt.regexen.endScreenNameMatch)){var startPosition=text.indexOf(atSign+screenName,position);position=startPosition+screenName.length+1;possibleScreenNames.push({screenName:screenName,indices:[startPosition,position]})}});return possibleScreenNames};twttr.txt.extractReplies=function(text){if(!text){return null}var possibleScreenName=text.match(twttr.txt.regexen.extractReply);if(!possibleScreenName){return null}return possibleScreenName[1]};twttr.txt.extractUrls=function(text){var urlsOnly=[],urlsWithIndices=twttr.txt.extractUrlsWithIndices(text);for(var i=0;i<urlsWithIndices.length;i++){urlsOnly.push(urlsWithIndices[i].url)}return urlsOnly};twttr.txt.extractUrlsWithIndices=function(text){if(!text){return[]}var urls=[],position=0;text.replace(twttr.txt.regexen.validUrl,function(match,all,before,url,protocol,domain,path,query){var tldComponents;if(protocol){var startPosition=text.indexOf(url,position),position=startPosition+url.length;urls.push({url:url,indices:[startPosition,position]})}});return urls};twttr.txt.extractHashtags=function(text){var hashtagsOnly=[],hashtagsWithIndices=twttr.txt.extractHashtagsWithIndices(text);for(var i=0;i<hashtagsWithIndices.length;i++){hashtagsOnly.push(hashtagsWithIndices[i].hashtag)}return hashtagsOnly};twttr.txt.extractHashtagsWithIndices=function(text){if(!text){return[]}var tags=[],position=0;text.replace(twttr.txt.regexen.autoLinkHashtags,function(match,before,hash,hashText){var startPosition=text.indexOf(hash+hashText,position);position=startPosition+hashText.length+1;tags.push({hashtag:hashText,indices:[startPosition,position]})});return tags};twttr.txt.splitTags=function(text){var firstSplits=text.split("<"),secondSplits,allSplits=[],split;for(var i=0;i<firstSplits.length;i+=1){split=firstSplits[i];if(!split){allSplits.push("")}else{secondSplits=split.split(">");for(var j=0;j<secondSplits.length;j+=1){allSplits.push(secondSplits[j])}}}return allSplits};twttr.txt.hitHighlight=function(text,hits,options){var defaultHighlightTag="em";hits=hits||[];options=options||{};if(hits.length===0){return text}var tagName=options.tag||defaultHighlightTag,tags=["<"+tagName+">","</"+tagName+">"],chunks=twttr.txt.splitTags(text),split,i,j,result="",chunkIndex=0,chunk=chunks[0],prevChunksLen=0,chunkCursor=0,startInChunk=false,chunkChars=chunk,flatHits=[],index,hit,tag,placed,hitSpot;for(i=0;i<hits.length;i+=1){for(j=0;j<hits[i].length;j+=1){flatHits.push(hits[i][j])}}for(index=0;index<flatHits.length;index+=1){hit=flatHits[index];tag=tags[index%2];placed=false;while(chunk!=null&&hit>=prevChunksLen+chunk.length){result+=chunkChars.slice(chunkCursor);if(startInChunk&&hit===prevChunksLen+chunkChars.length){result+=tag;placed=true}if(chunks[chunkIndex+1]){result+="<"+chunks[chunkIndex+1]+">"}prevChunksLen+=chunkChars.length;chunkCursor=0;chunkIndex+=2;chunk=chunks[chunkIndex];chunkChars=chunk;startInChunk=false}if(!placed&&chunk!=null){hitSpot=hit-prevChunksLen;result+=chunkChars.slice(chunkCursor,hitSpot)+tag;chunkCursor=hitSpot;if(index%2===0){startInChunk=true}else{startInChunk=false}}else{if(!placed){placed=true;result+=tag}}}if(chunk!=null){if(chunkCursor<chunkChars.length){result+=chunkChars.slice(chunkCursor)}for(index=chunkIndex+1;index<chunks.length;index+=1){result+=(index%2===0?chunks[index]:"<"+chunks[index]+">")}}return result}}());twttr.aug(twttr.util,{linkify:function(text){var isPretty=twttr.decider.isAvailable("phoenix_pretty_links");return twttr.txt.autoLinkUsernamesOrLists(twttr.txt.autoLinkUrlsCustom(twttr.txt.autoLinkHashtags(text,{hashtagClass:"twitter-hashtag",urlClass:" ",hashtagUrlBase:"/#!/search?q=%23",hash:isPretty?'<span class="hash">#</span>':"#",preText:isPretty?'<span class="hash-text">':null,postText:isPretty?"</span>":null}),{urlClass:"twitter-timeline-link",target:"_blank"}),{usernameClass:"twitter-atreply",listClass:"twitter-listname",urlClass:" ",at:isPretty?"":"@",preChunk:isPretty?'<span class="at">@</span><span class="at-text">':null,postChunk:isPretty?"</span>":null})},queryHighlight:function(query,tweet){var queryNoQuotes=query.replace(/"/gi,"");var pureTweet=tweet.replace(/<[^>]+>/g,"");return twttr.txt.hitHighlight(tweet,twttr.util.highlightIndices(queryNoQuotes,pureTweet),{tag:"strong"})},escapeRegExpChars:(function(){var specialChars="\\/{}|()[]?.*:^$";specialCharsMatcher=new RegExp("((\\"+specialChars.split("").join(")|(\\")+"))","gi");return function(query){return query.replace(specialCharsMatcher,function(m,c){return"\\"+c})}}()),highlightIndices:function(query,tweet){query=twttr.util.escapeRegExpChars(query);var tokens=query.split(/\s+/);var indices=[];var orTokens="("+tokens.join(")|(")+")";var escapedPunct="!#%&+,-./:;<=>?@^_{|}~".split("").join("\\");var tokenMatcher=new RegExp("(^|\\b|\\W|["+escapedPunct+"])("+orTokens+")(\\b|\\s|$|["+escapedPunct+"])","gi");tweet.replace(tokenMatcher,function(m,before,token){var offset=arguments[arguments.length-2]+before.length;indices.push([offset,offset+token.length])});return indices}});(function(){twttr.setup=function(){function getBrowser(){var browsers=["webkit","mozilla","opera","msie"];for(var i=0;i<browsers.length;i++){if($.browser[browsers[i]]){return browsers[i]}}}$("body").addClass(getBrowser());if(twttr.decider.isAvailable("new_tweet_labels")){$("body").addClass("new-tweet-labels")}if(twttr.currentUser){twttr.caches.User=new twttr.cache.local.User(twttr.currentUser.screenName)}else{twttr.caches.User=new twttr.cache.local.User($.cookie("guest_id"))}var flashMessage=$("#flash-message-storage").html();if($.trim(flashMessage)){twttr.showMessage(flashMessage);$("#flash-message-storage").empty()}twttr.app.init();twttr.recentlyViewedUsers=new twttr.StoredUserStack("recentlyViewedUsers");twttr.$win=$(window);twttr.$doc=$(document);twttr.provide("twttr.$elements",{page:$("#page-outer")});twttr.windowHeight=twttr.$win.height();twttr["interface"].setup();twttr.ui.loadBar();twttr.search.setup();twttr.API.globalEvents.bind("rate_limited",function(e){twttr.showMessage(_("Sorry! You've hit your hourly usage limit. Try again soon."))});if($(".welcome-banner-outer").length>0){var welcomeBanner=twttr.banners.welcomeToPhoenix();welcomeBanner.bind("closed",function(){$.cookie("phx_seen_banner",true,{expires:365})});$(".welcome-banner-outer").remove();welcomeBanner.insert()}if($(".became-user-banner-outer").length>0){$(".became-user-banner-outer").remove();twttr.banners.becameUser().insert()}if(twttr.showWelcomeDialog){var everythingInOnePlace=twttr.dialogs.firstTime();everythingInOnePlace.bind("close",function(){$.cookie("phx_seen_dialog-"+twttr.currentUser.id,true,{expires:365})});everythingInOnePlace.open()}if(twttr.currentUser&&(twttr.is.def(twttr.util.params().phx_show_bb_dialog)||$.cookie("phx_show_bb_dialog-"+twttr.currentUser.id))){var broughtBack=twttr.dialogs.broughtBack();broughtBack.bind("close",function(){$.cookie("phx_show_bb_dialog-"+twttr.currentUser.id,null)});broughtBack.open()}twttr.router.bind("routed",function(e,route){twttr.$win.scrollTop(0)});twttr.router.bind("urlChanged",function(e,route){twttr.trackPageView(route.name)});twttr.router.bind("routeNotFound",function(){twttr.app.switchToPage("404").notFound()});twttr.router.startRouting();var $banners=$(".top-bar-inside,.banner .banner-inside");twttr.$win.scroll(function(){$banners.css("left",-twttr.$win.scrollLeft())});if(twttr.decider.isAvailable("infinite_scroll")){twttr.util.lazyBind(window,"scroll",function(e){if(twttr.widget.Dialog.currentModal){return }var currentPage=twttr.app.currentPage(),streamManager;if(Math.abs(twttr.$doc.scrollTop()+twttr.windowHeight-twttr.$doc.height())<500){streamManager=currentPage.streamManager;if(streamManager){streamManager.getMoreOldItems(function(stream){scribble("stream-scrolled",{page:stream._page,stream:stream._cacheKey,focused_tweet_id:stream.focusedItemId||""});if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","scroll_home_timeline")}})}}if(currentPage.repositionDetailsPane){currentPage.repositionDetailsPane()}})}twttr.util.lazyBind(window,"resize",function(e){var cp=twttr.app.currentPage();twttr.windowHeight=twttr.$win.height();if(cp&&cp.resizeDetailsPane){cp.resizeDetailsPane()}twttr.windowHeight=twttr.$win.height()});(function(){var _d=0;function u(){var page=twttr.app.currentPage(),start=+new Date;if(page){page.$find("._timestamp[data-time$="+_d+"000]").each(function(){var $this=$(this),time=parseInt($this.attr("data-time"),10);if(start-time>86400000){$this.removeClass("_timestamp").addClass("_old-timestamp")}else{var text=twttr.helpers.timeAgo(time,JSON.parse($this.attr("data-long-form")||"false"),JSON.parse($this.attr("data-include-sec")||"false"));if(text!==$this.text()){$this.text(text)}}})}var t=+new Date-start;_d++;_d%=10;setTimeout(u,2000)}setTimeout(u,2000)}());twttr.API.User.bind("follow acceptFollow",function(e,user){twttr.currentUser.sync("friendsCount",++twttr.currentUser.friendsCount);twttr.components.Autocomplete.getAutocompletedUsers(function(){twttr.components.Autocomplete.addToList([user.id,user.screenName,user.name,user.profileImageUrl])})});twttr.API.User.bind("unfollow",function(e,user){twttr.currentUser.sync("friendsCount",Math.max(--twttr.currentUser.friendsCount,0))});if(twttr.is.nil($.cookie("js"))){$.cookie("js",1,{expires:30})}if(twttr.decider.isAvailable("phoenix_scribe_narrow")){scribble("narrow",{mode:twttr.isNarrow?"narrow":"regular"})}};twttr.showError=function(message){twttr.openMessageDrawer(message,"error")};twttr.showMessage=function(message){var view=twttr.openMessageDrawer(message,"message",{close_button:false});if(view){setTimeout(function(){view.$dom.css("opacity",1).animate({opacity:0},1000,function(){view.$dom.remove();twttr.views.MessageDrawer.isOpen=false})},2000)}};(function(){var defaultOptions={close_button:true};twttr.openMessageDrawer=function(message,type,options){options=twttr.merge({},defaultOptions,options||{});options.text=message;options.type=type;twttr.views.MessageDrawer.close();var view=new twttr.views.MessageDrawer(options);view.render("#message-drawer","append");twttr.views.MessageDrawer.isOpen=true;return view}}());twttr.messageNotification=function(message){var view=new twttr.views.MessageNotification({message:message.attributes}),senderId=message.senderScreenName,messageId=message.id;$("#message-notifications").append(view.$html());var $notification=$("#message-notifications [data-message-id="+messageId+"].notification");$notification.bind("click",function(){var $this=$(this);$this.unbind();$this.find(".message-notification-reply-box").show();var editor=new twttr.Editor("#message-notifications [data-message-id="+messageId+"].notification  .message-notification-reply-editor",function(){var that=this;this.focus();this.height(36);$("#message-notifications [data-message-id="+messageId+"].notification .message-notification-reply-button").click(function(){$notification.html("Sent!");setTimeout(function(){$notification.remove()},2000);twttr.API.DirectMessage.send(senderId,that.content())})})})};twttr.provide("twttr.ui",{toggleSpinner:function(selector,b){if(b){var $spinner=$('<div class="loading-spinner"><img src="/phoenix/img/loader.gif" alt="'+_("Loading")+'"/></div>').appendTo(selector)}else{$(selector).find("div.loading-spinner").remove()}},loadBar:function(){$("#global-nav a").each(function(){$(this).attr("href",twttr.router.lookupAndNormalizeRoute($(this).attr("href")))});if(twttr.loggedIn){$("#global-nav").delegate("a","mousedown",function(e){var link=$(this);scribble("globalnav",{input:"click",name:link.text(),href:link.attr("href")})})}}})}());(function(twttr){twttr.search={setup:function(){var that=this;this.$searchQuery=$("#search-query");if(!Modernizr.input.placeholder){var searchPrompt=this.$searchQuery.attr("placeholder");var placeholding=false;this.$searchQuery.bind({focus:function(){var $this=$(this);if(placeholding){$this.val("");placeholding=false}$this.addClass("focused").select()},blur:function(){if(!placeholding&&that.$searchQuery.val()===""){placeholding=true;that.$searchQuery.val(searchPrompt)}$(this).removeClass("focused")}});if(!this.$searchQuery[0].hasFocus){this.$searchQuery.blur()}else{this.$searchQuery.addClass("focused")}}},clear:function(){this.focusQuery("").blur()},focusQuery:function(q){if(!this.$searchQuery[0].hasFocus){this.$searchQuery.focus()}if(twttr.is.def(q)){this.$searchQuery.val(q)}return this.$searchQuery},doSearch:function(q){var query=this.focusQuery(q).val();if(query){trackClient({section:"",component:"searchbox",action:"search"},{query:query});twttr.router.routeTo(twttr.router.searchResultsPath({query:query}))}else{this.$searchQuery.blur()}},latestQuery:"",formifyLatestQuery:function($form){var query=jQuery.trim(this.latestQuery).replace(/\s+/," ");if(query){if($form.is(".advanced-search form")){var matches,phraseRe=/(|#|\-|@|\w+:|OR |AND )?\"([^\"]+)\"/i,addValue=function(prefix,value){var prefixMap={"#":"tag","-":"nots","@":"ref","to:":"to","from:":"from","near:":"near",or:"ors",and:"ands"},fieldName=prefix?prefixMap[jQuery.trim(prefix).toLowerCase()]:"phrase";if(fieldName){var $input=$form.find("input[name="+fieldName+"]"),old=$input.val();$input.val((old?old+" ":"")+value)}};while(matches=phraseRe.exec(query)){if(matches&&matches[2]){addValue(matches[1],matches[2])}query=query.replace(matches[0],"")}twttr.each(query.split(" "),function(word,i,a){switch(word.toLowerCase()){case":)":case":(":case"?":$form.find('input[value="'+word+'"]').attr("checked","checked");break;case"include:retweets":$form.find("input[name=include]").attr("checked","checked");break;case"":case"or":case"and":break;default:matches=/^(#|\-|@|to:|from:)(.*)/i.exec(word);if(matches&&matches[2]){addValue(matches[1],matches[2]);break}matches=/^within:(\d+)(mi|km)*/i.exec(word);if(matches){var $within=$form.find("select[name=within]");if($within.find("option[value="+matches[1]+"]")){$within.val(matches[1])}if(matches[2].match(/km/i)){$form.find("input[name=units]").each(function(){var $radio=$(this);$radio.attr("checked",$radio.val()=="km"?"checked":"")})}break}if(i&&a[i-1].match(/OR/i)){addValue("or",word)}else{addValue("and",word)}}})}else{$form.find("input[name=q]").val(q)}}},serializeAdvancedForm:function($form){var formData=$form.serializeArray();var q=[];for(var field in formData){var data=formData[field],value=jQuery.trim(data.value);if(!value){continue}switch(data.name){case"attd":case"ands":q.push(value);break;case"ors":q.push("OR "+value.split(" ").join(" OR "));break;case"phrase":q.push('"'+value+'"');break;case"nots":q.push("-"+value.split(" ").join(" -"));break;case"tag":q.push("#"+value.replace(/#+/g,"").split(" ").join(" OR #"));break;case"from":q.push("from:"+value.replace(/@+/g,"").split(" ").join(" OR from:"));break;case"to":q.push("to:"+value.replace(/@+/g,"").split(" ").join(" OR to:"));break;case"ref":q.push("@"+value.replace(/@+/g,"").split(" ").join(" OR @"));break;case"near":q.push('near:"'+value+'" within:'+$form.find("select[name=within]").val()+$form.find("input:radio[name=units]:checked").val());break;case"include":q.push("include:retweets");break}}return q.join(" ")}}}(twttr));twttr.helpers={timeWords:{longForm:{singular:{now:"now",seconds:"{{one}} second ago",minutes:"{{one}} minute ago",hours:"{{one}} hour ago",days:"{{one}} day ago"},plural:{now:"now",seconds:"{{plural_number}} seconds ago",minutes:"{{plural_number}} minutes ago",hours:"{{plural_number}} hours ago",days:"{{plural_number}} days ago"}},shortForm:{singular:{now:"now",seconds:"{{one}} sec",minutes:"{{one}} min",hours:"{{one}} hr",days:"{{one}} day"},plural:{now:"now",seconds:"{{plural_number}} sec",minutes:"{{plural_number}} mins",hours:"{{plural_number}} hrs",days:"{{plural_number}} days"}}},dates:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dates:["1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th","11th","12th","13th","14th","15th","16th","17th","18th","19th","20th","21st","22nd","23rd","24th","25th","26th","27th","28th","29th","30th","31st"]},hexToRGBA:function(hexColor,a){if(!hexColor||!hexColor.match(/^#?([0-9A-F]{6}|[0-9A-F]{3})$/i)||!RegExp.$1){return }RegExp.$1.match(/(..?)(..?)(..?)/);var r=parseInt((RegExp.$1+RegExp.$1).slice(0,2),16),g=parseInt((RegExp.$2+RegExp.$2).slice(0,2),16),b=parseInt((RegExp.$3+RegExp.$3).slice(0,2),16);return"rgba("+[r,g,b,a||"1"].join(",")+")"},sanitizeCssColor:function(hexColor){if(hexColor.match(/^[0-9a-f]{3,6}$/i)){return hexColor}},parseDateString:function(dateString){var then=new Date(dateString);if($.browser.msie&&dateString){then=new Date(Date.parse(dateString.replace(/( \+)/," UTC$1")))}return +then},prettyTime:function(time){var d=new Date(time),params={month:_(twttr.helpers.dates.months[d.getMonth()]),hours24:d.getHours(),hours12:(d.getHours()%12)||12,minutes:d.getMinutes().toString().replace(/^(\d)$/,"0$1"),amPm:d.getHours()<12?_("AM"):_("PM"),date:_(twttr.helpers.dates.dates[d.getDate()-1])};return _("{{hours12}}:{{minutes}} {{amPm}} {{month}} {{date}}",params)},prettyTimeFromString:function(dateString){return twttr.helpers.prettyTime(twttr.helpers.parseDateString(dateString))},timeAgoFromString:function(dateString,longForm,includeTime){return twttr.helpers.timeAgo(twttr.helpers.parseDateString(dateString),longForm,includeTime)},timeAgo:function(time,longForm,includeTime){var words=twttr.helpers.timeWords[longForm?"longForm":"shortForm"];var rightNow=new Date;var then=new Date(time);var diff=rightNow-then;var second=1000,minute=second*60,hour=minute*60,day=hour*24,week=day*7,result,word,ret;if(isNaN(diff)||diff<0){return""}if(diff<second*3){result="";word="now";includeTime=false}else{if(diff<minute){result=Math.floor(diff/second);word="seconds";includeTime=false}else{if(diff<hour){result=Math.floor(diff/minute);word="minutes";includeTime=false}else{if(diff<day){result=Math.floor(diff/hour);word="hours";includeTime=false}else{if(diff<day*365){ret=_("{{date}} {{month}}",{date:then.getDate(),month:_(twttr.helpers.dates.months[then.getMonth()])})}else{ret=_("{{date}} {{month}} {{year}}",{date:then.getDate(),month:_(twttr.helpers.dates.months[then.getMonth()]),year:then.getFullYear().toString().slice(2)})}}}}}if(!ret){if(result===1){words=words.singular}else{words=words.plural}ret=_(words[word],{one:result,plural_number:result})}if(includeTime){ret+=_(" at {{time}}",{time:then.toTimeString().split(":").slice(0,2).join(":")})}return ret},transformProfileImageUrl:function(profileImageUrl,size){if(!twttr.is.string(profileImageUrl)){return profileImageUrl}if(!size&&profileImageUrl.match(/default_profile_\d_normal.png$/)){size="bigger"}var replacementRegex=/_normal(\..*)?$/i;if(size){return profileImageUrl.replace(replacementRegex,"_"+size+"$1")}else{return profileImageUrl.replace(replacementRegex,"$1")}},isCurrentUser:function(userOrIdOrScreenName){return !twttr.currentUser?false:twttr.is.string(userOrIdOrScreenName)?twttr.currentUser.screenName===userOrIdOrScreenName:twttr.is.object(userOrIdOrScreenName)?userOrIdOrScreenName.id===twttr.currentUser.id:twttr.currentUser.id===userOrIdOrScreenName},userNoobLevel:function(user){var byParam=parseInt(twttr.Router.getCurrentQueryStringParams()["nooblevel"],10);if(!isNaN(byParam)){twttr.caches.User.set("noobLevel",byParam);return byParam}var byCache=twttr.caches.User.get("noobLevel");if(byCache<0){return byCache}var noob=twttr.constants.noob;user=user||twttr.currentUser;if(user&&twttr.decider.isAvailable("flock")){if(user.statusesCount==0){if(user.followersCount>49){return noob.notNoob}if(user.friendsCount===0){return(user.followersCount?noob.invited:noob.total)}else{if(user.followersCount||user.friendsCount>9){return noob.silent}return noob.friendless}}else{if(user.friendsCount>9||(user.friendsCount===0&&user.followersCount>49)){return noob.notNoob}if(user.friendsCount===0){return(user.followersCount?noob.popular:noob.talking)}else{return(user.followersCount?noob.struggling:noob.lonely)}}}return noob.notNoob},canViewUser:function(user){return !user["protected"]||user.following||this.isCurrentUser(user)||twttr.is.def(twttr.isAdmin)},truncate:function(str,maxLength,truncateString){truncateString=truncateString||"&hellip;";var truncateStringLength=$("<div/>").html(truncateString).text().length;if(str.length>maxLength){str=str.slice(0,maxLength-truncateStringLength)+truncateString}return str},displayUrl:function(){var wwwMatcher=/^www\./;return function(url,length){length=length||16;var uri=new twttr.util.Location(url);var host=uri.hostname.replace(wwwMatcher,"");if(!(uri.port==80||uri.port==443)){host+=":"+uri.port}var everythingElse=uri.pathname+uri.search+uri.hash;return host+twttr.helpers.truncate(everythingElse,length,"")}}(),getUserIdentifier:function($target){var userId=parseInt($target.attr("data-user-id"),10),screenName=$target.attr("data-screen-name");return isNaN(userId)?screenName:userId},parseEmailAddress:function(text){var result=twttr.constants.regexps.email.exec(text);return result?result[0]:null},extractEmailAddresses:function(text){return twttr.filter(twttr.map(text.split(","),twttr.helpers.parseEmailAddress),function(o){return !twttr.is.nil(o)})},handlePopupLinks:function($node){$node.find("a.popup").click(function(event){event.preventDefault();event.stopPropagation();var $this=$(this);window.open($this.attr("href"),$this.attr("name")||"twttr_popup",$this.attr("data-popup"))})},addFormEvents:function($form,submitCallback){$form.bind("submit",function(event){if($form.hasClass("submitting")){event.preventDefault();return }if(submitCallback){event.preventDefault();var o={};$.each($(this).serializeArray(),function(){if(o[this.name]){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||"")}else{o[this.name]=this.value||""}});submitCallback.call(this,event,o)}}).bind("keydown keypress",function(event){event.stopPropagation();if(event.which==twttr.constants.keyCodes.enter&&!$(event.target).is('textarea, [autocomplete="on"]')){event.preventDefault();event.target.blur();$form.submit()}});$form.find("div.button.submit").attr("tabindex",0).click(function(){$form.submit()});$form.find("input:text, textarea").bind("keydown",function(event){if(event.which==twttr.constants.keyCodes.escape){this.blur();return }}).each(function(){var $formField=$(this),labelText=$formField.attr("placeholder");if(labelText&&!Modernizr.input.placeholder){var placeholding=false;$formField.focus(function(){if(placeholding){$formField.val("");placeholding=false}$formField.addClass("focused").removeClass("placeholded").select()}).blur(function(){if(!placeholding&&$formField.val()===""){placeholding=true;$formField.val(labelText);$formField.addClass("placeholded")}$formField.removeClass("focused")});setTimeout(function(){$formField.blur()},0)}})},isModifier:function(event){return !!(event.shiftKey||event.metaKey||event.ctrlKey)},isTextOverflowEllipsisSupported:function(){return("textOverflow" in $("<div>")[0].style)},ellipsify:function(toEllipsify){if(twttr.helpers.isTextOverflowEllipsisSupported()){return false}$(toEllipsify).each(function(){var $container=$(this);if($container.hasClass("ellipsify-container")){return true}$container.addClass("ellipsify-container").wrapInner($("<span>").addClass("content"));var $content=$container.find("span.content");if($content.width()>$container.width()){var $e=$('<div class="ellip">&hellip;</div>');$container.append($e);$content.width($container.width()-$e.width()).css("margin-right",$e.width())}});return true}};twttr.viewHelpers={addMapLink:function(location,$location){},listItems:function(lists){return twttr.inject(lists.array,[],function(acc,i,list){var pathName=twttr.app.isOnPage("home")?"listInHomePath":"userListPath";acc.push({href:twttr.router[pathName]({screen_name:list.user.screenName,list_slug:list.slug}),name:list.fullName,icon_class:"list-icon",type:"list",id:list.id,is_private:list.mode==="private"});return acc})},listMembershipsItems:function(user,callback){user.memberships(function(lists){var count=lists.array.length;if(count===0){callback([]);return }var title=twttr.helpers.isCurrentUser(user)?_("Lists following you"):_("Lists following @{{screenName}}",user);callback([{name:title,href:twttr.router.membershipsPath({screen_name:user.screenName})}])})},listSubscriptionItems:function(user,callback){user.subscriptions(function(lists){var count=lists.array.length;if(count===0){callback([]);return }var title=twttr.helpers.isCurrentUser(user)?_("Lists you follow"):_("Lists @{{screenName}} follows",user);var items=twttr.viewHelpers.listItems(lists.slice(0,10));var href=twttr.router.subscriptionsPath({screen_name:user.screenName});items.unshift({name:title,href:href});if(count>10){items.push({name:_("View All"),href:href})}callback(items)})},profileListItems:function(user,callback){user.lists(function(lists){var count=lists.array.length;if(count===0){callback([]);return }var title=twttr.helpers.isCurrentUser(user)?_("Lists by you"):_("Lists by @{{screenName}}",user);var items=twttr.viewHelpers.listItems(lists.slice(0,10));var href=twttr.router.userListsPath({screen_name:user.screenName});items.unshift({name:title,href:href});if(count>10){items.push({name:_("View All"),href:href})}callback(items)})},createListItem:function(user){return{name:_("Create a list"),icon_class:"list",href:"#",handlers:{click:function(){new twttr.widget.ListDialog({}).open()}}}},noListsItem:function(user){if(twttr.app.isOnPage("home")){return{itemView:"NoLists"}}else{return{name:_("@{{screenName}} doesn't have any lists yet.",user)}}},superListDropdown:function(user,$target,callback){var subs=null;var mems=null;var lists=null;var superList=[];var profiler=new twttr.util.Profiler("twttr.viewHelpers.superListDropdown");twttr.viewHelpers.profileListItems(user,function(items){lists=items;onFetch()});twttr.viewHelpers.listSubscriptionItems(user,function(items){subs=items;onFetch()});twttr.viewHelpers.listMembershipsItems(user,function(items){mems=items;onFetch()});var onFetch=function(){if(subs!==null&&mems!==null&&lists!==null){var sections=[];if(subs.length===0&&mems.length===0&&lists.length===0){sections.push([twttr.viewHelpers.noListsItem(user)])}if(twttr.helpers.isCurrentUser(user)){lists.push(twttr.viewHelpers.createListItem(user))}sections.push(lists,subs,mems);$.each(sections,function(which_section,each_section){if(superList.length&&each_section.length){superList.push({divider:true})}superList=superList.concat(each_section)});callback(new twttr.control.Dropdown($target,{itemView:"StreamLink",items:superList}));profiler.done()}}},getLists:function(callback){twttr.currentUser.lists(callback)},openListDropDown:function(user,element,callback){var that=this;this.getLists(function(lists){var dropdownItems=[];var memberships={};var render=function(isReRender){lists.each(function(list){dropdownItems.push(makeItem(list))});dropdownItems.push({label:_("Create a list"),icon:"list",handlers:{click:function(){new twttr.widget.ListDialog({onSuccess:function(list){list.add(user,{success:function(resp){memberships[list.id]=true;var $node=dropdown.addItem(makeItem(list),"prependTo");$node.bind("click",that.handler(list,user))}});dropdown.close()}}).open()}}});var dropdown=new twttr.control.Dropdown(element,{view:"CheckboxDropdown",items:dropdownItems,itemView:twttr.views.CheckboxListItem,direction:"right"});callback(dropdown)};var makeItem=function(list){return{label:h(list.name),id:list.id,userIsMember:memberships[list.id],isPrivate:list.mode==="private",handlers:{click:that.handler(list,user)}}};if(lists.length()){user.memberships({filter_to_owned_lists:true,success:function(lists){lists.each(function(list,index){memberships[list.id]=true});render()}})}else{render()}})},getListDialogItems:function(user,callback){var that=this;this.getLists(function(lists){var dropdownItems=[];var memberships={};var render=function(isReRender){lists.each(function(list){dropdownItems.push(makeItem(list))});dropdownItems.push({label:_("Create a list"),icon:"list",className:"create-a-list",handlers:{click:function(){new twttr.widget.ListDialog({onSuccess:function(list){list.add(user,{success:function(resp){memberships[list.id]=true;var $node=dropdown.addItem(makeItem(list),"prependTo");$node.bind("click",that.handler(list,user))}});dropdown.close()}}).open()}}});callback(dropdownItems)};var makeItem=function(list){return{label:h(list.name),id:list.id,userIsMember:memberships[list.id],isPrivate:list.mode==="private",handlers:{click:that.handler(list,user)}}};if(lists.length()){user.memberships({filter_to_owned_lists:true,success:function(lists){lists.each(function(list,index){memberships[list.id]=true});render()}})}else{render()}})},handler:function(list,user){return function(event){event.stopPropagation();event.preventDefault();var $checkbox=$(this).find("input[type=checkbox]");var checkedAttr=$checkbox.attr("data-is-checked");var isChecked=(!!checkedAttr)&&checkedAttr==="true";var $spinner=$(this).find("img");$checkbox.hide();$spinner.show();list[isChecked?"remove":"add"](user,{success:function(){$checkbox.attr("data-is-checked",!isChecked);$checkbox.attr("checked",!isChecked)},error:function(){$checkbox.attr("data-is-checked",isChecked);$checkbox.attr("checked",isChecked);twttr.showError(_("There was an error updating the list"))},complete:function(){$spinner.hide();$checkbox.show()}})}},addRelatedTweetsLogging:function($target,scribeData,eventName){scribeData.subcomponent="related-tweets";var $group;if($target&&($group=$target.closest(".related-tweets")).length){var tweetId=$target.attr("data-tweet-id");scribeData.related_tweet_info={impression_id:$group.attr("data-related-impression-id"),group_name:$group.attr("data-related-group-name"),annotations:$group.attr("data-related-annotations"),tweet_id:tweetId?tweetId:"0"};var abDataBucket=$group.attr("data-ab-data-bucket");if(abDataBucket){var abData={bucket:abDataBucket,experiment_key:$group.attr("data-ab-data-experiment-key"),version:$group.attr("data-ab-data-version")};scribble(eventName,abData,"www_ab_testing")}}},addExtraLogging:function($target,scribeData,clickType){var $tweet=$target.closest(".stream-tweet");if(twttr.app.isOnPage("search")&&$tweet.is(".stream .stream-tweet")){twttr.components.pages.Search.addSearchClickLogging($tweet,scribeData)}else{if($tweet.is("div.details-pane .related-tweets .stream-tweet")){twttr.viewHelpers.addRelatedTweetsLogging($tweet,scribeData,clickType)}}}};twttr.provide("twttr.components");twttr.klass.component=function(namespace,ConstructorFunction){var ConstructorFunction=ConstructorFunction||function(){twttr.components.Base.apply(this,arguments)};var klass=twttr.klass(namespace,ConstructorFunction);klass.subclassOf(twttr.components.Base);return klass};twttr.klass("twttr.components.Base",function(){this.$node=$("<div/>").addClass("component");if(this.constructor._deciderKey&&!twttr.decider.isAvailable(this.constructor._deciderKey)){return }if(this.constructor._namespace!=="twttr.components.Base"){var shouldProfile=twttr.is.fn(this.constructor.shouldProfile)?this.constructor.shouldProfile():this.constructor.shouldProfile;if(shouldProfile){this.profiler=new twttr.util.Profiler(this.constructor._namespace)}}if(this.constructor._initializer){this.constructor._initializer.apply(this,arguments)}this.initComponentEvents()}).statics({shouldProfile:true,initializer:function(fn){fn._owner=this;this._initializer=fn;return this},destructor:function(fn){this._destructor=fn;return this},deciderKey:function(key){this._deciderKey=key;return this}}).mixin(twttr.mixins.componentEvents).methods(twttr.EventProvider).methods({hasRendered:function(){if(!this.noSpacer){this.$node.append("<hr class='component-spacer' />")}},$find:function(){return this.$node.find.apply(this.$node,arguments)},_superInitializer:function(args){var owner=arguments.callee.caller._owner;if(owner){var superInit=owner.uberclass._initializer;if(superInit){superInit.apply(this,args)}}},destroy:function(){if(this.constructor._destructor){this.constructor._destructor.apply(this)}this.$node.remove();this.trigger("destroyed");this.unbind()}});twttr.klass.mixin("twttr.mixins.caretHelper",function(){this.statics({spaceBoundary:/\s|$/,wordEnd:/\S+$/}).methods({init:function(){this.$input.bind("blur",twttr.bind(this,function(e){setTimeout(twttr.bind(this,function(){this.hide()}),1000)})).bind("mouseup",twttr.bind(this,function(e){setTimeout(twttr.bind(this,function(){this.getCaret()}),0)})).bind("focus",twttr.bind(this,function(e){this.getCaret()}))},getCurrentText:function(){return this.$input.val()},setCaretPosition:function(pos){var ctrl=this.$input[0];if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,pos)}else{if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}this.lastCaret=pos},getCaret:function(){var element=this.$input[0];var pos=0;if(document.selection){try{element.focus()}catch(e){}var r=document.selection.createRange();if(r==null){this.lastCaret=0;return 0}var re=element.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint("EndToStart",re);pos=rc.text.length}else{if(element.selectionStart||element.selectionStart=="0"){pos=element.selectionStart}}this.lastCaret=pos;return pos},insertOrReplaceSelection:function(text,selectNewText){var ctrl=this.$input[0];var originalPos=this.getCaret();var endPos=originalPos+text.length;if(document.selection){ctrl.focus();var r=document.selection.createRange();r.text=text;if(selectNewText){var re=ctrl.createTextRange();re.collapse(true);re.moveEnd("character",endPos);re.moveStart("character",originalPos);re.select()}else{this.setCaretPosition(endPos)}}else{if(ctrl.selectionStart||ctrl.selectionStart=="0"){var start=ctrl.selectionStart;var end=ctrl.selectionEnd;var scrollTop=ctrl.scrollTop;ctrl.value=ctrl.value.substring(0,start)+text+ctrl.value.substring(end,ctrl.value.length);ctrl.focus();ctrl.selectionStart=selectNewText?originalPos:endPos;ctrl.selectionEnd=endPos;ctrl.scrollTop=scrollTop}else{ctrl.value+=text;this.setCaretPosition(endPos);ctrl.focus()}}this.lastCaret=endPos;this.$input.change()},getCurrentWord:function(caret){var s=this.getCurrentText();var left=s.slice(0,caret);var right=s.slice(caret,s.length);var previousChar=s.charAt(caret-1);if(!previousChar||previousChar===" "){return""}this.leftBoundary=left.search(this.constructor.wordEnd);var begin=left.slice(this.leftBoundary,left.length);var end=right.slice(0,right.search(this.constructor.spaceBoundary));var word=begin.concat(end);this.rightBoundary=this.leftBoundary+word.length;return word},replaceCurrentWord:function(value){var val=this.getCurrentText().split("");this.oldValueArray=val;var first=val.slice(0,this.leftBoundary);var last=val.slice(this.rightBoundary,val.length);if(last.length<1||!last[0].match(/\s/)){value+=" "}var cursor=(first.join("")+value).length+1;return{value:first.join("")+value+last.join(""),cursor:cursor}}});return this});twttr.provide("twttr.geo",{LOG_VERSION:3,UI_VERSION:2,LOCATION_CACHE_INTERVAL:30000,BROWSER_GEO_BANNER_APPEAR_DELAY:500,BROWSER_GEO_BANNER_DISAPPEAR_INTERVAL:100,PLACE_SEARCH_AUTOCOMPLETE_DELAY:250,MAX_NEARBY_PLACES:12,MAX_NEARBY_NEIGHBORHOODS:5,MAX_PLACE_SEARCH_RESULTS:50,MAX_PLACE_AUTOCOMPLETE_RESULTS:8,PLACE_SEARCH_RESULTS_PER_PAGE:5,PLACE_CREATION_DEFAULT_ZOOM_LEVEL:15,SIMILAR_PLACES_MAX_ZOOM_LEVEL:17,ACCEPTABLE_LOCATION_ACCURACY:1000,ACCEPTABLE_LOCATION_TIMEOUT:5000,LOCATION_TIMEOUT:15000,LOCATION_MAXIMUM_AGE:60000,MAX_SIMILAR_PLACES:5,TARGET_POI_NAME_LENGTH:40,TARGET_PLACE_NAME_LENGTH:50,POI_MARKER_SIZE:{width:43,height:32},POI_MARKER_HOTSPOT:{x:14,y:33},POI_MAP_DEAD_ZONE:{left:4,top:24,right:6,bottom:0},geoEnabled:null,currentLocation:{},mapsTimeout:10000,mapsListeners:[],Exceptions:{GeoSupportException:function(){this.msg=_("This browser does not support GeoLocation")}},parseQueryParams:function(){return twttr.geo.unparam(window.location.search.substr(1))},mapsInitialized:function(){while(twttr.geo.mapsListeners.length){var listener=twttr.geo.mapsListeners.shift();listener()}},loadMaps:function(callback){if(twttr.geo.mapsAvailable()){callback()}else{twttr.geo.mapsListeners.push(callback);if(twttr.geo.mapsListeners.length==1){var mapsJs=window.location.protocol==="https:"?"https://maps-api-ssl.google.com":"http://maps.google.com";mapsJs+="/maps/api/js?v=3&sensor=false&callback=twttr.geo.mapsInitialized";if(window.location.hostname.match(/^(.+\.)?twitter\.com$/)){mapsJs+="&client=free-twitter"}var script=document.createElement("script");script.type="text/javascript";script.src=mapsJs;document.body.appendChild(script);setTimeout(twttr.geo.mapsInitialized,twttr.geo.mapsTimeout)}}},mapsAvailable:function(){return typeof google!="undefined"&&google.maps!==undefined},getBestContainer:function(place){if(!place){return{name:"",full_name:"",contained_within:[],place_type:"city",bounding_box:{type:"Polygon",coordinates:[[[-122.51368188,37.70813196],[-122.35845384,37.70813196],[-122.35845384,37.83245301],[-122.51368188,37.83245301]]]}}}var best={name:place.part_of_name||"",full_name:place.part_of_name||"",contained_within:[],place_type:"city"};if(place.contained_within){twttr.every(place.contained_within,function(parent){best=parent;return parent.place_type!="city"})}return best},getBestCity:function(place){return(place&&place.place_type=="city")?place:twttr.geo.getBestContainer(place)},getLocationFromPlace:function(place){if(!place||!place.bounding_box||place.bounding_box.type!="Polygon"||!place.bounding_box.coordinates){return null}var points=place.bounding_box.coordinates[0];if(!points||points.length!=4){return null}return{accuracy:500*twttr.geo.greatCircleDistanceInKm(points[0][1],points[0][0],points[2][1],points[2][0]),latitude:(points[0][1]+points[2][1])*0.5,longitude:(points[0][0]+points[2][0])*0.5}},getPlacePageLinkFromPlace:function(place){return"/search?"+$.param({q:"place:"+place.id,format:"html"})},getPlaceFullAddressAndMapLink:function(place){var full_address=[twttr.geo.getPlaceAttribute(place,"street_address"),place.contained_within&&place.contained_within.length>0?place.contained_within[0].full_name:null];full_address=twttr.filter(full_address,function(item){return item}).join(", ");var map_query=place.place_type=="poi"?full_address:place.name+", "+full_address;return{full_address:full_address,map_link:"http://maps.google.com/maps?"+$.param({q:map_query})}},placesFromApi:function(places){var result=[];places.each(function(place){result.push(place.data())});return result},getPlaceAttribute:function(place,attributeName){return(place.attributes&&place.attributes[attributeName])||""},getPlaceDetails:function(place){var address=twttr.geo.getPlaceAttribute(place,"street_address");if(address){return address}switch(place.place_type){case"city":return _("a city");case"neighborhood":return _("a neighborhood");case"country":return _("a country");case"admin":return _("a state or province");default:return twttr.geo.getBestContainer(place).name}},getFullPlace:function(place){return $.extend({},place,{address:twttr.geo.getPlaceAttribute(place,"street_address"),container:twttr.geo.getBestContainer(place).full_name,phone:twttr.geo.getPlaceAttribute(place,"phone"),place_id:place.id,place_name:place.full_name},twttr.geo.getPlaceFullAddressAndMapLink(place))},formatPlaceName:function(name,targetLength){if(name.length<=targetLength){return name}name=name.replace(/ [(].*[)]/g,"");if(name.length<=targetLength){return name}var suffix="...";return name.substr(0,targetLength-suffix.length)+suffix},renderPlace:function(viewName,place){var context=$.extend({},place);context.is_poi=place.place_type=="poi";if(context.is_poi){context.formatted_name=twttr.geo.formatPlaceName(place.name,twttr.geo.TARGET_POI_NAME_LENGTH)}else{context.formatted_name=twttr.geo.formatPlaceName(place.full_name,twttr.geo.TARGET_PLACE_NAME_LENGTH)}context.full_address=twttr.geo.getPlaceFullAddressAndMapLink(place).full_address;context.details=twttr.geo.getPlaceDetails(place);return(new twttr.views[viewName](context)).$html()},geoScribe:function(name,data){var user_created_at=twttr.currentUser?twttr.helpers.parseDateString(twttr.currentUser.createdAt):0;var scribeData=$.extend({ui_version:twttr.geo.UI_VERSION,log_version:twttr.geo.LOG_VERSION,user_created_at:user_created_at},data);twttr.scribble(name,scribeData,"geo_checkins")},resetGeoControls:function(){if(twttr.geo.manager){twttr.geo.manager.showCurrentStatus()}else{twttr.geo.manager=new twttr.GeoManager()}},greatCircleDistanceInKm:function(lat1,lon1,lat2,lon2){var d2r=Math.PI/180;var dLat=Math.sin((lat2-lat1)*d2r*0.5);var dLon=Math.sin((lon2-lon1)*d2r*0.5);var tmp=dLat*dLat+Math.cos(lat1*d2r)*Math.cos(lat2*d2r)*dLon*dLon;return 12742*Math.atan2(Math.sqrt(tmp),Math.sqrt(1-tmp))},unparam:function(encodedParams){var params={};var pieces=encodedParams.split("&");for(var i=0,len=pieces.length;i<len;i++){var pair=pieces[i].split("=",2);params[decodeURIComponent(pair[0])]=(pair.length==2?decodeURIComponent(pair[1].replace(/\+/g," ")):null)}return params},helpText:function($selector){$selector.each(function(){var $input=$(this);var focusable=$input.hasClass("help-focusable");if(focusable){$input.mouseup(function(e){if(!twttr.geo.helpVal($input)==""){$input.select();e.preventDefault()}})}$input.focus(function(e){twttr.geo.setHelpState($input,false,focusable)}).blur(function(){if(document.selection){document.selection.empty()}else{getSelection().removeAllRanges()}twttr.geo.setHelpState($input,true)});twttr.geo.setHelpState($input,true)});return $selector},helpVal:function($selector){var val=$.trim($selector.val());return val==$selector.attr("title")?"":val},setHelpState:function($selector,onOff,selectHelpWhenOff){$selector.each(function(){var $input=$(this);var helpClass="help-text";if(onOff){if(!twttr.geo.helpVal($input)){$input.val($input.attr("title"));$input.addClass(helpClass);if(this.hasFocus&&$input.hasClass("help-focusable")){$input.select()}}else{$input.removeClass(helpClass)}}else{$input.removeClass(helpClass);if(!twttr.geo.helpVal($input)){if(selectHelpWhenOff){$input.select()}else{$input.val("")}}}})},selectOnClick:function($selector){$selector.each(function(){var $input=$(this);var selectOnce=true;$input.click(function(){if(selectOnce){selectOnce=false;this.select()}}).blur(function(){selectOnce=true})});return $selector},log:function(line,reset){if(!twttr.decider.isAvailable("geo_diagnostics")){return }if(typeof (reset)==="undefined"){reset=false}function updateLog(){$(".geo_log_text").text(twttr.geo.logData)}if(twttr.geo.logData===undefined){twttr.geo.logData="";var $listItem=$('<li><a href="#">'+_("Geo diagnostics")+"</a></li>");$listItem.find("a").click(function(e){e.preventDefault();if(twttr.geo.logDialog){twttr.geo.logDialog.destroy()}twttr.geo.logDialog=new twttr.widget.GeoDialog({css:{width:700},template:{title:"Geo diagnostics",content:'<textarea rows="12" cols="80" style="width:100%" class="geo_log_text"/>'}});updateLog();twttr.geo.logDialog.open()});$("ul.user-dropdown").append($listItem)}if(reset||!twttr.geo.t0){twttr.geo.t0=(new Date()).getTime();twttr.geo.logData=""}var dt=(((new Date()).getTime()-twttr.geo.t0)+1000000).toFixed().toString().slice(-6);twttr.geo.logData+=dt+" "+line+"\n";updateLog()},v3:function(){return twttr.is.def(twttr.util.params().geov3)&&twttr.decider.isAvailable("phoenix_geo_v3")&&twttr.decider.isAvailable("geo_place_entities_write")}});(function(){twttr.provide("twttr.users",{autocompleted:[]});twttr.klass("twttr.components.Autocomplete",function(options){var defaultOptions={limit:5,placeLimit:5,textarea:false,preselect:true};this.options=twttr.merge({},defaultOptions,options);this.$input=$(this.options.input);this.$container=$('<ul class="autocomplete-container"></ul>').insertAfter(this.options.input);this._isCompletionsOpen=false;this.leftPlaceBoundary=-1;if(twttr.loggedIn&&(twttr.decider.isAvailable("phoenix_autocomplete")||twttr.util.params().autocomplete)){this.registerEvents()}this.init()}).mixin(twttr.mixins.caretHelper).statics({cache:{},regCache:new twttr.cache.Simple,hashtagCache:{},_isCompletionsOpen:false,nextCursor:-1,cursorCount:0,requestedUsers:false,getAutocompletedUsers:function(callback){if(!twttr.currentUser){}var that=this;if(twttr.loggedIn&&(twttr.decider.isAvailable("phoenix_autocomplete")||twttr.util.params().autocomplete)){function mapUsers(users){return twttr.map(users,function(user,i){return[user.id,user.screenName,user.name,user.profileImageUrl]})}if(!this.requestedUsers){this.requestedUsers=true;var friends=twttr.caches.User.get("autocomplete_friends");if(friends){twttr.users.autocompleted=friends;if(callback){callback()}}else{(function(){if(twttr.currentUser){twttr.components.Autocomplete.addToList([twttr.currentUser.id,twttr.currentUser.screenName,twttr.currentUser.name,twttr.currentUser.profileImageUrl])}function fetch(cursor){if(++that.cursorCount<=5&&twttr.currentUser){twttr.currentUser.friends({count:100,cursor:cursor,success:twttr.bind(that,function(users,details){twttr.components.Autocomplete.invalidateCache();if(users.isEmpty()){if(callback){callback()}return }users=mapUsers(users.toArray());twttr.users.autocompleted.push.apply(twttr.users.autocompleted,users);twttr.components.Autocomplete.resetStorageCache();if(details.response.next_cursor){fetch(details.response.next_cursor)}else{if(callback){callback()}}})})}else{if(callback){callback()}}}fetch(twttr.components.Autocomplete.nextCursor)}())}}else{if(callback){callback()}}}}}).methods(twttr.EventProvider).statics({username:/^[@]([a-zA-Z0-9_]{1,20})$/,hashtag:/^[#]([a-zA-Z0-9_]+)/,transformAvatar:/(.+)(?:_normal)\.(\w+)$/,startsWithAt:/^[@]/,nonWords:/\W/gi,skipFirstWord:/\s*\S+\s+(\S.*)$/,placePrefix:/\b(?:at|from|in|to)\s$/i,_matchesContiguously:function(input,fullstring){var ac=twttr.components.Autocomplete;var matchers=ac._matchesContiguouslyCaches.matchers=ac._matchesContiguouslyCaches.matchers||{};var results=ac._matchesContiguouslyCaches.results=ac._matchesContiguouslyCaches.results||{};if(results[input]&&results[input][fullstring]!==undefined){return results[input][fullstring]}matchers[input]=matchers[input]||new RegExp("^"+input,"i");results[input]=results[input]||{};results[input][fullstring]=matchers[input].test(fullstring.replace(/\W/,""));return results[input][fullstring]},_matchesConsecutively:function(input,fullstring){var ac=twttr.components.Autocomplete;var matchers=ac._matchesConsecutivelyCaches.matchers=ac._matchesConsecutivelyCaches.matchers||{};var results=ac._matchesConsecutivelyCaches.results=ac._matchesConsecutivelyCaches.results||{};if(results[input]&&results[input][fullstring]!==undefined){return results[input][fullstring]}matchers[input]=matchers[input]||new RegExp(input.split("").join(".*"),"i");results[input]=results[input]||{};results[input][fullstring]=matchers[input].test(fullstring);return results[input][fullstring]},levenSorter:function(a,b){var input=twttr.components.Autocomplete._currentPrefix;var dista=twttr.util.leven(a,input);var distb=twttr.util.leven(b,input);if(dista<distb){return -1}else{if(dista>distb){return 1}else{return 0}}},sorter:function(a,b){var matchesContiguously=twttr.components.Autocomplete._matchesContiguously;var matchesConsecutively=twttr.components.Autocomplete._matchesConsecutively;var input=twttr.components.Autocomplete._currentPrefix;if(matchesContiguously(input,a[1])&&!matchesContiguously(input,b[1])){return -1}if(!matchesContiguously(input,a[1])&&matchesContiguously(input,b[1])){return 1}if(matchesContiguously(input,a[2])&&!matchesContiguously(input,b[2])){return -1}if(!matchesContiguously(input,a[2])&&matchesContiguously(input,b[2])){return 1}if(matchesConsecutively(input,a[1])&&!matchesConsecutively(input,b[1])){return -1}if(!matchesConsecutively(input,a[1])&&matchesConsecutively(input,b[1])){return 1}if(matchesConsecutively(input,a[2])&&!matchesConsecutively(input,b[2])){return -1}if(!matchesConsecutively(input,a[2])&&matchesConsecutively(input,b[2])){return 1}var leftScreenNameDist=twttr.util.leven(a[1],input),rightScreenNameDist=twttr.util.leven(b[1],input);if(leftScreenNameDist<rightScreenNameDist){return -1}else{if(leftScreenNameDist>rightScreenNameDist){return 1}}var leftFullNameDist=twttr.util.leven(a[2],input),rightFullNameDist=twttr.util.leven(b[2],input);if(leftFullNameDist<rightFullNameDist){return -1}else{if(leftFullNameDist>rightFullNameDist){return 1}}return 0},_htmlEscapeAndStrongifyMatches:function(text,re){return h(text.replace(re,"<strong>$1</strong>")).replace(/&lt;(\/?strong)&gt;/g,"<$1>")}}).statics({_matchesContiguouslyCaches:{results:{},matchers:{}},_matchesConsecutivelyCaches:{results:{},matchers:{}}}).statics({invalidateCache:function(prefix){if(!prefix){this.cache={};twttr.components.Autocomplete._matchesConsecutivelyCaches.results={};twttr.components.Autocomplete._matchesConsecutivelyCaches.matchers={};twttr.components.Autocomplete._matchesContiguouslyCaches.results={};twttr.components.Autocomplete._matchesContiguouslyCaches.matchers={};return }var temp="";prefix=prefix.split("");for(var i=prefix.length-1;i>=0;i--){temp+=prefix.shift();delete this.cache[temp];delete twttr.components.Autocomplete._matchesConsecutivelyCaches.results[temp];delete twttr.components.Autocomplete._matchesConsecutivelyCaches.matchers[temp];delete twttr.components.Autocomplete._matchesContiguouslyCaches.results[temp];delete twttr.components.Autocomplete._matchesContiguouslyCaches.matchers[temp]}},resetStorageCache:function(){var newUsers=[];var j=0;twttr.users.autocompleted.sort(function(a,b){if(a[0]<b[0]){return -1}else{if(a[0]>b[0]){return 1}}return 0});for(var i=0,len=twttr.users.autocompleted.length;i<len;i++){if(twttr.users.autocompleted[i+1]&&twttr.users.autocompleted[i][0]==twttr.users.autocompleted[i+1][0]){continue}newUsers[j++]=twttr.users.autocompleted[i]}twttr.users.autocompleted=newUsers;twttr.caches.User.set("autocomplete_friends",twttr.users.autocompleted,60*60*24*3*1000)},addToList:function(u){var alreadyInList=false;for(var i=0,len=twttr.users.autocompleted.length;i<len;++i){if(twttr.users.autocompleted[i][1]===u[1]){alreadyInList=true;break}}if(!alreadyInList){twttr.users.autocompleted.push(u)}twttr.components.Autocomplete.invalidateCache(u[1]);this.resetStorageCache()},addRecentPlace:function(place){if(!twttr.geo.v3()){return }var recentPlaces=twttr.recentPlaces||[];for(var i=0,len=recentPlaces.length;i<len;++i){if(recentPlaces[0]===place.id){return }}delete this.mergedPlaces;recentPlaces.unshift([place.id,place.name,twttr.geo.getPlaceAttribute(place,"street_address"),twttr.geo.getBestContainer(place).full_name])}}).methods({registerEvents:function(){var that=this;twttr.widget.Dialog.bind("close",twttr.bind(this,function(){this.hide()}));var keyEvents="keypress"+($.browser.webkit||$.browser.msie?" keydown":"");this.$input.bind("keyup click",twttr.bind(this,this.keyup));this.$input.bind("change",twttr.bind(this,this.change));this.$input.bind(keyEvents,twttr.bind(this,this.keypress));this.$container.delegate("li.selectable","mouseenter",function(e){that.$container.find("li.selected").removeClass("selected");$(this).addClass("selected")}).delegate(".close-places","click",function(e){that.hide();that.$input.focus();return false}).delegate("li.selectable","click",twttr.bind(this,function(e){if($(e.target).hasClass("twttr-follow-notice")){return }$(e.target).addClass("selected").siblings(".selected").removeClass("selected");this.select();this.$input.focus()}));this.$input.bind("keydown",function(e){e.stopPropagation()});this.position()},set:function(value){if(this.options.textarea){var currentWord=this.replaceCurrentWord(value);this.$input.val(currentWord.value);this.setCaretPosition(currentWord.cursor)}else{this.$input.val(value)}this.$input.change()},hide:function(){setTimeout(twttr.bind(this,function(){this.$container.css("visibility","hidden");this._isCompletionsOpen=false;this.constructor._isCompletionsOpen=false}),0)},show:function(){this.$container.css("visibility","visible");this.constructor._isCompletionsOpen=true;this._isCompletionsOpen=true},keypress:function(e){e.stopPropagation();switch(e.keyCode){case twttr.constants.keyCodes.tab:case twttr.constants.keyCodes.enter:case twttr.constants.keyCodes.escape:if(this._isCompletionsOpen){e.preventDefault()}break;case twttr.constants.keyCodes.upArrow:if(this._isCompletionsOpen&&!e.shiftKey){this.previous();e.preventDefault()}break;case twttr.constants.keyCodes.downArrow:if(this._isCompletionsOpen&&!e.shiftKey){this.next();e.preventDefault()}break}setTimeout(twttr.bind(this,this.change),0)},keyup:function(e){e.stopPropagation();if(e&&(e.keyCode===twttr.constants.keyCodes.tab||e.keyCode===twttr.constants.keyCodes.shift)&&!this._isCompletionsOpen){return }var val="";var matchFound=false;var leftPlaceBoundary=this.leftPlaceBoundary;if(this.options.textarea){var caret=this.getCaret();val=this.getCurrentWord(caret);var placeWords="";var rightPlaceBoundary=val.length?this.rightBoundary:caret;if(leftPlaceBoundary>=0&&rightPlaceBoundary>leftPlaceBoundary){placeWords=this.getCurrentText().slice(leftPlaceBoundary,rightPlaceBoundary)}if(this._isCompletionsOpen&&this.autocompleteType==="place"&&placeWords.length){val=placeWords;matchFound=true}else{if(val.match(this.constructor.username)){val=RegExp.$1;this.autocompleteType="username";matchFound=true}else{if(val.match(this.constructor.hashtag)){val=RegExp.$1;this.autocompleteType="hashtag";matchFound=true}else{if(twttr.geo.v3()&&twttr.decider.isAvailable("geo_ui")&&twttr.decider.isAvailable("geo_place_entities_write")){if(twttr.decider.isAvailable("phoenix_autocomplete_place_trigger_words")&&val.length&&this.getCurrentText().slice(0,this.leftBoundary).match(this.constructor.placePrefix)){this.autocompleteType="place";this.placeTriggeredByWord=true;leftPlaceBoundary=this.leftBoundary;matchFound=true}else{if(placeWords.length){val=placeWords;this.autocompleteType="place";matchFound=true}}}}}}}else{this.autocompleteType="username";val=this.$input.val();matchFound=true}if(val.length&&matchFound){switch(e.keyCode){case twttr.constants.keyCodes.escape:this.hide();e.stopPropagation();break;case twttr.constants.keyCodes.upArrow:case twttr.constants.keyCodes.downArrow:break;case twttr.constants.keyCodes.tab:case twttr.constants.keyCodes.enter:if(!e.shiftKey&&this._isCompletionsOpen){this.select()}break;default:if(this.autocompleteType=="hashtag"){this.lookUpHashtag(val)}else{if(this.autocompleteType=="place"){if(this.lookUpPlace(val)){this.leftPlaceBoundary=leftPlaceBoundary}}else{this.lookUpUser(val)}}break}}else{this.hide()}},select:function(){var $el=this.$container.find("li.selected");var text=$el.find("b").text();var img=$el.find("img").attr("src");if(this.autocompleteType==="place"&&this.leftPlaceBoundary>=0&&this.leftPlaceBoundary<this.leftBoundary){this.leftBoundary=this.leftPlaceBoundary;this.leftPlaceBoundary=-1}if(!$el.hasClass("more-places")){this.set(text)}this.hide();if(this.autocompleteType==="username"){var screenName=$el.attr("data-user-screenname");var userId=$el.attr("data-user-id");this.trigger("select",[this.autocompleteType,text,img,screenName,userId])}else{if(this.autocompleteType==="place"){if($el.hasClass("more-places")){this.searchPlaces(text)}else{var placeName=$el.attr("data-place-name");var placeId=$el.attr("data-place-id");this.trigger("selectPlace",[placeId,this.leftBoundary,this.leftBoundary+text.length])}}else{this.trigger("select",[this.autocompleteType,text,img])}}},change:function(){var text=this.getCurrentText();var lastText=this.lastText||"";if(text===lastText){return }var preMatchLength=0;var textLength=text.length;var lastTextLength=lastText.length;var maxPrefix=Math.min(textLength,this.getCaret());for(var i=0;i<maxPrefix;i++){if(lastText.charAt(i)===text.charAt(i)){preMatchLength+=1}else{break}}var postMatchLength=0;for(var i=1;i<=textLength-preMatchLength;i++){if(lastText.charAt(lastTextLength-i)===text.charAt(textLength-i)){postMatchLength+=1}else{break}}var sum=preMatchLength+postMatchLength;this.lastText=text;this.trigger("substitution",[preMatchLength,lastTextLength-sum,textLength-sum,text])},searchPlaces:function(text){var placer=twttr.components.Autocomplete.placer;if(!placer){placer=twttr.geo.manager.placer;if(!placer||!placer.selectedPlace){placer=new twttr.geo.Placer({geoParams:{granularity:"poi",ip:twttr.remoteIP}})}else{placer=placer.getDeepCopyForPoi()}twttr.components.Autocomplete.placer=placer}var that=this;var openDialog=function(){new twttr.geo.PlaceSearchDialog(placer,function(place){that.set(place.name);placer.selectedPlace=place;that.trigger("selectPlace",[place.id,that.leftBoundary,that.leftBoundary+place.name.length])},true)};if(placer.detectedPlace){openDialog()}else{placer.search(function(){openDialog()},function(){openDialog()},function(){openDialog()})}},sanitize:function(prefix){this.constructor._currentPrefix=prefix.replace(/ /g,"");return this.constructor._currentPrefix},appendNotice:function(data){if(twttr.currentUser&&twttr.currentUser.friendsCount>500){data+='<li class="twttr-follow-notice">'+_("<em>Showing most recent 500 you're following</em>")+"</li>"}return data},lookUpHashtag:function(prefix){var that=this;prefix=this.sanitize(prefix);var cached=this.constructor.hashtagCache[prefix];if(cached){this.$container.html(cached);this.$container.find("li.selectable:first").addClass("selected");this.show();return }var callback=function(el){if(el.match(that.regexPrefix)){return el}};var items=twttr.merge({},this.getFilteredResults(prefix,twttr.suggestedHashtags||[],callback,this.constructor.levenSorter),true);var html=this.getItemTemplate(items,function(hashtag,re){return'<li class="hashtag-completion selectable"><b>#'+that.constructor._htmlEscapeAndStrongifyMatches(hashtag,re)+"</b></li>"}).slice(0,this.options.limit);if(html.length>0){var data=html.join("");this.constructor.hashtagCache[prefix]=data;this.$container.html(data);this.$container.find("li.selectable:first").addClass("selected");this.show()}else{this.hide()}},lookUpUser:function(prefix){var that=this;prefix=this.sanitize(prefix);var cached=this.constructor.cache[prefix];if(cached){this.$container.html(cached);if(this.options.preselect){this.$container.find("li.selectable:first").addClass("selected")}this.show();return }var callback=function(el){if(el[1].match(that.regexPrefix)){return el}else{if(el[2].replace(/ /g,"").match(that.regexPrefix)){return el}}};var items=twttr.merge({},this.getFilteredResults(prefix,twttr.users.autocompleted,callback,this.constructor.sorter),true);var html=this.getItemTemplate(items,function(user,re){var avatar=user[3].replace(that.constructor.transformAvatar,"$1_mini.$2");return'<li data-user-id="'+h(user[0])+'" data-user-screenname="'+h(user[1])+'" class="selectable"><img src="'+h(avatar)+'"/> <span><b>@'+that.constructor._htmlEscapeAndStrongifyMatches(user[1],re)+"</b> <em>"+that.constructor._htmlEscapeAndStrongifyMatches(user[2],re)+"</em></span></li>"}).slice(0,this.options.limit);if(html.length>0){var data=html.join("");data=this.appendNotice(data);this.constructor.cache[prefix]=data;this.$container.html(data);if(this.options.preselect){this.$container.find("li.selectable:first").addClass("selected")}this.show()}else{this.hide()}},autocompletePlaces:function(){if(!this.constructor.mergedPlaces||twttr.components.Autocomplete.prefixPlaces!=this.constructor.lastPrefixPlaces){var preloadPlaces=twttr.components.Autocomplete.autocompletePlaces||[];var prefixPlaces=twttr.components.Autocomplete.prefixPlaces||[];var recentPlaces=twttr.recentPlaces||[];var mergedPlaces=recentPlaces.concat(preloadPlaces).concat(prefixPlaces);var placeHash={};var dedupedPlaces=[];for(var i=0;i<mergedPlaces.length;++i){var place=mergedPlaces[i];var id=place[0];if(!placeHash[id]){placeHash[id]=true;dedupedPlaces.push(place)}}this.constructor.mergedPlaces=dedupedPlaces;this.constructor.lastPrefixPlaces=twttr.components.Autocomplete.prefixPlaces}return this.constructor.mergedPlaces},lookUpPlace:function(prefix){var that=this;var regexSafePrefix=prefix.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var contiguousRegex=new RegExp("^"+regexSafePrefix,"i");var minPrefixLength=(this.placeTriggeredByWord&&!/^[A-Z]/.test(prefix))?3:1;if(prefix.length===2&&twttr.requestFullCity){var normalizedPrefix=prefix.toLowerCase().replace(/\W/g,"_");using(twttr.placeDataPrefix+twttr.requestFullCity+"-"+normalizedPrefix+".js")}if(prefix.length<minPrefixLength){this.hide();return false}var placeFilter=function(el){var partial=el[1];while(partial){if(contiguousRegex.test(partial)){return el}var match=partial.match(that.constructor.skipFirstWord);partial=match&&match[1]}};var places=twttr.merge({},this.getFilteredResults(prefix,that.autocompletePlaces(),placeFilter,null),true);var reHighlightSpans=new RegExp("("+regexSafePrefix+")","gi");var html=twttr.map(places,twttr.bind(this,function(place,i){var result='<li data-place-id="'+h(place[0])+'" data-place-name="'+h(place[1])+'" class="selectable"><img src="/phoenix/img/poi-icon.png"/> <span><b>'+that.constructor._htmlEscapeAndStrongifyMatches(place[1],reHighlightSpans)+"</b> <em>"+h(place[2])+", "+h(place[3])+"</em></span></li>";return result}),null,"array").slice(0,this.options.placeLimit);if(html.length>0||prefix.length===1&&!this.placeTriggeredByWord){html.push('<li class="more-places selectable"><span>'+_("Search places...")+'<a class="close-places" href="#"><span>&nbsp;</span></a></span></li>');var data=html.join("");this.$container.html(data);this.show();return true}this.hide();return false},position:function(){setTimeout(twttr.bind(this,function(){var top=Math.round(this.$input.position().top+this.$input.innerHeight()+1),left=Math.round(this.$input.position().left);this.$container.css({top:top,left:left})}),0);this.$container.css({width:this.$input.innerWidth()})},getItemTemplate:function(items,template){var highLightLetters=new RegExp("("+this.constructor._currentPrefix.split("").join("|")+")","gi");return twttr.map(items,twttr.bind(this,function(thing,i){return template(thing,highLightLetters)}),null,"array")},getFilteredResults:function(prefix,list,filterCallback,sorter){var that=this;var re;var regCache=this.constructor.regCache.get(prefix);if(regCache){this.regexPrefix=regCache}else{var a=prefix.split("");var reStr="^"+a.join("\\w*");this.regexPrefix=new RegExp(reStr,"i");this.constructor.regCache.set(prefix,this.regexPrefix)}var filtered=twttr.filter(list,filterCallback);return sorter?filtered.sort(sorter):filtered},next:function(){var $next=this.$container.find("li.selected");if(!$next.length){this.$container.find("li.selectable:first").addClass("selected");return }$next=$next.removeClass("selected").nextAll("li.selectable:first");if($next.length){$next.addClass("selected")}else{this.$container.find("li.selectable:first").addClass("selected")}},previous:function(){var $prev=this.$container.find("li.selected");if(!$prev.length){this.$container.find("li.selectable:last").addClass("selected");return }$prev=$prev.removeClass("selected").prevAll("li.selectable:first");if($prev.length){$prev.addClass("selected")}else{this.$container.find("li.selectable:last").addClass("selected")}},insertPlace:function(){var lastCaret=this.lastCaret;this.$input.focus();if(twttr.is.def(lastCaret)){this.setCaretPosition(lastCaret)}if(this.getCurrentText().slice(0,this.getCaret()).match(/\S$/)){this.insertOrReplaceSelection(" ")}this.leftPlaceBoundary=this.getCaret();if(this.getCurrentText().slice(this.leftPlaceBoundary).match(/^\S/)){this.insertOrReplaceSelection(" ");this.setCaretPosition(this.leftPlaceBoundary)}this.insertOrReplaceSelection(_("type place name"),true);this.placeTriggeredByWord=false}});if(twttr.requestFullCity&&twttr.geo.v3()){using(twttr.placeDataPrefix+twttr.requestFullCity+".js")}}());twttr.klass("twttr.components.Editor",function(selector,options){var that=this;this.$container=$(selector);this.$container.addClass("twttr-editor");this.options=options||{};this._defaultContent=this.options.defaultContent||"";var WIDTH=this.options.width||"100%",HEIGHT=this.options.height||"auto";this.$editor=$("<textarea/>").addClass("twitter-anywhere-tweet-box-editor").css({width:WIDTH,height:HEIGHT}).val(this._defaultContent);if(this.options.condensed){this.$container.addClass("condensed")}this.css={width:$.browser.mozilla?WIDTH-2:WIDTH,height:HEIGHT,"min-height":HEIGHT};this.$container.append(this.$editor);this._registerEvents()}).methods(twttr.EventProvider).methods({content:function(){return this.$editor.val()},setContent:function(text){this.$editor.val(text);this.trigger("didChangeContent",[text])},height:function(height){this.$editor.css("height",height)},width:function(width){this.$editor.css("width",width)},focus:function(){this.$editor.focus()},blur:function(){this.$editor.blur()},toggle:function(){this.$editor.toggle()},reset:function(){this.setContent("")},_registerEvents:function(){var that=this;this.$editor.bind("focus blur",function(e){that.trigger(e.type,Array.prototype.slice.call(arguments,1))});this.$editor.bind("keypress",function(e){e.stopPropagation()});this.$editor.bind("keydown",function(e){e.stopPropagation();switch(e.keyCode){case twttr.constants.keyCodes.tab:e.preventDefault();that.trigger("blurFromTab",[e]);break;case twttr.constants.keyCodes.esc:e.preventDefault();that.trigger("blurFromEscape");break}});if($.browser.mozilla){this.$editor.bind("input mousedown mouseup",twttr.bind(this,this._keyEvents))}else{this.$editor.bind("keydown keyup paste change mousedown mouseup input",twttr.bind(this,this._keyEvents))}},_keyEvents:function(e){if($.browser.webkit&&(e.type=="paste"||e.type=="keydown")){setTimeout(twttr.bind(this,function(){this._inputCallback(e)}),0)}else{this._inputCallback(e)}},_inputCallback:function(e){this.trigger("didChangeContent",[this.content(),e])}});twttr.klass("twttr.components.RichEditor",function(selector,options){var that=this;this.supr=twttr.components.Editor;this.supr.apply(this,arguments);this._queue=new twttr.util.WaitQueue;this._$proxyWrapper={length:0};var that=this;this.$iframe=$('<iframe allowtransparency="true" frameborder="0" tabindex="-1" role="presentation" scrolling="no"/>').bind("load",function(e){that.$iframe=$(this);var offset=that.$editor.offset();that.$proxy=$(this.contentWindow.document.body);that.$proxy.append("<style>"+that.constructor.css+"</style>");that._$proxyWrapper=$('<pre class="proxy-wrapper"></pre>').appendTo(that.$proxy);that._applyStyles();that._queue.flush()}).insertBefore(this.$editor);this.$iframe.addClass("proxy-editor");this.$container.addClass("rich-editor");this._tweetBoxHeight=0;$('<div class="tweet-meta"><div class="tweetbox-media-icon"/></div>').appendTo(this.$container);this.$mediaicon=this.$container.find(".tweetbox-media-icon");this._foundMedia=false;this.bind("didChangeContent",twttr.bind(this,this._proxyLinkify))}).subclassOf(twttr.components.Editor).statics({css:'body {      margin: 0;      width: 482px;      height: 56px;      color: #222;      overflow-x: hidden;      overflow-y: hidden;    }    pre {      margin: 0;      padding: 0;      font: 14px/18px "Helvetica Neue", Arial, sans-serif;      white-space: pre-wrap;      word-wrap: break-word;    }    a {      color: #0084b4;      text-decoration: none;    }    a.twitter-timeline-link {      background-color: #bedff8;      -moz-border-radius: 5px;      -webkit-border-radius: 5px;      border-radius: 5px;    }    em {      font-style: normal;      display: inline-block;      width: 2px;    }'}).methods({_applyStyles:function(){this.$editor.css("min-height",this.css.height);this.$proxy.css("width",this.css.width);this.$iframe.css("width",this.css.width)},_growTweetBox:function(){var height=this._$proxyWrapper.height();if($.browser.webkit){height+=10}if(height!==this._tweetBoxHeight){this.$editor.height(height);this.$iframe.height(height);this.trigger("heightChange")}this._tweetBoxHeight=height},_replaceAndys:function(s){return s.replace(/&amp;/g,"&")},_proxyLinkify:function(){this._queue.add(twttr.bind(this,function(){var content=this.content();this._$proxyWrapper.html(twttr.util.linkify(this._replaceAndys(h(content)))+"<em>&nbsp;</em>");this._growTweetBox();this._showMediaIcon()}))},_showMediaIcon:function(){var urls=twttr.txt.extractUrls(this.content());var m;for(var i=0;i<urls.length;i++){var url=urls[i];m=twttr.media.match(url);if(m&&!this._foundMedia){this.$mediaicon.addClass(m._icon);this._foundMedia=true;return }}if(!m&&this._foundMedia){this.$mediaicon[0].className="tweetbox-media-icon";this._foundMedia=false}},reset:function(){this.supr.prototype.reset.apply(this,arguments);this._$proxyWrapper.html("");this._applyStyles()}});twttr.klass("twttr.components.UrlShortener",function(tweetbox,inst){if(!twttr.decider.isAvailable("phoenix_tweetbox_talon")){return }this.tweetbox=tweetbox;this.inst=inst;this.$input=this.inst.editor.$editor;this.$counter=this.inst.$counter;this.$links=[];this.tweetbox.method("_getTextLength",this._getTextLength);this._a=false;this._registerEvents();this._isTipShowing=false;this._oldLinkLen=0}).statics({matchers:{tco:/^https?:\/\/t.co\/\w+$/}}).mixin(twttr.mixins.caretHelper).methods({_registerEvents:function(){this.inst.editor.bind("didChangeContent",twttr.bind(this,this._showCounterTipsy));this.$counterText=$('<div class="tweetbox-counter-tipsy">'+this._getLinkCounterText(1)+"</div>");this.$counter.before(this.$counterText);this.$counterText.css("opacity",0)},_getLinkCounterText:function(count){var plural=_("Links will appear shortened");var single=_("Link will appear shortened");if(count>1){return plural}return single},_showCounterTipsy:function(){this._linkLen=this._extractUrls().length;if(this._linkLen&&this._linkLen!==this._oldLinkLen){this.$counterText.html(this._getLinkCounterText(this._linkLen));this.$counterText.animate({opacity:1},100);this._isTipShowing=true}else{if(this._isTipShowing&&!this._linkLen){this.$counterText.animate({opacity:0},100);this._isTipShowing=false}}this._oldLinkLen=this._linkLen},_showCounterFade:function(){if(twttr.txt.extractUrls(this.getCurrentWord(this.getCaret())).length){this.$counter.css({color:"green"});if(!this._a){var $proxyCounter=this.$counter.clone();var o=this.$counter.position();$proxyCounter.css({left:o.left,top:o.top});$proxyCounter.addClass("tweet-counter-proxy");this.$counter.after($proxyCounter);function done(){$proxyCounter.remove()}$proxyCounter.animate({fontSize:"40px",opacity:0,marginTop:-20,marginLeft:-(Math.round($proxyCounter.width()/2))},200,done);this._a=true}}else{this.$counter.css({color:""});if(this._a){this._a=false}}},_tweetReady:function(){this.inst.lock();this.callTalon(this._extractUrls(),twttr.bind(this,function(urls){this.inst.setTweetContent(this.replaceWithTalonUrls(urls));this.inst.unlock();this.inst.tweet()}))},_extractUrls:function(){return this.filterInvalidLinks(twttr.txt.extractUrls(this.inst.editor.content()))},replaceWithTalonUrls:function(urls){var content=this.inst.editor.content();twttr.each(urls,function(url){content=this.replaceContent(content,url)},this);return content},callTalon:function(urls,callback){if(!urls.length){callback([])}else{twttr.API.Urls.shortenMultiple(urls,callback)}},replaceContent:function(str,resp){return str.replace(resp.expanded_url,resp.url)},filterInvalidLinks:function(links){return twttr.filter(links,function(link){return !link.match(twttr.components.UrlShortener.matchers.tco)})},_getTextLength:function(content){var len=twttr.util.displayLength(content);var urls=twttr.txt.extractUrls(content);len-=urls.join("").length;twttr.each(urls,function(u){len+=twttr.constants.tcoLength;if(u.match(/https:/)){len+=1}});return len},_mousemove:function(e){var x=e.pageX,y=e.pageY;twttr.each(this.$links,function(el){var $this=$(el);var offset=$this.offset();var mouseEntered=$this.attr("data-mouse-entered");if(x>=offset.left&&x<=(offset.left+$this.width())&&y>=offset.top&&y<=(offset.top+$this.height())){if(!mouseEntered||mouseEntered==="false"){$this.attr("data-mouse-entered","true");$this.trigger("mouseenter")}return false}else{if(mouseEntered==="true"){$this.attr("data-mouse-entered","false");$this.trigger("mouseleave")}}})},_matchUrls:function(){setTimeout(twttr.bind(this,function(){this.$links=this.inst.$find("a.twitter-timeline-link");this.$links.tipsy({html:true,gravity:"n",offset:3,className:"tweetbox-tipsy",title:function(){return'<span class="tweetbox-tipsy-text">'+_("Link will be displayed as {{url}}",{url:twttr.helpers.displayUrl(this.href)})+"</span>"}})}),0)}});(function(){var defaultOptions={condensed:true,closeAfterSuccess:true,defaultContent:"",width:560,height:56,autocomplete:true,template:{show_geo:true,show_title:true},statusAction:"update"};var index=1;var tweetBoxCache={};var actionLookup={update:"Status",reply:"Status",dm:"DirectMessage",directMessage:"DirectMessage"};var sendingDirectMessage=/^(?:d|m|dm)\s+[@]?([a-zA-Z0-9_]{1,20}) /;twttr.klass("twttr.TweetBox",function(selector,options){var that=this;defaultOptions.template.title=_("Whats happening?");defaultOptions.template.button_text=_("Tweet");this.options=twttr.merge({},defaultOptions,options||{},true);this.places=[];this._isButtonEnabled=false;this._hasWarned=true;this._hasSuperWarned=false;this._hasNoWarned=false;var editorOptions={defaultContent:this.options.defaultContent,width:this.options.width,height:this.options.height};this.id=this.options.id||index++;tweetBoxCache[this.id]=this;this.$container=$(selector);this.view=new twttr.views.TweetBox(this.options.template).render(selector,"append");var rich=twttr.decider.isAvailable("phoenix_tweetbox_talon")&&twttr.decider.isAvailable("phoenix_rich_editor")&&!$.browser.msie;var editorKlass=rich?"RichEditor":"Editor";this.editor=new twttr.components[editorKlass](this.$container.find(".text-area-editor"),editorOptions);this.$counter=this.$find(".tweet-counter");this.$tweetButton=this.$container.find(".tweet-button");this.$title=this.$container.find("h2");if(this.options.autocomplete){this.autocomplete=new twttr.components.TweetboxAutocomplete(this)}if(!this.options.condensed||this.options.defaultContent){this.open()}this.registerEvents()}).lazyLoad(twttr.components.UrlShortener).statics({focus:function(id){tweetBoxCache[id].editor.focus()},_getDefaultContentForReply:function($tweet,screenName,currentUser){var multiple=false;var $links=$tweet.find("a.twitter-atreply");var defaultContent="@"+screenName+" ";if($links.length){multiple=true;var screenNames=[];$links.each(function(i,el){var text=$(this).text().replace("@","");if(!text.match(new RegExp("^"+screenName+"$"),"i")&&!twttr.is.inArray(text,screenNames)&&!text.match(new RegExp("^"+currentUser+"$","i"))){screenNames.push(text)}});screenNames.unshift(screenName);defaultContent=twttr.map(screenNames,function(el){return"@"+el+" "}).join("")}return{defaultContent:defaultContent,multiple:multiple}}}).statics(twttr.EventProvider).methods(twttr.EventProvider).methods({_tweetContent:"",$find:function(selector){return this.$container.find(selector)},_locked:false,lock:function(){this._locked=true},unlock:function(){this._locked=false},_getTextLength:function(content){return twttr.util.displayLength(content)},_toggleButtonState:function(e,text){var len=this._getTextLength(text);if(len>140||len==0){if(this._isButtonEnabled){this._isButtonEnabled=false;this.$tweetButton.addClass("disabled")}}else{if(!this._isButtonEnabled){this._isButtonEnabled=true;this.$tweetButton.removeClass("disabled")}}},_toggleCounterState:function(e,text){var len=this._getTextLength(text);this._updateCounter(len);if(len>120&&len<130){if(!this._hasWarned){this._hasWarned=true;this._hasSuperWarned=false;this._hasNoWarned=false;this.$counter.addClass("warn").removeClass("superwarn")}}else{if(len>=130){if(!this._hasSuperWarned){this._hasSuperWarned=true;this._hasWarned=false;this._hasNoWarned=false;this.$counter.addClass("superwarn").removeClass("warn")}}else{if(!this._hasNoWarned){this._hasNoWarned=true;this._hasSuperWarned=false;this._hasWarned=false;this.$counter.removeClass("superwarn").removeClass("warn")}}}},_updateCounter:function(totalChars){this.$counter.val(140-totalChars)},open:function(){var that=this;if(this._isOpen){return }this._isOpen=true;this.$container.find(".tweet-box").removeClass("condensed");this.trigger("open");if(this.options.template.show_geo&&twttr.decider.isAvailable("geo_ui_dropdown_available")){twttr.geo.resetGeoControls()}},close:function(){if(!this._isOpen){return }if(this.options.condensed){this.$container.find(".tweet-box").addClass("condensed")}this.trigger("close");this._isOpen=false},disable:function(){this.close();this.editor.$editor.val("");this.editor.$editor.bind("keypress",function(e){e.preventDefault()})},getTweetContent:function(){return this._tweetContent||this.editor.content()},setTweetContent:function(content){this._tweetContent=content},resetTweetContent:function(){this._tweetContent=""},_tweet:function(){this.trigger("readyToTweet");this.tweet()},tweet:function(){var params=this._shouldTweet();if(params.shouldTweet){this.setTweetBoxToBusyState();this.makeRequest.apply(this,params.args)}if(params.msg){twttr.showError(params.msg)}if(params.redirectToProfile){twttr.router.routeTo(twttr.router.profilePath({screen_name:params.redirectToProfile}))}},_tweetTooLongMessage:function(){return _("Your tweet was over 140 characters. You'll have to be more clever.")},_shouldTweet:function(){var args=[],action=this.options.statusAction,klass=actionLookup[action],content=this.editor.content();if(this._sendingStatus||this._locked){return{shouldTweet:false}}if(action==="update"&&this.editor.content().match(twttr.constants.regexps.usernameWithSpace)){var name=RegExp.$1;this.$container.find(".tweet-spinner").show();this.$container.find(".tweet-counter").hide();return{shouldTweet:false,redirectToProfile:name}}if(this._getTextLength(content)>140){return{shouldTweet:false,msg:this._tweetTooLongMessage()}}if(content.length==0){return{shouldTweet:false}}if(action=="directMessage"){if(!twttr.is.def(this.options.data.getUser())||twttr.is.blank(this.options.data.getUser())){return{shouldTweet:false,msg:_("Whoops! You forgot to type in a username.")}}}var that=this;var options=this._getRequestOptions();if(this.options.inReplyToStatusId){twttr.merge(options,{in_reply_to_status_id:this.options.inReplyToStatusId})}var location=twttr.geo.currentLocation;if(location){if(twttr.is.number(location.lat)&&twttr.is.number(location.lon)){options.lat=location.lat;options.lon=location.lon;options.display_coordinates=false}if(location.place_id){options.place_id=location.place_id}}if(twttr.decider.isAvailable("geo_place_entities_write")){if(this.places.length){options.places=JSON.stringify(this.places)}}options.timeout=function(request){request.retry()};switch(action){case"update":args=[this.getTweetContent(),options];break;case"reply":options.impression_id=this.options.data.impressionId;args=[this.options.data.tweetId,this.getTweetContent(),options];break;case"directMessage":action="send";args=[this.options.data.getUser(),this.getTweetContent(),options];break}return{shouldTweet:true,args:[klass,action,args]}},setTweetBoxToBusyState:function(){this.$container.find(".tweet-spinner").show();this.$container.find(".tweet-counter").hide();this.$tweetButton.addClass("disabled")},unSetTweetBoxToBusyState:function(){this.$container.find(".tweet-spinner").hide();this.$container.find(".tweet-counter").show()},_getRequestOptions:function(){var that=this;var profiler=new twttr.util.Profiler(this.constructor._namespace);var isDm=that.options.statusAction==="directMessage"||that.editor.content().match(sendingDirectMessage);return{complete:function(){that.unSetTweetBoxToBusyState();that._sendingStatus=false;that.resetTweetContent();profiler.done()},success:function(tweet){if(that.options.closeAfterSuccess){that.close()}if(isDm){that.trigger("dmSuccess",[tweet,that.options.statusAction])}else{that.trigger("tweetSuccess",[tweet,that.options.statusAction]);that.constructor.trigger("tweetSuccess",[tweet,that.options.statusAction])}that.editor.reset();that.places=[];that.$tweetButton.addClass("disabled");delete that.options.inReplyToStatusId;scribble("tweet",{tweet_type:that.options.statusAction,origin:that.options.origin,input:that.options.inputSource,component:that.options.component});if(that.options.condensed){that.$container.find(".tweet-box").addClass("condensed")}},error:function(resp){that.$tweetButton.removeClass("disabled");var responseError=resp.error&&resp.response&&resp.response.error||"";var errorCode;var errorMessage;if(responseError.match(/not following/)){errorMessage=_("You cannot send messages to users who are not following you");errorCode=twttr.constants.errorCodes.notFollowing}else{if(responseError.match(/duplicate/)){errorMessage=_("Whoops! You already said that...");errorCode=twttr.constants.errorCodes.duplicateTweet}else{if(responseError.match(/malware/)){errorMessage=(new twttr.views.MalwareErrorMessage()).html();errorCode=twttr.constants.errorCodes.malwareTweet}else{if(responseError.match(/daily/)){errorMessage=_("You are over the status update limit. Please wait a few hours and try again.");errorCode=twttr.constants.errorCodes.overDailyLimitTweet}else{if(responseError.match(/140/)){errorMessage=that._tweetTooLongMessage();errorCode=twttr.constants.errorCodes.tooLongTweet}else{errorMessage=isDm?_("Sorry! We did something wrong. Try sending your message again in a minute"):_("Sorry! We did something wrong. Try sending your tweet again in a minute");errorCode=twttr.constants.errorCodes.whale}}}}}twttr.showError(errorMessage);that.trigger(isDm?"dmError":"tweetError",[errorCode])}}},makeRequest:function(klass,action,args){this._sendingStatus=true;twttr.API[klass][action].apply(twttr.API[klass],args)},registerEvents:function(){var that=this;this.$tweetButton.addClass("disabled");this.editor.bind("focus",function(e){setTimeout(function(){that.open()},0)});this.editor.bind("didChangeContent",twttr.bind(this,this._toggleButtonState));this.editor.bind("didChangeContent",twttr.bind(this,this._toggleCounterState));this.editor.bind("blurFromTab",function(e,browserEvent){if(!twttr.components.Autocomplete._isCompletionsOpen){that.$container.find(".tweet-button").focus()}});this.editor.bind("blurFromEscape",function(e){if(!twttr.components.Autocomplete._isCompletionsOpen){that.editor.blur();that.trigger("blurFromEscape")}});if(this.options.defaultContent.length>0){this.editor.trigger("didChangeContent",[this.options.defaultContent]);setTimeout(twttr.bind(this,function(){this.open();this.editor.focus();this.editor.$editor.trigger(jQuery.Event("keyup"))}),0)}this.$tweetButton.bind("keypress",twttr.bind(this,function(e){e.stopPropagation();if(e.keyCode===twttr.constants.keyCodes.enter||e.charCode===twttr.constants.charCodes.space){this._tweet();e.preventDefault();return false}})).bind("click",function(e){that._tweet();e.preventDefault()});var isDm,isReply,isMention,isUpdate;if(this.options.statusAction=="update"||this.options.statusAction=="reply"){this.bind("titleChanged",function(e,title,type){that.$tweetButton[0].childNodes[0].nodeValue=type=="dm"?_("Send Message"):_("Tweet")});this.editor.bind("didChangeContent",twttr.bind(this,function(e,text){if(text.match(sendingDirectMessage)){if(!isDm){isDm=true;isReply=isMention=isUpdate=false;var username=RegExp.$1;var title=_("Message {{username}}",{username:username});this.$title.html(title);this.trigger("titleChanged",[title,"dm"])}}else{if(this.options.statusAction=="reply"&&text.match(new RegExp("[@]"+this.options.data.screenName+" "))){if(!isReply){isReply=true;isDm=isMention=isUpdate=false;var title=_("Reply to @{{username}}",{username:this.options.data.screenName});this.$title.html(title);this.trigger("titleChanged",[title,"reply"])}}else{if(text.match(twttr.constants.regexps.usernameWithAt)){if(!isMention){isMention=true;isDm=isReply=isUpdate=false;var title=_("Mention {{username}}",{username:RegExp.$1});this.$title.html(title);this.trigger("titleChanged",[title,"mention"])}}else{if(!isUpdate){isUpdate=true;isDm=isReply=isMention=false;this.$title.html(defaultOptions.template.title);this.trigger("titleChanged",defaultOptions.template.title,"update")}}}}}))}this.trigger("ready")}})}());twttr.klass.component("twttr.components.TweetboxAutocomplete").initializer(function(tweetbox){var that=this;this.tweetbox=tweetbox;this.places=tweetbox.places;this.autocomplete=new twttr.components.Autocomplete({input:tweetbox.editor.$editor,textarea:true,limit:10});this.autocomplete.bind("select",function(e){that.tweetbox.editor.trigger("didChangeContent")});this.tweetbox.editor.bind("heightChange",twttr.bind(this.autocomplete,this.autocomplete.position));this.bindGeoEvents();tweetbox.bind("open",function(e){twttr.components.Autocomplete.getAutocompletedUsers();that.autocomplete.position()});tweetbox.$container.delegate(".geo-insert-place-button","click",twttr.bind(this,function(e){this.autocomplete.insertPlace();return false}))}).statics({shouldProfile:false}).methods({bindGeoEvents:function(){var that=this;this.autocomplete.bind("selectPlace",function(e,id,start,end){for(var i=that.tweetbox.places.length-1;i>=0;i--){var place=that.tweetbox.places[i];if(start<place.indices[1]&&end>place.indices[0]){that.tweetbox.places.splice(i,1)}}that.tweetbox.places.push({id:id,indices:[start,end]})});this.autocomplete.bind("substitution",function(e,prefixLength,oldLength,newLength,text){for(var i=that.tweetbox.places.length-1;i>=0;i--){var place=that.tweetbox.places[i];for(var j=0;j<2;j++){var index=place.indices[j];if(index>=prefixLength){if(index<prefixLength+oldLength){place.indices[j]=prefixLength+newLength}else{if(j===1&&index===prefixLength+oldLength&&text.charAt(prefixLength)===" "){}else{place.indices[j]+=newLength-oldLength}}}}if(place.indices[1]<=place.indices[0]){that.tweetbox.places.splice(i,1)}}})}});twttr.tweetCache={get:function(id){return this._cache[id]},put:function(tweet){this._cache[tweet.id]=tweet},putAll:function(tweets){tweets.each(function(tweet){twttr.tweetCache.put(tweet)})},dirty:function(id){delete this._cache[id]},has:function(id){return !!this._cache[id]},_cache:{}};twttr["interface"]={setup:function(){$("a[href^=#]").live("click",function(e){e.preventDefault()});$(".user-profile-link").live("click",twttr.scribbles.logViewProfileDetails);$("a[href^=/]").live("click",function(event){var $this=$(this),href=$this.attr("href"),target=$this.attr("target");if((target&&twttr.router.shouldRedirectTo(href))||event.metaKey||event.shiftKey){return }twttr.router.routeTo($this.attr("href"));event.preventDefault();return false});$(document).delegate("a[href^=http:]","click",function(e){var destUrl=e.target.href;if(twttr.isSSL()&&twttr.decider.isAvailable("https_referers")&&!!e.target.target){e.preventDefault();var cookieNum=Math.floor(Math.random()*1000000);var date=new Date();date.setTime(date.getTime()+(10*60*1000));document.cookie="redir_"+cookieNum+"="+encodeURIComponent(destUrl)+"; expires="+date.toGMTString()+"; path=/redirector;";var bounce="http://"+twttr.domains.local+"/redirector#target="+encodeURIComponent(destUrl)+"&cookie="+cookieNum;window.open(bounce,"redirector")}});$(".user-thumb-list-member img").tipsy({live:true,gravity:"s"});$("div.tweet a.twitter-timeline-link").live("mousedown",function(){var $this=$(this);var data={};if($this.is("div.dashboard a")){data.component="dashboard"}else{if($this.is("div.details-pane a")){data.component="details-pane"}else{if($this.is(".stream-tweet a")){data.component="stream"}else{if($this.is(".twttr-dialog a")){data.component="dialog";data.dialog_type=$this.closest(".twttr-dialog").attr("type")}}}}twttr.viewHelpers.addExtraLogging($this,data,"tweet-link");data.tweet_id=$this.closest(".tweet").attr("data-tweet-id");data.input="click";data.href=$this.attr("href");data.text=$this.text();scribble("tweet-link",data);if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","link_click_from_home_timeline",{tweet_id:data.tweet_id})}});$(".media-attribution-link").live("click",function(e){scribble("follow-attribution-link",{component:"inline-media",input:"click",type:$(this).attr("data-media-type")})});$(".inline-media-image").live("click",function(e){scribble("open-inline-media-photo",{component:"inline-media",input:"click",type:$(this).attr("data-media-type")})});$("#new-tweet").click(function(e){new twttr.widget.TweetDialog({modal:false,draggable:true,template:{title:_("Whats happening?")},origin:"new-tweet-titlebar-button"}).open().focus()}).tipsy({gravity:"e"});twttr.helpers.ellipsify($("#screen-name"));$("#search-form .glass").click(function(e){$("#search-form").submit()});$("#search-form").submit(function(e){var $query=$("#search-query");if($query.val()){twttr.search.doSearch()}e.preventDefault()});$("#message-drawer").delegate(".dismiss","click",function(){twttr.views.MessageDrawer.close();return false});$(".mention-action").live("click",function(e){var $this=$(this);var screenName=$this.attr("data-screen-name");twttr.userActions.mention(screenName);return false});$(".signout-button").click(function(event){event.preventDefault();twttr.router.routingEnabled=false;$.ajax({url:$("#signout-form").attr("action"),type:"POST",dataType:"json",data:{authenticity_token:$("#authenticity_token").val(),redirect:false},complete:function(e){var response;try{response=JSON.parse(e.responseText)}catch(e){response={}}function redirect(){window.location=response.redirect;window.location.reload(true)}if(response.status!=="ok"||!response.redirect){window.location.reload(true);return }if(!window.applicationCache){redirect();return }window.applicationCache.addEventListener("obsolete",function(e){redirect()},false);window.applicationCache.addEventListener("error",function(e){redirect()},false);try{window.applicationCache.update()}catch(e){redirect()}}});$.ajax=$.noop});$(".back-to-top").live("click",function(event){$(window).scrollTop(0);event.preventDefault();return false});$(".sms-codes-link").live("click",function(e){twttr.dialogs.smsCodes().open()});$(".use-old-twitter").live("click",function(event){$.cookie("phx_seen_banner",null);$.cookie("phx_seen_dialog-"+twttr.currentUser.id,null)});$(".contributor-account-link").each(function(e){var $this=$(this);var profileImageURL=$this.attr("data-profile-image-url");if(window.location.protocol==="https:"&&twttr.cdnBase){profileImageURL=twttr.assets.getPathFromAbsoluteURL(profileImageURL,{isSSL:true,isVersioned:false})}$this.find("img").attr("src",profileImageURL)});$("#search-query").bind("keyup keypress keydown",function(e){e.stopPropagation()}).bind("keydown",function(e){if(e.keyCode===twttr.constants.keyCodes.escape){twttr.search.clear()}});var initialLoginTime=parseInt(twttr.util.params($.cookie("twll"))["l"],10)||0;twttr.verifySession=function(){var loginTime=parseInt(twttr.util.params($.cookie("twll"))["l"],10)||0;if(loginTime!==initialLoginTime){window.location.reload(true)}};window.setInterval(twttr.verifySession,twttr.constants.sessionPollInterval);if(!$.browser.msie){$(window).focus(function(){twttr.verifySession()})}else{document.onfocusout=function(){twttr.verifySession()}}$(window).scrollTop(0);var appCache=window.applicationCache;if(appCache&&document.getElementsByTagName("html")[0].hasAttribute("manifest")){function checkRequiredVersion(){using(">bootstrap_data",function(data){var store=new twttr.cache.LocalProvider("appcache");var ourMajorVersion=store.get("majorVersion")||0;var requiredMajorVersion=data.appcacheRequiredMajorVersion;store.set("majorVersion",requiredMajorVersion);if(ourMajorVersion<requiredMajorVersion){window.location.reload(true)}})}function listen(ev,cb){appCache.addEventListener(ev,cb,false)}listen("updateready",function(e){if(appCache.status!==appCache.UPDATEREADY){return }appCache.swapCache();checkRequiredVersion()});listen("noupdate",checkRequiredVersion);if(twttr.util.params()["appcache"]){$.each("cached checking downloading error noupdate obsolete progress updateready".split(" "),function(i,eventName){listen(eventName,function(){console.log("Application cache %s %o",eventName,arguments)})})}appCache.update()}}};$(document).ready(function(){var $session=$("#session"),isOnLoginPage=twttr.app&&twttr.app.isOnPage("login");$session.click(function(){if(isOnLoginPage){twttr.router.routeTo(twttr.router.signupPath())}else{$session.toggleClass("active");if(!twttr.loggedIn&&$session.hasClass("active")){$session.find(".username input").focus()}}});$(document).bind("click",function(e){var sessionElem=$session.get(0);if(e.target!==sessionElem&&!$.contains(sessionElem,e.target)){$session.removeClass("active")}}).bind("keydown",function(e){if(e.keyCode===27){$session.removeClass("active")}});if(!twttr.loggedIn){$("#session > a").attr("href","#");var $form=$("#signin-dropdown form");$form.bind("click",function(e){e.stopPropagation()});if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){$form.find("input").each(function(){if(this.type.match(/text|password/)){var el=$(this);el.clone().appendTo(el.parent());el.remove()}})}if(twttr.helpers){twttr.helpers.addFormEvents($form)}$form.find("input").bind("focus",function(){if(isOnLoginPage){twttr.app.currentPage().$find(".username input").focus()}else{$session.addClass("active")}})}});twttr.app.bind("init",function(event){$(document).bind("keydown",twttr.shortcuts.openDialogs);$(document).bind("keydown",twttr.shortcuts.closeDialogs);$(document).bind("keypress","/",twttr.shortcuts.focusSearchBox);$(document).bind("keypress",twttr.shortcuts.openKeyboardDialog);twttr.shortcuts.delegateToApp();twttr.shortcuts.initCombos();twttr.shortcuts.initSecrets();$("#keyboard-shortcut-trigger").live("click",function(e){e.preventDefault();twttr.dialogs.keyboardShortcuts().open()})});twttr.shortcuts={delegateToApp:function(){$(document).bind("keypress",function(e){return twttr.app.currentPage().onkeypress(e)});$(document).bind("keyup",function(e){return twttr.app.currentPage().onkeyup(e)});$(document).bind("keydown",function(e){return twttr.app.currentPage().onkeydown(e)})},focusSearchBox:function(e){e.preventDefault();$("#search-query").focus();scribble("search-box-focus",{input:"keyboard"})},initCombos:function(){twttr.shortcuts.currentKey=null;var combos=[];var numberToKeyMap={71:"g",85:"u",82:"r",80:"p",72:"h",70:"f",88:"x",77:"m"};$(document).keydown(function(e){if(twttr.shortcuts.verify(e)&&$(e.target).is(":not(input)")){e.preventDefault()}else{twttr.shortcuts.currentKey=null}});twttr.augmentString("twttr.shortcuts.combo",function(combo,fn){combos.push({keys:combo,fn:fn})});twttr.augmentString("twttr.shortcuts.verify",function(e){var pressedKey=e.keyCode;var prevent=false;for(var i=0;i<combos.length;i++){var combo=combos[i];if(numberToKeyMap[pressedKey]===combo.keys[0]){prevent=true;twttr.shortcuts.currentKey=numberToKeyMap[pressedKey];break}else{if(numberToKeyMap[pressedKey]===combo.keys[1]&&twttr.shortcuts.currentKey===combo.keys[0]){prevent=true;twttr.shortcuts.currentKey=null;combo.fn();break}}}return prevent});twttr.shortcuts.combo(["g","u"],function(){scribble("open-goto-user-dialog",{input:"keyboard"});twttr.components.Autocomplete.getAutocompletedUsers();twttr.dialogs.goToUser().open()});if(twttr.loggedIn){twttr.shortcuts.combo(["g","r"],function(){scribble("switch-stream",{input:"keyboard",toStream:"mentions"});twttr.router.routeTo(twttr.router.mentionsPath())});twttr.shortcuts.combo(["g","p"],function(){scribble("switch-page",{input:"keyboard",toPage:"profile"});twttr.router.routeTo(twttr.router.profilePath({screen_name:twttr.currentUser.screenName}))});twttr.shortcuts.combo(["g","m"],function(){scribble("switch-page",{input:"keyboard",toPage:"messages"});twttr.router.routeTo(twttr.router.messagesPath())});twttr.shortcuts.combo(["g","h"],function(){scribble("switch-stream",{input:"keyboard",toStream:"home"});twttr.router.routeTo(twttr.router.homePath())});twttr.shortcuts.combo(["g","f"],function(){scribble("switch-stream",{input:"keyboard",toStream:"favorites"});twttr.router.routeTo(twttr.router.favoritesPath())});twttr.shortcuts.combo(["g","x"],function(){if(twttr.decider.isAvailable("muteUsers")){twttr.components.Autocomplete.getAutocompletedUsers();new twttr.widget.MuteDialog().open()}})}},initSecrets:function(){if(twttr.loggedIn){twttr.provide("twttr.secrets");twttr.secrets.secretSauce=function(secret,sauce){$(document).bind("keydown",sauce.split("->"),function(e){if(twttr.decider.isAvailable(secret)){twttr.secrets[secret]=!twttr.secrets[secret]}})};twttr.secrets.secretSauce("hideMentions","x->o");twttr.secrets.secretSauce("allMedia","x->i")}},openDialogs:function(e){if(!twttr.loggedIn||twttr.shortcuts.currentKey){return }if(twttr.helpers.isModifier(e)||$(e.target).is("input")){return }if(e.keyCode===77){twttr.dialogs.directMessage({origin:"message-dialog-hotkey"}).open();scribble("dialog-direct-message",{input:"keyboard"});e.preventDefault()}else{if(e.keyCode===78){new twttr.widget.TweetDialog({draggable:true,modal:false,template:{title:_("Whats happening?")},origin:"new-tweet-hotkey"}).open().focus();scribble("dialog-new-tweet",{input:"keyboard"});e.preventDefault()}}},closeDialogs:function(e){if(e.keyCode===twttr.constants.keyCodes.escape){if(twttr.widget.Dialog.currentModal){twttr.widget.Dialog.close();e.stopPropagation();e.preventDefault()}}},openKeyboardDialog:function(e){if(e.charCode==twttr.constants.charCodes.questionMark){e.preventDefault();twttr.dialogs.keyboardShortcuts().toggle();scribble("shortcut-dialog",{input:"keyboard"})}}};twttr.app.bind("init",function(event){$(document.body).bind("copy",twttr.bind(twttr.tco,twttr.tco.onCopy));$(document.body).bind("aftercopy",twttr.bind(twttr.tco,twttr.tco.onAfterCopy))});twttr.provide("twttr.tco");twttr.tco={onCopy:function(e){var sel,originalRange;var shouldRefreshSelection=twttr.is.fn(window.getSelection);if(shouldRefreshSelection){originalRange=this.getCurrentRange()}if(!this.displayToTco($(e.target))){return }window.setTimeout(function(){$(document.body).trigger("aftercopy",[e,originalRange])},0)},displayToTco:function($target){var didModifyLinks=false;$target.find("a.twitter-timeline-link").each(function(i,elem){var $elem=$(elem);if($elem.attr("href").match(/^http:\/\/t.co\//)){$elem.attr("data-display-url",$elem.html());$elem[0].innerHTML=$elem.attr("href");didModifyLinks=true}});return didModifyLinks},tcoToDisplay:function($target){$target.find("a.twitter-timeline-link").each(function(i,elem){var $elem=$(elem);if($elem.attr("data-display-url")){$elem[0].innerHTML=$elem.attr("data-display-url");$elem.attr("data-display-url",null)}})},getCurrentRange:function(){var sel=window.getSelection();return{anchorNode:sel.anchorNode,anchorOffset:sel.anchorOffset,focusNode:sel.focusNode,focusOffset:sel.focusOffset}},onAfterCopy:function(event,e,originalRange){this.tcoToDisplay($(e.target));if(originalRange){this.updateSelection(originalRange)}},updateSelection:function(rangeNodes){var sel=window.getSelection();var range=document.createRange();range.setStart(rangeNodes.anchorNode,rangeNodes.anchorOffset);range.setEnd(rangeNodes.focusNode,rangeNodes.focusOffset);sel.removeAllRanges();sel.addRange(range)}};(function(twttr){var timeouts={ACTIVE:30000,INACTIVE:90000};var currentTimeout=timeouts.ACTIVE;$(window).focus(function(){currentTimeout=timeouts.ACTIVE});$(window).blur(function(){currentTimeout=timeouts.INACTIVE});twttr.tweetStream=function(ns,fn){if(!fn){fn=function(){twttr.streams.TweetStream.apply(this,arguments)}}var klass=twttr.stream(ns,fn);klass.subclassOf(twttr.streams.TweetStream);klass.prototype._updateMethod=function(){};klass.update=function(m){this.prototype._updateMethod=m;return this};klass.every=function(seconds){this.prototype._interval=seconds*1000;return this};klass.setTitle=function(title){this.prototype._setTitle=title;return this};klass.deciderKey=function(key){klass._deciderKey=key;return klass};klass.pollingDeciderKey=function(key){klass._pollingDeciderKey=key;return klass};return klass};twttr.klass("twttr.streams.TweetStream",function(){var that=this;twttr.streams.Stream.apply(this,arguments);twttr.API.User.bind("block",function(event,user){that.blockTweetsBy(user)});twttr.API.User.bind("unblock",function(event,user){that.blockTweetsBy(user,true)});var that=this;this.bind("didTweet",function(e,tweet){that.fetchTweets(function(stream){stream.render()})});this.registerTweetActionEvents();this.updateI18nDisplay();this.registerTweetFeedbackEvents();this.periodicUpdater=null}).subclassOf(twttr.streams.Stream).mixin(twttr.mixins.tweetActionable,twttr.mixins.i18nTweet).methods(twttr.EventProvider).methods({itemViewClass:"StreamTweet",streamItemType:"tweet"}).methods({_fetchCount:function(){},_fetchMoreCount:function(){return 20},afterFirstSwitchingTo:function(callback){var that=this;var startTime=new Date();var fetchTweetsProfiler=new twttr.util.Profiler(this.constructor._namespace+".afterFirstSwitchingTo.fetchTweets");if(!this._attachedTweetBarEvent){this._attachedTweetBarEvent=true;this.dom().delegate("#new-tweets-bar","click",function(){that._showNewItems()})}this.startPeriodicFetcher();this._loadedStreamOnce=true;this.isLoadingMore();this.fetchTweets(true,function(stream,status){fetchTweetsProfiler.done();stream.render();if(twttr.util.Profiler.isEnabled()&&twttr.app.currentPage()&&twttr.app.currentPage().profiler&&!twttr.app.currentPage().profiler.isComplete){twttr.app.currentPage().profiler.waypoint("tweets_visible")}stream.doneLoadingMore();if(status!==twttr.streams.SUCCESS){that._showError(status)}else{that.fetchUntilScreenIsFull()}if(that.constructor._namespace=="twttr.streams.Home"){twttr.abdecider.track("home_timeline_collapsing-36","streams_Home_afterFirstSwitchingTo_timing",{event_value:new Date()-startTime})}callback?callback():$.noop})},fetchUntilScreenIsFull:function(){var that=this;if(!this.noMoreOldItems&&this._isInDOM()&&this._shorterThanWindow()){this.getMoreOldItems(function(stream,status){if(status!==twttr.streams.SUCCESS){that._showError(status)}else{that.fetchUntilScreenIsFull()}})}},_isInDOM:function(){return jQuery.contains(document.body,this.$node[0])},_shorterThanWindow:function(){return this.$node.height()<$(window).height()},afterSwitchingToAgain:function(callback){var fetchTweetsProfiler=new twttr.util.Profiler(this.constructor._namespace+".afterSwitchingToAgain.fetchTweets");this.fetchTweets(twttr.bind(this,function(stream){fetchTweetsProfiler.done();var count=this.newItemsCount;if(this.newItemsCount>0){this._showNewItems()}this.restartFetcher();var firstItem=this.getFirstItem();this.highlightItem(firstItem);callback?callback():$.noop}))},_getStreamWhaleText:function(){return _("Loading Tweets seems to be taking a while.")},blockTweetsBy:function(user,undo){var onBlockedProfile=this.constructor._name==="User"&&this.screenName===user.screenName,onSearch=this.constructor._name==="Search";if(onBlockedProfile||onSearch){return }var streamItems=this.$find('.stream-item [data-screen-name="'+user.screenName+'"]').parent();streamItems[undo?"addClass":"removeClass"]("blocked")},onTweetActionDelete:function(tweetId){this.remove(tweetId);for(var i=0;i<this.items.length;i++){if(this.items[i].id===tweetId){this.items.splice(i,1)}}},onTweetActionHide:function(tweetId){this.selectedItem(tweetId).hide()},onTweetActionShow:function(tweetId){this.selectedItem(tweetId).show()},beforeShowNewItems:function(){this.$find(".last-new-tweet").removeClass("last-new-tweet");this.$find(".stream-item").first().addClass("first-old-tweet");var that=this;var promotedItems=twttr.filter(this.items.slice(this.newItemsCount),function(item){return item.isPromoted()});twttr.each(promotedItems.reverse(),function(item){that.items.unshift(item);if(that.newItemsCount>that.NEW_ITEMS_COUNT_MAX&&that.itemIds!==undefined){delete that.itemIds[item.id]}});this.newItemsCount+=promotedItems.length},separateOldAndNewTweets:function(){if(this.$find(".first-old-tweet").length>0){$(this.$find(".first-old-tweet")[0].previousSibling).addClass("last-new-tweet");this.$find(".first-old-tweet").removeClass("first-old-tweet")}},onShowNewItems:function($html){this.addInlineMediaIcons($html);this.separateOldAndNewTweets();this.addHashflags($html);this.addI18nDisplay($html);this.$find("#new-tweets-bar").remove()},onShowOldItems:function($html){this.addInlineMediaIcons($html);this.addHashflags($html);this.addI18nDisplay($html)},addHashflags:function($html){if(!twttr.decider.isAvailable("hashflags")){return }$html.each(function(i,tweet){$(tweet).find(".tweet-text a.twitter-hashtag").each(function(i,hashtag){var $hashtag=$(hashtag);var hashtagText="|"+$hashtag.text().toLowerCase()+"|";var allowedHashtags="|#superbowl|#sb45|#sbxlv|#steelers|#packers|#sb|";if(allowedHashtags.indexOf(hashtagText)!=-1){$hashtag.addClass("superbowl")}})})},addI18nDisplay:function($html){var that=this;$html.find(".tweet").each(function(){that.updateI18nDisplay($(this))})},beforeSwitchingAway:function(){this.stopPeriodicFetcher()},_fetchItems:function(cb){this.fetchTweets(true,cb)},fetchTweets:function(willFetchOlder,cb,initialOptions){if(twttr.is.fn(willFetchOlder)){initialOptions=cb;cb=willFetchOlder;willFetchOlder=false}if(!twttr.decider.isAvailable("tweet_streams")||(this.constructor._deciderKey&&!twttr.decider.isAvailable(this.constructor._deciderKey))){cb(this,twttr.streams.DECIDER);return }var that=this;var audit=twttr.audit.trail();var options=willFetchOlder?this._optionsForOld(cb):this._optionsForNew(cb);initialOptions=initialOptions||{};options=twttr.merge(initialOptions,options);options.include_entities=1;options.include_available_features=1;options.contributor_details=!audit[1]||audit[1].page!=="welcome";this._updateMethod(options,this.params,cb)},_idForTweet:function(tweet){return tweet.wasRetweeted?tweet.retweetingStatus.id:tweet.id},_optionsForNew:function(cb){var that=this;var options={success:function(tweets){if(tweets instanceof twttr.API.util.BaseCollection){tweets=tweets.array}tweets=that.cleanStream(tweets);that.unshift(tweets);that._updateSinceId(tweets);if(cb){cb(that,twttr.streams.SUCCESS)}},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}}};if(this.items.length){options.since_id=this._sinceId}return options},_updateSinceId:function(tweets){if(!twttr.is.array(tweets)){tweets=Array.prototype.slice.call(arguments)}for(var i=0;i<tweets.length;i++){var tweet=tweets[i],id=this._idForTweet(tweet);if(!tweet.isPromoted()&&tweet.resultCategory!=="popular"){if(twttr.util.natcompare(id,this._sinceId||"0")>0){this._sinceId=id}return }}},cleanStream:function(tweets){tweets=this._filterMutedUsers(tweets);tweets=this._filterDeletedTweets(tweets);tweets=this._filterOutRetweets(tweets);return tweets},_filterOutRetweets:function(tweets){if(!twttr.currentUser){return tweets}return twttr.filter(tweets,function(tweet){if(!tweet.wasRetweeted){return tweet}return tweet})},_filterMutedUsers:function(tweets){if(!twttr.decider.isAvailable("muteUsers")){tweets}if(twttr.currentUser&&this.constructor._name=="Home"){var peoples=twttr.caches.User.get("muted");tweets=twttr.filter(tweets,function(tweet){if(!twttr.is.def(peoples)||(tweet.wasRetweeted&&!twttr.is.def(peoples[tweet.retweetingStatus.user.id]))||(!tweet.wasRetweeted&&!twttr.is.def(peoples[tweet.user.id]))){return tweet}})}return tweets},_filterDeletedTweets:function(tweets){return twttr.filter(tweets,function(tweet){if(!twttr.app.caches.deletedTweets.get(tweet.id)){return tweet}})},hasPromotedContent:function(){for(var i=0;i<this.items.length;i++){if(this.items[i].isPromoted()){return true}}return false},_optionsForOld:function(cb){var that=this;var options={success:function(tweets){if(options.max_id){tweets=tweets.slice(1)}if(tweets instanceof twttr.API.util.BaseCollection){tweets=tweets.array}tweets=that.cleanStream(tweets);that.push(tweets);that._updateSinceId(tweets);if(!tweets.length){that.reachedTheEnd()}if(cb){cb(that,twttr.streams.SUCCESS)}},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}},timeout:function(request){request.retry()},cancel:function(){cb(that,twttr.streams.TIMEOUT)}};if(this.items.length){options.max_id=this._idForTweet(this.items[this.items.length-1]);options.count=this._fetchMoreCount()+1}else{if(this._fetchCount()){options.count=this._fetchCount()}}return options},_getInterval:function(){return currentTimeout},startPeriodicFetcher:function(){if(this.periodicUpdater||!twttr.decider.isAvailable("tweet_streams_polling")||(this.constructor._pollingDeciderKey&&!twttr.decider.isAvailable(this.constructor._pollingDeciderKey))){return }this.periodicUpdater=setTimeout(twttr.bind(this,this.fetchNewTweetsThenPoll),this._getInterval())},fetchNewTweetsThenPoll:function(){var pollOptions={headers:{"X-Twitter-Polling":true}};this.fetchTweets(twttr.bind(this,function(stream){var count=stream.newItemsCount;if(count>0){this.showNewTweetsBar(count);this.trigger("newTweets",[stream,count])}}),pollOptions);this.restartFetcher()},stopPeriodicFetcher:function(){if(this.periodicUpdater){clearTimeout(this.periodicUpdater);this.periodicUpdater=null}},restartFetcher:function(){this.stopPeriodicFetcher();this.startPeriodicFetcher()},addInlineMediaIcons:function($html){new twttr.media.Iconifier($html)},showNewTweetsBar:function(count){var $bar=this.$find("#new-tweets-bar");var countPhrase=count==1?_("1 new tweet"):_("{{count}} new tweets",{count:count});if($bar.length>0){$bar.html(countPhrase)}else{$bar=$(new twttr.views.NewTweetsBar({count:count,tweets_count_phrase:countPhrase}).html());$bar.hide().prependTo(this.dom()).slideDown()}}});twttr.tweetStream("twttr.streams.Home",function(){twttr.streams.TweetStream.apply(this,arguments)}).update(function(options,params,originalCallback){options.pc=true;twttr.currentUser.homeTimeline(options)}).methods({VIEWABLE_PAGE:10,MIN_ITEMS_TO_COLLAPSE:4,_fetchCount:function(){return this._collapsingEnabled()?twttr.API.homeTimelineFetchSize:null},_fetchMoreCount:function(){return this._collapsingEnabled()?twttr.API.homeTimelineFetchSize:20},_collapsingEnabled:function(){return twttr.abdecider.choose("home_timeline_collapsing-36",true)=="use_collapsing"},_useCollapsing:function(items){if(!this._collapsingEnabled()){return false}var size=0;var allSame=true;var first=null;twttr.each(items,function(item){if(!first){first=item.user.id}allSame=allSame&&(item.user.id==first);size++});return size>20&&!allSame},_isHideable:function(status){return status.user.id!=twttr.currentUser.id&&status.inReplyToUserId!=twttr.currentUser.id},_collapseItems:function(items){var that=this;var collapsedItems=[];var hiddenItemsView=null;twttr.each(items,function(item,idx){var hide=idx>0&&item.user.id==items[idx-1].user.id&&that._isHideable(item)&&(!hiddenItemsView||that._sameDisplayDay(item,hiddenItemsView.items[0]));if(hide){if(!hiddenItemsView){hiddenItemsView=new twttr.views.HiddenStreamItems()}hiddenItemsView.addItem(item)}if(hiddenItemsView&&(!hide||idx==items.length-1)){var renderedHidden=false;twttr.each(hiddenItemsView.items,function(hiddenItem){if(hiddenItemsView.items.length>=that.MIN_ITEMS_TO_COLLAPSE-1){hiddenItem.hidden_id=hiddenItemsView.hidden_id();renderedHidden=true}else{collapsedItems.push(hiddenItem)}});if(renderedHidden){collapsedItems.push(hiddenItemsView)}hiddenItemsView=null}if(!hide){collapsedItems.push(item)}});var visibleItems=twttr.filter(collapsedItems,function(item){return !item.hidden_id});if(visibleItems.length>=this.VIEWABLE_PAGE&&this._numUniqueUsersOnPage(visibleItems)<=this._numUniqueUsersOnPage(items)){collapsedItems=items;twttr.each(items,function(item){delete item.hidden_id})}return collapsedItems},_numUniqueUsersOnPage:function(items){var num=0,done={};for(var i=0,length=items.length;i<length&&i<this.VIEWABLE_PAGE;i++){var val=items[i].user.id;if(!done[val]){done[val]=true;num++}}return num},_sameDisplayDay:function(startStatus,endStatus){var day=24*60*60*1000;var rightNow=new Date;var endStatusDate=new Date(twttr.helpers.parseDateString(endStatus.createdAt));var startStatusDate=new Date(twttr.helpers.parseDateString(startStatus.createdAt));if(rightNow-endStatusDate<day){return rightNow-startStatusDate<day}return endStatusDate.toDateString()==startStatusDate.toDateString()},_getStreamEndComponent:function(){return this.constructor.uber._getStreamEndComponent.apply(this,arguments)},_getEmptyStreamComponent:function(){var component=new twttr.components.EmptyHome(),eventType="newItemsCountChanged.EmptyHomeComponent",stream=this;this.bind(eventType,function(e,count){if(!count&&!stream.isEmpty()){component.destroy();stream.unbind(eventType);stream._alreadyMarkedEnd=false;stream.markStreamEnd()}});return component}}).deciderKey("tweet_stream_home").pollingDeciderKey("tweet_stream_home_polling");twttr.tweetStream("twttr.streams.Mentions").statics({isLoadingRelationships:false}).setTitle(function(cb){cb(_("Tweets mentioning {{username}}",{username:"@"+twttr.currentUser.screenName}))}).update(function(options,params,originalCallback){var that=this;if(twttr.secrets&&twttr.secrets.hideMentions){var success=options.success;options.success=function(resp){success.apply(options,arguments);if(that.constructor.isLoadingRelationships){return }that.constructor.isLoadingRelationships=true;setTimeout(function(){var data={user_a:twttr.currentUser.id,user_ids:resp.map(function(status){return status.user.id}).join(",")};$.ajax({url:"/account/batch_followed_by",data:data,dataType:"jsonp",type:"get",success:function(json){var selector=[];for(var key in json.relationships){if(!json.relationships[key]){selector.push(".stream-tweet[data-user-id="+key+"]")}}if(selector.length>0){$(selector.join(",")).hide()}that.constructor.isLoadingRelationships=false}})},10)}}twttr.currentUser.mentions(options)}).methods({_getEmptyStreamHtml:function(){return _("Tweets that mention you, or are in reply to you, appear here.")}}).deciderKey("tweet_stream_mentions").pollingDeciderKey("tweet_stream_mentions_polling");twttr.tweetStream("twttr.streams.Favorites").setTitle(function(cb){if(!this.screenName||this.stream_user_is_current_user()){cb(_("Your Favorites"))}else{cb(_("{{username}}'s Favorites",{username:this.screenName}))}}).update(function(options,params,originalCallback){if(!this.screenName){twttr.currentUser.favorites(options)}else{twttr.API.User.find(this.screenName).favorites(options)}}).methods({_getEmptyStreamHtml:function(){if(!this.screenName||this.stream_user_is_current_user()){return _("Your favorite tweets get saved here. To favorite a tweet, hover over it and click: <span class='favorite-icon'></span> <strong>Favorite</strong>")}else{return _("<b>@{{screen_name}}</b> hasn't favorited any Tweets yet.",{screen_name:this.screenName})}}}).deciderKey("tweet_stream_favorites").pollingDeciderKey("tweet_stream_favorites_polling");twttr.tweetStream("twttr.streams.User").update(function(options,params,originalCallback){options.cacheOptions={shouldCacheAssociated:false};options.include_rts=!this.params.noRetweets;if(this.params.canViewUser){twttr.API.User.find(this.params.screenName).timeline(options)}else{originalCallback(this,twttr.streams.PROTECTED)}}).methods({_getStreamErrorComponent:function(status){if(status===twttr.streams.PROTECTED){return new twttr.components.ProtectedUser({screen_name:this.params.screenName})}else{return this.constructor.uber._getStreamErrorComponent.apply(this,arguments)}},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You haven't tweeted yet.")}else{return _("@{{screen_name}} hasn't tweeted yet.",{screen_name:this.screenName})}}}).deciderKey("tweet_stream_user").pollingDeciderKey("tweet_stream_user_polling");twttr.tweetStream("twttr.streams.List").setTitle(function(cb){var that=this;this._getList(function(list){var viewParams={attributes:twttr.merge(that.params,list.attributes)};cb(new twttr.views.ListStreamTitle(viewParams).html())})}).update(function(options,params,originalCallback){this._getList(function(list){list.statuses(options)})}).methods({_getEmptyStreamComponent:function(){if(twttr.helpers.isCurrentUser(this.screenName)){return new twttr.components.AddPeople()}else{return new twttr.components.NoListMembers()}},_getList:function(cb){var that=this;this._fetchingCallbacks=this._fetchingCallbacks||[];this._fetchingCallbacks.push(cb);if(this._fetching){return }this._fetching=true;twttr.API.User.find(this.screenName,{success:function(u){u.lists.find(that.params.listSlug,function(list){if(!list){that.trigger("notFound");return }that.memberCount=list.memberCount;var cb;while(cb=that._fetchingCallbacks.pop()){cb(list)}that._list=list;that._fetching=false})},error:function(){that.trigger("notFound")}})}}).deciderKey("tweet_stream_list").pollingDeciderKey("tweet_stream_list_polling");twttr.tweetStream("twttr.streams.Search").setTitle(function(cb){if(!this.params.hideTitle){cb(new twttr.views.SearchStreamTitle(this.params).html())}}).update(function(options,params,originalCallback){var that=this;if(!options.since_id){var originalSuccess=options.success;options.success=function(statuses,resp){that.logPromotedImpressions(statuses);that.logSearchImpressions(statuses);that._next_page=resp.response.next_page;var returnValue=originalSuccess.apply({},arguments);if(!that._next_page&&!resp.response.served_by_blender){that.reachedTheEnd()}return returnValue}}if(options.max_id){options.page=that._next_page}if(this.params.debug){options.debug=this.params.debug}if(this.params.experimentId){options.experimentId=this.params.experimentId}if(this.params.mode==="links"){options.filter="links"}else{if(this.params.mode==="relevance"){options.mode="relevance"}}this.search(this.params.query,options)}).methods({_shouldCache:false,search:function(query,options){var that=this;this.$find(".stream-items").attr("data-search-query",query);if(this.inProgress){return }var overrideFn=function(originalCallback,inProgress){var originalCallback=originalCallback||$.noop;return function(){that.inProgress=inProgress;return originalCallback()}};options.before=overrideFn(options.before,true);options.complete=overrideFn(options.complete,false);options.cancel=overrideFn(options.cancel,false);twttr.API.Status.search(query,options)},scribeData:function(){return twttr.merge(twttr.streams.Stream.prototype.scribeData.apply(this),{query:this.params.query,type:this.params.mode})},logPromotedImpressions:function(statuses){statuses.each(function(status){if(status.isPromoted()){twttr.API.util.PromotedContent.logImpression(status.impressionId)}})},logSearchImpressions:function(statuses){var organicTweets=[],topTweets=[],promoted=[];statuses.each(function(status){if(status.isPromoted()){promoted.push(status.id)}else{if(status.resultCategory==="popular"){topTweets.push(status.id)}else{organicTweets.push(status.id)}}});scribble("integrated_search_impression",{mode:this.params.mode,query:this.params.query,pretty_query:this.params.pretty_query,top_tweets:topTweets,promoted_tweets:promoted,tweet_count:statuses.length()})},_getEmptyStreamHtml:function(){if(this.params.mode==="links"){return _("No Tweet results with links for <strong>{{pretty_query}}</strong>.",this.params)}else{return _("No Tweet results for <strong>{{pretty_query}}</strong>.",this.params)}},_getStreamEndHtml:function(){if(this.params.mode==="links"){return _("Older Tweet results with links for <strong>{{pretty_query}}</strong> are unavailable.",this.params)}else{if(this.params.mode==="relevance"){var options={path:twttr.router.searchRealtimePath({query:this.params.query}),pretty_query:this.params.pretty_query};return _('There are no more relevant results for <strong>{{pretty_query}}</strong>. View all <a href="{{path}}">unfiltered Tweets</a>.',options)}else{return _("Older Tweet results for <strong>{{pretty_query}}</strong> are unavailable.",this.params)}}},onGotInitialResults:function(){var organicTweetIds=[];twttr.each(this.items.slice(this.newItemsCount),function(status){if(!status.isPromoted()&&status.resultCategory!=="popular"){organicTweetIds.push(status.id)}});this.scribbler.scribe({section:"search",component:"",action:"results"},{query:this.params.query,item_ids:organicTweetIds})},onGotNewItems:function(newItems){var scribeParams={item_ids:newItems.map(function(item){return item.id}),query:this.params.query};this.scribbler.scribe({section:"search",component:"",action:"get_newer"},scribeParams)},onShowNewItems:function($html){this.constructor.uber.onShowNewItems.apply(this,arguments);var $promoted=this.$find(".promoted-tweet").parent();this.$streamItems().prepend($promoted)},onGotOldItems:function(oldItems){var scribeParams={item_ids:oldItems.map(function(item){return item.id}),position:this.items.length-this.oldItemsCount,query:this.params.query};this.scribbler.scribe({section:"search",component:"",action:"get_older"},scribeParams)}}).deciderKey("tweet_stream_search").pollingDeciderKey("tweet_stream_search_polling");twttr.tweetStream("twttr.streams.RetweetsByYou").setTitle(function(cb){cb(_("Retweets by you"))}).update(function(options,params,originalCallback){var oldSuccess=options.success;options.success=function(tweets){tweets.each(function(tweet){tweet.retweeted=tweet.attributes.retweeted=true});oldSuccess(tweets)};twttr.currentUser.retweeting(options)}).every(180).methods({_getEmptyStreamHtml:function(){return _("You haven't retweeted anything yet. To spread the word to your followers, hover over a Tweet and click: <span class='retweet-icon'></span> <strong>Retweet</strong>")}}).deciderKey("tweet_stream_retweets_by_you").pollingDeciderKey("tweet_stream_retweets_by_you_polling");twttr.tweetStream("twttr.streams.RetweetsByOthers").setTitle(function(cb){cb(_("Retweets by others"))}).update(function(options,params,originalCallback){twttr.currentUser.retweets(options)}).methods({_getEmptyStreamHtml:function(){return _("Tweets that are retweeted by others appear here.")}}).deciderKey("tweet_stream_retweets_by_others").pollingDeciderKey("tweet_stream_retweets_by_others_polling");twttr.tweetStream("twttr.streams.YourTweetsRetweeted").setTitle(function(cb){cb(_("Your tweets, retweeted"))}).update(function(options,params,originalCallback){twttr.currentUser.retweeted(options)}).methods({_getEmptyStreamHtml:function(){return _("You haven't been retweeted yet. Check back here to see who has retweeted your Tweets.")}}).deciderKey("tweet_stream_your_tweets_retweeted").pollingDeciderKey("tweet_stream_your_tweets_retweeted_polling");twttr.tweetStream("twttr.streams.Griffin").update(function(options,params,originalCallback){twttr.API.Status.griffinTimeline(this.params.griffinId,options)}).deciderKey("tweet_stream_griffin").pollingDeciderKey("tweet_stream_griffin_polling");twttr.tweetStream("twttr.streams.GriffinSocial").update(function(options,params,originalCallback){twttr.API.Status.griffinSocialTimeline(this.params.griffinId,options)}).deciderKey("tweet_stream_griffin_social").pollingDeciderKey("tweet_stream_griffin_social_polling");twttr.tweetStream("twttr.streams.GriffinMerged").update(function(options,params,originalCallback){twttr.API.Status.griffinMergedTimeline(this.params.griffinId,options)}).deciderKey("tweet_stream_griffin_merged").pollingDeciderKey("tweet_stream_griffin_merged_polling")}(twttr));twttr.klass("twttr.streams.StreamManager",function(){var that=this;this.$node=$("<div><div class='stream-title'></div><div class='stream-container'></div></div>");this.$titleContainer=this.$node.find("div.stream-title");this.$streamContainer=this.$node.find("div.stream-container");this.$moreButton=$("<a class='more-button'>"+_("more")+"</a>");if(!twttr.decider.isAvailable("infinite_scroll")){this.$moreButton.appendTo(this.$node).click(function(e){that.getMoreOldItems(function(stream){scribble("stream-more-button",{page:stream._cacheKey,stream:stream._cacheKey,focused_tweet_id:stream.focusedItemId||""});if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","more_button_from_home_timeline")}});e.stopPropagation();e.preventDefault();return false})}this.resetCache()}).statics({cacheKeyForStream:function(stream){return stream._cacheKey},cacheKeyForStreamClass:function(StreamClass,params){var key=StreamClass._name;if(params&&!$.isEmptyObject(params)){var safeParams=twttr.filter(params,function(k,v){return !twttr.is.fn(v)&&!twttr.is.object(v)});key+=JSON.stringify(safeParams)}return encodeURIComponent(key)}}).methods(twttr.EventProvider).methods({$find:function(){return this.$node.find.apply(this.$node,arguments)},getCurrent:function(){return this.streams.current},setCurrent:function(stream){this.streams.current=stream},getStream:function(StreamClass,params){var cacheKey=twttr.streams.StreamManager.cacheKeyForStreamClass(StreamClass,params);return this.streams[cacheKey]},onSwitchAway:function(){var currentStream=this.getCurrent();if(currentStream){currentStream.beforeSwitchingAway()}},switchTo:function(StreamClass,params,callback){var that=this,cacheKey=twttr.streams.StreamManager.cacheKeyForStreamClass(StreamClass,params),currentStream=this.getCurrent(),stream,loadedFromCache=false;var profiler=new twttr.util.Profiler("StreamManager."+StreamClass._namespace);if(twttr.app.currentPage){twttr.app.currentPage().profiler.waitFor(profiler)}callback=profiler.doneAfterCallback(callback||$.noop);scribble("stream-view",{stream_name:StreamClass._name});if(twttr.app.currentPageName()=="home"){twttr.abdecider.track("home_timeline_collapsing-36","view_home_timeline")}params=params||{};if(currentStream){var currentStreamCacheKey=twttr.streams.StreamManager.cacheKeyForStream(currentStream);if(currentStreamCacheKey===cacheKey){currentStream.afterSwitchingToAgain(callback);return }currentStream.beforeSwitchingAway();currentStream.dom().detach()}this.trigger("switchTo");if(this.streams[cacheKey]){stream=this.streams[cacheKey];loadedFromCache=true}else{stream=new StreamClass(params);stream._cacheKey=cacheKey;stream.bind("newItemsCountChanged",twttr.bind(this,function(e,itemCount){if(stream===this.getCurrent()){this.trigger("newItemsCountChanged",[itemCount])}}));stream.bind("notFound",twttr.bind(this,function(e){this.trigger("notFound")}));if(stream._shouldCache){this.streams[cacheKey]=stream}}this.$streamContainer.prepend(stream.dom());this.setTitle(stream);stream.bind("streamEnd",function(){if(!twttr.decider.isAvailable("infinite_scroll")){that.$moreButton.hide()}});stream._alreadyMarkedEnd?this.$moreButton.hide():this.$moreButton.show();this.setCurrent(stream);this.trigger("newItemsCountChanged",[stream.newItemsCount]);if(loadedFromCache){stream.afterSwitchingToAgain(callback)}else{stream.afterFirstSwitchingTo(callback)}return stream},setTitle:function(stream){this.$titleContainer.empty();stream._setTitle(twttr.bind(this,function(title){if(title){this.$titleContainer.html("<h2>"+title+"</h2>")}}))},getMoreOldItems:function(cb){if(this.getCurrent()){this.getCurrent().getMoreOldItems(cb)}},resetCache:function(){this.streams={};this.setCurrent(null)},clearFromCache:function(StreamClass,params){params=params||{};var cacheKey=twttr.streams.StreamManager.cacheKeyForStreamClass(StreamClass,params);delete this.streams[cacheKey]}});(function(){twttr.augString("twttr.views",{makeDefaultViews:function(templates){twttr.map(templates,function(v,k){var upperCamel=twttr.util.capitalize(twttr.util.camelize(k));twttr.views[upperCamel]=twttr.views[upperCamel]||twttr.view("twttr.views."+upperCamel)});provide(">defaultViews")}});twttr.view=function(ns,fn){if(!fn){fn=function(){twttr.views.Base.apply(this,arguments)}}var klass=twttr.klass(ns,fn);klass.subclassOf(twttr.views.Base);klass.template=function(t){this._template=t;return this};twttr.view._setDefaultTemplate(klass,ns);klass._partials=twttr.templates;return klass};twttr.view._setDefaultTemplate=function(klass,ns){klass.template(twttr.templates[twttr.util.underscore(ns.split(".")[2]).toLowerCase()])}}());twttr.klass("twttr.ViewStack",function(selector,operation){this.$referenceNode=$(selector);this.operation=operation||"append";this._cache={};this._stack=[]}).methods({cached:function(viewId){if(!twttr.is.string(viewId)){viewId=viewId.viewId}return twttr.is.def(this._cache[viewId])},size:function(){return this._stack.length},contains:function(view){return twttr.is.inArray(view,this._stack)},remove:function(view){delete this._cache[view.viewId]},top:function(depth){return this._stack[this._stack.length-1-(depth||0)]},push:function(view){var prev=this.top();if(prev&&prev._backLabel){view._backLabel=prev._backLabel;prev.hide()}if(!this.cached(view)){this._cache[view.viewId]=view;view._viewstack=this;this._stack.push(view);view.render(this.$referenceNode,this.operation)}else{view=this._cache[view.viewId];this._stack.push(view)}view.show();return view},pop:function(hidePreviousView){var currentView=this._stack.pop(),previousView=this._stack[this._stack.length-1];if(currentView){currentView.hide()}if(previousView&&!hidePreviousView){previousView.show()}return currentView?currentView:null},reset:function(view){while(this.pop()){}if(view){return this.push(view)}}});twttr.augString("twttr.puffin",function(){var expandedUrls={};return{expand:function(urls,callback){var expandedUrl,cacheHits={},cacheMisses=[];if(twttr.decider.isAvailable("phoenix_puffin")&&twttr.is.array(urls)){for(var i=0,len=urls.length;i<len;++i){var url=urls[i];if(expandedUrl=expandedUrls[url]){cacheHits[url]=expandedUrl}else{cacheMisses.push(url)}}if(cacheMisses.length===0){callback(cacheHits)}else{twttr.API.Urls.resolve(cacheMisses,function(expansions){for(var shortUrl in expansions){var longUrl=expansions[shortUrl];expandedUrls[shortUrl]=cacheHits[shortUrl]=longUrl}callback(cacheHits)})}}},cache:function(urls){for(var shortUrl in urls){expandedUrls[shortUrl]=urls[shortUrl]}}}}());(function(){twttr.provide("twttr.media");var matchCache={};var mediaHelpers={match:function(url){var didMatch,match,mediaType;if(match=matchCache[url]){return match.mediaType}$.each(twttr.media.types,function(klassName,klass){$.each(klass.matchers,function(label,matcher){match=twttr.is.regex(matcher)?url.match(matcher):matcher(url);if(match){matchCache[url]={mediaType:klass,matchLabel:label,match:RegExp.$1};mediaType=klass;return false}});if(match){return false}});return mediaType},matchInstance:function(url){var mediaType=this.match(url);if(mediaType){return new mediaType({url:url,matchLabel:matchCache[url].matchLabel,slug:matchCache[url].match})}},expand:function(urls,cb){twttr.puffin.expand(urls,function(expansions){cb(expansions)})},mediaTypes:function(urls,cb){var unmatchedLinks=[];var mediaTypes={};var matchUrl=function(index,url){var mediaType=twttr.media.match(url);if(!mediaType){unmatchedLinks.push(url)}else{mediaTypes[url]=mediaType}};$.each(urls,matchUrl);if(unmatchedLinks.length===0){cb(mediaTypes);return }else{twttr.media.expand(unmatchedLinks,function(expandedUrls){$.each(expandedUrls,matchUrl);cb(mediaTypes)})}},extractUrls:function(tweet){var urls={};if(tweet.entities&&tweet.entities.urls){$.each(tweet.entities.urls,function(i,entity){if(entity.expanded_url){urls[entity.url]=entity.expanded_url}});twttr.puffin.cache(urls)}$.each(twttr.txt.extractUrls(tweet.text),function(i,href){if(!urls[href]){urls[href]=href}});return urls},resolveImageUrl:function(url,size,options){var that=this;var mediaType=twttr.media.matchInstance(url);var errorCb=options.error?options.error:$.noop;if(mediaType&&mediaType.getImageURL){mediaType.getImageURL(size,function(resolvedURL){if(!twttr.is.nil(resolvedURL)&&twttr.is.def(resolvedURL)){options.success(resolvedURL)}else{errorCb("getImageUrl did not return a resolvedURL")}})}else{errorCb("url did not match any media types")}},iconType:function(url,mediaType){var mediaInstance=new mediaType({url:url,matchLabel:matchCache[url].matchLabel,slug:matchCache[url].match});return mediaInstance.icon()}};twttr.aug(twttr.media,{match:mediaHelpers.match,matchInstance:mediaHelpers.matchInstance,extractUrls:mediaHelpers.extractUrls,mediaTypes:mediaHelpers.mediaTypes,expand:mediaHelpers.expand,resolveImageUrl:mediaHelpers.resolveImageUrl,iconType:mediaHelpers.iconType});var Iconifier=twttr.klass("twttr.media.Iconifier",function(tweets){var that=this,$tweets=$(tweets);$tweets.attr("media",true);that.iconify($tweets.find("a.twitter-timeline-link").get(),true)});Iconifier.methods({expand:function(links,cb){var urls=[],expandedLinks=[];$.each(links,function(i,link){urls.push(link.href)});mediaHelpers.expand(urls,function(expansions){var expansion;$.each(links,function(i,link){expansion=expansions[link.href];if(expansion){link.setAttribute("data-expanded-url",expansion);link.setAttribute("title",expansion);expandedLinks.push(link)}});cb(expandedLinks)})},iconify:function(links,expandUnmatched){var that=this,unmatchedLinks=[];$.each(links,function(i,link){var $link=$(link),url=link.getAttribute("data-expanded-url")||link.href,mediaType=mediaHelpers.match(url);if(!mediaType){unmatchedLinks.push(link);return }var iconType=twttr.media.iconType(url,mediaType),$iconContainer=$link.closest(".stream-item").find(".inlinemedia-icons");if($iconContainer.find("span."+iconType).length===0){new twttr.views.InlineMediaIcon({icon:iconType,media_name:mediaType._name.toLowerCase()}).render($iconContainer,"append")}});if(expandUnmatched&&unmatchedLinks.length>0){this.expand(unmatchedLinks,function(expandedLinks){that.iconify(expandedLinks)})}}});var Embedder=twttr.klass("twttr.media.Embedder",function(tweet,options){this.tweet=tweet;this.options=options||{};this.options.preProcess=this.options.preProcess||function(instance,cb){cb()};this.options.postProcess=this.options.postProcess||function(){};this.options.beforeRender=this.options.beforeRender||function(instance,cb){cb({shouldRender:true})};this.options.afterRender=this.options.afterRender||function(){}});Embedder.methods({expand:function(urls,cb){var expandedUrls=[];mediaHelpers.expand(urls,function(expansions){$.each(expansions,function(shortUrl,longUrl){expandedUrls.push(longUrl)});cb(expandedUrls)})},render:function(cb){var that=this,urls=twttr.media.extractUrls(this.tweet);var unmatchedUrls=this.embedMatchedAndReturnUnmatched(urls);if(unmatchedUrls.length){this.expand(unmatchedUrls,function(expandedUrls){that.embedMatchedAndReturnUnmatched(expandedUrls)})}cb&&cb()},embedMatchedAndReturnUnmatched:function(urls){var that=this,unmatchedUrls=[];$.each(urls,function(i,url){var mediaType=mediaHelpers.match(url);mediaType?that.embed(url,mediaType):unmatchedUrls.push(url)});return unmatchedUrls},embedThumbnail:function(url){var that=this;var mediaType=mediaHelpers.match(url);if(!mediaType){return }var mediaInstance=new mediaType({url:url,matchLabel:matchCache[url].matchLabel,slug:matchCache[url].match,size:this.options.size});mediaInstance.process(function(){mediaInstance.renderThumbnail(that.options.DOMContainer)})},embed:function(url,mediaType){var that=this;var mediaInstance=new mediaType({url:url,matchLabel:matchCache[url].matchLabel,slug:matchCache[url].match,tweet:this.tweet});that.options.preProcess(mediaInstance,function(processOptions){mediaInstance.process(function(){that.options.postProcess(mediaInstance,processOptions||{});that.options.beforeRender(mediaInstance,function(renderOptions){var $container=new twttr.views.MediaTypeContainer({url:url,media_type:mediaInstance.constructor._name}).$html();that.options.DOMContainer.append($container);mediaInstance.render($container);if(!that.options.skipAttribution){$container.append(mediaInstance.attribution())}that.options.afterRender(mediaInstance,renderOptions||{})})},processOptions||{})})}})}());twttr.klass("twttr.media.MediaType",function(options){this.url=options.url;this.matchLabel=options.matchLabel;this.slug=options.slug;this.tweet=options.tweet||null;this.options=options||{};this.location=new twttr.util.Location(this.url);this.data={}});twttr.mediaType=function(ns,options){var klass=twttr.klass(ns,function(){twttr.media.MediaType.apply(this,arguments)});klass.subclassOf(twttr.media.MediaType).statics({favicon:options.favicon||null,domain:options.domain||"",title:options.title||null,_icon:options.icon||"generic",screenName:options.screenName||null,aspectRatio:options.aspectRatio||twttr.constants.videos.fullscreen,attributionTemplate:options.attributionTemplate||"        <div class='media-attribution'>          <span>via</span>          <img src='{{icon_url}}'/>          <a target='_blank' data-media-type='{{media_type}}' class='media-attribution-link' href='{{url}}'>{{title}}</a>        </div>",validActions:options.validActions||{},enableAPI:options.enableAPI||false,addMatchers:function(obj){for(var label in obj){this.matchers[label]=twttr.util.regexSupplant(obj[label])}}}).methods({process:options.process||function(){},render:options.render||function(){},getImageURL:options.getImageURL||function(){},metadata:function(cb){if(twttr.is.fn(options.metadata)){return options.metadata.apply(this,[cb])}},calcHeight:function(maxwidth,aspectRatio){if(!aspectRatio){aspectRatio=this.constructor.aspectRatio}var width=parseInt(aspectRatio.split(":")[0],10);var height=parseInt(aspectRatio.split(":")[1],10);var controlsHeight=30;return Math.round(maxwidth*(height/width))+controlsHeight},icon:function(){return twttr.is.fn(this.constructor._icon)?this.constructor._icon.call(this,this.url):this.constructor._icon},attribution:function(){if(options.attribution&&twttr.is.fn(options.attribution)){return options.attribution.call(this)}return Mustache.to_html(this.constructor.attributionTemplate,{url:this.data.attribution_url||this.constructor.domain,icon_url:this.data.attribution_icon||this.constructor.favicon||(this.constructor.domain+"/favicon.ico"),title:this.data.attribution_title||this.constructor.title||this.constructor._name,media_type:this.constructor._name})},renderThumbnail:function(dom){var that=this;this.metadata(function(data){data.alt=that.constructor.title;var html=Mustache.to_html('<img src="{{image}}" alt="{{alt}}" title="{{title}}" />',data);$(dom).append(html)})}});klass.matchers=options.matchers||{};for(var label in klass.matchers){(function(){var l=label;klass.matchers[l]=twttr.util.regexSupplant(klass.matchers[l])}())}return klass};(function(){if(!twttr.platform){twttr.platform={}}twttr.platform.application_types={embedded:"embedded"};twttr.platform.runningApplications={};function stopRunningApplications(applicationId){var runningApplication=twttr.platform.runningApplications[applicationId];if(runningApplication){runningApplication.stop();delete twttr.platform.runningApplication[applicationId]}}var RATE_LIMIT=50;var ONE_HOUR=1000*60*60;var WHITELIST_PUBLIC={trends:true,"geo/nearby_places":true,"statuses/retweets/:id":true,"followers/ids":true,"geo/id/:id":true,"geo/search":true,"lists/statuses":true,"users/suggestions":true,"friendships/show":true,"statuses/show":true,"trends/current":true,"geo/similar_places":true,"statuses/user_timeline":true,"friends/ids":true,"trends/:woeid":true,"statuses/followers":true,"statuses/friends":true,"statuses/public_timeline":true,"users/show":true};var WHITELIST_AUTHENTICATED={"users/search":true,":user/lists/subscriptions":true,"statuses/friends_timeline":true,":user/:list_id/members":true,":user/lists/memberships":true,"statuses/:id/retweeted_by/ids":true,":user/lists":true,"statuses/mentions":true,"geo/reverse_geocode":true,"friendships/exists":true,":user/:list_id/members/:id":true,search:true,"statuses/retweeted_to_me":true,"statuses/retweets_of_me":true,"statuses/retweeted_by_me":true,":user/:list_id/subscribers":true,":user/:list_id/subscribers/:id":true,"favorites/:id":true,"statuses/:id/retweeted_by":true,"account/verify_credentials":true,"users/lookup":true,"trends/weekly":true,"trends/daily":true,"statuses/home_timeline":true,"lists/show":true};twttr.platform.events={resize:function(){var that=this;$(window).bind("resize."+this.config._name,function(){var $pane=$("div.details-pane.opened");if($pane.length!==0){that.socket.trigger("resize",$pane.width())}})}};twttr.platform.interfaceActions={openTab:function(data){window.open(data.url,"_blank")},openProfile:function(success,error){var currentPage=twttr.app.currentPage();var paneAvailable=currentPage&&currentPage.loadUserInDetailsPane;if(paneAvailable&&this.config.screenName){currentPage.loadUserInDetailsPane(this.config.screenName,{});return success(true)}error("Profile pane not available or no registered screen name")},tweet:function(text,success,error){new twttr.widget.TweetDialog({defaultContent:text,modal:false,draggable:true,template:{title:_("Whats happening?")},origin:"new-tweet-titlebar-button"}).open().focus()},notify:function(data,success){twttr.Notifications.notify(data.type,data.subject,data.message,data.icon,function(){success(data)})},resizeFrame:function(height){this.DOMContainer.firstChild.style.height=height+"px"},bind:function(eventName,success,error){var bindableEvent=twttr.platform.events[eventName];if(bindableEvent){bindableEvent.call(this);success(true)}else{error("You tried to bind to an event that is not bindable")}},unbind:function(eventName,success,error){var bindableEvent=twttr.platform.events[eventName];if(bindableEvent){$(window).unbind(eventName+"."+this.config._name);success(true)}else{error("You tried to unbind from an event that is not bindable")}}};var applicationId=0;var BaseApplication=twttr.klass("twttr.platform.BaseApplication",function(config){this.limiter=0;this.interval=(new Date).getTime();this.socket=null;this.config=config;this.minimized=false;this.id=++applicationId});BaseApplication.methods({run:function(url,options){var that=this;this.options=options||{};this.url=url;var DOMContainer=options.DOMContainer||document.body;if(DOMContainer instanceof jQuery){this.DOMContainer=DOMContainer[0]}this.socket=new easyXDM.Rpc({remote:this.url,container:this.DOMContainer,props:{width:options.width||"100%",height:options.height||0},onReady:function(){twttr.platform.runningApplications[that.id]=that;that.limiter=0;that.interval=(new Date).getTime();var initialData=that.initialData();that.socket.initialize(initialData);if(options.loaded){options.loaded.call(that)}}},{local:{api:twttr.bind(this,this.api),ui:twttr.bind(this,this.ui),log:twttr.bind(this,this.log)},remote:{trigger:{},initialize:{}}})},initialData:function(){var $pane=$("div.details-pane.opened");if($pane.length!==0){return{size:$pane.width()}}return{}},stop:function(){this.socket.destroy()},maximize:function(){if(this.minimized){this.minimized=false;this.run(this.url,this.options)}},minimize:function(){this.stop();this.attribution=$(this.DOMContainer).find(".media-attribution").detach();this.minimized=true},isRateLimited:function(){var currentTime=(new Date).getTime();if((currentTime-this.interval)>ONE_HOUR){this.limiter=0;this.interval=currentTime;return false}else{return this.limiter>=RATE_LIMIT}},isPermitted:function(){return true},isProtectedEndpoint:function(endpoint){if(twttr.currentUser["protected"]&&!this.isPermitted(this.socket.origin)){return true}if(!WHITELIST_PUBLIC[endpoint]&&!WHITELIST_AUTHENTICATED[endpoint]){return true}return false},log:function(eventName,data,success,error){if(twttr.is.fn(data)){error=success;success=data;data={}}data=data||{};success=success||$.noop;error=error||$.noop;if(this.minimized){return error("You cannot log information while your application is minimized")}scribble("partner_event",{partner:this.config._name,origin:this.socket.origin,eventName:eventName,data:data});success(true)},api:function(endpoint,args,success,error){error=error||$.noop;if(this.minimized){return error("You cannot access the API while your application is minimized")}if(!this.config.enableAPI){return error("You do not have API Access")}if(!this.isRateLimited()){this.limiter++}else{return error("You have been rate-limited.")}if(this.isProtectedEndpoint(endpoint)){return error("You do not have access to that endpoint.")}if(twttr.is.fn(args)){error=success;success=args;args=[]}twttr.anywhere.api.util.makeRemoteRequest(endpoint,args,{success:function(resp){if(success){success(resp)}},error:function(resp){if(error){error(resp)}}})},ui:function(actionName,data,success,error){if(twttr.is.fn(data)){error=success;success=data;data={}}data=data||{};success=success||$.noop;error=error||$.noop;if(!this.config.validActions[actionName]){return error("This is not a valid UI action.")}if(this.minimized){return error("You cannot access interface components while your application is minimized")}scribble("partner_ui_action",{partner:this.config._name,origin:this.socket.origin,actionName:actionName,data:data});twttr.platform.interfaceActions[actionName].apply(this,[data,success,error])}})}());(function(){var EmbeddedApplication=twttr.klass("twttr.platform.EmbeddedApplication",function(config,options){options=options||{};twttr.platform.BaseApplication.apply(this,arguments);this.tweet=options.tweet||null;this.originalUrl=options.originalUrl||null;this.applicationType=twttr.platform.application_types.embedded});EmbeddedApplication.subclassOf(twttr.platform.BaseApplication);EmbeddedApplication.methods({initialData:function(){var baseData=twttr.platform.BaseApplication.prototype.initialData.call(this);return baseData},log:function(eventName,data,success,error){if(twttr.is.fn(data)){error=success;success=data;data={}}data.original_url=this.originalUrl;twttr.platform.BaseApplication.prototype.log.apply(this,arguments)}})}());(function(){twttr.provide("twttr.regexps",{protocol:/(?:https?\:\/\/)/,optional_protocol:/(?:(?:https?\:\/\/)?(?:www\.)?)/,protocol_subdomain:/(?:(?:https?\:\/\/)?(?:[\w\-]+\.))/,optional_protocol_subdomain:/(?:(?:https?\:\/\/)?(?:[\w\-]+\.)?)/,wildcard:/[a-zA-Z0-9_#\.\-\?\&\=\/]+/});function sandboxedAjax(options){if(twttr.isSSL()&&twttr.decider&&twttr.decider.isAvailable("phoenix_sandboxed_ajax")){callback=options.success;delete options.success;var socket=new easyXDM.Socket({remote:twttr.jsonpSandboxURL,onMessage:function(message,origin){callback(JSON.parse(message))}});socket.postMessage(JSON.stringify(options))}else{$.ajax(options)}}twttr.mediaType("twttr.media.types.Youtube",{title:"YouTube",icon:"video",domain:"//www.youtube.com",matchers:{tinyUrl:/^#{optional_protocol}?youtu\.be\/([a-zA-Z0-9_\-\?\&\=\/]+)/i,standardUrl:/^#{optional_protocol}?youtube\.com\/watch[a-zA-Z0-9_\-\?\&\=\/]+/i},process:function(finished,options){this.data.width=(options&&options.maxwidth)?options.maxwidth:390;this.data.height=(options&&options.maxwidth)?this.calcHeight(options.maxwidth):307;if(this.url.match(this.constructor.matchers.tinyUrl)){this.data.id=this.location.pathname.replace(/\//g,"");finished()}else{if(this.location.search.match(/[\?\&]v\=([\w\-]+)(?:\&|$)/)){this.data.id=this.location.query("v");finished()}}},metadata:function(cb){var data={image:twttr.util.supplant("http://img.youtube.com/vi/{id}/0.jpg",this.data)};cb(data)},getImageURL:function(size,cb){var that=this;this.process(function(){that.metadata(function(data){if(data&&data.image){cb(data.image)}else{cb(null)}})})},render:function(dom){var t='<iframe                 class="youtube-player"                 type="text/html"                 width="{{width}}"                 height="{{height}}"                 src="//www.youtube.com/embed/{{id}}?wmode=opaque"                 frameborder="0">               </iframe>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Twitter",{icon:"generic",favicon:"//twitter.com/phoenix/favicon.ico",domain:"//twitter.com",matchers:{permalink:/^#{optional_protocol}?twitter\.com\/(?:#!?\/)?\w{1,20}\/status\/(\d+)/i},process:function(finished){var that=this;twttr.API.Status.find(this.slug,function(status){that.data.tweet=status;finished()})},render:function(dom){$(dom).append(new twttr.views.LatestTweet(this.data.tweet).html())}});twttr.mediaType("twttr.media.types.Ustream",{icon:"video",favicon:"http://cdn2.ustream.tv/static/images/favicon:1.ico",domain:"http://ustream.tv",matchers:{recorded:/^(?:(?:https?\:\/\/)?(?:www\.)?)?ustream\.tv\/(recorded\/(?:\d+))/i,channel:/^(?:(?:https?\:\/\/)?(?:www\.)?)?ustream\.tv\/(channel\/(?:[\w\-]+)\/?)/i},metadata:function(cb){var image=null;if(this.data&&this.data.imageUrl&&this.data.imageUrl.small){image=this.data.imageUrl.small}cb({title:this.data.title,description:this.data.description?twttr.helpers.truncate(this.data.description,255,"..."):"",image:image})},getImageURL:function(size,cb){var that=this;this.process(function(){that.metadata(function(data){cb(data.image)})})},process:function(finished,options){var that=this;this.data.width=(options&&options.maxwidth)?options.maxwidth:390;this.data.height=this.calcHeight(this.data.width);if(this.slug.match(this.constructor.re.channel)||this.slug.match(this.constructor.re.video)){sandboxedAjax({url:"http://api.ustream.tv/json/channel/"+RegExp.$1+"/getInfo",dataType:"jsonp",data:{key:this.constructor.API_KEY},success:function(resp){if(resp!==null){that.data.type="channel";that.data.embed=resp.embedTag;that.data.imageUrl=resp.imageUrl}finished()}})}},render:function(dom){if(this.data.type==="channel"){$(dom).append(this.data.embed)}else{$(dom).append(Mustache.to_html(this.constructor.templates[this.data.type],this.data))}}}).statics({API_KEY:"12ab548e85128e0d3182ba3a346c3428",re:{video:/^recorded\/(\d+)/,channel:/^channel\/([\w\-]+)\/?/},templates:{video:'        <object width="{{width}}" height="{{height}}">          <param name="flashvars" value="autoplay=false&amp;vid={{videoId}}&amp;"/>          <param name="allowfullscreen" value="true"/>          <param name="allowscriptaccess" value="always"/>          <param name="wmode" value="opaque"/>          <param name="src" value="http://www.ustream.tv/flash/video/{{videoId}}"/>          <embed            flashvars="loc=%2F&amp;autoplay=false&amp;vid={{videoId}}&amp;"            width="{{width}}"            height="{{height}}"            allowfullscreen="true"            allowscriptaccess="always"            wmode="opaque"            src="http://www.ustream.tv/flash/video/{{videoId}}"            type="application/x-shockwave-flash" />        </object>'}});twttr.mediaType("twttr.media.types.Vevo",{icon:"video",domain:"http://vevo.com",matchers:{standardVideo:/^#{optional_protocol}?vevo\.com\/watch\/[\w-]+\/[\w-]+\/([a-zA-Z0-9_]+)/i},process:function(finished,options){this.data.id=this.slug;this.data.width=(options&&options.maxwidth)?options.maxwidth:390;this.data.height=this.calcHeight(this.data.width);finished()},render:function(dom){var t='<object width="{{width}}" height="{{height}}">                <param name="movie" value="http://www.vevo.com/VideoPlayer/Embedded?videoId={{id}}&playlist=false&autoplay=0&playerId=62FF0A5C-0D9E-4AC1-AF04-1D9E97EE3961&playerType=embedded"/>                <param name="bgcolor" value="#000000"/>                <param name="allowFullScreen" value="true"/>                <param name="allowScriptAccess" value="always"/>                <param name="wmode" value="opaque"/>                <embed                  src="http://www.vevo.com/VideoPlayer/Embedded?videoId={{id}}&playlist=false&autoplay=0&playerId=62FF0A5C-0D9E-4AC1-AF04-1D9E97EE3961&playerType=embedded"                   type="application/x-shockwave-flash"                   allowfullscreen="true"                   allowscriptaccess="always"                   wmode="opaque"                   width="{{width}}"                   height="{{height}}"                   bgcolor="#000000" />              </object>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Flickr",{icon:"photo",domain:twttr.isSSL()?"https://secure.flickr.com":"http://flickr.com",favicon:"http://l.yimg.com/g/favicon.ico",matchers:{profile:/^#{optional_protocol}?flickr\.com\/(?:photos|people)\/([\w\@\-]+)\/?$/i,photo:/^#{optional_protocol}?flickr\.com\/photos\/[\w\@\-]+\/(\d+)\/?/i,sets:/^#{optional_protocol}?flickr\.com\/photos\/(?:[\w\@\-]+)\/sets\/(\d+)\/?(?:show\/?)?$/i,galleries:/^#{optional_protocol}?flickr\.com\/photos\/([\w\@\-]+)\/galleries\/(\d+)\/?$/i,pool:/^#{optional_protocol}?flickr\.com\/groups\/([\w\@\-]+)\/?(?:pool\/|discuss\/)?$/i},attribution:function(){var attributionTemplate="        <div class='media-attribution'>          <span>via</span>          <a target='_blank' data-media-type='{{media_type}}' class='media-attribution-link' href='{{url}}'>            <img src='{{icon_url}}'/>          </a>";if(this.data.author_name){attributionTemplate+='<span>by <a target="_blank" href="{{author_url}}">{{author_name}}</a></span>'}attributionTemplate+="</div>";return Mustache.to_html(attributionTemplate,{url:this.constructor.domain,icon_url:this.constructor.favicon||(this.constructor.domain+"/favicon.ico"),title:this.constructor.title||this.constructor._name,media_type:this.constructor._name,author_name:this.data.author_name,author_url:this.data.author_url})},metadata:function(cb){var photo;if(this.data.photos&&this.data.photos.length>=1){photo=this.data.photos[0];cb({image:Mustache.to_html("http://farm{{farm}}.static.flickr.com/{{server}}/{{id}}_{{secret}}.jpg",photo),title:this.data.title,description:this.data.description,author:{name:this.data.author_name,url:this.data.author_url}})}},getImageURL:function(size,cb){var that=this;this.process(function(){that.metadata(function(data){if(data&&data.image){cb(data.image)}else{cb(null)}})})},process:function(finished,options){this.data.width=(options&&options.maxwidth)?options.maxwidth:390;this.data.height=this.calcHeight(this.data.width);var flickr=twttr.media.types.Flickr.matchers;var that=this;var originalHref=this.url;if(originalHref.match(flickr.photo)){var photoId=RegExp.$1;this.makeRequest({data:{method:"flickr.photos.getInfo",photo_id:photoId},success:function(resp){if(resp.photo){that.data.author_name=resp.photo.owner.realname;that.data.author_url=that.constructor.domain+"/photos/"+resp.photo.owner.nsid;if(resp.photo.media&&resp.photo.media=="video"){that.data.isVideo=true}that.data.photos=[resp.photo]}finished()}})}else{if(originalHref.match(flickr.sets)){this._makeSetRequest(RegExp.$1,finished)}else{if(originalHref.match(flickr.profile)){this.lookUpUserPhotos(RegExp.$1,this.slug,finished)}else{if(originalHref.match(flickr.pool)){this._makeGroupRequestByName(RegExp.$1,finished)}else{if(originalHref.match(flickr.galleries)){this.makeRequest({data:{method:"flickr.urls.lookupGallery",url:"flickr.com/photos/"+RegExp.$1+"/galleries/"+RegExp.$2},success:function(resp){var gallery_id=resp.gallery.id;that.makeRequest({data:{method:"flickr.galleries.getPhotos",gallery_id:gallery_id},success:function(resp){that.data.photos=resp.photos.photo.slice(0,16);that.data.isGallery=1;finished()}})}})}}}}}return false},render:function(dom){var html="";var flickr=twttr.media.types.Flickr;if(this.data.photos.length==1){if(this.data.isVideo){html+=Mustache.to_html(flickr.templates.video,this.data.photos[0])}else{this.data.photos[0].href=this.data.photos[0].urls.url[0]._content;html+=Mustache.to_html(flickr.templates.photo,this.data.photos[0])}}else{html='<div class="flickr-group">'+this.createThumbList(this.data.photos)+"</div>";if(this.data.isGallery){$(dom).append(html);return }var options;if(this.data.set_id){options=flickr.photoSetFlashVars}else{if(this.data.group_id){options=flickr.photoGroupFlashVars}else{options=flickr.photoUserFlashVars}}options=twttr.merge({},flickr.defaultSlideshowFlashVars,options,true);var str=[];jQuery.each(options,function(k,v){str.push(k+"="+v)});str=Mustache.to_html(str.join("&"),this.data);html+=Mustache.to_html(flickr.templates.slideshow,{flashvars:str})}$(dom).append(html)}}).statics({API_KEY:"2a56884b56a00758525eaa2fee16a798",SECRET:"7c794fe3256175b6",defaultSlideshowFlashVars:{lang:"en-us",offsite:true,minH:100,minW:100},templates:{video:'<object width="{{width}}" height="{{height}}"                   type="application/x-shockwave-flash"                   data="http://www.flickr.com/apps/video/stewart.swf?v=71377"                   classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">                   <param name="flashvars" value="intl_lang=en-us&photo_secret={{secret}}&photo_id={{id}}"/>                   <param name="movie" value="http://www.flickr.com/apps/video/stewart.swf?v=71377"/>                   <param name="bgcolor" value="#000000"/>                   <param name="allowFullScreen" value="true"/>                   <param name="wmode" value="opaque"/>                   <embed                     type="application/x-shockwave-flash"                     src="http://www.flickr.com/apps/video/stewart.swf?v=71377"                     bgcolor="#000000"                     allowfullscreen="true"                     wmode="opaque"                     flashvars="intl_lang=en-us&photo_secret={{secret}}&photo_id={{id}}"                     height="{{height}}"                     width="{{width}}" />                 </object>',photo:'<div class="flickr-photo">                   <a href="{{href}}" target="_blank">                     <img src="http://farm{{farm}}.static.flickr.com/{{server}}/{{id}}_{{secret}}.jpg"/>                   </a>                 </div>',set:'<a href="{{href}}" target="_blank">                <img class="flickr-thumb" src="http://farm{{farm}}.static.flickr.com/{{server}}/{{id}}_{{secret}}_s.jpg"/>              </a>',slideshow:'<embed type="application/x-shockwave-flash"                             src="http://flickr.com/apps/slideshow/show.swf.v71649"                             width="{{width}}"                             height="{{height}}"                             id="slideShowMovie"                             bgcolor="#000000"                             quality="high"                             allowfullscreen="true"                             allowscriptaccess="always"                             wmode="opaque"                             flashvars={{flashvars}} />'},photoUserFlashVars:{user_id:"{{user_id}}",page_show_back_url:"/photos/{{user_name}}/",page_show_url:"/photos/{{user_name}}/show/"},photoGroupFlashVars:{group_id:"{{group_id}}",page_show_url:"/groups/{{group_id}}/pool/show/",page_show_back_url:"/groups/{{group_id}}/pool/"},photoSetFlashVars:{set_id:"{{set_id}}",page_show_back_url:"/photos/{{user_name}}/sets/{{set_id}}/",page_show_url:"/photos/{{user_name}}/sets/{{set_id}}/show/"}}).methods({FLICKR_PHOTO_URL:"http://flickr.com/photos",base58:function(snippet){var alphabet="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var num=snippet.length;var decoded=0;var multi=1;for(var i=num-1;i>=0;i--){decoded=decoded+multi*alphabet.indexOf(snippet[i]);multi=multi*alphabet.length}return decoded},lookUpUserPhotos:function(userName,slug,finished){var that=this;this.makeRequest({data:{method:"flickr.urls.lookupUser",url:"flickr.com/photos/"+userName},success:function(resp){var userId=resp.user.id;var authorName=resp.user.username._content;that.makeRequest({data:{method:"flickr.people.getPublicPhotos",user_id:userId},success:function(resp){that.data.photos=resp.photos.photo.slice(0,16);that.data.user_id=userId;that.data.user_name=userName;that.data.author_name=authorName;that.data.author_url=that.constructor.domain+"/photos/"+userId;finished()}})}})},createThumbList:function(photos){var that=this;return $.map(photos,function(photo,i){photo.href=[that.FLICKR_PHOTO_URL,photo.owner,photo.id].join("/");return Mustache.to_html(twttr.media.types.Flickr.templates.set,photo)}).join("")},_makeGroupRequestByName:function(name,finished){this.makeRequest({data:{method:"flickr.urls.lookupGroup",url:"flickr.com/groups/"+name},success:twttr.bind(this,function(resp){this._makeGroupRequestById(resp.group.id,finished)})})},_makeGroupRequestById:function(id,finished){this.makeRequest({data:{method:"flickr.groups.pools.getPhotos",group_id:id},success:twttr.bind(this,function(resp){this.data.photos=resp.photos.photo.slice(0,16);this.data.group_id=id;finished()})})},_makeSetRequest:function(id,finished){this.makeRequest({data:{method:"flickr.photosets.getPhotos",photoset_id:id},success:twttr.bind(this,function(resp){var owner=resp.photoset.owner;this.data.photos=resp.photoset.photo.slice(0,16);twttr.each(this.data.photos,function(photo){photo.owner=owner});this.data.set_id=resp.photoset.id;this.data.user_name=owner;this.data.author_name=resp.photoset.ownername;this.data.author_url=this.constructor.domain+"/photos/"+resp.photoset.owner;finished()})})},makeRequest:function(options){var defaultOptions={url:this.constructor.domain+"/services/rest",dataType:"jsonp",jsonp:"jsoncallback",data:{format:"json",api_key:twttr.media.types.Flickr.API_KEY},success:function(resp){}};sandboxedAjax(twttr.merge({},defaultOptions,options,true))}});twttr.mediaType("twttr.media.types.DeviantArt",{title:"deviantART",icon:"photo",domain:"http://deviantart.com",matchers:{canonical:/^((?:https?\:\/\/)?(?:[\w\-]+\.)deviantart\.com\/art\/(?:[\w\@-]+))/i,oldStyle:/^((?:https?\:\/\/)?(?:[\w\-]+\.)deviantart\.com\/deviation\/(?:[\w\@-]+))/i,gallery:/^((?:https?\:\/\/)?(?:[\w\-]+\.)deviantart\.com\/gallery\/#\/d(?:[\w\@-]+))/i,favMe:/^((?:https?\:\/\/)?fav\.me\/(?:[\w\@-]+))/i,oldView:/^((?:https?\:\/\/)?(?:[\w\-]+\.)deviantart\.com\/view\/(?:[\w\@-]+))/i},metadata:function(cb){cb({image:this.data.src,title:this.data.title,author:{name:this.data.author_name,url:this.data.author_url}})},process:function(finished){sandboxedAjax({url:"http://backend.deviantart.com/oembed",data:{url:this.slug,format:"jsonp"},dataType:"jsonp",success:twttr.bind(this,function(oembed){this.data.href=this.url;this.data.name=this.constructor._name;this.data.src=oembed.thumbnail_url;this.data.author_name=oembed.author_name;this.data.author_url=oembed.author_url;finished()})})},attribution:function(){var attributionFooter="         <div class='media-attribution'>           <span>via</span>            <a target='_blank' class='media-attribution-link' href='{{author_url}}'>{{author_name}}</a>            from <img src='{{icon_url}}'/>           <a target='_blank' data-media-type='{{media_type}}' class='media-attribution-link' href='{{url}}'>{{title}}</a>         </div>";return Mustache.to_html(attributionFooter,{url:this.constructor.domain,icon_url:this.constructor.favicon||(this.constructor.domain+"/favicon.ico"),title:this.constructor.title||this.constructor._name,media_type:this.constructor._name,author_name:this.data.author_name,author_url:this.data.author_url})},render:function(dom){var t='<div class="deviantart">                <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                  <img src="{{src}}"/>                </a>              </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Gist",{icon:"generic",domain:"//gist.github.com",matchers:{gist:/^(?:https?\:\/\/)?gist\.github\.com\/([a-zA-Z0-9_\-\?\=]+)/i},process:function(finished){this.data.id=this.slug;finished()},render:function(dom){var t='<div class="gist"><iframe src="//gist.github.com/{{id}}.pibb" /></div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Vimeo",{icon:"video",domain:"http://vimeo.com",matchers:{video:/^#{optional_protocol}?vimeo\.com\/(\d+)/i},metadata:function(cb){cb({title:this.data.title,description:twttr.helpers.truncate(this.data.description,255,"..."),image:this.data.thumbnail_url.replace(/_\d+\./,"_100.")})},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.thumbnail_url){cb(that.data.thumbnail_url)}else{cb(null)}})},process:function(finished,options){var that=this;options=options||{};this.data.video_id=this.slug;sandboxedAjax({url:"http://vimeo.com/api/oembed.json",dataType:"jsonp",data:{url:"http://vimeo.com/"+this.slug,width:options.maxwidth||446},success:function(resp){that.data.html=resp.html;that.data.thumbnail_url=resp.thumbnail_url;finished()}})},render:function(dom){$(dom).append(this.data.html)}});twttr.mediaType("twttr.media.types.Etsy",{icon:"photo",domain:"http://etsy.com",matchers:{itemListing:/^#{optional_protocol}?etsy\.com\/listing\/(\d+)/i},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.images&&that.data.images.length>0){cb(that.data.images[0]["url_170x135"])}else{cb(null)}})},process:function(finished){var that=this;this.data.itemId=this.slug;this.data.href=this.url;this.data.name=this.constructor._name;sandboxedAjax({url:"http://openapi.etsy.com/v2/public/listings/"+this.slug+".js",dataType:"jsonp",data:{detail_level:"high",api_key:"qev732j7b8j44eg5pqsb38k4",includes:"Images(url_170x135):6",fields:"listing_id,title,price,currency_code,quantity"},success:function(resp){var r=resp.results[0];that.data.title=r.title;switch(r.currency_code){case"USD":that.data.price=r.quantity+" for $"+(r.price||0);break;default:that.data.price=r.quantity+" for "+(r.price||0)+" "+r.currency_code;break}that.data.images=r.Images;var images=$.map(r.Images,function(image,i){return'<a class="inline-media-image" data-inline-type="{{name}}" target="_blank" href="{{href}}">                      <img class="thumb" src="'+image.url_170x135+'"/>                    </a>'}).join("");var t='            <div class="etsy">              <h3>{{title}}</h3>              <p>{{price}}</p>              <p>'+images+"</p>            </div>";that.data.html=Mustache.to_html(t,that.data);finished()}})},render:function(dom){$(dom).append(this.data.html)}});twttr.mediaType("twttr.media.types.Photozou",{icon:"photo",domain:"http://photozou.jp",matchers:{photo:/^#{optional_protocol}?photozou\.(?:com|jp)\/photo\/show\/\d+\/(\d+)/i},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.src){cb(that.data.src)}else{cb(null)}})},process:function(finished){this.data.src="http://photozou.jp/p/img/"+this.slug;this.data.href=this.url;this.data.name=this.constructor._name;finished()},render:function(dom){var t='<div class="photozou">                 <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                   <img src="{{src}}"/>                 </a>               </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.TwitPic",{title:"TwitPic",icon:"photo",domain:"//twitpic.com",matchers:{media:/^#{optional_protocol}?twitpic\.com\/(?!(?:place|photos|events)\/)([a-zA-Z0-9\?\=\-]+)/i},metadata:function(cb){var that=this,imgUrl="";if(this.options.size=="medium"){imgUrl="http://twitpic.com/show/thumb/"}else{imgUrl="http://twitpic.com/show/mini/"}$.ajax({url:"http://api.twitpic.com/2/media/show.jsonp",type:"GET",dataType:"jsonp",data:{id:this.slug},success:function(resp){var data={image:imgUrl+that.slug,title:resp.message,author:{name:resp.user.name||resp.user.username,url:"http://twitpic.com/photos/"+resp.user.username}};if(resp.events&&resp.events.length>0){data.description=resp.events[0].description}cb(data)}})},process:function(finished){this.data.src=this.slug;this.data.href=this.url;this.data.name=this.constructor._name;finished()},getImageURL:function(size,cb){if(this.slug){var imgUrl="";if(size==twttr.constants.imageSizes.medium){imgUrl="http://twitpic.com/show/thumb/"+this.slug}else{if(size=="small"){imgUrl="http://twitpic.com/show/mini/"+this.slug}else{imgUrl="http://twitpic.com/show/iphone/"+this.slug}}cb(imgUrl)}else{cb(null)}},render:function(dom){var t='<div class="twitpic">                 <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                   <img src="//twitpic.com/show/large/{{src}}"/>                 </a>              </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Twitgoo",{icon:"photo",domain:"http://twitgoo.com",matchers:{image:/^#{optional_protocol}?twitgoo\.com\/(?!a\/)([a-zA-Z0-9\-\?\=]+)/i},getImageURL:function(size,cb){if(this.slug){cb(twttr.util.supplant("http://twitgoo.com/{src}/img",{src:this.slug}))}else{cb(null)}},process:function(finished){this.data.src=this.slug;this.data.href=this.url;this.data.name=this.constructor._name;finished()},render:function(dom){var t='<div class="twitgoo">                 <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                   <img src="http://twitgoo.com/{{src}}/img"/>                 </a>               </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.DailyBooth",{icon:"photo",domain:"http://dailybooth.com",matchers:{photo1:/^#{optional_protocol}?dailybooth\.com\/(u\/\w+)/i,photo2:/^#{optional_protocol}?dailybooth\.com\/(\w+\/\w+)/i},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data){if(size===twttr.constants.imageSizes.original){cb(that.data.src)}else{cb(that.data.smallImage)}}else{cb(null)}})},process:function(finished){var that=this;this.data.href=this.url;this.data.name=this.constructor._name;if(this.slug.match(/^u\/(\w+)/)){var n=parseInt(RegExp.$1,36);var baseTen=this.getBaseTen(n)}else{var baseTen=this.slug.match(/\w+\/(\w+)/);if(baseTen){baseTen=baseTen[1]}else{return false}}sandboxedAjax({url:"http://api.dailybooth.com/v1/picture/"+baseTen+".json",dataType:"jsonp",type:"get",success:function(resp){that.data.src=resp.urls.large;that.data.smallImage=resp.urls.small;finished()}})},render:function(dom){var t='<div class="dailybooth">                 <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                   <img src="{{src}}"/>                 </a>               </div>';$(dom).append(Mustache.to_html(t,this.data))}}).methods({getBaseTen:function(n){if(Number.prototype.toFixed){n=n.toFixed(5);n=parseFloat(n)}else{var leftSide=Math.floor(n);var rightSide=n-leftSide;n=leftSide+Math.round(rightSide*100000000000000)/100000000000000}return n}});twttr.mediaType("twttr.media.types.YFrog",{title:"YFrog",domain:"//yfrog.com",icon:function(url){var format=this.slug.charAt(this.slug.length-1);switch(format){case"j":case"p":case"b":case"t":case"g":return"photo";case"z":case"f":case"s":return"video"}},matchers:{media:/^#{optional_protocol}?yfrog\.(?:com|ru|com\.tr|it|fr|co\.il|co\.uk|com\.pl|pl|eu|us)\/(\w+)/i},getImageURL:function(size,cb){if(this.slug){if(size===twttr.constants.imageSizes.small){cb(twttr.util.supplant("http://yfrog.com/{id}:small",{id:this.slug}))}else{cb(twttr.util.supplant("http://yfrog.com/{id}:medium",{id:this.slug}))}}else{cb(null)}},process:function(finished){this.data.media_id=this.slug;this.data.href=this.url.replace(/\/$/,"");this.data.name=this.constructor._name;finished()},render:function(dom){var t,format=this.data.media_id.charAt(this.data.media_id.length-1);if(format=="j"||format=="p"||format=="b"||format=="t"||format=="g"){t='<div class="yfrog">               <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                 <img src="http://yfrog.com/{{media_id}}:iphone">               </a>             </div>'}else{if(format=="z"||format=="f"||format=="s"){t='<embed                src="http://yfrog.com/{{media_id}}:embed"                width="100%"                allowFullScreen="true"                wmode="transparent"                type="application/x-shockwave-flash"/>'}}if(t){$(dom).append(Mustache.to_html(t,this.data))}}});twttr.mediaType("twttr.media.types.Plixi",{icon:"photo",domain:"//plixi.com",matchers:{tweetphoto:/^#{optional_protocol}?tweetphoto\.com\/(\d+)/i,plixi:/^#{optional_protocol}?plixi\.com\/p\/(\d+)/i,mobile:/^#{protocol}?m\.plixi\.com\/p\/(\d+)/i},metadata:function(cb){cb({image:this.data.thumbnail,description:this.data.message})},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.src){cb(that.data.src)}else{cb(null)}})},process:function(finished){var that=this;sandboxedAjax({url:"//tweetphotoapi.com/api/tpapi.svc/jsonp/photos/"+this.slug,dataType:"jsonp",success:function(resp){that.data.src=resp.MediumImageUrl;that.data.href=that.url;that.data.name=that.constructor._name;finished()}})},render:function(dom){var t='<div class="plixi">                 <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                   <img src="{{src}}" />                 </a>              </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Kiva",{icon:"generic",domain:"http://kiva.org",matchers:{project:/^#{optional_protocol}?kiva\.org\/lend\/(\d+)/i},process:function(finished){var that=this;sandboxedAjax({url:"http://www.kiva.org/services/oembed",dataType:"jsonp",jsonp:"jsonp",data:{url:"http://www.kiva.org/lend/"+this.slug,format:"jsonp"},success:function(resp){that.data.html=resp.html;finished()}})},render:function(dom){$(dom).append(this.data.html)}});twttr.mediaType("twttr.media.types.TwitVid",{icon:"video",domain:"http://twitvid.com",matchers:{video:/^#{optional_protocol}?twitvid\.com\/([a-zA-Z0-9_\-\?\=]+)/i},process:function(finished,options){this.data.media_id=this.slug;this.data.width=(options&&options.maxwidth)?options.maxwidth:425;this.data.height=this.calcHeight(this.data.width);finished()},metadata:function(cb){var pathData={media_id:this.data.media_id,part1:this.data.media_id.substr(0,1),part2:this.data.media_id.substr(1,1),part3:this.data.media_id.substr(2,1)};var data={image:twttr.util.supplant("http://llphotos.twitvid.com/twitvidthumbnails/{part1}/{part2}/{part3}/{media_id}.jpg",pathData)};cb(data)},getImageURL:function(size,cb){var that=this;this.process(function(){that.metadata(function(data){if(data&&data.image){cb(data.image)}else{cb(null)}})})},render:function(dom){var t='        <object width="{{width}}" height="{{height}}">           <param name="movie" value="http://www.twitvid.com/player/{{media_id}}"></param>           <param name="allowscriptaccess" value="always"></param>           <param name="allowFullScreen" value="true"></param>           <param name="wmode" value="transparent"/></param>           <embed type="application/x-shockwave-flash"                  src="http://www.twitvid.com/player/{{media_id}}"                   quality="high"                   allowscriptaccess="always"                   allowNetworking="all"                   allowfullscreen="true"                   wmode="transparent"                   height="{{height}}"                   width="{{width}}" />        </object>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.GoogleVideo",{icon:"video",domain:"http://video.google.com",matchers:{video:/^#{optional_protocol}video\.google\.com\/([a-zA-Z0-9_\-\?\=\&\#]+)/i},process:function(finished){if(this.slug.match(/#docid=(\-?\d+)/)){this.data.doc_id=RegExp.$1;finished()}else{if(this.slug.match(/\?docid=(\-?\d+)/)){this.data.doc_id=RegExp.$1;finished()}}},render:function(dom){var t='         <embed type="application/x-shockwave-flash"                 id="VideoPlayback"                 src="http://video.google.com/googleplayer.swf?docid={{doc_id}}&hl=en&fs=true"                 style="width:400px;height:326px"                 allowFullScreen="true"                 allowScriptAccess="always"                wmode="opaque" />';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.JustinTV",{icon:"video",domain:"http://justin.tv",matchers:{embed:/^http:\/\/([a-zA-Z0-9_\-\?\=]*\.)?justin\.tv\/[a-zA-Z0-9]+(\/b\/\d+)?\/?(\?\w*?)?(#\w*)?$/i},metadata:function(cb){cb({image:this.data.thumbnail_url,title:this.data.title,author:{name:this.data.author_name,url:this.data.author_url}})},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.thumbnail_url){cb(that.data.thumbnail_url)}else{cb(null)}})},process:function(finished){var that=this;$.getJSON("http://api.justin.tv/api/embed/from_url.json?jsonp=?&url="+this.url,function(resp){if(!resp.error){that.data.embed=resp.html;if(resp.thumbnail_url){that.data.thumbnail_url=resp.thumbnail_url}finished()}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Twaudio",{icon:"video",domain:"//twaud.io",matchers:{audio:/^#{optional_protocol}?twaud\.io\/([a-zA-Z0-9_\-\?\=\&]+)/i},metadata:function(cb){cb({description:twttr.helpers.truncate(this.data.title,255,"..."),author:{name:this.data.author_name,url:this.data.author_url}})},process:function(finished){var that=this;sandboxedAjax({url:"//twaud.io/oembed.json",dataType:"jsonp",data:{url:"//twaud.io/"+this.slug},success:function(resp){that.data.embed=resp.html;finished()}})},render:function(dom){$(dom).append(this.data.embed)}});twttr.mediaType("twttr.media.types.Kickstarter",{icon:"generic",domain:"http://kickstarter.com",matchers:{project:/(^#{optional_protocol}?kickstarter\.com\/projects\/[a-zA-Z0-9_\-]+\/[a-zA-Z0-9_\-\?\=\&\#]+)/i},process:function(finished){var url=this.slug;if(url.slice(-1)!=="/"){url+="/"}url+="widget/twitter.jpg";this.data.embed="<img src='"+url+"' />";finished()},render:function(dom){$(dom).append(this.data.embed)}});twttr.mediaType("twttr.media.types.MTV",{icon:"video",domain:"http://mtv.com",matchers:{video:/^#{optional_protocol}?mtv\.com\/videos\/([a-z0-9\-\_]+\/)+[0-9]+\/[a-z0-9\-\_]+\.jhtml(#[a-z0-9\=\&]+)?/i},process:function(finished){var that=this;sandboxedAjax({url:"http://www.mtv.com/videos/oembed",type:"GET",dataType:"jsonp",data:{url:this.url},success:function(resp){if(!resp.error){that.data.url=resp.url;if(resp.width>400){that.data.width=400;that.data.height=Math.floor((resp.height*400)/resp.width)}else{that.data.height=resp.height;that.data.width=resp.width}finished()}}})},render:function(dom){var t='<object width="{{width}}" height="{{height}}">                <param name="movie" value="{{url}}"/>                <param name="allowFullScreen" value="true"/>                <param name="allowscriptaccess" value="always"/>                <param name="wmode" value="opaque"/>                <embed src="{{url}}"                        type="application/x-shockwave-flash"                        allowscriptaccess="always"                        allowfullscreen="true"                        wmode="opaque"                        width="{{width}}"                        height="{{height}}"/>              </object>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.WashingtonPost",{icon:"video",domain:"http://washingtonpost.com",matchers:{video:/(^(?:(?:https?\:\/\/)?(?:[\w\-\_]+\.))?washingtonpost\.com\/wp-dyn\/content\/video\/\d{4}\/\d{2}\/\d{2}\/VI\d+\.html(#{wildcard})?)/i},process:function(finished){var that=this;sandboxedAjax({url:"http://specials.washingtonpost.com/tv/info.json",type:"GET",dataType:"jsonp",data:{url:this.url},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.MSNBC",{icon:"video",domain:"http://msnbc.com",matchers:{video:/(^(?:(?:https?\:\/\/)?(?:[\w\-\_]+\.))?msnbc\.msn\.com\/id\/\d{1,8}\/vp\/\d{1,8}(#{wildcard})?)/i},process:function(finished){var that=this;sandboxedAjax({url:"http://www.polls.newsvine.com/_labs/twitter/oembed",type:"GET",dataType:"jsonp",data:{format:"jsonp",url:this.url},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.CNN",{icon:"video",domain:"http://cnn.com",title:"CNN Video",matchers:{video:/(^(?:(?:https?\:\/\/)?(?:(?:www|edition|us)\.)?)?cnn\.com\/video\/[\?|#]\/#{wildcard})/i},process:function(finished){var that=this,url=this.url;var tokens=url.split("?");if(tokens.length>2){tokens.pop();url=tokens.join("?")}sandboxedAjax({url:"http://newspulse.cnn.com/widget/json/twitter-video",type:"GET",dataType:"jsonp",data:{format:"jsonp",url:url},success:function(resp){if(!resp.error){that.data.embed=resp.html;that.data.attribution_url="http://cnn.com/video";finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Apple",{icon:"song",domain:"http://itunes.apple.com",matchers:{album:/^#{protocol}?itunes\.apple\.com(?:\/[a-z][a-z])?(?:\/album)\//i,song:/^#{protocol}?(?:c\.)itunes\.apple\.com(?:\/[a-z][a-z])?\/event\//i},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.src){cb(that.data.src)}else{cb(null)}})},attributionTemplate:"      <div class='media-attribution icon-only auto-size'>        <span>via</span>        <a target='_blank' data-media-type='{{media_type}}' class='media-attribution-link' href='{{url}}'>          <img src='{{icon_url}}'/>        </a>      </div>",enableAPI:false,validActions:{resizeFrame:true,bind:true,unbind:true},process:function(finished){var that=this;sandboxedAjax({url:"http://itunes.apple.com/WebObjects/MZStore.woa/wa/remotePreview",type:"GET",dataType:"jsonp",data:{url:this.url},success:function(resp){if(!resp.error){that.data.src=resp.src;that.data.attribution_icon=resp.attribution_icon;that.data.attribution_url=resp.attribution_url;if(resp.favicon){that.data.attribution_icon=resp.favicon}if(resp.faviconLink){that.data.attribution_url=resp.faviconLink}if(resp.height){that.data.height=resp.height}finished()}}})},render:function(dom){var app=new twttr.platform.EmbeddedApplication(this.constructor,{tweet:this.tweet,originalUrl:this.url});var runOptions={DOMContainer:dom};if(this.data.height){runOptions.height=this.data.height}app.run(this.data.src,runOptions)}});twttr.media.types.Apple.addMatchers({music_video:/^#{protocol}?itunes\.apple\.com(?:\/[a-z][a-z])?(?:\/music-video)\//i,video:/^#{protocol}?itunes\.apple\.com(?:\/[a-z][a-z])?(?:\/video)\//i,software:/^#{protocol}?itunes\.apple\.com(?:\/[a-z][a-z])?(?:\/app)\//i,playlist:/^#{protocol}?(?:c\.)itunes\.apple\.com(?:\/[a-z][a-z])?(?:\/imix)\//i});twttr.mediaType("twttr.media.types.Instagram",{icon:"photo",domain:"//instagr.am",title:"Instagram",matchers:{video:/(^#{optional_protocol_subdomain}?instagr\.am\/p\/[a-zA-Z0-9_\-]+\/?)/i},metadata:function(cb){cb({image:this.data.href,title:this.data.title,author:{name:this.data.author_name}})},getImageURL:function(size,cb){var that=this;this.process(function(){if(that.data&&that.data.href){cb(that.data.href)}else{cb(null)}})},process:function(finished,options){var that=this;options=options||{};sandboxedAjax({url:"//instagr.am/api/v1/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth||390},success:function(resp){if(!resp.error){that.data.href=resp.url;that.data.name=that.constructor._name;finished()}}})},render:function(dom){var t='        <div class="instagram">          <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">            <img src="{{href}}"/>          </a>        </div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Rdio",{icon:"song",domain:"http://rdio.com",matchers:{rdio:/^#{optional_protocol}(?:rd\.io|rdio\.com)\/#{wildcard}/i},process:function(finished,options){var that=this;options=options||{};sandboxedAjax({url:"http://rdio.com/api/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth||390},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))},metadata:function(cb){cb({image:this.data.thumbnail_url,title:this.data.title,author:{name:this.data.author_name,url:this.data.author_url}})},getImageURL:function(size,cb){var that=this;this.process(function(){cb(this.url)},{maxwidth:500})}});twttr.mediaType("twttr.media.types.Dipdive",{domain:"http://dipdive.com",matchers:{photos:/^#{optional_protocol_subdomain}?dipdive\.com\/(((?:member\/[a-zA-Z0-9\-]+\/)?pictures\/([0-9]+))|(v\/[a-zA-Z0-9]+))/i,videos:/^#{optional_protocol_subdomain}?dipdive\.com\/(((?:member\/[a-zA-Z0-9\-]+\/)?media\/([0-9]+))|(v\/[a-zA-Z0-9]+))/i},icon:function(url){if(this._icon){return this._icon}if(url.match(/pictures/)){this._icon="photo"}else{this._icon="video"}return this._icon},process:function(finished,options){var that=this;options=options||{};sandboxedAjax({url:"http://api.dipdive.com/oembed.jsonp",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth||390},success:function(resp){if(!resp.error){if(resp.type==="photo"){that.data.type="photo";that.data.href=resp.url;that.data.name=that.constructor._name}else{that.data.embed=resp.html}finished()}}})},render:function(dom){var t;if(this.data.type==="photo"){t='<div class="dipdive">               <a class="inline-media-image" data-inline-type="{{name}}" href="{{href}}" target="_blank">                 <img src="{{href}}"/>               </a>             </div>'}else{t='<div class="inlinemedia">{{{embed}}}</div>'}$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.SlideShare",{icon:"generic",domain:"http://slideshare.com",matchers:{slides:/^#{optional_protocol}?slideshare\.(?:com|net)\/[a-zA-Z0-9\.]+\/[a-zA-Z0-9-]+\/?#{wildcard}?/i},attributionTemplate:"      <div class='media-attribution'>        <span>View more presentations from</span>         <a target='_blank' data-media-type='{{media_type}}' class='media-attribution-link' href='{{url}}'>{{title}}</a>      </div>",process:function(finished,options){var that=this;options=options||{};sandboxedAjax({url:"http://www.slideshare.net/api/oembed/1",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth||390},success:function(resp){if(!resp.error){that.data.embed=resp.html;that.data.attribution_url=resp.author_url;that.data.attribution_title=resp.author_name;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.BlipTV",{icon:"video",domain:"//blip.tv",title:"blip.tv",matchers:{videos:/^#{optional_protocol_subdomain}?(?:[\w\-]+\.)?blip\.tv\/(?:file|episode)\/[\w-]+\/?/i},getImageUrl:function(size,cb){var that=this;this.process(function(){cb(that.data.thumbnail_url)})},process:function(finished,options){var that=this;options=options||{};sandboxedAjax({url:"//blip.tv/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth},success:function(resp){if(!resp.error){that.data.embed=resp.html;that.data.thumbnail_url=resp.thumbnail_url;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Livestream",{icon:"video",domain:"http://www.livestream.com",matchers:{wwwlivestream:/^#{optional_protocol}?livestream\.com\/[\w_]+(\/#{wildcard})?/i,livestream:/^#{protocol}?livestre\.am\/[\w_]+(\/#{wildcard})?/i,twitcam:/^#{protocol}?twitcam\.(?:livestream\.)com\/[\w_]+(\/#{wildcard})?/i},process:function(finished,options){var that=this;options=options||{};$.ajax({url:"http://www.livestream.com/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.WallStreetJournal",{icon:"video",domain:"http://online.wsj.com",title:"The Wall Street Journal Digital Network",matchers:{video:/^#{protocol}?online\.wsj\.com\/video\/[A-Z0-9a-z\-]+\/[A-Z0-9a-z\-]+\.html/i},process:function(finished,options){var that=this;options=options||{};$.ajax({url:"http://online.wsj.com/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.Hulu",{icon:"video",domain:"http://www.hulu.com",matchers:{video:/^#{optional_protocol}?hulu\.com\/w(atch)?\/([a-zA-Z0-9]+)/i},process:function(finished,options){var that=this;options=options||{};$.ajax({url:"http://www.hulu.com/api/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}});twttr.mediaType("twttr.media.types.NHL",{icon:"video",domain:"http://www.nhl.com",matchers:{video:/^#{protocol}?video\.([a-z]{4,11}\.)?nhl\.com\/videocenter\/console\?(((catid=-?\d+&)?id=\d+)|(hlg=\d{8},\d,\d{1,4}(&event=[A-Z0-9]{4,6})?)|(hlp=\d{5,10}(&event=[A-Z0-9]{4,6})?))/i},process:function(finished,options){var that=this;options=options||{};$.ajax({url:"http://video.nhl.com/videocenter/oembed",type:"GET",dataType:"jsonp",data:{url:this.url,maxwidth:options.maxwidth},success:function(resp){if(!resp.error){that.data.embed=resp.html;finished()}}})},render:function(dom){var t='<div class="inlinemedia">{{{embed}}}</div>';$(dom).append(Mustache.to_html(t,this.data))}})}());twttr.klass("twttr.DesktopNotifier",function(){}).methods({HasSupport:function(){if(window.webkitNotifications){return true}else{return false}},RequestPermission:function(cb){window.webkitNotifications.requestPermission(function(){if(cb){cb(window.webkitNotifications.checkPermission()==0)}})},Notify:function(icon,title,body){if(window.webkitNotifications.checkPermission()==0){var popup=window.webkitNotifications.createNotification(icon,title,body);popup.show();return true}return false}});twttr.klass("twttr.geo.autocomplete",function(options){var that=this;that.opts=twttr.merge({getInputVal:function(){return that.opts.$input.val()},hoverClass:"hover",delay:350},options);that.cache={};that._clearFakeFocus();that.opts.$input.keydown(function(e){switch(e.keyCode){case 38:that.arrowUp();break;case 40:that.arrowDown();break;case 13:if(!that.hasFakeFocus){return }that.$fakeFocus.click();break;case 27:if(that.opts.$dropdown.is(":visible")){that.hide()}else{return }break;case 9:if(that.opts.$dropdown.is(":visible")){that.hide()}return ;default:that._onInputChange();return }that.keyDownEvent=true;e.stopPropagation();e.preventDefault()}).keypress(function(e){if(e.charCode==0&&(e.keyCode==38||e.keyCode==40)){if(!that.keyDownEvent){if(e.keyCode==38){that.arrowUp()}else{that.arrowDown()}}that.keyDownEvent=false;e.preventDefault()}}).change(function(){that._onInputChange()}).blur(function(){if(!that.hovering){that.hide()}})}).method("arrowDown",function(){if(this.hasFakeFocus){this._setFakeFocus(this.$fakeFocus.next())}else{this._show()}}).method("arrowUp",function(){this._setFakeFocus(this.$fakeFocus.prev())}).method("hide",function(){this._clearFakeFocus();this.opts.$dropdown.hide();this.displayedInputVal=this.opts.getInputVal()}).method("_show",function(){this.displayedInputVal="";this._display();this._setFakeFocus(this.opts.$dropdown.children(":first"))}).method("_clearFakeFocus",function(){this.$fakeFocus=$([]);this.hasFakeFocus=false;this.opts.$dropdown.children().removeClass(this.opts.HoverClass)}).method("_setFakeFocus",function($itemToFocus){if($itemToFocus.length>0){this.hasFakeFocus=true;this.$fakeFocus=$itemToFocus;this.$fakeFocus.addClass(this.opts.hoverClass).siblings().removeClass(this.opts.hoverClass)}}).method("_onInputChange",function(){var that=this;setTimeout(function(){that._display()},0)}).method("_display",function(noDelay){var that=this;var inputVal=that.opts.getInputVal();if(that.displayedInputVal!=inputVal){that._clearFakeFocus();var $dropdown=that.opts.$dropdown.hide().empty();that.displayedInputVal="";var matches=that.cache[inputVal];if(matches){twttr.each(matches,function(match,index){$dropdown.append(that.opts.renderMatch(match,index,matches))});$dropdown.children().hover(function(){if(that.hasFakeFocus){that._setFakeFocus($(this))}else{$(this).addClass(that.opts.hoverClass)}that.hovering=true},function(){if(!that.hasFakeFocus){$(this).removeClass(that.opts.hoverClass)}that.hovering=false});var pos=that.opts.$input.position();$dropdown.css({left:pos.left,top:pos.top+that.opts.$input.outerHeight()-1}).show();that.displayedInputVal=inputVal}else{that._fetch(inputVal,noDelay)}}}).method("_fetch",function(inputVal,noDelay){var that=this;clearTimeout(that.timerId);that.timerId=setTimeout(function(){if(!that.fetching){that.fetching=true;that.opts.fetchMatches(inputVal,function(matches){that.fetching=false;if(matches&&matches.length>0){that.cache[inputVal]=matches;that._display(true)}},function(){that.fetching=false})}},noDelay?0:that.opts.delay)});twttr.klass("twttr.geo.Locator",function(params){var that=this;that.position=null;that.locator=null;that.locatorType="none";that.browserGeoPermissionsHelpBannerView="";if(params&&params.lat!==undefined&&params.lon!==undefined){that.locatorType="manual";that.locator={watchPosition:function(onSuccess){onSuccess({coords:{latitude:params.lat,longitude:params.lon,accuracy:parseInt(params.accuracy)||200}});return 0},clearWatch:function(){}}}else{if(navigator&&navigator.geolocation){that.locatorType="html5";that.locator=navigator.geolocation;if(navigator.userAgent.indexOf("Firefox")!=-1){that.browserGeoPermissionsHelpBannerView="GeoFirefoxBanner"}else{if(navigator.userAgent.indexOf("Chrome")!=-1){that.browserGeoPermissionsHelpBannerView="GeoChromeBanner"}else{if(navigator.userAgent.indexOf("MSIE")!=-1&&navigator.userAgent.indexOf("GTB")!=-1){that.browserGeoPermissionsHelpBannerView="GeoIeGoogleToolbarBanner"}}}}else{if(typeof google!="undefined"&&typeof google.gears!="undefined"){that.locatorType="gears";that.locator=google.gears.factory.create("beta.geolocation")}}}}).method("isLocatable",function(){return !!(this.locator)}).method("getLocation",function(options){var that=this;that.bannerShown=false;if(!that.isLocatable()){throw new twttr.geo.Exceptions.GeoSupportException()}var opts=$.extend({onSuccess:function(position){},onFailure:function(geoError){},options:{timeout:twttr.geo.LOCATION_TIMEOUT,enableHighAcuracy:true,maximumAge:twttr.geo.LOCATION_MAXIMUM_AGE}},options);if(!that.getBrowserGeoPermissionsHelpBannerSeen()){that.detectBrowserGeoPermissionsBanner()}that.position=null;that.waitForAcceptableId=window.setTimeout(function(){that.waitForAcceptableId=null;if(that.watchId!=null){that.watchPositionAcceptable(opts.onSuccess)}},twttr.geo.ACCEPTABLE_LOCATION_TIMEOUT);that.watchId=null;twttr.geo.log("Watch position: "+$.param(opts.options));that.watchId=that.locator.watchPosition(function(position){window.setTimeout(function(){if(that.watchId!=null){that.watchPositionSuccess(position,opts.onSuccess)}},0)},function(positionError){window.setTimeout(function(){if(that.watchId!=null){that.watchPositionError(positionError,opts.onFailure)}},0)},opts.options)}).method("watchPositionSuccess",function(position,onSuccess){var that=this;that.setBrowserGeoPermissionsHelpBannerSeen();that.position={latitude:position.coords.latitude,longitude:position.coords.longitude,accuracy:position.coords.accuracy};if(typeof (that.position.accuracy)!="number"){that.position.accuracy=0}twttr.geo.log("Watch position success: "+$.param(that.position));if(that.waitForAcceptableId==null||(that.position.accuracy!=undefined&&that.position.accuracy<twttr.geo.ACCEPTABLE_LOCATION_ACCURACY)){that.watchPositionAcceptable(onSuccess)}}).method("watchPositionError",function(positionError,onFailure){var that=this;that.setBrowserGeoPermissionsHelpBannerSeen();twttr.geo.log("Watch position error: "+positionError.code);var permissionDenied=(positionError.code===positionError.PERMISSION_DENIED);var error={allowRetry:!permissionDenied,msg:permissionDenied?_("Please grant your web browser permission to tell Twitter where you are."):_("We were unable to detect your location.")};var errorStatus="error_"+positionError.code;that.scribeLocationDetection(errorStatus);if(that.bannerShown){that.scribeLocationBanner(errorStatus)}if(permissionDenied){twttr.showMessage(error.msg)}that.watchPositionCleanup();onFailure(error)}).method("watchPositionAcceptable",function(onSuccess){var that=this;if(that.position){that.watchPositionCleanup();onSuccess(that.position);twttr.geo.log("Watch position accepted: "+$.param(that.position));that.scribeLocationDetection("success",that.position);if(that.bannerShown){that.scribeLocationBanner("success")}}}).method("watchPositionCleanup",function(){var that=this;window.clearTimeout(that.waitForAcceptableId);that.locator.clearWatch(that.watchId);that.watchId=null}).method("getWindowHeight",function(){return $(window).height()}).method("getBrowserGeoPermissionsHelpBannerSeen",function(){return $.cookie("geo_browser_help_banner")}).method("setBrowserGeoPermissionsHelpBannerSeen",function(){var that=this;if(that.browserGeoPermissionsHelpBannerView){that.clearDetectBrowserGeoPermissionsBanner();if(!that.getBrowserGeoPermissionsHelpBannerSeen()){$.cookie("geo_browser_help_banner","1",{expires:3650})}}}).method("showBrowserGeoPermissionsHelpBanner",function(){$("body").append((new twttr.views[this.browserGeoPermissionsHelpBannerView]()).html())}).method("detectBrowserGeoPermissionsBanner",function(){var that=this;if(that.browserGeoPermissionsHelpBannerView){var original_height=that.getWindowHeight();that.bannerCleared=false;that.browserGeoPermissionsHelpTimer=window.setTimeout(function(){if(that.getWindowHeight()<original_height){that.showBrowserGeoPermissionsHelpBanner();that.bannerShown=true;that.scribeLocationBanner("shown");that.browserGeoPermissionsHelpInterval=window.setInterval(function(){if(that.getWindowHeight()==original_height){that.clearDetectBrowserGeoPermissionsBanner()}},twttr.geo.BROWSER_GEO_BANNER_DISAPPEAR_INTERVAL)}},twttr.geo.BROWSER_GEO_BANNER_APPEAR_DELAY)}}).method("clearDetectBrowserGeoPermissionsBanner",function(){var that=this;if(!that.bannerCleared){that.bannerCleared=true;window.clearTimeout(that.browserGeoPermissionsHelpTimer);window.clearInterval(that.browserGeoPermissionsHelpInterval);if(that.bannerShown){that.scribeLocationBanner("cleared")}$("#geo_browser_help_banner").remove()}}).method("scribeLocationDetection",function(status,extraData){twttr.geo.geoScribe("location_detection",$.extend({status:status,locator_type:this.locatorType,banner_shown:this.bannerShown,banner_type:this.browserGeoPermissionsHelpBannerView},extraData))}).method("scribeLocationBanner",function(status,extraData){twttr.geo.geoScribe("location_banner",$.extend({status:status,locator_type:this.locatorType,banner_type:this.browserGeoPermissionsHelpBannerView},extraData))});twttr.klass("twttr.GeoManager",function(){var that=this;if(twttr.geo.geoEnabled==null){twttr.geo.geoEnabled=twttr.currentUser&&twttr.currentUser.geoEnabled}that.locator=new twttr.geo.Locator(twttr.util.params());$(".geo_enable_webclient").die("click");$(".geo_enable_webclient").live("click",function(e){e.preventDefault();that.enableGeoForWebClient()});$(".geo_disable_webclient").die("click");$(".geo_disable_webclient").live("click",function(e){e.preventDefault();that.disableGeoForWebClient()});if(!twttr.decider.isAvailable("geo_ui")){return }if(twttr.geo.geoEnabled){if($.cookie("geo_webclient")){that.detectLocation(false)}else{that.disableGeoForWebClient()}}else{that.setGeoStatus("GeoAddLocationGeoDisabled");twttr.geo.geoScribe("promo_bar_shown")}}).method("setGeoStatus",function(viewName,context){var v3=twttr.geo.v3();var context=twttr.merge({v3:v3},context);this.currentStatusHtml=(new twttr.views[viewName](context)).html();if(v3){this.currentStatusHtml=(new twttr.views.PlaceMentionButton({status_html:this.currentStatusHtml})).html()}this.showCurrentStatus()}).method("showCurrentStatus",function(){var that=this;if(!twttr.decider.isAvailable("geo_ui")){this.currentStatusHtml=(new twttr.views.GeoAddLocationGeoEnabled).html();twttr.geo.currentLocation={};$(".geo-control").html();return }$(".geo-control").html(this.currentStatusHtml);$(".geo-control .place_content").each(function(index,placeContent){new twttr.geo.PlacesDropdown(that.placer,$(placeContent.parentNode),function(newPlace){that.changeLocation(newPlace)})});$(".show_geo_dialog").click(function(e){e.preventDefault();e.stopPropagation();that.showPromoDialog();twttr.geo.geoScribe("promo_bar_dialog_open")});$(".geo_add_manual").click(function(e){e.preventDefault();that.setLocationManually()})}).method("scribePlaceLookup",function(status,extraData){twttr.geo.geoScribe("place_lookup",$.extend({status:status,locator_type:this.locator.locatorType},extraData))}).method("lookupPlacesAndShowDropdown",function(geoParams,userInitiated){var that=this;that.placer=new twttr.geo.Placer({geoParams:geoParams});that.placer.search(function(){that.scribePlaceLookup("success",that.placer.getState());that.setGeoStatus("GeoPlaceContent")},function(){that.cannotDetectLocation(userInitiated);that.scribePlaceLookup("error",that.placer.getState())},function(){that.setGeoStatus("GeoFailureTryAgain",{message:_("Location service is currently unavailable.")})})}).method("detectLocationByIp",function(userInitiated){var that=this;if(twttr.remoteIP){twttr.geo.log("Detect location by IP: "+twttr.remoteIP);twttr.geo.currentLocation.lat=null;twttr.geo.currentLocation.lon=null;that.lookupPlacesAndShowDropdown({ip:twttr.remoteIP,accuracy:16000,granularity:that.getGranularity(),max_results:that.getMaxResults()},userInitiated)}else{that.scribePlaceLookup("no_ip");that.cannotDetectLocation(userInitiated)}}).method("cannotDetectLocation",function(userInitiated){var that=this;if(twttr.decider.isAvailable("geo_allow_set_location_manually")){if(userInitiated){that.setLocationManually()}else{that.setGeoStatus("GeoDetectionFailedSetManually")}}else{that.setGeoStatus("GeoFailureTryAgain",{message:_("Unable to associate your coordinates with a place.")})}}).method("changeLocation",function(newPlace){var that=this;that.setGeoStatus("GeoProgress",{message:_("Changing location...")});that.placer.selectPlaceAndUpdateNearbyPlaces(newPlace,function(){that.setGeoStatus("GeoPlaceContent")})}).method("setLocationManually",function(){var that=this;that.placer=new twttr.geo.Placer({geoParams:{granularity:that.getGranularity(),max_results:that.getMaxResults()}});var continueSettingLocation=function(){that.setGeoStatus("GeoAddLocationGeoEnabled");new twttr.geo.PlaceSearchDialog(that.placer,function(newPlace){that.changeLocation(newPlace);that.setGeoStatus("GeoPlaceContent")});twttr.geo.geoScribe("set_location_manually")};var recentPlaceId=that.placer.getRecentPlaceId();if(recentPlaceId){that.setGeoStatus("GeoProgress",{message:_("Getting recent location...")});that.placer.selectPlaceById(recentPlaceId,function(){continueSettingLocation()},function(){continueSettingLocation()})}else{continueSettingLocation()}}).method("detectLocation",function(userInitiated){twttr.geo.currentLocation={};this.setGeoStatus("GeoProgress",{message:_("Getting your location...")});var that=this;twttr.geo.log("Detect location",true);if(!that.locator.isLocatable()||twttr.util.params().nodetect!==undefined){that.detectLocationByIp(userInitiated)}else{that.locator.getLocation({onSuccess:function(position){twttr.merge(twttr.geo.currentLocation,{lat:position.latitude,lon:position.longitude});that.lookupPlacesAndShowDropdown({lat:position.latitude,lon:position.longitude,accuracy:position.accuracy,granularity:that.getGranularity(),max_results:that.getMaxResults()},false)},onFailure:function(error){if(error.allowRetry){that.detectLocationByIp(userInitiated)}else{that.disableGeoForWebClient()}}})}}).method("showPromoDialog",function(){var that=this;var options={template:{title:_("Add a location to your tweets"),content:(new twttr.views.GeoPromoDialog()).html()},modal:true};that.dialog=new twttr.widget.GeoDialog(options);$("#geo_turn_location_on").click(function(){that.turnLocationOn();twttr.geo.geoScribe("promo_dialog_turn_location_on")});$(".geo_dialog_close").click(function(e){e.preventDefault();that.hidePromoDialog();twttr.geo.geoScribe("promo_dialog_not_now")});that.dialog.open()}).method("hidePromoDialog",function(){if(this.dialog){this.dialog.destroy()}}).method("turnLocationOn",function(){var that=this;var $progress=$("#geo_promo_dialog_content .geo-progress");var $error=$("#geo_promo_dialog_content .geo-unable-to-turn-location-on");if($progress.hasClass("geo-spinner")){return }$progress.addClass("geo-spinner");$error.hide();twttr.currentUser.setGeoEnabled(true,{success:function(){twttr.geo.geoEnabled=true;that.hidePromoDialog();that.enableGeoForWebClient()},error:function(){$progress.removeClass("geo-spinner");$error.show()},timeout:function(){$progress.removeClass("geo-spinner");$error.show()}})}).method("getGranularity",function(){return twttr.geo.v3()?"neighborhood":"poi"}).method("getMaxResults",function(){return twttr.geo.v3()?twttr.geo.MAX_NEARBY_NEIGHBORHOODS:twttr.geo.MAX_NEARBY_PLACES}).method("enableGeoForWebClient",function(){if(!twttr.decider.isAvailable("geo_ui")){this.showCurrentStatus();return }if(!$.cookie("geo_webclient")){$.cookie("geo_webclient","1",{expires:3650})}this.detectLocation(true)}).method("disableGeoForWebClient",function(){if(!twttr.decider.isAvailable("geo_ui")){this.showCurrentStatus();return }twttr.geo.currentLocation={};if($.cookie("geo_webclient")){$.cookie("geo_webclient",null)}this.setGeoStatus("GeoAddLocationGeoEnabled")});twttr.klass("twttr.geo.Map",function($canvas,opts){var that=this;if(!twttr.geo.mapsAvailable()){return }var defaultOptions={mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:true,scrollwheel:false,navigationControl:true,navigationControlOptions:{position:google.maps.ControlPosition.TOP_LEFT,style:google.maps.NavigationControlStyle.SMALL}};that.map=new google.maps.Map($canvas.get(0),twttr.merge(defaultOptions,opts));that.bounds=new google.maps.LatLngBounds();that.initialized=true;that.$canvas=$canvas;that.addListener("tilesloaded",function(){that.resize()})}).methods({addListener:function(eventName,callback){google.maps.event.addListener(this.map,eventName,callback)},createOverlay:function(callback){var that=this;function MapOverlay(){this.setMap(that.map)}MapOverlay.prototype=new google.maps.OverlayView();MapOverlay.prototype.onAdd=function(){};MapOverlay.prototype.onRemove=function(){};MapOverlay.prototype.draw=function(){if(callback){setTimeout(callback,0);callback=null}};that.mapOverlay=new MapOverlay()},getProjection:function(){var overlay=this.mapOverlay;return overlay&&overlay.getProjection()},latLngToContainerPoint:function(latLng){var that=this;latLng=that.normalizeLatLng(latLng);var projection=that.getProjection();return projection?projection.fromLatLngToContainerPixel(latLng):null},latLngToOverlayPoint:function(latLng){var that=this;latLng=that.normalizeLatLng(latLng);var projection=that.getProjection();return projection?projection.fromLatLngToDivPixel(latLng):null},containerPointToLatLng:function(x,y){return this.getProjection().fromContainerPixelToLatLng(new google.maps.Point(x,y))},extendBounds:function(latLng){this.bounds.extend(latLng)},normalizeLatLng:function(latLng){return $.isArray(latLng)?new google.maps.LatLng(latLng[1],latLng[0]):latLng},addPoint:function(latLng,avatarUrl){var that=this;latLng=that.normalizeLatLng(latLng);that.extendBounds(latLng);var size=twttr.geo.POI_MARKER_SIZE;var hot=twttr.geo.POI_MARKER_HOTSPOT;var markerImage=new google.maps.MarkerImage("/phoenix/img/pin.png",new google.maps.Size(size.width,size.height),null,new google.maps.Point(hot.x,hot.y));that.marker=new google.maps.Marker({flat:true,icon:markerImage,map:that.map,position:latLng,clickable:false,zIndex:2});if(avatarUrl){var avatarImage=new google.maps.MarkerImage(avatarUrl,null,null,new google.maps.Point(13,32),new google.maps.Size(24,24));that.avatar=new google.maps.Marker({flat:true,icon:avatarImage,map:that.map,position:latLng,zIndex:3})}},addPoi:function(latLng,onPositionChanged){var draggable=twttr.is.fn(onPositionChanged);latLng=this.normalizeLatLng(latLng);this.extendBounds(latLng);var markerImage=new google.maps.MarkerImage("/phoenix/img/poi-pin.png",null,null,new google.maps.Point(twttr.geo.POI_MARKER_HOTSPOT.x,twttr.geo.POI_MARKER_HOTSPOT.y));var marker=new google.maps.Marker({flat:true,icon:markerImage,map:this.map,position:latLng,draggable:draggable,clickable:draggable,zIndex:2});if(draggable){google.maps.event.addListener(marker,"position_changed",function(){var latLng=marker.getPosition();onPositionChanged(latLng.lat(),latLng.lng())})}return marker},addFocusablePoint:function(latLng,onHover,onClick){var that=this;latLng=that.normalizeLatLng(latLng);that.extendBounds(latLng);var markerOn=new google.maps.MarkerImage("/phoenix/img/place-minor10x.png",new google.maps.Size(10,10),new google.maps.Point(10,0),new google.maps.Point(5,5));var markerOff=new google.maps.MarkerImage("/phoenix/img/place-minor10x.png",new google.maps.Size(10,10),null,new google.maps.Point(5,5));var marker=new google.maps.Marker({flat:true,icon:markerOff,map:that.map,position:latLng,clickable:onHover!==undefined,zIndex:2});if(onHover){google.maps.event.addListener(marker,"mouseover",function(e){onHover(true,that.latLngToContainerPoint(latLng))});google.maps.event.addListener(marker,"mouseout",function(e){onHover(false,that.latLngToContainerPoint(latLng))})}if(onClick){google.maps.event.addListener(marker,"click",function(e){onClick()})}return function(onOff){if(onOff){marker.setIcon(markerOn);marker.setZIndex(3)}else{marker.setIcon(markerOff);marker.setZIndex(2)}}},extendBoundsToIncludeCircle:function(latLng,radius){if(radius<200){return }var circle=new google.maps.Circle({map:null,center:this.normalizeLatLng(latLng),radius:radius,clickable:false,fillColor:"#0040FF",fillOpacity:0.08,strokeColor:"#2929D4",strokeOpacity:0.7,strokeWeight:0.5,zIndex:1});var bounds=circle.getBounds();this.extendBounds(bounds.getNorthEast());this.extendBounds(bounds.getSouthWest())},addPlacePolygon:function(polyPoints){polyPoints=polyPoints[0];var path=[];for(var i=0;i<polyPoints.length;i++){var latLng=this.normalizeLatLng(polyPoints[i]);path.push(latLng);this.extendBounds(latLng)}new google.maps.Polygon({path:path,strokeColor:"#FF0000",strokeOpacity:0.5,strokeWeight:0.5,fillColor:"#FF0000",fillOpacity:0.2,map:this.map})},isEmpty:function(){return this.bounds.isEmpty()},adjustBounds:function(maxZoom,center){var that=this;if(this.isEmpty()){return }that.fitBounds(that.bounds,maxZoom,center)},MIN_LAT:-85.05113,MAX_LAT:85.05113,X_FROM_LNG:256/360,Y_FROM_RADIANS:-256/(2*Math.PI),DEGREES_FROM_RADIANS:180/Math.PI,MAX_CONTENT_WIDTH_RATIO:0.9,MAX_CONTENT_HEIGHT_RATIO:0.9,_worldXFromLng:function(lng){return lng*this.X_FROM_LNG},_worldYFromLat:function(lat){var that=this;lat=Math.max(that.MIN_LAT,Math.min(that.MAX_LAT,lat));var f=Math.sin(lat/that.DEGREES_FROM_RADIANS);return Math.log((1+f)/(1-f))*0.5*that.Y_FROM_RADIANS},_lngFromWorldX:function(x){return x/this.X_FROM_LNG},_latFromWorldY:function(y){var f=2*Math.atan(Math.exp(y/this.Y_FROM_RADIANS));return(f-0.5*Math.PI)*this.DEGREES_FROM_RADIANS},_zoomFromPixelDelta:function(mapDelta,worldDelta,maxZoom){var zoom=Math.floor(Math.log(Math.abs(mapDelta/worldDelta))/Math.LN2);return isNaN(zoom)?maxZoom:Math.max(0,Math.min(maxZoom,zoom))},fitBounds:function(bounds,maxZoom,center){var that=this;that.bounds=bounds;var ne=bounds.getNorthEast();var sw=bounds.getSouthWest();var x1=that._worldXFromLng(sw.lng());var x2=that._worldXFromLng(ne.lng());var y1=that._worldYFromLat(ne.lat());var y2=that._worldYFromLat(sw.lat());var zoomWidth=that._zoomFromPixelDelta(that.$canvas.width()*that.MAX_CONTENT_WIDTH_RATIO,x2-x1,maxZoom);var zoomHeight=that._zoomFromPixelDelta(that.$canvas.height()*that.MAX_CONTENT_HEIGHT_RATIO,y2-y1,maxZoom);that.map.setZoom(Math.min(zoomWidth,zoomHeight));if(!center){var latCentroid=that._latFromWorldY((y1+y2)*0.5);center=new google.maps.LatLng(latCentroid,bounds.getCenter().lng())}that.map.setCenter(that.normalizeLatLng(center))},getCenter:function(){return this.map.getCenter()},resize:function(){google.maps.event.trigger(this.map,"resize")}});twttr.klass("twttr.geo.Placer",function(options){var that=this;that.opts=options;that.places=[];that.detectedParams={};var geoParams=that.opts.geoParams;if(geoParams.lat!==undefined&&geoParams.lon!==undefined){that.detectedParams.lat=parseFloat(geoParams.lat).toFixed(4);that.detectedParams.lon=parseFloat(geoParams.lon).toFixed(4)}if(geoParams.ip!==undefined){that.detectedParams.ip=geoParams.ip}}).methods({PLACE_OVERRIDES_COOKIE:"place_overrides",RECENT_PLACE_COOKIE:"recent_place",MAX_PLACE_OVERRIDES:8,STICKY_RADIUS_IN_KM:0.1}).method("search",function(onSuccess,onError,onServiceUnavailable){var that=this;try{twttr.geo.log("Search: "+$.param(that.opts.geoParams));twttr.API.Place.search(twttr.merge({},that.opts.geoParams,{success:function(places){that.places=twttr.geo.placesFromApi(places);twttr.geo.log("Search success: "+that.places.length+" places");that.determinePlaces(onSuccess,onError)},error:function(req){twttr.geo.log("Search error: "+req.status);if(req.status==503){onServiceUnavailable()}else{onError()}}}))}catch(e){onError()}}).method("determinePlaces",function(onSuccess,onError){var that=this;if(twttr.every(that.places,function(place){if(place.place_type!="poi"){that.detectedPlace=place;that.detectedGeoParams=$.extend(true,{},that.opts.geoParams);return false}return true})){onError();return }twttr.geo.log("Determine Places: Detected place is "+that.detectedPlace.id+" ("+that.detectedPlace.full_name+")");if(twttr.every(that.getOverrides(),function(override){if(that.isOverrideCloseToDetected(override)){twttr.geo.log("Local Override: "+$.param(override)+"  Detected params: "+$.param(that.detectedParams));that.selectPlaceById(override.id,onSuccess,onError);return false}return true})){that.selectPlace(that.detectedPlace);onSuccess()}}).method("selectPlaceById",function(id,onSuccess,onError){var that=this;if(twttr.every(that.places,function(place){if(place.id==id){that.selectPlace(place);onSuccess();return false}return true})){try{twttr.API.Place.find(id,{success:function(apiPlace){that.selectPlaceAndUpdateNearbyPlaces(apiPlace.data(),onSuccess)},error:function(){onError()}})}catch(e){onError()}}}).method("setOverrides",function(overrides){if(overrides!=this.getOverrides()){if(overrides.length>0){$.cookie(this.PLACE_OVERRIDES_COOKIE,twttr.map(overrides,function(override){return $.param(override)}).join(","),{expires:3650})}else{$.cookie(this.PLACE_OVERRIDES_COOKIE,null)}}}).method("getOverrides",function(){var cookieItems=($.cookie(this.PLACE_OVERRIDES_COOKIE)||"").split(",");cookieItems=twttr.filter(cookieItems,function(override){return override!=""});return twttr.map(cookieItems,function(override){return twttr.geo.unparam(override)})}).method("selectPlace",function(newPlace){var that=this;if(twttr.every(that.places,function(place){if(newPlace.id==place.id){that.selectedPlace=place;return false}return true})){that.places.unshift(newPlace);that.selectedPlace=newPlace}if(that.selectedPlace.place_type!="poi"){that.setOverride();that.setRecentPlaceId(that.selectedPlace.id)}}).method("setOverride",function(){var that=this;var overrides=twttr.filter(that.getOverrides(),function(override){return !that.isOverrideCloseToDetected(override)});if(that.detectedPlace&&that.selectedPlace.id!=that.detectedPlace.id){overrides.unshift(twttr.merge({id:that.selectedPlace.id},that.detectedParams))}that.setOverrides(overrides.slice(0,that.MAX_PLACE_OVERRIDES))}).method("getRecentPlaceId",function(){return $.cookie(this.RECENT_PLACE_COOKIE)}).method("setRecentPlaceId",function(id){$.cookie(this.RECENT_PLACE_COOKIE,id,{expires:3650})}).method("isOverrideCloseToDetected",function(override){var dp=this.detectedParams;if(!dp){return false}if(override.lat!==undefined&&override.lon!==undefined&&dp.lat!==undefined&&dp.lon!==undefined&&twttr.geo.greatCircleDistanceInKm(override.lat,override.lon,dp.lat,dp.lon)<this.STICKY_RADIUS_IN_KM){return true}return dp.ip&&dp.ip==override.ip}).method("getState",function(){var that=this;var state={geo_params:that.opts.geoParams,place_ids:[]};var placeIds=[];if(that.places){twttr.each(that.places,function(place,index){state.place_ids.push(place.id);if(that.selectedPlace&&that.selectedPlace.id==place.id){state.selected_place_index=index}})}if(that.selectedPlace){state.selected_place_id=that.selectedPlace.id}if(that.detectedPlace){state.detected_place_id=that.detectedPlace.id}return state}).method("selectPlaceAndUpdateNearbyPlaces",function(newPlace,onComplete){var that=this;var oldCity=twttr.geo.getBestCity(that.selectedPlace);var newCity=twttr.geo.getBestCity(newPlace);twttr.geo.log("Change place: "+newPlace.id+" ("+newPlace.full_name+")");var finish=function(){if(newCity.id!=newPlace.id){that.selectPlace(newCity)}that.selectPlace(newPlace);onComplete()};if(newCity.id==oldCity.id){twttr.geo.log("Change place: Same city");finish();return }if(that.detectedPlace&&twttr.geo.getBestCity(that.detectedPlace).id==newCity.id){that.opts.geoParams=$.extend(true,{},that.detectedGeoParams)}else{var location=twttr.geo.getLocationFromPlace(newPlace);if(!location){twttr.geo.log("Change place: New place has no geometry");finish();return }that.opts.geoParams.lat=location.latitude;that.opts.geoParams.lon=location.longitude;that.opts.geoParams.accuracy=location.accuracy;delete that.opts.geoParams.contained_by;delete that.opts.geoParams.ip}twttr.geo.log("Change place nearby search: "+$.param(that.opts.geoParams));try{twttr.API.Place.search(twttr.merge({},that.opts.geoParams,{success:function(places){that.places=twttr.geo.placesFromApi(places);twttr.geo.log("Change place nearby search success: "+that.places.length+" places");if(that.detectedPlace){if(twttr.every(that.places,function(place){return that.detectedPlace!=place.id})){that.places.push(that.detectedPlace)}}finish()},error:function(req){finish()}}))}catch(e){finish()}}).method("getGranularity",function(){return(this.opts.geoParams&&this.opts.geoParams.granularity)||"poi"}).method("getDeepCopyForPoi",function(){return $.extend(true,{},this,{opts:{geoParams:{granularity:"poi"}}})});twttr.view("twttr.views.Base",function(id,obj){if(!twttr.is.string(id)){this.obj=id;this.viewId=null}else{this.viewId=id;this.obj=obj}if(!this.obj){return }var currPage=twttr.audit.currentPage();if(currPage){this["in_"+currPage+"_page"]=true}var currAction=twttr.audit.currentAction();if(currAction){this["in_"+currAction+"_action"]=true}this.originalObject=this.obj;this.attach(this.obj)}).statics({formatDeciderMethodName:function(name){return twttr.util.underscore(name.replace(/[^A-Z0-9]/gi,"_"))},_addBucketTestMethod:function(experiment,experimentKey,bucket){var bucketKey=experimentKey+"_"+this.formatDeciderMethodName(bucket);if(bucket&&!this.prototype[bucketKey]){this.method(bucketKey,function(){return bucket==twttr.abdecider.choose(experiment)})}},addABTestMethods:function(experiment,currentBucket,bucketNames){var experimentKey="abtest_"+this.formatDeciderMethodName(experiment);if(!this.prototype[experimentKey]){this.method(experimentKey,function(){return !!twttr.abdecider.choose(experiment)})}var anyBucketKey=experimentKey+"_any_bucket";if(!this.prototype[anyBucketKey]){this.method(anyBucketKey,function(){var bucket=twttr.abdecider.choose(experiment);return !!(bucket&&bucket!="control")})}if(bucketNames){for(var i=0;i<bucketNames.length;i++){this._addBucketTestMethod(experiment,experimentKey,bucketNames[i])}}else{this._addBucketTestMethod(experiment,experimentKey,currentBucket)}},addDeciderMethod:function(key){this.method("decider_"+twttr.util.underscore(key),function(){return twttr.decider.isAvailable(key)})},onDeciderKeyChange:function(event,details){twttr.views.Base.addDeciderMethod(details.key)},onABTestKeyChange:function(event,details){if(details.current){twttr.views.Base.addABTestMethods(details.key,details.current.bucket,details.current.bucket_names)}}}).methods({languages:function(){return twttr.map(twttr.languages,function(lang){var localized_name=_(lang.name_en);return{name:localized_name,name_own:lang.name,code:lang.code,css_classes:lang.css_classes,toString:function(){return localized_name},current:(lang.code==twttr.pageLocale)}}).sort()},render:function(selector,operation){this.selector=selector;this.operation=operation||"html";this.$dom=$(this.html());$(this.selector)[this.operation](this.$dom);this.afterRender(this.$dom);return this.$dom},attach:function(o){for(var key in o){this[key]=o[key]}},hide:function(){this.$dom.hide();this.$dom.addClass("inactive").removeClass("active")},show:function(){this.$dom.show();this.$dom.addClass("active").removeClass("inactive")},refresh:function(){this.$dom=$(this.html(true));$(this.selector)[this.operation](this.$dom)},html:function(force){if(!force&&this._html){return this._html}var args=[this.constructor._template,this];if(this.constructor._partials){args.push(this.constructor._partials)}this._html=Mustache.to_html.apply(Mustache,args);this.afterHtml(this._html);return this._html},$html:function(options){return $(this.html())},rendering_on_server:false,afterHtml:function(html){},afterRender:function($domElement){},subview:function(viewName,view){this[viewName]=view;return this},logged_in:function(){return !!twttr.currentUser},is_ssl:function(){return twttr.proto=="https"},is_mobile:function(){return !!twttr.isMobile},is_narrow:function(){return !!twttr.isNarrow},form_authenticity_token:function(){return twttr.anywhere.api.config.postAuthenticityToken},render_page_content:true});(function(){for(var key in twttr.decider.features()){twttr.views.Base.addDeciderMethod(key)}var experiments=twttr.abdecider.experiments();for(var experimentName in experiments){var experiment=experiments[experimentName];if(experiment&&experiment.bucket){twttr.views.Base.addABTestMethods(experimentName,experiment.bucket,experiment.bucket_names)}}})();twttr.decider.bind("keyChanged",twttr.views.Base.onDeciderKeyChange);twttr.abdecider.bind("keyChanged",twttr.views.Base.onABTestKeyChange);twttr.view("twttr.views.BaseAPI").methods({attach:function(o){var data=(o.attributes||o);for(var key in data){this[key]=data[key]}}});twttr.view("twttr.views.BaseAPIList",function(){var that=this;twttr.views.Base.apply(this,arguments);this.items=[];if(!this.obj){return }this.obj.each(function(item){that.items.push(new that.ItemView(item))})}).methods({ItemView:twttr.views.BaseAPI});twttr.view("twttr.views.LinkSimpleList",function(links){this.links=links});twttr.view("twttr.views.LinkList",function(links,separator){var links=(links.array||links),last=links.length-1;this.links=twttr.map(links,function(item,i){return twttr.merge({separator:(i==last?false:separator)},item)})});twttr.view("twttr.views.BaseTweet",function(){twttr.views.BaseAPI.apply(this,arguments);this.user=new twttr.views.BaseUser({attributes:this.user})}).subclassOf(twttr.views.BaseAPI).methods({full_timestamp:function(){return twttr.helpers.timeAgo(this.actual_timestamp(),true)},short_timestamp:function(){return twttr.helpers.timeAgo(this.actual_timestamp())},explicit_timestamp:function(){return twttr.helpers.prettyTime(this.actual_timestamp())},actual_timestamp:function(){return twttr.helpers.parseDateString(this.created_at)},linkified_text:function(){if(!this.text){return""}var linkified=this.text;if(twttr.decider.isAvailable("geo_place_entities_read")){if(this.entities&&this.entities.places){this.entities.places.sort(function(a,b){return b.indices[0]-a.indices[0]});var previousStart=linkified.length;twttr.each(this.entities.places,function(place){var start=place.indices[0];var end=place.indices[1];if(end<=previousStart&&end>start){var placeText=linkified.substring(start,end);if(twttr.txt.extractUrlsWithIndices(placeText).length===0){linkified=linkified.substring(0,start)+'<a href="/places/'+h(place.id)+'" target="_blank" class="twitter-place" data-place-id="'+h(place.id)+'">'+placeText+"</a>"+linkified.substring(end)}previousStart=start}})}}linkified=twttr.util.linkify(linkified,{nofollow:true});linkified=twttr.util.linkifyEntities(linkified,this);return this.query?twttr.util.queryHighlight(this.query,linkified):linkified},is_top_tweet:function(){return this.result_category==="popular"},is_sponsored:function(){return !!(this.impression_id)},tweet_impression_id:function(){return this.impression_id?Mustache.to_html("data-impression-id='{{id}}' ",{id:this.impression_id}):""},advertiser_name:function(){return this.was_retweeted?this.retweeting_status.user.name:this.user.name},allowed_to_retweet:function(){return !this.user["protected"]&&!twttr.helpers.isCurrentUser(this.user)},retweet_count_text:function(){var count=this.retweet_count;if(count===1){return _("{{retweet_count}} Retweet",{retweet_count:count})}else{return _("{{retweet_count}} Retweets",{retweet_count:twttr.util.formatNumber(count)})}},show_trashcan:function(){return twttr.helpers.isCurrentUser(this.user)||(twttr.admin&&twttr.admin.showTrashcan())},show_not_relevant_action:function(){return(twttr.decider.isAvailable("phoenix_search_relevance_not_relevant_action")&&this.result_category==="relevance")},contributor:function(){return this.contributors?this.contributors[0]:null},can_view:function(){return this.user.can_view()},retweet_source_screen_name_link:function(){if(this.retweeting_status){var screenName=this.retweeting_status.text.match(/^RT @?([0-9A-Za-z_]*):/).pop();return Mustache.to_html("<a href='{{path}}' class='latest-status-retweeted-user'>{{screen_name}}</a>",{path:twttr.router.profilePath({screen_name:screenName}),screen_name:screenName})}},dogear_css_classes:function(){var c="";if(this.favorited){c+=" tweet-dogear-fav"}if(this.current_user_retweet){c+=" tweet-dogear-rt"}return c},css_classes:function(){var classes="";$.each({is_top_tweet:"top-tweet",is_sponsored:"promoted-tweet",current_user_retweet:"tweet-retweeted",favorited:"tweet-favorited"},twttr.bind(this,function(k,v){if(twttr.is.fn(this[k])?this[k]():this[k]){classes+=v+" "}}));return classes},permalink_path:function(){return twttr.router.permalinkPath({screen_name:this.user.screen_name,id:this.id})},truncated_text:function(){return twttr.helpers.truncate(this.text,50)}});twttr.view("twttr.views.BaseUser",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI).methods({defaultAvatarRegEx:/default_profile_\d/,defaultAvatar:function(getImage){if(this.profile_image_url.match(this.defaultAvatarRegEx)&&this.is_current_user()){if(getImage){return twttr.assets.path("/images/default_profile_add_photo.png")}else{return twttr.router.settingsProfilePath()}}return false},bigger_profile_image_url:function(){return this.defaultAvatar(false)||twttr.helpers.transformProfileImageUrl(this.profile_image_url)},reasonably_small_profile_image_url:function(){return this.defaultAvatar(true)||twttr.helpers.transformProfileImageUrl(this.profile_image_url,"reasonably_small")},account_profile_image_path:function(){return"/account/profile_image/"+this.screen_name},linkified_description:function(){if(!this.description){return""}var linkified=twttr.util.linkifyEntities(twttr.util.linkify(this.description,{nofollow:true}),this);return this.query?twttr.util.queryHighlight(this.query,linkified):linkified},display_url_or_url:function(){if(!this.url){return""}return twttr.txt.htmlEscape(this.display_url||this.url)},is_current_user:function(){return twttr.helpers.isCurrentUser(this.id)},can_view:function(){return twttr.helpers.canViewUser(this)},is_sponsored:function(){return !!this.promoted_content},translation_tool_path:function(){if(twttr.decider.isAvailable("i18n_new_translation_center")){return"http://translate.twttr.com"}else{return this.translate_path()}},account_impression_id:function(){var promotedContent=this.promoted_content;return promotedContent?Mustache.to_html("data-impression-id='{{id}}' ",{id:promotedContent.impression_id}):""},feedback_token:function(){return this.feedback?Mustache.to_html("data-feedback-token='{{feedback}}' ",{feedback:this.feedback}):""},mini_profile_image_url:function(){return twttr.helpers.transformProfileImageUrl(this.profile_image_url,"mini")}});twttr.view("twttr.views.StreamTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.SlideshowTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.SimpleTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.PermalinkTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.LatestTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.DetailsPaneTweet",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.TweetActions",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.TweetDogear",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.InReplyTo",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet);twttr.view("twttr.views.LatestFavorite",function(){twttr.views.BaseTweet.apply(this,arguments)}).subclassOf(twttr.views.BaseTweet).statics({TRUNCATE_LENGTH:70}).methods({truncated_text:function(){return twttr.helpers.truncate(this.text,this.constructor.TRUNCATE_LENGTH)}});twttr.view("twttr.views.HiddenStreamItems",function(){twttr.views.Base.apply(this,arguments);this.items=[]}).superclass(twttr.views.Base).methods({hidden_id:function(){return this.items[0].id},items_count:function(){return this.items.length},addItem:function(item){this.items.push(item)},_itemUsers:function(){var itemUsers=[];var itemUserMap={};twttr.each(this.items,function(ea){itemUserMap[ea.user.attributes.screen_name]=ea.user});for(var name in itemUserMap){itemUsers.push(itemUserMap[name])}return itemUsers},_showUsers:3,users:function(){var itemUsers=this._itemUsers();var lastShown=itemUsers.length===this._showUsers?this._showUsers:this._showUsers-1;itemUsers=itemUsers.slice(0,lastShown);return twttr.map(itemUsers,function(ea){return new twttr.views.UserLink(ea.attributes)})},more_users:function(){return this._itemUsers().length>this._showUsers},more_users_count:function(){return this._itemUsers().length-this._showUsers+1},first_screen_name:function(){return this.items[0].user.attributes.screen_name}});twttr.view("twttr.views.TweetPane",function(){twttr.views.Base.apply(this,arguments)}).subclassOf(twttr.views.Base).methods({pane_header_text:function(){return _("tweet from @{{screen_name}}",{screen_name:this.tweet.user.screen_name})}});twttr.view("twttr.views.BaseStats",function(obj){twttr.views.BaseUser.apply(this,arguments);if(obj.status){this.status=new twttr.views.BaseTweet(obj.status);this.status.user=this}}).subclassOf(twttr.views.BaseUser).methods({statuses_count_commaized:function(){return twttr.util.formatNumber(this.statuses_count,twttr.pageLocale)},following_nobody:function(argument){return this.friends_count==0},friends_count_commaized:function(){if(this.screen_name==="toptweets"){return _("everyone!")}return twttr.util.formatNumber(this.friends_count,twttr.pageLocale)},followers_count_commaized:function(){return twttr.util.formatNumber(this.followers_count,twttr.pageLocale)},favorites_count_commaized:function(){if(this.favourites_count&&parseInt(this.favourites_count,10)>0){return twttr.util.formatNumber(this.favourites_count,twttr.pageLocale)}else{return 0}},listed_count_commaized:function(){if(this.listed_count&&parseInt(this.listed_count,10)>0){return twttr.util.formatNumber(this.listed_count,twttr.pageLocale)}else{return 0}},can_view:function(){return twttr.helpers.canViewUser(this)}});twttr.view("twttr.views.ProfilePane",function(){twttr.views.BaseStats.apply(this,arguments)}).subclassOf(twttr.views.BaseStats).methods({source_tweet_impression_id:function(){var impressionId=this.impression_id;return impressionId?Mustache.to_html("data-impression-id='{{id}}' ",{id:impressionId}):""},pane_header_text:function(){return _("profile summary for @{{screen_name}}",{screen_name:this.screen_name})},right_image_size:function(){return twttr.helpers.transformProfileImageUrl(this.profile_image_url,"bigger")}});twttr.view("twttr.views.MessageThread",function(items){twttr.views.Base.apply(this,arguments);this.items=[];for(var i=0;i<items.length;i++){this.items.push(new twttr.views.Message(items[i]))}}).subclassOf(twttr.views.Base);twttr.view("twttr.views.ProfileActions").methods({is_current_user:function(){return twttr.helpers.isCurrentUser(this.user)},can_view:function(){return twttr.helpers.canViewUser(this.user)},show_list_options:function(){return twttr.loggedIn&&(this.following||!this.user["protected"])},show_sms_prompt:function(){return twttr.pageLocale!="ja"},show_device_notifications:function(){return !this.is_current_user()&&this.following&&(twttr.currentUser.lang!="ja"||twttr.decider.isAvailable("email_device_settings"))},notifications_on_for_user:function(){return twttr.currentUser.deviceSetup&&this.notifications},is_admin:function(){return twttr.is.def(twttr.isAdmin)},sms_follow_text:function(){return _("Text {{{command}}} to {{{number}}} in {{{country}}}",{command:"<strong>"+_("follow {{screen_name}}",this)+"</strong>",number:"<strong>"+_("40404")+"</strong>",country:'<a href="#" class="sms-codes-link">'+_("the United States")+"</a>"})}});twttr.view("twttr.views.MessageThreadPreview").methods({last_was_yours:function(){return twttr.helpers.isCurrentUser(this.last_message().sender)},message_count:function(){return this.messages.length},last_message:function(){if(this._last_message){return this._last_message}return this._last_message=new twttr.views.Message(this.messages[0])},other_person:function(){return new twttr.views.User(this.last_was_yours()?this.last_message().recipient:this.last_message().sender)}});twttr.view("twttr.views.Message",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI).methods({linkified_text:function(){var linkified=twttr.util.linkify(this.text,{nofollow:true});linkified=twttr.util.linkifyEntities(linkified,this);return linkified},timestamp:function(){return twttr.helpers.timeAgo(this.actual_timestamp(),true,true)},actual_timestamp:function(){return twttr.helpers.parseDateString(this.created_at)}});twttr.view("twttr.views.DashboardProfileStats",function(user,title){twttr.views.BaseStats.apply(this,[user]);this.profileStatsTitle=title}).subclassOf(twttr.views.BaseStats).methods({profile_stats_title:function(){return this.profileStatsTitle||_("About @{{screen_name}}",{screen_name:this.obj.screenName})},translator_profile_path:function(){if(twttr.decider.isAvailable("i18n_new_translation_center")){return this.translation_tool_path()+"/user/"+this.screen_name}else{return this.translation_tool_path()}}});twttr.view("twttr.views.UserStats",function(){twttr.views.BaseStats.apply(this,arguments)}).subclassOf(twttr.views.BaseStats);twttr.view("twttr.views.DashboardGettingStarted",function(noobLevel){this.noobLevel=noobLevel;twttr.views.BaseStats.apply(this,arguments)}).subclassOf(twttr.views.BaseStats).methods({noob_level:function(){return this.noobLevel},is_noob_level_0:function(){return this.noobLevel==twttr.constants.noob.total},is_noob_level_1_2_3:function(){return this.noobLevel>twttr.constants.noob.total&&this.noobLevel<twttr.constants.noob.talking},is_noob_level_4:function(){return this.noobLevel==twttr.constants.noob.talking},is_noob_level_5_6_7:function(){return this.noobLevel>twttr.constants.noob.talking},title:function(){return this.noobLevel?_("What's next?"):_("Get started on Twitter")}});twttr.view("twttr.views.DashboardYourProfile",function(){twttr.views.BaseStats.apply(this,arguments)}).subclassOf(twttr.views.BaseStats).methods({afterRender:function($dom){if(twttr.isNarrow){setTimeout(function(){twttr.helpers.ellipsify($dom.find("div.latest-tweet .tweet-row"))},0)}}});twttr.view("twttr.views.RecentProfileActivity",function(user,subcomponents,noobLevel){twttr.views.BaseStats.apply(this,[user]);this.subcomponents=subcomponents;this.noobLevel=noobLevel}).subclassOf(twttr.views.BaseStats).methods({show_following:function(){return this.subcomponents.following||this.subcomponents.following15},show_following_15_narrow:function(){return this.subcomponents.following15&&twttr.isNarrow},show_followers:function(){return this.subcomponents.followers},show_favorite:function(){return this.subcomponents.favorite},show_lists:function(){return this.subcomponents.lists},show_wtf_links:function(){return this.subcomponents.wtfLinks},positive_nooblevel:function(){return this.noobLevel>=0}});twttr.view("twttr.views.TrendItem",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI).methods({is_sponsored:function(){return !!this.promoted_content},trend_search_path:function(){return twttr.router.searchResultsPath({query:this.name})}});twttr.view("twttr.views.LocalTrendLocation",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI);twttr.view("twttr.views.LocalTrendLocationNew",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI);twttr.view("twttr.views.FollowList").methods({follow_list:function(){return(new twttr.views.UserThumbList(this.users)).html()}});twttr.view("twttr.views.LocalTrends",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({_sortPlaces:function(places){return places.sort(function(a,b){if(a.name<b.name){return -1}else{if(a.name>b.name){return 1}else{return 0}}})},country_locations:function(){var locations=[];var worldwide;for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.placeType.code!==twttr.constants.placeTypes.city){if(item.placeType.code==19){worldwide=item;continue}locations.push(item)}}locations=this._sortPlaces(locations);if(worldwide){locations.unshift(worldwide)}return locations},city_locations:function(){var locations=[];for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.placeType.code===twttr.constants.placeTypes.city){locations.push(item)}}locations=this._sortPlaces(locations);return locations}});twttr.view("twttr.views.LocalTrendsNew",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({_sortPlaces:function(places){return places.sort(function(a,b){if(a.name<b.name){return -1}else{if(a.name>b.name){return 1}else{return 0}}})},breadcrumb_locations:function(){return twttr.trendLocations.withFilterAncestors().reverse()},first_breadcrumb_locations:function(){var locs=this.breadcrumb_locations();return locs.slice(0,locs.length-1)},last_breadcrumb_location:function(){var locs=this.breadcrumb_locations();return locs[locs.length-1]},locations:function(){return this._sortPlaces(twttr.trendLocations.currentChildren())},locationsFor:function(column){var all=this.locations();var columnLength=Math.ceil(all.length/3);return all.slice(column*columnLength,(column+1)*columnLength)},locations0:function(){return this.locationsFor(0)},locations1:function(){return this.locationsFor(1)},locations2:function(){return this.locationsFor(2)}});twttr.view("twttr.views.Dialog",function(options){this.options=options;var template=this.options.template||this.options;twttr.views.Base.call(this,template)});twttr.view("twttr.views.TweetDialog",function(options){this.options=options;this.options.fixed=true;twttr.views.Dialog.call(this,options)}).subclassOf(twttr.views.Dialog).template(twttr.templates.dialog).methods(twttr.EventProvider).methods({afterRender:function($dom){var options={container_id:"tweetbox",condensed:false,closeAfterSuccess:false,template:{button_text:this.options.tweetButton||_("Tweet"),show_geo:this.options.template.show_geo},statusAction:this.options.statusAction||"update",data:this.options.data,defaultContent:this.options.defaultContent||"",height:56,width:452,origin:this.options.origin};this.tweetBox=new twttr.TweetBox($dom.find(".twttr-dialog-content"),options);this.tweetBox.bind("ready",twttr.bind(this,function(){this.trigger("ready")}))}});twttr.view("twttr.views.ReplyDialog",function(options){this.options=options;this.options.statusAction="reply";twttr.views.TweetDialog.call(this,this.options)}).subclassOf(twttr.views.TweetDialog).template(twttr.templates.dialog).methods({afterRender:function($dom){twttr.views.TweetDialog.prototype.afterRender.call(this,$dom);twttr.API.Status.find(this.options.data.tweetId,twttr.bind(this,function(tweet){var footer=new twttr.views.ReplyDialogFooter({screen_name:h(this.options.data.screenName),text:twttr.util.linkifyEntities(twttr.util.linkify(tweet.text,{nofollow:true}),tweet),profile_image_url:tweet.user.profileImageUrl});footer.render($dom.find(".twttr-dialog-footer"),"append")}))}});twttr.view("twttr.views.DirectMessageDialog",function(options){this.options=options;this.options.statusAction="directMessage";this.options.tweetButton=_("Send");twttr.views.TweetDialog.call(this,this.options)}).subclassOf(twttr.views.TweetDialog).template(twttr.templates.dialog);twttr.view("twttr.views.KeyboardShortCuts").subclassOf(twttr.views.Dialog).template(twttr.templates.dialog);twttr.view("twttr.views.MessageDrawer").statics({isOpen:false,close:function(){twttr.views.MessageDrawer.isOpen=false;$("#message-drawer .message").remove()}});twttr.view("twttr.views.MessageNotification").statics({isOpen:false,close:function(){twttr.views.MessageNotification.isOpen=false;$("#message-notification .notification").remove()}});twttr.view("twttr.views.UserCss",function(){twttr.views.BaseAPI.apply(this,arguments);var troublesomeProperties=["profile_background_color","profile_text_color","profile_link_color","profile_sidebar_fill_color"];for(var i=0;i<troublesomeProperties.length;i++){this[troublesomeProperties[i]]=twttr.helpers.sanitizeCssColor(this[troublesomeProperties[i]])}}).subclassOf(twttr.views.BaseAPI).methods({rgba_sidebar_color:function(){if(!this.profile_sidebar_fill_color){return }return twttr.helpers.hexToRGBA(this.profile_sidebar_fill_color,"0.9")},rgba_tweet_background_color:function(){if(!this.profile_link_color){return }return twttr.helpers.hexToRGBA(this.profile_link_color,"0.1")},rgba_tweet_border_color:function(){if(!this.profile_link_color){return }return twttr.helpers.hexToRGBA(this.profile_link_color,"0.15")},rgba_newtweets_background_color:function(){if(!this.profile_link_color){return }return twttr.helpers.hexToRGBA(this.profile_link_color,"0.2")},rgba_newtweets_border_color:function(){if(!this.profile_link_color){return }return twttr.helpers.hexToRGBA(this.profile_link_color,"0.25")},rgba_text_color:function(){if(!this.profile_text_color){return }return twttr.helpers.hexToRGBA(this.profile_text_color,"0.6")}});twttr.view("twttr.views.BgImgCss",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI);twttr.view("twttr.views.UserThumbList",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.BaseUser});twttr.view("twttr.views.UserSmallListItem",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.UserThumbListItem",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.UserSmallList",function(users){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.UserSmallListItem});twttr.view("twttr.views.UserDetailedListItem",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.UserDetailedList",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.UserDetailedListItem});twttr.view("twttr.views.UserStaticListItem",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.UserStaticList",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.UserStaticListItem});twttr.view("twttr.views.UserItemAction",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.RecentlyViewed",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.BaseUser});twttr.view("twttr.views.ContactImportMatchesStats",function(){twttr.views.Base.apply(this,arguments)}).subclassOf(twttr.views.Base).methods({found_contacts_text:function(){if(this.count==1){return _("Found <strong>1 contact</strong> from {{service_name}}",this)}else{return _("Found <strong>{{count}} contacts</strong> from {{service_name}}",this)}},follow_all_text:function(){if(this.count==1){return _("Follow all")}else{return _("Follow all {{count}}",this)}}});twttr.view("twttr.views.InviteContacts",function(){twttr.views.Base.apply(this,arguments)}).subclassOf(twttr.views.Base).methods({select_all_text:function(){if(this.contacts.length==1){return _("Select all")}else{return _("Select all {{count}}",{count:this.contacts.length})}},preview_link_html:function(){return _("<a {{{link_attributes}}}>See what you'll send them</a>.",{link_attributes:Mustache.to_html('href="{{path}}" class="popup" name="invitation_email_preview" data-popup="height=450,width=670"',{path:twttr.router.invitationEmailPreviewPath()})})},truncate:function(){return function(template,render){var charCount=28,str=render(template);return twttr.helpers.truncate(str,charCount)}}});twttr.view("twttr.views.Welcome").methods({warm_signup:function(){return twttr.decider.isAvailable("welcome_warm_signup")&&(twttr.currentUser.friendsCount>0)}});twttr.view("twttr.views.WelcomeAmbassador",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.FrontRadialItem").methods({secure_profile_image_url:function(){return twttr.assets.getPathFromAbsoluteURL(this.profile_image_url,{isSSL:true,isVersioned:false})}});twttr.view("twttr.views.RecentTweets",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.SimpleTweet,screen_name:function(){return this.items[0].user.screen_name}});twttr.view("twttr.views.Conversation",function(resultGroup,tweet,ancestors){twttr.views.BaseAPI.apply(this,arguments);this.tweet=tweet;this.ancestors=ancestors||[]}).subclassOf(twttr.views.BaseAPI).methods({_viewFor:function(tweet){return new twttr.views.StreamTweet(tweet)},_viewsFor:function(tweets){var that=this;return twttr.map(tweets,function(tweet){return that._viewFor(tweet)})},all_but_last_ancestor_tweet_views:function(){return this._viewsFor(this.ancestors.slice(0,this.ancestors.length-1))},last_ancestor_tweet_view:function(){var lastAncestor=this.ancestors[this.ancestors.length-1];return lastAncestor?this._viewFor(lastAncestor):null},has_earlier:function(){return this.ancestors.length>0},tweet_view:function(){return this._viewFor(this.tweet)}});twttr.view("twttr.views.Replies",function(resultGroup,descendants,forks){twttr.views.BaseAPI.apply(this,arguments);this.descendants=descendants||[];this.forks=forks||[]}).subclassOf(twttr.views.BaseAPI).methods({_viewFor:function(tweet){return new twttr.views.StreamTweet(tweet)},_viewsFor:function(tweets){var that=this;return twttr.map(tweets,function(tweet){return that._viewFor(tweet)})},has_tweets:function(){return this.descendants.length>0||this.forks.length>0},descendant_tweet_views:function(){return this._viewsFor(this.descendants)},fork_tweet_views:function(){return this._viewsFor(this.forks)}});twttr.view("twttr.views.StreamUser",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.StreamFollowerRequest",function(){this.constructor.uber.constructor.apply(this,arguments)}).subclassOf(twttr.views.StreamUser);twttr.view("twttr.views.ProfileUser",function(){twttr.views.BaseUser.apply(this,arguments)}).subclassOf(twttr.views.BaseUser);twttr.view("twttr.views.List",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI).methods({is_public:function(){return(this.mode==="public")||(this.mode===undefined)},is_own_list:function(){return twttr.helpers.isCurrentUser(this.user)},user_list_path:function(){return twttr.router.userListPath({screen_name:this.user.screen_name,list_slug:this.slug})},list_subscribers_path:function(){return twttr.router.listSubscribersPath({screen_name:this.user.screen_name,list_slug:this.slug})},list_members_path:function(){return twttr.router.listMembersPath({screen_name:this.user.screen_name,list_slug:this.slug})}});twttr.view("twttr.views.NewestListMembers").subclassOf(twttr.views.List);twttr.view("twttr.views.StreamList").subclassOf(twttr.views.List);twttr.view("twttr.views.ListStreamTitle").subclassOf(twttr.views.List);twttr.view("twttr.views.RecentList").subclassOf(twttr.views.List);twttr.view("twttr.views.ListActions").subclassOf(twttr.views.List);twttr.view("twttr.views.ListHeader").subclassOf(twttr.views.List);twttr.view("twttr.views.RecentLists",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.RecentList,list_names:function(){var that=this;var html=twttr.util.arrayMap(this.items,function(item,i,ar){if(!that.items[i+1]){return item.html()}else{return item.html().replace(/<\/a>/,"</a>,")}}).join(" ");return html}});twttr.view("twttr.views.ListOfLists",function(){twttr.views.BaseAPIList.apply(this,arguments)}).subclassOf(twttr.views.BaseAPIList).methods({ItemView:twttr.views.List});twttr.view("twttr.views.ListDialog").subclassOf(twttr.views.List);twttr.view("twttr.views.WebSearchResults").methods({more_results_url:function(){return"http://www.bing.com/search?q="+encodeURIComponent(this.query)}});twttr.view("twttr.views.DetailsPane").methods({closable:true,back_label:function(){return this._backLabel},popable:function(){return this._viewstack&&this._viewstack.size()>1},hide:function(){this.$dom.addClass("inactive").removeClass("active");this.$dom=this.$dom.detach()},show:function(){$(this.selector)[this.operation](this.$dom);this.$dom.addClass("active").removeClass("inactive")}});twttr.view("twttr.views.Retweeters",function(data){twttr.views.Base.apply(this,arguments);this.count=data.count;this.retweeters=data.retweeters.map(function(user){return new twttr.views.BaseUser(user)}).array}).methods({retweeted_by_count:function(){var retweeter=this.tweet.retweetingStatus?new twttr.views.BaseUser(this.tweet.retweetingStatus.user):this.retweeters[0];var user_link=Mustache.to_html('<a class="user-profile-link" data-user-id="{{id}}" href="{{path}}" >{{screen_name}}</a>',{id:retweeter.id,path:twttr.router.profilePath({screen_name:retweeter.screen_name}),screen_name:retweeter.screen_name});if(this.count===1){return _("Retweeted by {{{user_link}}}",{user_link:user_link})}else{if(this.count===2){return _("Retweeted by {{{user_link}}} and 1 other",{user_link:user_link})}else{if(this.count){return _("Retweeted by {{{user_link}}} and {{count}} others",{user_link:user_link,count:this.count})}}}return _("Retweeted by {{{user_link}}} and others",{user_link:user_link})}});twttr.view("twttr.views.ProfilePage").methods({has_pending_requests:function(){return twttr.helpers.isCurrentUser(twttr.profileUser)&&twttr.currentUser["protected"]}});twttr.view("twttr.views.StreamSuggestionCategory",function(){twttr.views.BaseAPI.apply(this,arguments)}).subclassOf(twttr.views.BaseAPI).methods({user_sample:function(){return(this.obj.sample&&this.obj.sample.length?new twttr.views.UserStaticList(this.obj.sample.slice(0,2)):false)},category_name:function(){return this.obj.localeType?_(this.obj.name):this.obj.name}});(function(){twttr.router=new twttr.Router();var route=twttr.bind(twttr.router,twttr.router.route),staticRoute=twttr.bind(twttr.router,twttr.router.staticRoute),redirectRoute=twttr.bind(twttr.router,twttr.router.redirectRoute);twttr.router.bind("routeAdded",function(e,name,fn){twttr.views.Base.method(twttr.util.underscore(name),function(){return fn(this)})});oldTwitterRoute("about","/about");oldTwitterRoute("jobs","/jobs");oldTwitterRoute("tos","/tos");oldTwitterRoute("privacy","/privacy");oldTwitterRoute("settings","/settings/account");oldTwitterRoute("settingsProfile","/settings/profile");oldTwitterRoute("devices","/devices");oldTwitterRoute("invitationEmailPreview","/invitations/email_preview");oldTwitterRoute("campaigns","/account/campaigns");oldTwitterRoute("resources","/about/resources");oldTwitterRoute("translate","/translate");oldTwitterRoute("whatsNew","/newtwitter");oldTwitterRoute("changeLocale","/sessions/change_locale");oldTwitterRoute("resendPassword","/account/resend_password");oldTwitterRoute("mobileComplete","/account/complete");oldTwitterRoute("turnPhxOff","/account/use_phx?setting=false&format=html");sslRelativeRoute("sessions","/sessions?phx=1");sslRelativeRoute("signup","/signup");route("login","/#!/login",page("login").action("index"));route("loginRedirect","/#!/login/redirect/:redirect_after_login",page("login").action("index"));route("loginError","/#!/login/:error",page("login").action("error"));route("logout","/#!/logout",page("logout").action("index"));oldTwitterRoute("logout_action","/logout");staticRoute("support","http://support.twitter.com");staticRoute("blog",twttr.localize({ja:"http://blog.twitter.jp",es:"http://blog.es.twitter.com",fr:"http://blog.fr.twitter.com"},"http://blog.twitter.com"));staticRoute("status",twttr.localize({ja:"http://status.twitter.jp"},"http://status.twitter.com"));staticRoute("developers","//dev.twitter.com");staticRoute("businesses","//business.twitter.com/");staticRoute("advertisers","//business.twitter.com/advertise/start");staticRoute("partnerships","http://media.twitter.com");staticRoute("helpPromotedTweets","http://support.twitter.com/articles/142101");staticRoute("spamLearnMore","http://support.twitter.com/articles/64986-how-to-report-spam-on-twitter");staticRoute("malwareLearnMore","http://support.twitter.com/articles/90491-my-website-is-being-flagged-as-malware-or-spam");staticRoute("savedSearchesHelp","http://support.twitter.com/articles/96646-how-to-save-searches");staticRoute("listsHelp","http://support.twitter.com/articles/76460-how-to-use-twitter-lists");staticRoute("emailHelp","http://support.twitter.com/articles/82050-i-m-having-trouble-confirming-my-email");staticRoute("changeEmail","https://twitter.com/settings/account?change_email=true");staticRoute("suspendedHelp","http://support.twitter.com/groups/32-something-s-not-working/topics/116-account-settings-problems/articles/15790-how-to-contest-account-suspension");staticRoute("mobile","http://mobile.twitter.com");staticRoute("mobileHelp","http://support.twitter.com/groups/34-mobile");staticRoute("mobileHelpFaq","http://support.twitter.com/groups/34-mobile/topics/123-getting-started/articles/14014-twitter-phone-faqs");staticRoute("shortCodeHelp","http://support.twitter.com/articles/14226-how-to-find-your-twitter-short-code");staticRoute("smsHelp","http://support.twitter.com/articles/14020-about-twitter-sms-commands");staticRoute("helpDiscovery","http://support.twitter.com/articles/106925-how-to-find-people-and-be-found");staticRoute("analytics","//analytics.twitter.com/");route("index","/#!/",loginHelper({loggedIn:page("home").action("home"),loggedOut:page("front").action("index")}));route("home","/#!/",loginHelper({loggedIn:page("home").action("home"),loggedOut:page("front").action("index")}));route("mentions","/#!/mentions",page("home").action("mentions"));route("replies","/#!/replies",page("home").action("mentions"));route("retweets","/#!/retweets",page("home").action("retweetsByYou"));route("retweetsByOthers","/#!/retweets_by_others",page("home").action("retweetsByOthers"));route("retweetsOfMine","/#!/retweeted_of_mine",page("home").action("retweetsOfYourTweets"));route("listInHome","/#!/list/:screen_name/:list_slug",page("home").action("listInHome"));route("savedSearch","/#!/saved-search/:query",page("home").action("savedSearch"));route("rateLimit","/#!/twttr/rate_limit",page("rateLimit").action("tooMuch"));route("searchHome","/#!/search-home",page("searchHome").action("index"));route("searchAdvanced","/#!/search-advanced",page("searchHome").action("advanced"));route("searchRealtime","/#!/search/realtime/:query",page("search").action("realtime"));route("searchResults","/#!/search/:query",page("search").action("search"));route("formSearchResults","/#!/search",page("search").action("search"));route("searchLinks","/#!/search/links/:query",page("search").action("links"));route("formSearchLinks","/#!/search/links",page("search").action("links"));route("placeTweetSearch","/#!/search/place_tweets/:place_id/:place_name",page("search").action("placeTweetSearch"));route("userSearch","/#!/search/users/:query",page("search").action("people"));route("userSearchForm","/#!/search/users/",page("search").action("people"));route("searchFacetsGrid","/#!/search/:query/grid/:mode",page("mediaGallery").action("grid"));route("searchFacetsSlideshow","/#!/search/:query/slideshow/:mode",page("mediaGallery").action("slideshow"));route("searchFacetsGridDefault","/#!/search/:query/grid",page("mediaGallery").action("grid"));route("searchFacetsSlideshowDefault","/#!/search/:query/slideshow",page("mediaGallery").action("slideshow"));route("place","/#!/places/:place_id",page("place").action("tweets"));route("placeLinks","/#!/places/:place_id/links",page("place").action("links"));route("placeUsers","/#!/places/:place_id/users",page("placeUsers").action("all"));route("placeUsersFollowing","/#!/places/:place_id/users/following",page("placeUsers").action("following"));route("messages","/#!/messages",page("messages").action("messages"));route("inbox","/#!/inbox",page("messages").action("messages"));route("sent","/#!/sent",page("messages").action("messages"));route("createDm","/direct_messages/create/:screen_name",page("profile").action("message"));route("permalink","/#!/:screen_name/status/:id",page("permalink").action("permalink"));route("permalinkOld","/#!/:screen_name/statuses/:id",page("permalink").action("permalink"));route("photoPermalink","/#!/:screen_name/status/:id/photo/:photo_index",page("permalink").action("permalink"));route("whoToFollow","/#!/who_to_follow",loginHelper({loggedIn:page("who_to_follow").action("suggestions"),loggedOut:page("who_to_follow").action("interests")}));route("whoToFollowSearch","/#!/who_to_follow/search/:query",page("who_to_follow").action("search"));route("whoToFollowSearchForm","/#!/who_to_follow/search",page("who_to_follow").action("search"));route("whoToFollowInterests","/#!/who_to_follow/interests",page("who_to_follow").action("interests"));route("whoToFollowInterestsCategory","/#!/who_to_follow/interests/:category",page("who_to_follow").action("category"));route("whoToFollowSuggestions","/#!/who_to_follow/suggestions",page("who_to_follow").action("suggestions"));route("whoToFollowImport","/#!/who_to_follow/import",page("who_to_follow").action("import"));route("whoToFollowImportMatches","/#!/who_to_follow/matches",page("who_to_follow").action("matches"));route("welcome","/#!/welcome",page("welcome").action("starter"));route("welcomeSearch","/#!/welcome/search/:query",page("welcome").action("search"));route("welcomeSearchForm","/#!/welcome/search",page("welcome").action("search"));route("welcomeInterests","/#!/welcome/interests",page("welcome").action("interests"));route("welcomeInterestsCategory","/#!/welcome/interests/:category",page("welcome").action("category"));route("welcomeImport","/#!/welcome/import",page("welcome").action("import"));route("welcomeImportMatches","/#!/welcome/matches",page("welcome").action("matches"));route("welcomeStarter","/#!/welcome/starter",page("welcome").action("starter"));route("mobileGallery",(window.location.pathname=="/")?"/#!/download":"/download",page("mobile_gallery").action("gallery"));route("mobileApp",(window.location.pathname=="/")?"/#!/download/:app":"/download/:app",page("mobile_gallery").action("app"));if(twttr.decider.isAvailable("griffin")){route("griffin","/#!/thegrffn/:griffin_id",page("griffin").action("tweets"));route("griffinSocial","/#!/thegrffn/:griffin_id/social",page("griffin").action("social"));route("griffinTop","/#!/thegrffn/:griffin_id/top",page("griffin").action("top"));route("griffinHashtag","/#!/thegrffn/:griffin_id/hashtag",page("griffin").action("hashtag"))}route("followers","/#!/followers",page("profile").action("followers"));route("following","/#!/following",page("profile").action("following"));route("favorites","/#!/favorites",page("profile").action("favorites"));route("friends","/#!/friends",page("profile").action("following"));route("lists","/#!/lists",page("profile").action("lists"));route("youBothFollow","/#!/:screen_name/you_both_follow",page("profile").action("youBothFollow"));route("followersYouFollow","/#!/:screen_name/followers_you_follow",page("profile").action("followersYouFollow"));route("profile","/#!/:screen_name",page("profile").action("profile"));route("userFavorites","/#!/:screen_name/favorites",page("profile").action("favorites"));route("userFollowers","/#!/:screen_name/followers",page("profile").action("followers"));route("userFollowing","/#!/:screen_name/following",page("profile").action("following"));route("userLists","/#!/:screen_name/lists",page("profile").action("lists"));route("memberships","/#!/:screen_name/lists/memberships",page("profile").action("memberships"));route("subscriptions","/#!/:screen_name/lists/subscriptions",page("profile").action("subscriptions"));route("followerRequests","/#!/:screen_name/follower_requests",page("profile").action("followerRequests"));route("similarTo","/#!/similar_to/:screen_name",page("similar_to").action("index"));route("userList","/#!/:screen_name/:list_slug",page("list").action("list"));route("listMembers","/#!/:screen_name/:list_slug/members",page("list").action("members"));route("listSubscribers","/#!/:screen_name/:list_slug/subscribers",page("list").action("followers"));route("userListFull","/#!/:screen_name/lists/:list_slug",page("list").action("list"));route("topTweets","/#!/toptweets",$.noop);function page(pageName){var action;function f(params){var page=twttr.app.switchToPage(pageName);if(page&&action){page[action].apply(page,arguments)}}f.action=function(actionName){this.actionName=action=actionName;return f};f.pageName=pageName;return f}function hashbangRedirect(name,path,redirPath){route("hashbang"+twttr.util.capitalize(name),"/#!"+path,function(){twttr.themes.loadLoadingTheme();twttr.Router.performRedirect(redirPath||path)})}function oldTwitterRoute(name,path){hashbangRedirect(name,path);route(name,path,$.noop)}function sslRelativeRoute(name,path){var redirPath=(twttr.isLocalhost?"":"https://"+location.hostname)+path;hashbangRedirect(name,path,redirPath);staticRoute(name,redirPath)}function loginHelper(o){return twttr.loggedIn?o.loggedIn:o.loggedOut}}());twttr.klass("twttr.AuditTrail",function(){this.array=[]}).methods({MAX_LENGTH:20,add:function(item){this.array.unshift(item);if(this.array.length>this.MAX_LENGTH){this.array=this.array.slice(0,this.MAX_LENGTH)}},trail:function(){return this.array},currentPage:function(){return this.page(0)},currentAction:function(){return this.action(0)},currentPath:function(){return this.path(0)},page:function(index){var routes=this._routes();return routes[index]&&routes[index].page},action:function(index){var routes=this._routes();return routes[index]&&routes[index].action},path:function(index){var routes=this._routes();return routes[index]&&routes[index].path},_routes:function(){return twttr.filter(this.array,function(item,index){return item.type==="route"})}});twttr.audit=new twttr.AuditTrail();twttr.router.bind("routeFollowed",function(e,route,path){var page=route.fn.pageName;twttr.audit.add({action:route.fn.actionName,page:page,path:path,type:"route"});var $doc=$("#doc").removeClass();if(page){$doc.addClass("route-"+page.replace(/_/g,"-"))}});using(">payload",function(){if(twttr.payload.conditionalTemplates){$.each(twttr.payload.conditionalTemplates,function(k,v){twttr.templates[k]=v});twttr.views.makeDefaultViews(twttr.templates)}});twttr.views.makeDefaultViews(twttr.templates);(function(){var defaultOptions={view:"Control"};twttr.klass("twttr.control.Base",function(options){this.options=$.extend({},defaultOptions,options);this.itemView=twttr.views.DefaultDropdownItem;if(this.options.itemView){this.itemView=twttr.is.string(this.options.itemView)?twttr.views[this.options.itemView]:this.options.itemView}}).methods(twttr.EventProvider).methods({render:function(selector,action){var data=this.viewData();this.view=new twttr.views[this.options.view](data);this.$dropdown=this.view.$html();$(selector)[action](this.$dropdown)},viewData:function(){return this.options}});twttr.augString("twttr.helpers.control",function(ns,fn){var klass=twttr.klass("twttr.control."+ns,fn);klass.subclassOf(twttr.control.Base);return klass});(function(){var dropdownDefaultOptions={direction:"left",view:"Dropdown"};var dropdownCache=[];twttr.helpers.control("Dropdown",function(controller,options){dropdownCache.push(this);this.$controller=$(controller);var options=$.extend({},dropdownDefaultOptions,options);this.items=options.items||[];twttr.control.Dropdown.uber.constructor.call(this,options);this.registerEvents()}).statics({_registeredHtmlClick:false,caches:{},createCache:function(key){this.caches[key]={}},closeAll:function(){twttr.each(dropdownCache,function(dropdown){dropdown.close()})}}).methods({defaultDividerView:twttr.views.DefaultDropdownDivider,registerEvents:function(){this.$controller.bind("click",twttr.bind(this,function(e){this.toggle()}))},applyDirection:function(){this.$dropdown.css({left:this.options.direction=="left"?"0":"auto",right:this.options.direction=="right"?"0":"auto"})},flushItems:function(){this.$dropdown.empty();this.items=[]},setItemsFromCallback:function(){var that=this;that.flushItems();that.itemsCallback(function(items){that.addItems(items);that.registerItemHandlers()})},open:function(){this.constructor.closeAll();if(this.itemsCallback){this.setItemsFromCallback()}this.$controller.addClass("open").addClass("button-active");this.$dropdown.css({top:this.$container?this.$container.outerHeight():this.$controller.outerHeight(),visibility:"visible"});var handler=twttr.bind(this,function(e){if(this.$controller.get(0)!==e.target&&!$.contains(this.$controller.get(0),e.target)){$("#doc").unbind("click",handler);this.close()}});$("#doc").bind("click",handler)},close:function(){this.$controller.removeClass("open").removeClass("button-active");this.$dropdown.css("visibility","hidden")},toggle:function(){if(this.$controller.hasClass("open")){this.close()}else{this.open()}},addItem:function(item,operation){operation=operation||"appendTo";this.items.push(item);var $item=(this.getItemView(item).$html());$item[operation](this.$dropdown);return $item},addItems:function(items){var that=this;that.items=that.items.concat(items);var itemViews=twttr.map(that.items,function(item){return that.getItemView(item).html()});$(itemViews.join("")).appendTo(that.$dropdown)},itemsFrom:function(callback){this.itemsCallback=callback},registerItemHandlers:function(){var $items=this.$dropdown.children();for(var i=0;i<this.items.length;i++){var item=this.items[i];if(!item.handlers){continue}$.each(item.handlers,function(name,handler){var $node=$($items[i]);var args=[name];if(twttr.is.array(handler)){args=args.concat(handler)}else{args.push(handler)}$node.bind.apply($node,args)})}},render:function(selector,action,cacheOptions){if(action==="before"||action==="after"){this.$container=this.$controller.wrap('<div class="drop-down-container"/>').parent()}twttr.control.Base.prototype.render.apply(this,arguments);if(cacheOptions){if(!this.constructor.caches[cacheOptions.key]){this.constructor.caches[cacheOptions.key]={}}this.constructor.caches[cacheOptions.key][cacheOptions.id]=true}this.registerItemHandlers();this.applyDirection();return this},getItemView:function(item){return item.itemView?new twttr.views[item.itemView](item):item.divider?new this.defaultDividerView:new this.itemView(item)},viewData:function(){var that=this;var items=twttr.map(this.items,function(item,i){return that.getItemView(item).html()});return{items:items.join("")}}})}())}());twttr.klass("twttr.components.Page",function(){this.$node=$("<div/>");this._isOpen=false;this.initComponentEvents()}).statics({view:function(View){this.prototype._View=View;return this},containerCssClass:function(cssClass){this._containerCssClass=cssClass;return this},deciderKey:function(key){this._deciderKey=key;return this},isAvailable:function(){return !this._deciderKey||twttr.decider.isAvailable(this._deciderKey)}}).mixin(twttr.mixins.componentEvents).methods(twttr.EventProvider).methods({initializeProfiler:function(){this.profiler=new twttr.util.Profiler(this.constructor._namespace+"."+twttr.router.getCurrentRoute().name);if(twttr.util.Profiler.verboseProfiling){this.profiler.bind("complete",function(e,profiler){twttr.showMessage("Page load took "+twttr.util.addCommas(profiler.endTime-profiler.startTime)+" ms")})}},newTrendsComponent:function(options){if(twttr.decider.isAvailable("new_trends_location_selector")){return new twttr.components.NewTrends(options)}else{return new twttr.components.Trends(options)}},$find:function(){return this.$node.find.apply(this.$node,arguments)},keyevent:function(event,type){var key;if(event.keyCode===twttr.constants.keyCodes.esc){key="esc"}else{if(event.keyCode===twttr.constants.keyCodes.enter){key="return"}else{if(event.which===twttr.constants.which.period){key="period"}else{if(event.keyCode===twttr.constants.keyCodes.leftArrow){key="left"}else{if(event.keyCode===twttr.constants.keyCodes.rightArrow){key="right"}else{if(event.keyCode===twttr.constants.keyCodes.upArrow){key="up"}else{if(event.keyCode===twttr.constants.keyCodes.downArrow){key="down"}else{key=String.fromCharCode(event.which).toLowerCase()}}}}}}}if(this["_"+type]&&this["_"+type][key]&&(event.which<111||event.which>118)){if(!twttr.shortcuts.currentKey){return this["_"+type][key].call(this,event)}}},render:function(scopeExtension){this.beforeRender();var viewData=$.extend(this.viewData(),scopeExtension);this.$node.html(new this._View(viewData).html());this.afterRender();if(this._renderCallback){this._renderCallback();delete this._renderCallback}return this},onkeydown:function(event){this.keyevent(event,"keydown")},onkeypress:function(event){this.keyevent(event,"keypress")},onkeyup:function(event){this.keyevent(event,"keyup")},addDashboardComponent:function(component,index){var $dashboard=this.$node.find(".dashboard");if(index==null){$dashboard.append(component.$node)}else{$dashboard.children(":nth-child("+index+")").before(component.$node)}if(component.profiler){this.profiler.waitFor(component)}component.bind("notRendered",twttr.bind(this,function(data){this.componentNotRendered(component,data)}));component.trigger("addedToPage",[component])},addDashboardComponents:function(components){for(var i=0;i<components.length;i++){this.addDashboardComponent(components[i])}},componentNotRendered:function(component,data){},updatePageTitle:function(title){this._pageTitle=title;document.title=title},hasNewItems:function(count){if(count){$("#global-nav .active").addClass("new");document.title="("+count+") "+this._pageTitle}else{$("#global-nav .active").removeClass("new");document.title=this._pageTitle}},highlightGlobalNav:function(name){$("#global-nav li").removeClass("active");if(name){$("#global-nav-"+name).addClass("active")}}});twttr.klass.page=function(ns,init){return twttr.klass(ns,init).subclassOf(twttr.components.Page)};$.each(["beforeRender","afterRender","onFirstSwitch","viewData","onSwitchAway","onSwitchTo"],function(which,functionName){var upCased=functionName.charAt(0).toUpperCase()+functionName.slice(1),underscored="_"+functionName;twttr.components.Page["add"+upCased]=function(fn){var a=[],b=this.prototype[underscored];if(b){for(var i=0;i<b.length;i++){a.push(b[i])}}a.push(fn);this.prototype[underscored]=a;return this};twttr.components.Page.prototype[functionName]=function(){var that=this;var ret={};$.each(this[underscored]||[],function(which,fn){twttr.aug(ret,fn.call(that))});return ret}});twttr.components.Page.addOnSwitchTo(function(){this.initializeProfiler();if(this.constructor._containerCssClass){$("#page-container").addClass(this.constructor._containerCssClass)}}).addOnSwitchAway(function(){if(this.constructor._containerCssClass){$("#page-container").removeClass(this.constructor._containerCssClass)}$(".tipsy").remove()}).addBeforeRender(function(){$(".tipsy").remove()}).addAfterRender(function(){$(".tipsy").remove()}).addBeforeRender(function(){twttr.isRendering=twttr.is.def(twttr.isRendering)?(twttr.isRendering+1):1}).addAfterRender(function(){twttr.isRendering=twttr.is.def(twttr.isRendering)?(twttr.isRendering-1):0}).mixin(twttr.mixins.listActionable,twttr.mixins.userActionable);twttr.provide("twttr.dialogs");twttr.dialogs.defaultOptions={modal:false,draggable:false,css:{width:500,height:"auto"},fixed:true,template:{container_id:null,title:null,footer:null,content:null}};twttr.klass("twttr.widget.Dialog",function(options){this.options=twttr.merge({},twttr.dialogs.defaultOptions,options||{},true);this._isOpen=false;this.view=new twttr.views[this.options.view||this.constructor._name](this.options);this.$container=this.view.render(this.options.node||"body","append");this.$dialog=this.$container.find(".twttr-dialog");this.$title=this.$container.find(".twttr-dialog-header h3");this.$dialog.css(this.options.css);if(twttr.is.nil(this.options.template.footer)){this.$container.find(".twttr-dialog-footer").hide()}if(this.options.draggable){this.applyDraggability()}if(this.options.modal){this.$container.addClass("twttr-dialog-container-modal")}this._escKeyHandler=twttr.bind(this,function(e){if(e.keyCode===twttr.constants.keyCodes.esc){$(window).unbind("keydown",this._escKeyHandler);this.close();e.stopPropagation()}});this.registerEvents()}).statics(twttr.EventProvider).statics({currentModal:false,close:function(){if(this.currentModal){this.currentModal.close()}}}).methods(twttr.EventProvider).methods({$find:function(selector){return this.$container.find(selector)},registerEvents:function(){var that=this;this.$find("textarea, input[type=text],input[type=password]").bind("keydown keypress keyup",twttr.bind(this,function(e){if(!twttr.components.Autocomplete._isCompletionsOpen){e.stopPropagation();if(e.type==="keydown"&&e.keyCode===twttr.constants.keyCodes.esc){this.destroy()}}}));this.$container.find(".twttr-dialog-close").bind("click",function(e){e.preventDefault();e.stopPropagation();if(that.options.destroyOnCloseBox){that.destroy()}else{that.close()}});twttr.router.bind("urlChanged",function(e,route){that.close()})},applyDraggability:function(){this.$dialog.addClass("draggable");this.$dialog.draggable({handle:this.$dialog.find(".twttr-dialog-header")})},toggle:function(){if(this._isOpen){this.close()}else{this.open()}return this},open:function(){if(twttr.widget.Dialog.currentModal){return this}if(this.options.modal){twttr.widget.Dialog.currentModal=this;this.$container.height($(document).height())}this.position();this.$container.css("visibility","visible");this.trigger("open");twttr.widget.Dialog.trigger("open");this._isOpen=true;$(window).bind("keydown",this._escKeyHandler);return this},close:function(){if(this.options.modal){twttr.widget.Dialog.currentModal=false;this.$container.height("100%")}if(document.activeElement&&$.contains(this.$container.get(0),document.activeElement)){$(document.activeElement).blur()}this.$container.css("visibility","hidden");this.trigger("close");twttr.widget.Dialog.trigger("close");this._isOpen=false;$(window).unbind("keydown",this._escKeyHandler);return this},show:function(){return this.open()},hide:function(){return this.close()},setFooterText:function(text){this.$find(".twttr-dialog-footer").html(text)},position:function(){if(!this.options.fixed){this.$dialog.addClass("static")}var scrollTop=$(window).scrollTop(),innerHeight=this.$dialog.innerHeight(),winHeight=$(window).height(),top=Math.round((winHeight/2)-(innerHeight/2));if(!this.options.fixed){top+=scrollTop}var innerWidth=this.$dialog.innerWidth(),winWidth=$(window).width(),left=Math.round((winWidth/2)-(innerWidth/2));top=(this.options.positioning&&this.options.positioning.top)?this.options.positioning.top:top;left=(this.options.positioning&&this.options.positioning.left)?this.options.positioning.left:left;this.$dialog.css({left:left,top:top});return this},destroy:function(){this.close();this.remove();return this},remove:function(){this.$container.unbind();this.$container.remove();this._isOpen=false;return this},isOpen:function(){return this._isOpen}});twttr.aug(twttr.dialogs,{reply:function(data){var dataFields=twttr.TweetBox._getDefaultContentForReply(data.$tweet,data.screenName,twttr.currentUserScreenName);var options={multiple:dataFields.multiple,modal:false,draggable:true,defaultContent:dataFields.defaultContent,template:{title:_("Reply to @<strong>{{screen_name}}</strong>",{screen_name:data.screenName}),footer:""},data:data,origin:data.origin};return new twttr.widget.ReplyDialog(options)},directMessage:function(data){var avatarSrc=twttr.assets.path("sticky/default_profile_images/default_profile_6_mini.png",{isVersioned:false});var options={modal:false,draggable:true,basic:false,template:{title:_("Message")+' <img class="avatar" src="'+avatarSrc+'"/> <input class="twttr-directmessage-input" type="text"/> <span class="twttr-dm-check"/>',footer:_("tip: you can send a message to anyone who follows you")},origin:data.origin};return new twttr.widget.DirectMessageDialog(options)},dmSingle:function(options){twttr.merge(options,{draggable:true,basic:false,template:{title:'<img src="'+options.user.profile_image_url+'"/> '+_("<strong>Send <b>{{user_name}}</b> a message</strong>",{user_name:options.user.name})}});return new twttr.widget.DirectMessageDialogSingle(options)},keyboardShortcuts:function(){twttr.dialogs._keyboardShortcuts=twttr.dialogs._keyboardShortcuts||new twttr.widget.Dialog({css:{width:550},modal:true,draggable:false,template:{title:_("Keyboard shortcuts"),content:(new twttr.views.KeyboardShortcuts()).html()}});return twttr.dialogs._keyboardShortcuts},firstTime:function(options){var dialog=new twttr.widget.Dialog(twttr.merge({view:"FirstTimeDialog",modal:true,draggable:false,css:{width:530}},options));dialog.$container.find(".button.ok-thanks").bind("click",function(e){e.preventDefault();e.stopPropagation();dialog.destroy()});return dialog},broughtBack:function(){return new twttr.widget.BroughtBackDialog({css:{width:480}})},discoverable:function(){var u=twttr.currentUser,opts={help_url:twttr.router.helpDiscoveryPath(),email_checked:(!u.emailDiscoverabilitySet||u.discoverableByEmail),phone_checked:(!u.mobilePhoneDiscoverabilitySet||u.discoverableByMobilePhone)};return new twttr.widget.DiscoveryDialog(twttr.merge(opts,u.attributes))},verifyEmail:function(bucket){return new twttr.widget.VerifyEmailDialog(bucket,twttr.currentUser)},retweet:function(tweetId,text,callback){var options={modal:true,draggable:true,callback:callback,template:{title:_("Retweet this to your followers?"),footer:"",content:(new twttr.views.Prompt({ok:_("Retweet"),cancel:_("Cancel")})).html()},data:{tweetId:tweetId},tweetText:text,css:{width:500}};return new twttr.widget.RetweetDialog(options)},deleteMessage:function(callback){var options={modal:true,draggable:true,callback:callback,template:{title:_("Are you sure you want to delete this message?")},css:{width:450}};return new twttr.widget.Prompt(options)},deleteSavedSearch:function(callback){return new twttr.widget.Prompt({modal:true,template:{title:_("Are you sure you want to delete this search?"),content:(new twttr.views.Prompt({ok:_("Yes"),cancel:_("No")})).html()},callback:callback})},goToUser:function(){var options={modal:true,draggable:true,template:{title:_("Go to a person's profile"),content:'<input class="twttr-goto-user-input" type="text"/>'},css:{width:450},positioning:{top:75}};var Dialog=new twttr.widget.Dialog(options);var $input=Dialog.$find(".twttr-goto-user-input");var autoComplete=new twttr.components.Autocomplete({limit:8,input:$input,type:"username",preselect:true});$input.bind("keypress",function(e){if(e.keyCode===twttr.constants.keyCodes.enter&&!autoComplete._isCompletionsOpen){e.preventDefault();Dialog.close();twttr.router.one("routed",function(){$('<input type="text"/>').css({position:"absolute",top:0,left:0}).appendTo("body").focus().remove()});twttr.router.routeTo(twttr.router.profilePath({screen_name:$input.val().replace("@","")}))}});Dialog.bind("open",function(){$input.focus()});return Dialog},_trendsOptions:function(){return options={draggable:true,css:{width:505},template:{title:_("Choose a trend location")}}},trends:function(){return arguments.callee._ret=arguments.callee._ret||new twttr.widget.Trends(this._trendsOptions())},newTrends:function(){return arguments.callee._ret=arguments.callee._ret||new twttr.widget.NewTrends(this._trendsOptions())},signinOrSignup:function(options){options=options||{};var screen_name=options.follow?options.follow.screenName:false,context={screen_name:screen_name,signup_source:twttr.audit.currentPage()};if(screen_name){context.redirect_after_login=twttr.router.profilePath(context)}var dialog=new twttr.widget.Dialog({css:{width:500},modal:true,draggable:true,template:{title:screen_name?_("Sign in to Twitter &amp; follow @{{screen_name}}",context):_("Sign in to Twitter"),content:(new twttr.views.SigninOrSignup(context)).html()}}),$signin=dialog.$find("form.signin"),$inputs=$signin.find(".textbox input");twttr.helpers.addFormEvents($signin);$inputs.bind("keypress",function(e){if(e.keyCode===twttr.constants.keyCodes.enter&&$(this).val()){e.preventDefault();$signin.submit()}});dialog.bind("open",function(){$inputs.first().focus();var scribeTerms={section:"auth_dialog",component:(options.follow?"unauth_follow":"unauth_action"),action:"open"};trackClient(scribeTerms,twttr.audit.currentPage())});dialog.$find("form").bind("submit",function(){dialog.close();trackClient({section:"auth_dialog",component:"signup_form",action:"signup_click"},twttr.audit.currentPage())});return dialog},searchOperators:function(){twttr.dialogs._searchOperators=twttr.dialogs._searchOperators||new twttr.widget.Dialog({modal:false,draggable:true,template:{title:_("Search Operators"),content:(new twttr.views.SearchOperators()).html()}});return twttr.dialogs._searchOperators},smsCodes:function(){twttr.dialogs._smsCodes=twttr.dialogs._smsCodes||new twttr.widget.Dialog({modal:false,draggable:true,template:{title:_("Two-way (sending and receiving) short codes:"),content:(new twttr.views.SmsCodes()).html()}});return twttr.dialogs._smsCodes}});twttr.klass("twttr.widget.TweetDialog",function(options){options=twttr.merge({basic:true,fixed:true},options);options.template=twttr.merge({show_geo:true,container_id:"tweet_dialog"},options&&options.template);options=$.extend(true,{basic:true,template:{show_geo:true,container_id:"tweet_dialog"}},options);twttr.widget.TweetDialog.uber.constructor.call(this,options);this._ready=false}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){var that=this;twttr.widget.Dialog.prototype.registerEvents.call(this);this.view.bind("ready",twttr.bind(this,function(){this._ready=true;setTimeout(twttr.bind(this,function(){this.onReady()}),0)}));this.view.tweetBox.bind("tweetSuccess",twttr.bind(this,function(e,tweet,action){if(action==="reply"){twttr.showMessage(_("Your Tweet to @{{username}} has been sent!",{username:this.options.data.screenName}))}else{twttr.showMessage(_("Your Tweet was posted!"))}this.destroy()}));this.view.tweetBox.bind("dmSuccess",twttr.bind(this,function(e,tweet){if(twttr.is.def(twttr.messageManager)){twttr.messageManager.addMessage(tweet)}twttr.showMessage(_("Your message was sent!"));that.close()}));this.view.tweetBox.bind("dmFail",twttr.bind(this,function(e,tweet){that.close()}));if(this.options.basic){this.view.tweetBox.bind("titleChanged",twttr.bind(this,function(event,title){this.$title.html(title||this.options.template.title)}))}},onReady:function(){var queue=[];return function(callback){if(callback){queue.push(callback)}else{twttr.each(queue,function(cb){cb()});queue=[]}}}(),open:function(){twttr.widget.Dialog.prototype.open.call(this);this.onReady(twttr.bind(this,function(){setTimeout(twttr.bind(this,function(){if(this.options.defaultContent){this.focus();this.setContent(this.options.defaultContent)}}),0)}));return this},setContent:function(content){this.view.tweetBox.editor.setContent(content);return this},setCaretPosition:function(pos,optEnd){optEnd=optEnd||pos;var ctrl=this.view.tweetBox.editor.$editor[0];if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,optEnd)}else{if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveStart("character",pos);range.moveEnd("character",optEnd);range.select()}}},focus:function(){if(this.options.defaultContent){var pos=this.view.tweetBox.editor.$editor.val().length;this.setCaretPosition(pos)}else{this.view.tweetBox.editor.focus()}return this}});twttr.klass("twttr.widget.Prompt",function(options){var opts={view:"Dialog",template:{content:(new twttr.views.Prompt({ok:_("Yes"),cancel:_("No")})).html()}};this.options=twttr.merge({},opts,options,true);twttr.widget.Prompt.uber.constructor.call(this,this.options)}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Dialog.prototype.registerEvents.call(this);this.$ok=this.$container.find(".twttr-prompt-ok");this.$cancel=this.$container.find(".twttr-prompt-cancel");this.$ok.addClass("selected").bind("click",twttr.bind(this,function(e){e.preventDefault();this.options.callback(true);this.close()}));this.$cancel.bind("click",twttr.bind(this,function(e){e.preventDefault();this.options.callback(false);this.close()}));this.$container.bind("keypress",twttr.bind(this,function(e){e.stopPropagation();if(e.metaKey){return }if(e.keyCode===twttr.constants.keyCodes.tab){this.$cancel.toggleClass("selected");this.$ok.toggleClass("selected")}else{if(e.keyCode===twttr.constants.keyCodes.enter||e.keyCode===twttr.constants.keyCodes.spacebar){e.preventDefault();this.options.callback(this.$ok.hasClass("selected"));this.destroy()}}}));this._$tabInput=$('<input type="text" class="twttr-hidden-input"/>').appendTo(this.$dialog).bind("keypress",function(e){e.preventDefault()})},open:function(){twttr.widget.Dialog.prototype.open.call(this);setTimeout(twttr.bind(this,function(){this._$tabInput.focus()}),10);return this}});twttr.klass("twttr.widget.DeviceSetupDialog",function(options){options=twttr.merge({destroyOnCloseBox:true,modal:true,draggable:true,css:{width:550,height:"auto"},positioning:{top:80},template:{title:_("Get notifications and Tweet via SMS"),content:new twttr.views.DeviceSetupDialog().html()}},options||{},true);options.view="Dialog";this._fetchStatus();var that=this;this._carriers=twttr.API.Device.carriers({success:function(carriers){that._carriers=carriers}});twttr.widget.Dialog.call(this,options)}).superclass(twttr.widget.Dialog).statics({POLLING_DELAY:15000}).methods({close:function(){this._clearDelayedStatusFetch();twttr.widget.Dialog.prototype.close.call(this)},_fetchStatus:function(){this._clearDelayedStatusFetch();var dialogBox=this;twttr.API.Device.list({success:twttr.bind(this,this._updateStatus),error:function(resp){dialogBox.close();twttr.showError(resp.response.error.message)}})},_fetchStatusDelayed:function(){this._fetchTimeout=window.setTimeout(twttr.bind(this,this._fetchStatus),twttr.widget.DeviceSetupDialog.POLLING_DELAY)},_clearDelayedStatusFetch:function(){if(this._fetchTimeout){window.clearTimeout(this._fetchTimeout);this._fetchTimeout=null}},_updateStatus:function(devices){if(devices.length==0){this._showCreate()}else{var device=devices[0];if(device.verified){this._showVerified(device)}else{this._showWaiting(device)}}},_showCreate:function(){var dialog=this,$contents=this.$container.find(".twttr-dialog-device-setup"),view=new twttr.views.DeviceSetupDialogCreate();$contents.empty().append('<div class="loading"></div>');this._carriers.get(function(carriers){$contents.empty();var $view=view.render($contents,"append"),$countriesOrRegions=$view.find("select.country-or-region"),$countriesInRegion=$view.find("select.country-in-region"),$carriers=$view.find("select.carrier"),$languages=$view.find("select.language");for(var i=0;i<carriers.regionsAndCountryCodes.length;++i){var regionAndCode=carriers.regionsAndCountryCodes[i];$("<option>").text(regionAndCode[0]).val(regionAndCode[1]).appendTo($countriesOrRegions)}var updateCarrierMenus=function(){var $this=$(this),$selected=$this.find("option:selected"),countryOrRegionName=$selected.text(),countryCode=$selected.val();if(carriers.countries[countryOrRegionName]){var regionName=countryOrRegionName;$countriesInRegion.empty();var countries=carriers.countries[regionName];for(var i=0;i<countries.length;++i){var countryAndCode=countries[i];$("<option>").text(countryAndCode[0]).val(countryAndCode[1]).appendTo($countriesInRegion)}$countriesInRegion.parents(".field").first().show();updateCarrierMenus.call($countriesInRegion.get(0));return }var countryName=countryOrRegionName;$view.find(".country-code").text(countryCode);if($this.hasClass("country-or-region")){$countriesInRegion.empty();$countriesInRegion.parents(".field").first().hide()}$carriers.empty();$languages.empty();var countryCarriers=carriers.carriers[countryName],countryLanguages=carriers.languages[countryName];if(countryCarriers){for(var i=0;i<countryCarriers.length;++i){var carrier=countryCarriers[i];$("<option>").text(carrier.display).val(carrier.value).appendTo($carriers)}$carriers.parents(".field").first().show()}else{$carriers.parents(".field").first().hide()}if(countryLanguages){for(var i=0;i<countryLanguages.length;++i){var language=countryLanguages[i];$("<option>").text(language.display).val(language.value).appendTo($languages)}$languages.parents(".field").first().show()}else{$languages.parents(".field").first().hide()}};$countriesOrRegions.change(updateCarrierMenus);$countriesInRegion.change(updateCarrierMenus);updateCarrierMenus.call($countriesOrRegions.get(0));twttr.helpers.addFormEvents($view.find("form"),function(e,data){var $form=$(this);data.device_country_intl_prefix=$form.find(".country-code").text();$form.find(".error").removeClass("error");$form.find(".error-text").remove();$form.addClass("submitting");twttr.API.Device.create(data,{success:function(resp){$form.removeClass("submitting");var device=resp.devices[0];if(resp.duplicate){dialog._showDuplicate(device,data)}else{if(resp.errors){dialog._showCreateErrors($form,resp.errors)}else{device.carrier_name=$carriers.find(":selected").text();dialog._showWaiting(device)}}},error:function(resp){$form.removeClass("submitting");var errors=resp.response.errors;if(errors&&errors.length&&errors[0].message){twttr.showError(errors[0].message)}else{twttr.showError(_("Whoops! Something went wrong. Please try again!"))}}})})})},_showCreateErrors:function($form,errors){var deviceErrors=errors.device;for(var i=0;i<deviceErrors.length;++i){var error=deviceErrors[i],$input=$form.find("input[name='device["+error[0]+"]']"),$field=$input.parents(".field").first();$error=$("<div>").addClass("error-text").text(error[1]);$field.addClass("error");$field.find(".label").first().append($error)}},_showDuplicate:function(device,data){this._updateDeviceForRendering(device);var dialog=this,$contents=this.$container.find(".twttr-dialog-device-setup");$contents.empty();var $view=new twttr.views.DeviceSetupDialogDuplicate(device).render($contents,"append");$view.find(".retry").click(function(e){e.preventDefault();var $this=$(this);if($this.hasClass("disabled")){return }$this.addClass("disabled");twttr.API.Device.create(data,{success:function(resp){$this.removeClass("disabled");if(resp.duplicate){}else{if(resp.errors){dialog._showCreate()}else{dialog._showWaiting(resp.devices[0])}}},error:function(){$this.removeClass("disabled")}})});$view.find(".cancel-instructions a").click(function(e){e.preventDefault();dialog._showCreate()})},_showWaiting:function(device){this._fetchStatusDelayed();var dialog=this,$contents=this.$container.find(".twttr-dialog-device-setup"),$view=$contents.find(".twttr-dialog-device-setup-waiting");if($view.length){return }$contents.empty();this._updateDeviceForRendering(device);$view=new twttr.views.DeviceSetupDialogWaiting(device).render($contents,"append");$view.find(".refresh a").click(function(e){e.preventDefault();dialog._fetchStatus()});$view.find(".cancel-instructions a").click(function(e){e.preventDefault();dialog._clearDelayedStatusFetch();twttr.API.Device.destroy(device.id,{success:twttr.bind(dialog,dialog._showCreate)})})},_showVerified:function(device){var $contents=this.$container.find(".twttr-dialog-device-setup");$contents.empty();this._updateDeviceForRendering(device);new twttr.views.DeviceSetupDialogVerified(device).render($contents,"append")},_updateDeviceForRendering:function(device){device.address_without_country_code=device.address.replace("+"+device.country_code,"");device.stop_command="Stop";device.go_command="Go"}});twttr.klass("twttr.widget.InviteContactsDialog",function(contactsResponse,options){this.routeToHome=options.routeToHome;options=options||{};options.template=options.template||{};options.template.title=options.template.title||_("Invite your friends who aren't on Twitter");options.template.content=options.template.content||"";defaultOptions={modal:true,draggable:true};options=twttr.merge({},defaultOptions,options,true);options.view="Dialog";twttr.widget.Dialog.call(this,options);var onSuccess=options.onSuccess||$.noop;var that=this;var componentOptions={onSuccess:function(){onSuccess.call(that)},scribbler:options.scribbler};var component=new twttr.components.InviteContacts(contactsResponse,componentOptions);this.$container.find(".twttr-dialog-content").append(component.$node);this.$container.find(".twttr-dialog-footer").remove()}).subclassOf(twttr.widget.Dialog).methods({close:function(){this.constructor.uber.close.call(this);if(this.routeToHome){twttr.router.routeTo(twttr.router.homePath())}}});twttr.klass("twttr.widget.ListDialog",function(options){options=options||{};options.template=options.template||{};options.template.title=options.template.title||options.list?_("Edit list details"):_("Create a new list");options.template.content=options.template.content||new twttr.views.ListDialog(options.list).html();if(!twttr.is.def(options.modal)){options.modal=true}if(!twttr.is.def(options.draggable)){options.draggable=true}options.view="Dialog";if(!twttr.is.fn(options.onSuccess)){options.onSuccess=function(list){twttr.router.routeTo(twttr.router.userListPath({screen_name:twttr.currentUser.screenName,list_slug:list.slug}))}}twttr.widget.Dialog.call(this,options)}).subclassOf(twttr.widget.Dialog).methods({open:function(){twttr.widget.Dialog.prototype.open.call(this);this.$container.find("input[name=name]").focus()},registerEvents:function(){var that=this;twttr.widget.Dialog.prototype.registerEvents.call(this);var updateButton=this.$container.find(".update-list-button");this.$container.find(".field .text").bind("focus blur keyup",function(event){if(this.value.length){updateButton.removeClass("disabled")}else{updateButton.addClass("disabled")}});updateButton.click(function(event){if($(this).hasClass("disabled")){return }$(this).addClass("disabled");var inputs={name:that.$container.find("[name=name]").val(),description:that.$container.find("[name=description]").val(),mode:that.$container.find("[name=mode]:checked").val(),error:function(response){twttr.showError(response.reason);$(this).removeClass("disabled")},complete:function(){that.close()}};if(that.options.list){that.options.list.update(twttr.merge(inputs,{success:function(list){twttr.showMessage(_("List updated!"));that.options.onSuccess(list)}}))}else{twttr.currentUser.lists.create(inputs.name,twttr.merge(inputs,{success:function(list){twttr.showMessage(_("List created!"));that.options.onSuccess(list)}}))}})},close:function(){this.constructor.uber.close.call(this);this.remove()}});twttr.klass("twttr.widget.DirectMessageDialog",function(options){var that=this;var o={data:{getUser:twttr.bind(this,function(){return this.$container.find(".twttr-directmessage-input").val()})},template:{show_geo:false}};this.options=twttr.merge({},options,o,true);twttr.widget.DirectMessageDialog.uber.constructor.call(this,this.options);this.autocomplete=new twttr.components.Autocomplete({limit:8,input:this.$find(".twttr-directmessage-input")});this.$container.addClass("twttr-direct-message")}).subclassOf(twttr.widget.TweetDialog).methods({registerEvents:function(){var that=this;twttr.widget.TweetDialog.prototype.registerEvents.call(this);this.bind("close",function(){that.remove()});this.view.tweetBox.editor.bind("blurFromTab",function(e,browserEvent){if(browserEvent.shiftKey){that.$find("input[type=text]").focus()}});this.$container.delegate(".twttr-directmessage-input","blur",{self:this},this._blurHandler)},_blurHandler:function(e){var that=e.data.self;var $input=$(this);var username=h($(this).val());if(twttr.is.blank(username)){return }if(!username.match(twttr.constants.regexps.username)){that._setProfileImageUrl();that._showError(_("Whoops! That's not a valid username."));return }that._findUser(username,{success:function(u){that._setProfileImageUrl(u.profileImageUrl);that._relationshipWith(u.screenName,function(relationship){if(relationship.canDM){that._showSuccess()}else{that._showError(_("You can't send a message to a user who is not following you."))}})},error:function(error){that._setProfileImageUrl();that._showError(_("Whoops! That user does not exist."))}})},_findUser:function(username,options){twttr.API.User.find(username,options)},_relationshipWith:function(username,cb){twttr.currentUser.relationshipWith(username,cb)},_setProfileImageUrl:function(url){url=url||twttr.assets.path("sticky/default_profile_images/default_profile_6_mini.png",{isVersioned:false});this.$container.find("h3 img").attr("src",url)},_showError:function(reason){this._showCheck(false);this._setMessageText(reason)},_showSuccess:function(){this._showCheck(true);this._setMessageText()},_setMessageText:function(text){var $error;if(this.$find(".error-text").length){$error=this.$find(".error-text")}else{$error=$('<div class="error-text"/>');$error.insertBefore(this.$find(".text-area"))}$error.hide();if(text){$error.html(text).fadeIn(500)}else{$error.fadeOut(500)}},_showCheck:function(ok){var that=this;if(ok){this.$container.removeClass("error");this.$find(".twttr-dm-check").show().css("opacity","1");setTimeout(function(){that.$find(".twttr-dm-check").fadeOut(500)},2000)}else{this.$container.addClass("error")}},open:function(){twttr.widget.TweetDialog.prototype.open.call(this);this.$container.find(".twttr-directmessage-input").focus();return this}});twttr.klass("twttr.widget.DirectMessageDialogSingle",function(options){if(!options.user.screenName){throw new Error("Direct Message dialog instantiated without a screenName")}var defaultOptions={view:"DirectMessageDialog",data:{getUser:function(){return options.user.screenName}},template:{show_geo:false}};var options=twttr.merge({},defaultOptions,options,true);twttr.widget.DirectMessageDialogSingle.uber.constructor.call(this,options);this.$container.addClass("twttr-direct-message-single");this.bind("close",twttr.bind(this,function(){this.remove()}))}).subclassOf(twttr.widget.TweetDialog).methods({open:function(){twttr.widget.TweetDialog.prototype.open.call(this);this.$container.find("textarea").focus();return this}});twttr.klass("twttr.widget.NewTrends",function(options){var that=this;var options=twttr.merge({view:"Dialog"},options,true);twttr.widget.NewTrends.uber.constructor.call(this,options);that.resetChangeCount();that.bind("close",function(){that.logClose()});that.rerender();that.position()}).subclassOf(twttr.widget.Dialog).methods({resetChangeCount:function(){this.changeCount=0},logClose:function(){scribble("close-trend-location-dialog",{woeid:twttr.trendLocations.current.woeid,change_count:this.changeCount,input:"click"});this.resetChangeCount()},rerender:function(){var $node=this.$container.find(".twttr-dialog-content");$node.empty();(new twttr.views.LocalTrendsNew(twttr.trendLocations.all)).render($node,"append");this.markLocation()},registerEvents:function(){var that=this;twttr.widget.Trends.uber.constructor.prototype.registerEvents.call(that);that.$container.delegate("li a","click",function(e){var woeid=parseInt($(this).attr("data-woeid"),10);twttr.trendLocations.setCurrent(woeid,"dialog");$(this).closest(".twttr-dialog-content").find("a.selected").removeClass("selected");$(this).addClass("selected");that.changeCount+=1});that.$container.delegate("a.trend-breadcrumb-location","click",function(e){var woeid=parseInt($(this).attr("data-woeid"),10);twttr.trendLocations.setCurrent(woeid,"dialog-breadcrumb");that.changeCount+=1})},position:function(){if(!this.options.fixed){this.$dialog.addClass("static")}var $db=twttr.app.currentPage().$find(".dashboard");if($db.length===0){this.centerHorizontal()}var right=Math.max($db.offset().left,this.$dialog.outerWidth());var scrollTop=$(window).scrollTop(),innerHeight=this.$dialog.innerHeight(),winHeight=$(window).height(),top=Math.round((winHeight/2)-(innerHeight/2));top=Math.max(top,$("#top-stuff").innerHeight()+1);if(!this.options.fixed){top+=scrollTop}this.$dialog.css({left:right-this.$dialog.outerWidth(),top:top})},markLocation:function(){var trendLocation=twttr.trendLocations.current;var id=(trendLocation&&trendLocation.woeid)||1;this.$container.find("[data-woeid="+id+"]").addClass("selected")}});twttr.klass("twttr.widget.MuteDialog",function(){this.peoples=twttr.caches.User.get("muted");if(!this.peoples){this.peoples={}}var options={fixed:false,draggable:true,modal:false,view:"Dialog",template:{title:_("Mute a User"),content:(new twttr.views.MuteUsers()).html()}};twttr.widget.Dialog.call(this,options)}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){var that=this;twttr.widget.Dialog.prototype.registerEvents.call(this);this.autocomplete=new twttr.components.Autocomplete({input:this.$find(".mute-input"),limit:10});this.currentSelection={};this.autocomplete.bind("select",function(e,type,text,img,screenName,userId){that.currentSelection.screenName=screenName;that.currentSelection.userId=userId;that.currentSelection.profileImageUrl=img});this.$dialog.delegate(".remove-muted-person","click",function(e){var $user=$(this).parent();var user=$user.attr("data-user-id");delete that.peoples[user];twttr.caches.User.set("muted",that.peoples);$user.remove()});this.$find(".mute-input,.twttr-dialog").bind("keydown",function(e){if(e.keyCode===twttr.constants.keyCodes.enter&&!twttr.components.Autocomplete._isCompletionsOpen){e.stopPropagation();that.fetchUser()}});this.$find(".button").bind("click",function(e){that.fetchUser()});this.populateUsers()},fetchUser:function(){var $input=this.$find("input[type=text]");twttr.API.User.find($input.val().toString(),twttr.bind(this,function(u){$input.val("");$(".stream-tweet[data-user-id="+u.id+"]").parent().hide();var o={screenName:u.screenName,userId:u.id,profileImageUrl:twttr.helpers.transformProfileImageUrl(u.profileImageUrl,"mini")};this.peoples[u.id]=o;twttr.caches.User.set("muted",this.peoples);this.populateUsers()}))},populateUsers:function(){var html=[];for(var k in this.peoples){html.push('<li data-user-id="'+this.peoples[k].userId+'" data-user-screenname="'+this.peoples[k].screenName+'">                  <img width="24" height="24" src="'+this.peoples[k].profileImageUrl+'"/> '+this.peoples[k].screenName+' <span class="remove-muted-person">&times;</span></li>')}html=html.join("");this.$find(".muted-user-list").html(html)},open:function(){twttr.widget.Dialog.prototype.open.call(this);this.$find("input[type=text]").focus();return this},close:function(){twttr.widget.Dialog.prototype.close.call(this);this.remove();return this}});twttr.klass("twttr.widget.DiscoveryDialog",function(options){twttr.widget.Dialog.call(this,twttr.merge({modal:true,draggable:false,css:{width:530}},options))}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Dialog.prototype.registerEvents.call(this);var dialog=this,$form=this.$find("form"),makeFormUnusable=function(){$form.find("input, textarea").attr("disabled","disabled");$form.find(".button").addClass("disabled")},gotoHome=function(){twttr.Router.performRedirect(twttr.router.homePath())};twttr.helpers.addFormEvents($form,function(e,values){if($form.find(".button").hasClass("disabled")){return }makeFormUnusable();twttr.currentUser.updateDiscoverability(values,{success:function(response){twttr.currentUser.sync("name",response.name);twttr.currentUser.sync("description",response.description);twttr.currentUser.sync("location",response.location);twttr.currentUser.sync("email_discoverability_set",response.email_discoverability_set);twttr.currentUser.sync("mobile_phone_discoverability_set",response.mobile_phone_discoverability_set);twttr.currentUser.sync("discoverable_by_email",response.discoverable_by_email);twttr.currentUser.sync("discoverable_by_mobile_phone",response.discoverable_by_mobile_phone);dialog.destroy();gotoHome()},error:function(e){twttr.showError(_("Whoops! Something went wrong. Please try again!"));dialog.destroy()}})});this.$find(".button.cancel").bind("click",function(){makeFormUnusable();gotoHome()})}});twttr.klass("twttr.widget.GeoDialog",function(options){twttr.widget.Dialog.call(this,twttr.merge({view:"Dialog",fixed:false,draggable:true},options))}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Dialog.prototype.registerEvents.call(this);this.$container.find(".twttr-dialog-close").bind("click",twttr.bind(this,function(e){e.preventDefault();e.stopPropagation();this.destroy()}));this.$container.bind("keypress keyup",function(e){e.stopPropagation()}).keydown(twttr.bind(this,function(e){e.stopPropagation();if(e.keyCode===twttr.constants.keyCodes.enter){this.$container.find(".geo-submit").trigger("geosubmit")}if(e.keyCode===twttr.constants.keyCodes.escape){this.destroy()}}))},open:function(){this.prevModal=twttr.widget.Dialog.currentModal;if(this.prevModal){this.prevModal.close()}twttr.widget.Dialog.prototype.open.call(this)},close:function(){twttr.widget.Dialog.prototype.close.call(this);if(this.prevModal){this.prevModal.open();this.prevModal=null}}});twttr.klass("twttr.widget.RetweetDialog",function(options){twttr.widget.RetweetDialog.uber.constructor.call(this,options);this.$dialog.attr("type","retweet");this.$container.find(".twttr-dialog-footer").hide();twttr.API.Status.find(this.options.data.tweetId,twttr.bind(this,function(tweet){var content=new twttr.views.ReplyDialogFooter({screen_name:tweet.user.screenName,text:options.tweetText,profile_image_url:tweet.user.profileImageUrl});content.render(this.$container.find(".twttr-dialog-content"),"prepend")}))}).subclassOf(twttr.widget.Prompt);twttr.klass("twttr.widget.Trends",function(options){var options=twttr.merge({view:"Dialog"},options,true);twttr.widget.Trends.uber.constructor.call(this,options);twttr.API.Trend.locations(twttr.bind(this,function(locations){var LocalTrends=new twttr.views.LocalTrends(locations);LocalTrends.render(this.$container.find(".twttr-dialog-content"),"append");this.position();this.markLocation()}))}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Trends.uber.constructor.prototype.registerEvents.call(this);this.$container.delegate("dl a","click",function(e){var woeid=parseInt($(this).attr("data-woeid"),10);twttr.currentUser.setTrendLocation(woeid);$(this).closest(".twttr-dialog-content").find("a.selected").removeClass("selected");$(this).addClass("selected");scribble("switch-trend-location",{woeid:woeid,input:"click",origin:"dialog"})})},position:function(){if(!this.options.fixed){this.$dialog.addClass("static")}var $db=twttr.app.currentPage().$find(".dashboard");if($db.length===0){this.centerHorizontal()}var right=Math.max($db.offset().left,this.$dialog.outerWidth());var scrollTop=$(window).scrollTop(),innerHeight=this.$dialog.innerHeight(),winHeight=$(window).height(),top=Math.round((winHeight/2)-(innerHeight/2));top=Math.max(top,$("#top-stuff").innerHeight()+1);if(!this.options.fixed){top+=scrollTop}this.$dialog.css({left:right-this.$dialog.outerWidth(),top:top})},markLocation:function(){twttr.currentUser.trendLocation().first(twttr.bind(this,function(trendLocation){var id=(trendLocation&&trendLocation.woeid)||1;this.$container.find("[data-woeid="+id+"]").addClass("selected")}))}});twttr.klass("twttr.widget.ReplyDialog",function(options){var options=twttr.merge({},twttr.dialogs.defaultOptions,options,{},true);twttr.widget.ReplyDialog.uber.constructor.call(this,options);this.$dialog.attr("type","reply")}).subclassOf(twttr.widget.TweetDialog).statics({openReplyDialog:false}).methods({open:function(){if(this.constructor.openReplyDialog){this.constructor.openReplyDialog.close()}twttr.widget.TweetDialog.prototype.open.call(this);this.constructor.openReplyDialog=this;this.focus();return this},focus:function(){var start=this.view.tweetBox.editor.$editor.val().length;var end=this.view.tweetBox.editor.$editor.val().length;if(this.options.multiple){start=this.options.data.screenName.length+2}this.setCaretPosition(start,end)}});twttr.klass("twttr.widget.BroughtBackDialog",function(options){twttr.widget.Dialog.call(this,twttr.merge({modal:true,draggable:false,css:{width:420}},options))}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Dialog.prototype.registerEvents.call(this);this.$container.delegate(".button.switch-back","click",twttr.bind(this,function(e){e.preventDefault();e.stopPropagation();this.destroy()}))}});twttr.klass("twttr.widget.ListMembershipDialog",function(user,options){options=twttr.merge({view:"Dialog",destroyOnCloseBox:true,modal:false,draggable:true,css:{width:300,height:"auto"},positioning:{top:80},template:{container_id:"list_membership_dialog",title:_("Your lists"),content:new twttr.views.AddToListDialog({screen_name:user.screenName}).html()}},options||{},true);this.makeListItems(user);twttr.widget.Dialog.call(this,options);this.addSpinner()}).subclassOf(twttr.widget.Dialog).methods({makeListItems:function(user){var that=this;twttr.viewHelpers.getListDialogItems(user,function(items){if(that.spinner){that.spinner.hide()}if(items.length>1){that.$container.find(".add-to-list-prompt").show()}that.renderItems(items);var origClick=items[items.length-1].handlers.click;items[items.length-1].handlers.click=function(){origClick.apply(this,arguments);that.destroy()};that.attachHandlers(items)})},addSpinner:function(){this.spinner=$("<span class='spinner' title='{{_i}}Loading...{{/i}}'></span>");this.spinner.appendTo(this.$container.find(".twttr-dialog-body"))},attachHandlers:function(items){var $items=this.$container.find(".list-membership-container").children();for(var i=0;i<items.length;i++){var item=items[i];if(!item.handlers){continue}$.each(item.handlers,function(name,handler){var $node=$($items[i]);var args=[name,handler];$node.bind.apply($node,args)})}},renderItems:function(items){var itemViews=twttr.map(items,function(item){return new twttr.views.CheckboxListItem(item).html()});$(itemViews.join("")).appendTo(this.$container.find(".list-membership-container"))}});twttr.klass("twttr.components.pages.Messages",function(){twttr.components.Page.apply(this,arguments);twttr.messageManager=twttr.messageManager||new twttr.MessageManager()}).subclassOf(twttr.components.Page).methods(twttr.EventProvider).mixin(twttr.mixins.streamablePage).view(twttr.views.MessagesPage).methods({messages:function(params){if(!twttr.loggedIn){return this.trigger("loginRequired")}this.updatePageTitle(_("Twitter / Messages"));this.highlightGlobalNav("messages");twttr.themes.loadCurrentUserStyle();this.openDetailsPane();this.repositionDetailsPane();var that=this;this.streamManager.switchTo(twttr.streams.MessageStream,{},function(){that.$node.find(".stream-item:first").click();that.profiler.done()});if(twttr.messageManager.isContinuouslyPolling()){twttr.messageManager._fetchMessages(function(){twttr.messageManager._sort()})}else{twttr.messageManager.setupContinuousPoll()}},openDetailsPane:function(){return false},closeDetailsPane:function(){return false}}).addAfterRender(function(){var that=this;this.$detailsPaneOuter=this.$find("#details-pane-outer");this.resizeDetailsPane();twttr.messageManager.bind("updatedThread",function(event,thread,action){that.streamManager.getCurrent().updateThread(thread,action)});twttr.messageManager.bind("deletedThread",function(event,threadId){that.streamManager.getCurrent().removeThread(threadId)})}).addOnSwitchAway(function(){twttr.messageManager.stopContinuousPoll()}).containerCssClass("messages-container").click({".new-message-button":function(event,$target){if(!(this._dialog&&this._dialog._isOpen)){this._dialog=twttr.dialogs.directMessage({origin:"message-dialog-new-message-button"});this._dialog.open()}else{this._dialog.focus()}event.preventDefault();event.stopPropagation();return false},".message .delete-action":function(event,$target){var $message=$target.closest(".message"),messageId=$message.attr("data-message-id"),threadId=$message.attr("data-thread-id");twttr.dialogs.deleteMessage(function(deleteIt){if(deleteIt){twttr.messageManager.deleteMessage(messageId,threadId)}}).open()}});twttr.klass("twttr.components.pages.MobileGallery",function(){twttr.components.Page.apply(this,arguments);if($("#page-container").hasClass(twttr.components.pages.MobileGallery._containerCssClass)){this._staticRender=true;this.$node=$("#page-container").children().first()}}).subclassOf(twttr.components.Page).view(twttr.views.MobileGalleryPage).deciderKey("mobile_download_gallery").containerCssClass("mobile-gallery").statics({CAMPAIGN_ID:"mobile_app_download",_makeDownloadFormHandler:function(opt_dialog){return function(e,data){var $form=$(this);$form.find(".error").removeClass("error");$form.find(".error-text").remove();$form.addClass("submitting");twttr.API.Download.sendLink(data.email,data.appId,{success:function(resp){$form.removeClass("submitting");if(resp.errors){for(var i=0;i<resp.errors.length;++i){var error=resp.errors[i],$input=$form.find("input[name='"+error[0]+"']"),$field=$input.parents(".field").first();$error=$("<div>").addClass("error-text").text(error[1]);$field.addClass("error");$field.find(".label").first().append($error)}}else{twttr.showMessage(_("An email has been sent to your address"));$form.find(".email").val("").blur();var scribeData={context:"mobile_gallery",event_info:twttr.components.pages.MobileGallery.CAMPAIGN_ID,query:this._appId};var scribeTerms={component:"send_link_form",action:"notification_sent"};trackClient(scribeTerms,scribeData);if(opt_dialog){opt_dialog.destroy()}}},error:function(resp){$form.removeClass("submitting");var errors=resp.response.errors;if(errors&&errors[0].message){twttr.showError(errors[0].message)}else{twttr.showError(_("Whoops! Something went wrong. Please try again!"))}}})}}}).addAfterRender(function(){var that=this;this.$find(".bottompart").append((new twttr.components.Footer()).$node);if(this._loggedOut){if(!this._$loggedOutHeader){this._$loggedOutHeader=new twttr.views.MobileGalleryLoggedOutHeader().$html();var paddingTop=$("#page-outer").css("padding-top");if(paddingTop){this._$loggedOutHeader.css("padding-top",paddingTop);$("#page-outer").css("padding-top","")}this._$loggedOutHeader.insertBefore("#page-outer")}}else{this._removeLoggedOutHeader();this.$find("div.download-info .button").click(function(){var scribeData={context:"mobile_gallery",event_info:twttr.components.pages.MobileGallery.CAMPAIGN_ID,query:that._appId};var scribeTerms={component:"download_button",action:"click"};trackClient(scribeTerms,scribeData)})}this.profiler.done()}).addOnSwitchAway(function(){this._removeLoggedOutHeader()}).methods({noAutoRender:true,gallery:function(args,params){this._appId=null;this._loggedOut=!!params.logged_out;if(!this._staticRender){this.render({logged_out:this._loggedOut})}else{this.afterRender()}this.updatePageTitle(_("Twitter / Download Mobile Apps"));this._showYesScriptElements();twttr.themes.loadStaticPageTheme();this.$node.find(".download-now").click(twttr.bind(this,this._openDownloadDialog));this.$node.find(".activate-sms").click(function(){if(twttr.currentUser){new twttr.widget.DeviceSetupDialog().show()}else{twttr.router.routeTo(twttr.router.loginPath()+"?redirect_after_login="+encodeURIComponent(twttr.router.devicesPath()))}});trackClient({component:"",action:"impression"},{context:"mobile_gallery",event_info:twttr.components.pages.MobileGallery.CAMPAIGN_ID})},app:function(args){this._appId=args.app;this._loggedOut=false;this._showYesScriptElements();twttr.themes.loadStaticPageTheme();if(this._apps){this._renderApp()}else{if(!this._loading){this._loading=true;var that=this;twttr.API.Download.apps({success:function(apps){that._loading=false;that._apps=apps;that._renderApp()},error:function(){that._loading=false;that.profiler.done()}})}}},_removeLoggedOutHeader:function(){if(this._$loggedOutHeader){var paddingTop=this._$loggedOutHeader.css("padding-top");if(paddingTop){$("#page-outer").css("padding-top",paddingTop)}this._$loggedOutHeader.remove();this._$loggedOutHeader=null}},_renderApp:function(){var that=this;if(!this._appId){this.gallery();return }appData=this._apps[this._appId];if(!appData){this.trigger("notFound");return }this.updatePageTitle(_("Twitter / Download {{{app_long_name}}}",appData));if(!this._staticRender){this.render(appData)}else{this.afterRender()}twttr.helpers.addFormEvents(this.$node.find(".app-download-form"),twttr.components.pages.MobileGallery._makeDownloadFormHandler());this.$find("div.app-download .button").click(function(){var evtName="download_button:click";var scribeData={context:"mobile_gallery",event_info:twttr.components.pages.MobileGallery.CAMPAIGN_ID,query:that._appId};var scribeTerms={component:"download_button",action:"click"};trackClient(scribeTerms,scribeData)});trackClient({component:"",action:"impression"},{context:"mobile_gallery",event_info:twttr.components.pages.MobileGallery.CAMPAIGN_ID,query:that._appId})},_showYesScriptElements:function(){if($("body").hasClass("loading-body")){this.$node.find(".yes-script").css({visibility:"visible",opacity:0}).animate({opacity:1},600)}},_openDownloadDialog:function(){var that=this;var dialog=new twttr.widget.Dialog({view:"Dialog",destroyOnCloseBox:true,template:{title:_("Download a Twitter app for your phone"),content:(new twttr.views.MobileGalleryDownloadDialog()).html()}});twttr.helpers.addFormEvents(dialog.$find("form"),twttr.components.pages.MobileGallery._makeDownloadFormHandler(dialog));dialog.$find(".cancel").click(function(){dialog.destroy()});dialog.open();dialog.$find("input[name=email]").get(0).focus()}});twttr.klass("twttr.components.pages.Search").subclassOf(twttr.components.Page).mixin(twttr.mixins.streamablePage).view(twttr.views.SearchPage).addOnSwitchAway(function(){twttr.search.clear()}).addOnSwitchTo(function(){trackClient({section:"",component:"",action:"impression"},{query:this._query});twttr.themes.loadCurrentUserStyle()}).addAfterRender(function(){var that=this;var components=[];if(!twttr.loggedIn){components.push(new twttr.components.SignupCallOut("search"))}else{if(this._mode!="placeTweetSearch"){components.push(new twttr.components.PeopleResults(this._query))}}this.facetsMedia=new twttr.components.SearchFacets(this._query);components.push(this.facetsMedia);components.push(this.newTrendsComponent(),new twttr.components.Footer());this.addDashboardComponents(components)}).statics({addSearchClickLogging:function($tweet,scribeData){if($tweet.length){var info={};scribeData.tweet_click_info=info;info.tweet_id=$tweet.attr("data-tweet-id");info.pos=$tweet.closest(".stream-item").prevAll(".stream-item").length;info.type=$tweet.is(".promoted-tweet")?"promoted":$tweet.is(".top-tweet")?"popular":"recent"}}}).methods({realtime:function(params,queryString){var query=params.query||queryString.q;if(twttr.decider.isAvailable("phoenix_search_relevance")){this.updatePageTitle(_("Twitter / Search - {{{query}}} - All Tweets",{query:query}))}else{this.updatePageTitle(_("Twitter / Search - {{{query}}}",{query:query}))}this.enterMode(query,"tweets")},links:function(params,queryString){var query=params.query||queryString.q;if(!query){return this.search({query:"links"})}this.updatePageTitle(_("Twitter / Search - {{{query}}} - Tweets with links",{query:query}));this.enterMode(query,"links")},people:function(params,queryString){if(!twttr.loggedIn){return this.trigger("loginRequired")}trackClient({action:"impression"},"user_search");var query=params.query||queryString.q;if(!query){return this.search({query:"users"})}this.updatePageTitle(_("Twitter / People Search - {{{query}}}",{query:query}));this.enterMode(query,"people")},search:function(params,queryString){if((!twttr.currentUser&&!twttr.decider.isAvailable("phoenix_search_relevance_logged_out"))||(twttr.currentUser&&!twttr.decider.isAvailable("phoenix_search_relevance"))){this.realtime(params,queryString);return }var query=params.query||queryString.q;this.updatePageTitle(_("Twitter / Search - {{{query}}}",{query:query}));this.enterMode(query,"relevance",queryString)},placeTweetSearch:function(params){var placeName=params.place_name,placeId=params.place_id;this.updatePageTitle(_("Twitter / Tweets at {{{placeName}}}",{placeName:placeName}));this._placeName=placeName;this.enterMode("place:"+placeId,"placeTweetSearch")},noAutoRender:true,enterMode:function(query,mode,queryString){twttr.search.latestQuery=query;queryString=queryString||{};if(!query){twttr.router.routeTo(twttr.router.searchHomePath());return }this.unfocusStreamItem();var that=this;that._mode=mode;if(query!==this._query){this._query=query;if(twttr.loggedIn){this.setupSavedSearchButton();this.registerSavedSearchListeners()}if(this.streamManager){this.streamManager.$node.detach()}var hasRelevance=false;if(twttr.currentUser){hasRelevance=twttr.decider.isAvailable("phoenix_search_relevance")}else{hasRelevance=twttr.decider.isAvailable("phoenix_search_relevance_logged_out")}var isPlaceSearch=(mode=="placeTweetSearch");this.render({query:query,pretty_query:isPlaceSearch&&this._placeName||query,is_place_search:isPlaceSearch,has_relevance_search:hasRelevance})}if(mode==="people"){var scribbler=twttr.Scribbler.clientEvent.spawn({context:"user_search",query:query});this.streamManager.switchTo(twttr.streams.PeopleSearch,{query:query,scribbler:scribbler})}else{var scribbler=twttr.Scribbler.clientEvent.spawn({context:(mode=="relevance")?"relevance_search":"search",query:query});this.streamManager.switchTo(twttr.streams.Search,{query:query,pretty_query:this._placeName||query,mode:mode,hideTitle:true,debug:queryString.debug,experimentId:queryString.experimentId,scribbler:scribbler})}this.focusStreamTab(mode);twttr.search.focusQuery(query);this.profiler.done()},setupSavedSearchButton:function(){var that=this;twttr.currentUser.savedSearches(function(savedSearches){var s=savedSearches.filter(function(savedSearch){return savedSearch.query===that._query});if(!s.length()){that.toggleSavedSearchOff()}else{that.toggleSavedSearchOn(s.first())}})},registerSavedSearchListeners:function(){var that=this;twttr.API.SavedSearch.bind("create",function(event,search){if(search.query==that._query){that.toggleSavedSearchOn(search)}});twttr.API.SavedSearch.bind("delete",function(event,search){if(search.query==that._query){that.toggleSavedSearchOff()}})},toggleSavedSearchOn:function(search){var mustache=new twttr.views.SavedSearchButton({show_trashcan:true});this.$find(".saved-search-container").replaceWith(mustache.html());this._savedSearch=search},toggleSavedSearchOff:function(){var mustache=new twttr.views.SavedSearchButton({show_trashcan:false});this.$find(".saved-search-container").replaceWith(mustache.html());this._savedSearch=null}}).click({".operators a:not(.advanced-search)":function(e){e.preventDefault();twttr.dialogs.searchOperators().open()},".save-search-button":function(event,$target){twttr.currentUser.savedSearches.create(this._query,{before:twttr.bind(this,this.toggleSavedSearchOn),error:twttr.bind(this,function(){this.toggleSavedSearchOff();twttr.showError(_("Error saving search"))})})},".delete-search-button":function(event,$target){twttr.dialogs.deleteSavedSearch(twttr.bind(this,function(okCancel){if(okCancel){var justInCaseWeError=this._savedSearch;this._savedSearch.destroy({before:twttr.bind(this,this.toggleSavedSearchOff),error:twttr.bind(this,function(){this.toggleSavedSearchOn(justInCaseWeError);twttr.showError(_("Error deleting search"))})})}})).open()}});twttr.klass.page("twttr.components.pages.SearchHome").view(twttr.views.SearchHome).click({".operators a:not(.advanced-search)":function(e){e.preventDefault();twttr.dialogs.searchOperators().open()}}).addAfterRender(function(){var $form=this.$find(".search form"),isAdvanced=$form.is(".advanced-search form");twttr.helpers.addFormEvents($form,function(e,data){var $form=$(this),query=isAdvanced?twttr.search.serializeAdvancedForm($form):data.q;if(query){twttr.search.doSearch(query)}else{twttr.showMessage(_("Enter your query before submitting the search form!"))}});twttr.search.formifyLatestQuery($form);if(isAdvanced){var $near=$form.find("input[name=near]"),$within=$form.find("fieldset.geo div.sel");if($near.val()){$within.show()}else{$near.one("keyup change",function(){$within.slideDown()})}}this.$find(".bottompart").append((new twttr.components.Footer()).$node);this.profiler.done()}).addOnSwitchTo(function(){twttr.themes.clear()}).methods({noAutoRender:true,index:function(){this.updatePageTitle(_("Twitter / Search"));this.render();this.$find("input").focus();var trends=this.newTrendsComponent();this.profiler.waitFor(trends);this.$find(".trends-container").append(trends.$node)},advanced:function(){if(!twttr.decider.isAvailable("advanced_search")){return twttr.router.routeTo(twttr.router.searchHomePath())}this.updatePageTitle(_("Twitter / Advanced Search"));this.render({is_advanced:true})}});twttr.klass("twttr.components.pages.Home").subclassOf(twttr.components.Page).mixin(twttr.mixins.streamablePage).view(twttr.views.HomePage).containerCssClass("home-container").addOnSwitchTo(function(){if(this._hasRendered){this.insertTweetbox()}var states=twttr.currentUser.states;if(states&&states.pending_email&&!$.cookie("abtest_email_verification_18")){var bucket=twttr.abdecider.choose("email_verification-18",true);if(bucket&&bucket!="control"){twttr.dialogs.verifyEmail(bucket).open()}}}).methods({home:function(params,queryString){if(params.discover||queryString.discover){var discoverDialog=twttr.dialogs.discoverable();discoverDialog.open()}this.loadPage(_("Twitter / Home"),"home",twttr.streams.Home)},mentions:function(params){var title=_("Twitter / @{{{screenName}}}",{screenName:twttr.currentUser.screenName});this.loadPage(title,"mentions",twttr.streams.Mentions)},favorites:function(params){this.loadPage(_("Twitter / Your Favorites"),"favorites",twttr.streams.Favorites)},listInHome:function(params){params=twttr.util.camelizeObject(params);params.showTitleLink=true;this.loadPage(_("Twitter / @{{{screenName}}}/{{{listSlug}}}",params),"lists",twttr.streams.List,params)},savedSearch:function(params){params.scribbler=twttr.Scribbler.clientEvent.spawn({context:"saved_search",query:params.query});this.loadPage(_("Twitter / Search - {{{query}}}",params),"searches",twttr.streams.Search,params);trackClient({section:"",component:"saved_search",action:"search"},{query:params.query})},retweetsByOthers:function(params){this.loadPage(_("Twitter / Retweets"),"retweets",twttr.streams.RetweetsByOthers)},retweetsByYou:function(params){var title=_("Twitter / Retweets by {{{screenName}}}",{screenName:twttr.currentUser.screenName});this.loadPage(title,"retweets",twttr.streams.RetweetsByYou)},retweetsOfYourTweets:function(params){this.loadPage(_("Twitter / My Tweets, retweeted"),"retweets",twttr.streams.YourTweetsRetweeted)},loadPage:function(pageTitle,streamTab,stream,params){var that=this;this.updatePageTitle(pageTitle);this.highlightGlobalNav("home");twttr.themes.loadCurrentUserStyle();this.streamManager.switchTo(stream,params||{});this.focusStreamTab(streamTab);this.unfocusStreamItem();twttr.components.JapaneseAd.refreshAds();this.profiler.done()},loadLists:function(cb){var items=[];var subscriptionsDone=false,listsDone=false;var loadListsProfiler=new twttr.util.Profiler(this.constructor._namespace+".loadLists");function done(){if(subscriptionsDone&&listsDone){loadListsProfiler.done();cb(items)}}twttr.currentUser.lists(function(lists){items.push.apply(items,lists.toArray());listsDone=true;done()});twttr.currentUser.subscriptions(function(lists){items.push.apply(items,lists.toArray());subscriptionsDone=true;done()})},loadSavedSearches:function(cb){twttr.currentUser.savedSearches(function(ss){cb(ss.toArray())})},deleteSavedSearch:function(){var query=this.streamManager.getCurrent().params.query;twttr.currentUser.savedSearches(function(savedSearches){savedSearches.filter(function(savedSearch){return savedSearch.query===query}).first().destroy({success:function(){twttr.router.routeTo(twttr.router.homePath())},error:function(){twttr.showError(_("Error deleting search"))}})})},componentNotRendered:function(component,data){if(component._namespace=="twttr.components.UserRecommendations"){this.$node.find("div.dashboard div.trends-inner").addClass("wide-trends")}},getNoobDashboardComponents:function(noobLevel){var out=[];var noob=twttr.constants.noob;switch(noobLevel){case noob.invited:case noob.friendless:case noob.silent:out.push(new twttr.components.RecentProfileActivity());break;case noob.talking:out.push(new twttr.components.YourProfile());break;case noob.popular:case noob.lonely:case noob.struggling:out.push(new twttr.components.YourProfile(),new twttr.components.RecentProfileActivity());break;case noob.total:default:}out.push(new twttr.components.GettingStarted(noobLevel),new twttr.components.ContactImportLauncher());switch(noobLevel){case noob.total:case noob.invited:case noob.talking:case noob.popular:out.push(this.newTrendsComponent({wide:true}));break;default:if(twttr.isNarrow){out.push(new twttr.components.UserRecommendations(),this.newTrendsComponent())}else{out.push(this.newTrendsComponent(),new twttr.components.UserRecommendations())}}return out},insertTweetbox:function(){var tweetBoxDefaultContent=twttr.util.params()["status"]||"";var inReplyToStatusId=twttr.util.params()["in_reply_to_status_id"]||null;var tweetBoxOptions={id:"main-tweet-box",condensed:!tweetBoxDefaultContent||true,defaultContent:tweetBoxDefaultContent,width:482,statusAction:"update",template:{button_text:_("Tweet")},origin:"main_tweet_box"};if(inReplyToStatusId){twttr.merge(tweetBoxOptions,{inReplyToStatusId:inReplyToStatusId})}this.tweetBox=new twttr.TweetBox(this.$node.find(".main-tweet-box").empty(),tweetBoxOptions);this.tweetBox.bind("dmSuccess",function(){twttr.showMessage(_("Your message was sent!"))})}}).addAfterRender(function(){var that=this;this._hasRendered=true;this.insertTweetbox();twttr.TweetBox.bind("tweetSuccess",function(e,tweet){var currentStream=that.streamManager.getCurrent().trigger("didTweet",[tweet])});this.addDashboardComponent(new twttr.components.JapaneseAd());if(twttr.loggedIn){var noobLevel=twttr.helpers.userNoobLevel(twttr.currentUser);if(noobLevel>=0){var components=this.getNoobDashboardComponents(noobLevel)}else{if(twttr.isNarrow){var components=[new twttr.components.YourProfile(),new twttr.components.RecentProfileActivity(),new twttr.components.UserRecommendations(),this.newTrendsComponent()]}else{var components=[new twttr.components.YourProfile(),new twttr.components.RecentProfileActivity(),this.newTrendsComponent(),new twttr.components.UserRecommendations()]}}this.addDashboardComponents(components)}else{this.addDashboardComponents([this.newTrendsComponent()])}this.addDashboardComponents([new twttr.components.Promo(),new twttr.components.Footer()])}).click({".delete-saved-search":function(event,$target){twttr.dialogs.deleteSavedSearch(twttr.bind(this,function(okCancel){if(okCancel){this.deleteSavedSearch()}})).open();event.stopPropagation();event.preventDefault();return false},".stream-tab-lists":function(event,$target){var that=this;if($(event.target).is(".tab-text, .tab-text *")){if(this._listsDropdown){return }this._listsDropdown=true;twttr.viewHelpers.superListDropdown(twttr.currentUser,$target,function(dropdown){that._listsDropdown=dropdown;dropdown.render($target,"append");dropdown.open()})}},".stream-tab-searches":function(event,$target){var that=this;if(this._savedSearchesDropdown){return }var savedSearchItem=function(savedSearch){var searchLink;if(savedSearch.isPlaceSearch){searchLink=twttr.router.placeTweetSearchPath({place_id:savedSearch.placeId,place_name:savedSearch.name})}else{searchLink=twttr.router.savedSearchPath({query:savedSearch.query})}return{href:searchLink,name:savedSearch.name,icon_class:"saved-search-icon",type:"saved search",id:savedSearch.id,delete_title:_("Delete this saved search.")}};var loadSavedSearchesProfiler=new twttr.util.Profiler(this.constructor._namespace+".loadSavedSearches");this.loadSavedSearches(function(savedSearches){if(savedSearches.length===0){that._savedSearchesDropdown=new twttr.control.Dropdown($target,{items:[{itemView:"NoSavedSearches"}]})}else{var items=twttr.inject(savedSearches,[],function(acc,i,savedSearch){acc.push(savedSearchItem(savedSearch));return acc});that._savedSearchesDropdown=new twttr.control.Dropdown($target,{itemView:"StreamLink",items:items})}twttr.API.SavedSearch.bind("create",function(event,search){that._savedSearchesDropdown.addItem(savedSearchItem(search))});twttr.API.SavedSearch.bind("delete",function(event,search){that.$node.find(".stream-link[data-item-id="+search.id+"]").remove()});that._savedSearchesDropdown.render($target,"append");that._savedSearchesDropdown.open();loadSavedSearchesProfiler.done()})},".stream-tab-retweets":function(event,$target){if(this._retweetsDropDown){return }this._retweetsDropDown=new twttr.control.Dropdown($target,{itemView:"StreamLink",items:[{href:twttr.router.retweetsByOthersPath(),name:_("Retweets by others")},{href:twttr.router.retweetsPath(),name:_("Retweets by you")},{href:twttr.router.retweetsOfMinePath(),name:_("Your Tweets, retweeted")}]});this._retweetsDropDown.render($target,"append");setTimeout(twttr.bind(this,function(){this._retweetsDropDown.open()}),0)}}).keypress({"shift+b":function(){this.panes.pop();scribble("detail-pane-back",{input:"keyboard"})}});twttr.klass.page("twttr.components.pages.Front",function(){twttr.components.Page.apply(this,arguments);if(twttr.decider.isAvailable("phoenix_frontpage_rotate_avatars")){this.ROTATE_DELAY=1500;var m=Math.floor(twttr.frontSuggestedUsers.length/2);this.avatarPool=twttr.frontSuggestedUsers.slice(0,m);this.avatarRotatePool=twttr.frontSuggestedUsers.slice(m)}else{this.avatarPool=twttr.frontSuggestedUsers}}).methods({$find:function(selector){return $("#front-container").find(selector)}}).view(twttr.views.Nothing).addAfterRender(function(){twttr.helpers.addFormEvents(this.$find(".front-signin form"));twttr.helpers.addFormEvents(this.$find(".front-signup form"));twttr.helpers.addFormEvents(this.$find(".search form"),function(e,data){if(data.q){twttr.search.doSearch(data.q)}else{twttr.router.routeTo(twttr.router.searchHomePath())}});this.$find(".home-events-list a").hover(function(){$(this).find(".caption span").slideDown("fast")},function(){$(this).find(".caption span").slideUp("fast")}).click(function(){$(this).find(".caption span").slideUp("fast")});this.$find(".bottompart").empty().append((new twttr.components.LanguageLinks()).$node.fadeIn()).append((new twttr.components.Footer()).$node);this.$radial=this.$find(".radial ul");var offset=0;this.$radial.children("li").each(function(){$(this).attr("data-item-offset",offset++)});this.nextOffset=offset;$("#front-container").delegate("a","mousedown",function(){var $this=$(this),id=$this.attr("data-user-id");if(id){trackClient({section:"main",component:"random_sul",action:"profile_click"},{item_ids:[parseInt(id)],item_count:1})}else{if($this.attr("href").match("toptweets")){trackClient({section:"main",component:"toptweets",action:"click"})}}});var $signupForm=this.$find(".front-signup");$signupForm.find("form").submit(function(){trackClient({section:"signup_callout",component:"form",action:"signup_click"})});$signupForm.find("input[type=text], input[type=password]").focus(function(){trackClient({section:"signup_callout",component:$(this).attr("name").split(/[\[|\]]/)[1],action:"focus_field"})});this.$find("div.search form").submit(function(){trackClient({section:"main",component:"search_field",action:"search"},{query:this.q.value})});this.$find("div.front-signin form").submit(function(){trackClient({section:"login_callout",component:"form",action:"login_click"})});var that=this;$("#front-container").bind("mouseup",function(e){var u=e.altKey&&e.shiftKey&&(function(x,y){var map={twitter:[158,49],gaarf:[458,122]};for(var k in map){var kX=map[k][0]-10,kY=map[k][1]-10;if(x>kX&&x<kX+20&&y>kY&&y<kY+20){return k}}})(e.layerX,e.layerY);if(u){twttr.API.User.find(u,function(me){that.avatarRotatePool=twttr.map(that.avatarRotatePool,function(o){return twttr.merge(o,me.attributes)})});var deg=0,el=that.$find("h1");(function tr(){var r=(deg+=20)<=360?"rotate("+deg+"deg)":"";el.css({"-moz-transform":r,"-webkit-transform":r});if(r){setTimeout(tr,33)}})()}});this.profiler.done()}).addOnSwitchTo(function(){twttr.$elements.page.css("padding-top","");var that=this;$(window).bind("resize.frontPage",function(){that._addRadialItemsAsNeeded()});if(this.avatarRotatePool){(function rotate(){that._rotateRandomAvatar(function(){var d=that.ROTATE_DELAY;that._wait=setTimeout(rotate,d+that._rand(d*2))})})()}}).addOnSwitchAway(function(){twttr.themes.loadDefaultTheme();$(window).unbind("resize.frontPage");clearTimeout(this._wait)}).methods({index:function(args,params){if(params.in_reply_to_status_id){twttr.router.routeTo(twttr.router.loginRedirectPath({redirect_after_login:"/"+window.location.search}));return }this.updatePageTitle(_("Twitter"));twttr.themes.loadFrontPageTheme();this._addRadialItemsAsNeeded()},_addRadialItemsAsNeeded:function(){var needed=Math.ceil(Math.min($(window).width(),2600)/48),missing=needed-this.nextOffset;while(missing>0){var o=this.nextOffset++;this._insertRadialItem(o);missing--;if(o){this._insertRadialItem(-o);missing--}}},_insertRadialItem:function(offset){var abs=Math.abs(offset),op="append",poolSize=this.avatarPool.length;while(abs>=poolSize){abs-=poolSize}if(offset<0){op="prepend";abs=poolSize-abs-1}new twttr.views.FrontRadialItem($.extend(this.avatarPool[abs],{offset:abs})).render(this.$radial,op)},_rotateRandomAvatar:function(cb){if(!this.$radial){return cb()}var selector="li.rotated";if(!this.$radial.hasClass("reverting")){var rotating=true,selector="li:not(.rotated)"}var $candidates=this.$radial.children(selector),$toReplace=$candidates.eq(this._rand($candidates.size()));if($toReplace.size()){var offset=$toReplace.attr("data-item-offset"),sugg=this[rotating?"avatarRotatePool":"avatarPool"][offset],view=new twttr.views.FrontRadialItem($.extend(sugg,{offset:offset})),$item=view.render($toReplace,"replaceWith");$item.find("img").hide().fadeIn("slow",cb);if(rotating){$item.addClass("rotated")}}else{this.$radial.toggleClass("reverting");cb()}},_rand:function(m){return Math.floor(Math.random()*m)},_keypress:{"/":function(){this.$find(".search input").focus()}}});twttr.klass.page("twttr.components.pages.Login").view(twttr.views.LoginPage).addBeforeRender(function(){this.updatePageTitle(_("Sign in to Twitter"));twttr.themes.clear()}).addAfterRender(function(){if(twttr.loggedIn){twttr.showMessage(_("You are already logged in!"));twttr.router.routeTo(twttr.router.homePath())}else{twttr.helpers.addFormEvents(this.$find("form.signin"));this.$find(".bottompart").append((new twttr.components.LanguageLinks()).$node).append((new twttr.components.Footer()).$node);var $username=this.$find(".username input").focus();setTimeout(function(){$username.focus()},1)}this.profiler.done()}).methods({noAutoRender:true,index:function(args,params){this.render({redirect_after_login:this._getRedirectAfterLogin(args,params)});trackClient({section:"",component:"",action:"impression"},"login")},error:function(args,params){this.render({redirect_after_login:this._getRedirectAfterLogin(args,params)});if(!twttr.loggedIn){if(args.error=="captcha"){this._addCaptcha();twttr.showMessage(_("We gotta check... are you human?"));trackClient({section:"form",component:"captcha",action:"show"},"login")}else{twttr.showError(_("Wrong Username/Email and password combination."));trackClient({section:"form",component:"username_password",action:"validation_error"},"login")}}},_getRedirectAfterLogin:function(args,params){var url=args.redirect_after_login||params.redirect_after_login;if(!url||!url.match(/^\/[^\/]/)){url=false}return url},_addCaptcha:function(){var that=this;using("http://www.google.com/recaptcha/api/js/recaptcha_ajax.js",function(){Recaptcha.create("6LfbTAAAAAAAAE0hk8Vnfd1THHnn9lJuow6fgulO",that.$find(".signin .captcha")[0],{lang:twttr.pageLocale,theme:"white"})})}});twttr.klass.page("twttr.components.pages.Logout").view(twttr.views.LogoutPage).addAfterRender(function(){twttr.helpers.addFormEvents(this.$find("form.signout"));this.$find(".cancel").click(function(){twttr.router.routeTo(twttr.router.homePath());return false});this.$find(".bottompart").append((new twttr.components.LanguageLinks()).$node).append((new twttr.components.Footer()).$node);this.profiler.done()}).methods({index:function(args,params){if(!twttr.loggedIn){if(twttr.decider.isAvailable("mobile_download_gallery_logged_out")){return twttr.router.routeTo(twttr.router.mobileGalleryPath()+"?logged_out=1")}else{return twttr.router.routeTo(twttr.router.indexPath())}}this.updatePageTitle(_("Twitter / Sign out of Twitter"));twttr.themes.clear()}});twttr.klass("twttr.components.pages.Profile").subclassOf(twttr.components.Page).mixin(twttr.mixins.streamablePage).mixin(twttr.mixins.profileHelper).view(twttr.views.ProfilePage).containerCssClass("profile-container").click({".stream-tab-lists":function(event,$target){if($(event.target).is(".tab-text, .tab-text *")){twttr.viewHelpers.superListDropdown(twttr.profileUser,$target,function(dropdown){dropdown.render($target,"append");dropdown.open()})}},".stream-tab-following.dropdown-link":function(event,$target){if(!this._isSocialContextAvailable()){return }event.preventDefault();if(this._followingDropDown){return }var profileName=twttr.profileUser.screenName;if($(event.target).hasClass("tab-text")){this._followingDropDown=new twttr.control.Dropdown($target,{itemView:"StreamLink",items:[{name:_("All following"),href:twttr.router.userFollowingPath({screen_name:profileName})},{name:_("You both follow"),href:twttr.router.youBothFollowPath({screen_name:profileName})}]});this._followingDropDown.render($target,"append");this._followingDropDown.open()}},".stream-tab-followers.dropdown-link":function(event,$target){if(!this._isSocialContextAvailable()){return }var profileName=twttr.profileUser.screenName;if(this._followersDropDown){return }if($(event.target).hasClass("tab-text")){this._followersDropDown=new twttr.control.Dropdown($target,{itemView:"StreamLink",items:[{name:_("All followers"),href:twttr.router.userFollowersPath({screen_name:profileName})},{name:_("Followers you follow"),href:twttr.router.followersYouFollowPath({screen_name:profileName})}]});this._followersDropDown.render($target,"append");this._followersDropDown.open()}}}).methods({userWasBlocked:function(e,user){if(user.screenName===twttr.profileUser.screenName){$(".profile-actions-container .direct-message-action").remove()}},_isSocialContextAvailable:function(){return twttr.decider.isAvailable("social_context")&&twttr.currentUser&&twttr.currentUser.id!=twttr.profileUser.id},_defaultedScreenName:function(screenName){return !screenName&&twttr.currentUser?twttr.currentUser.screenName:screenName},profile:function(params){var that=this;var screenName=params.screen_name;this.loading(screenName);this.getUserInfo(screenName,function(){that.updatePageTitle(_("{{{fullName}}} ({{{screenName}}}) on Twitter",{fullName:that.profileUser.name,screenName:screenName}));that._highlightNavIfCurrentUser(screenName);that._switchToStream({screenName:screenName,stream:twttr.streams.User,tab:"tweets"})})},message:function(params){this.profile(params);params=params||{};twttr.API.User.find(params.screen_name,function(user){twttr.dialogs.dmSingle({user:{screenName:params.screen_name,user_id:user.attributes.id,name:user.attributes.name,profile_image_url:user.attributes.profile_image_url},origin:params.origin}).open()})},favorites:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.getUserInfo(screenName,twttr.bind(this,function(){if(twttr.helpers.canViewUser(this.profileUser)){this.updatePageTitle(_("Twitter / {{{screenName}}}'s Favorites",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.Favorites,tab:"favorites"})}else{twttr.router.routeTo(twttr.router.profilePath({screen_name:this.profileUser.screenName}))}}))},followers:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.updatePageTitle(_("Twitter / People who follow {{{screenName}}}",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.Followers,tab:"followers"})},following:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.updatePageTitle(_("Twitter / People {{{screenName}}} is following",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.Friends,tab:"following"})},youBothFollow:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.getUserInfo(screenName,twttr.bind(this,function(){this.updatePageTitle(_("Twitter / People you and @{{{screenName}}} both follow",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);var scribbler=twttr.Scribbler.clientEvent.spawn({profile_id:function(){return twttr.profileUser.id},context:"profile",event_info:"following_social_context"});scribbler.scribe({action:"impression"});this._switchToStream({screenName:screenName,stream:twttr.streams.SocialContextStream,socialContextType:"followsInCommonWith",tab:"following",scribbler:scribbler})}))},followersYouFollow:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.getUserInfo(screenName,twttr.bind(this,function(){this.updatePageTitle(_("Twitter / People you follow who follow @{{{screenName}}}",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);var scribbler=twttr.Scribbler.clientEvent.spawn({profile_id:function(){return twttr.profileUser.id},context:"profile",event_info:"followers_social_context"});scribbler.scribe({action:"impression"});this._switchToStream({screenName:screenName,stream:twttr.streams.SocialContextStream,socialContextType:"followingFollowersOf",tab:"followers",scribbler:scribbler})}))},lists:function(params){var screenName=this._defaultedScreenName(params.screen_name);this.getUserInfo(screenName,twttr.bind(this,function(){if(twttr.helpers.canViewUser(this.profileUser)){this.updatePageTitle(_("Twitter / {{{screenName}}}'s Lists",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.OwnLists,tab:"lists"})}else{twttr.router.routeTo(twttr.router.profilePath({screen_name:this.profileUser.screenName}))}}))},memberships:function(params){var screenName=params.screen_name;this.updatePageTitle(_("Twitter / Lists following {{{screenName}}}",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.Memberships,tab:"lists"})},subscriptions:function(params){var screenName=params.screen_name;this.updatePageTitle(_("Twitter / Lists {{{screenName}}} is following",{screenName:screenName}));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.Subscriptions,tab:"lists"})},followerRequests:function(params){var screenName=this._defaultedScreenName(params.screen_name);if(!twttr.helpers.isCurrentUser(screenName)){twttr.router.routeTo(twttr.router.profilePath({screen_name:screenName}))}else{this.updatePageTitle(_("Twitter / My follower requests"));this._highlightNavIfCurrentUser(screenName);this._switchToStream({screenName:screenName,stream:twttr.streams.FollowerRequests,tab:"pending"});if(!this.didBindUserBlockedEvent){this.didBindUserBlockedEvent=true;var that=this;twttr.API.User.bind("block",function(){that.streamManager.resetCache()})}}},_addAdminTools:function(){if(twttr.admin&&!twttr.helpers.isCurrentUser(this.profileUser)){var that=this;using(">defaultViews",function(){twttr.admin.addToolsFor(that.profileUser.screenName,that.profileUser.id)})}},_addPromotedData:function(){if(twttr.promotedAccount&&twttr.promotedAccount.id==this.profileUser.id){this.profileUser=twttr.anywhere.api.util.PromotedStore.getPromotedUserInstance(this.profileUser,twttr.promotedAccount.impressionId);twttr.promotedAccount=null}},_highlightNavIfCurrentUser:function(screenName){var isCurrentUser=twttr.helpers.isCurrentUser(screenName);var globalTab=isCurrentUser?"profile":"";this.highlightGlobalNav(globalTab)},_switchToStream:function(params){var that=this;this.loading(params.screenName);this.getUserInfo(params.screenName,function(){that._addPromotedData();if(that._renderedScreenName!==params.screenName){that._renderPage()}else{twttr.themes.loadUserStyleFor(that.profileUser)}that.streamManager.switchTo(params.stream,{canViewUser:twttr.helpers.canViewUser(that.profileUser),screenName:params.screenName,title:params.title,socialContextType:params.socialContextType,scribbler:params.scribbler});twttr.components.JapaneseAd.refreshAds();that.profiler.done()});this.focusStreamTab(params.tab)},loading:function(screenName){this.unfocusStreamItem();if(this._renderedScreenName!==screenName){if(this.streamManager&&this.streamManager.getCurrent()){this.streamManager.getCurrent().$node.detach()}this.$node.children().empty();$(".tipsy").remove()}},_renderPage:function(){twttr.themes.loadUserStyleFor(this.profileUser);this._addAdminTools();this.render({social_context:this._isSocialContextAvailable()});this.renderUserInfo();this._followingDropDown=null;this._followersDropDown=null;this._renderedScreenName=this._screenName},listDeleted:function(list){this.streamManager.getCurrent().remove(list.uri)},listUpdated:function(list){window.location.reload()},dashStatsTitle:function(){return twttr.helpers.isCurrentUser(twttr.profileUser)?_("About you"):null},getUserInfo:function(screenName,cb){this._screenName=screenName;var findMethod;if(!twttr.loggedIn&&twttr.decider.isAvailable("profile_combined_api")){findMethod=twttr.API.User.findForProfile}else{findMethod=twttr.API.User.find}var getUserInfoProfiler=new twttr.util.Profiler(this.constructor._namespace+".getUserInfo");this.profiler.waitFor(getUserInfoProfiler);findMethod.call(twttr.API.User,this._screenName,{success:twttr.bind(this,function(profileUser){getUserInfoProfiler.done();this.profileUser=twttr.profileUser=profileUser;cb&&cb()}),error:twttr.bind(this,function(e){getUserInfoProfiler.done();this.profiler.done();if(e.status==403){this.trigger("suspended")}else{this.trigger("notFound")}})})},renderUserInfo:function(){var that=this,profileUser=this.profileUser;this.panes.push(new twttr.views.Dashboard("profile.dashboard",profileUser.attributes));var profileActions=new twttr.components.ProfileActions(profileUser);profileActions.$node.appendTo(this.$find(".profile-actions-container"));this.profiler.waitFor(profileActions);twttr.viewHelpers.addMapLink(profileUser.location,this.$node.find(".profile-info .screen-name-and-location"))},getNoobDashboardComponents:function(noobLevel){var out=[],u=twttr.profileUser;out.push(new twttr.components.DashboardProfileStats(u,this.dashStatsTitle()));var noob=twttr.constants.noob;switch(noobLevel){case noob.invited:case noob.silent:case noob.popular:case noob.struggling:out.push(new twttr.components.RecentProfileActivity(u));break;case noob.friendless:case noob.lonely:out.push(new twttr.components.RecentlyFollowed());break;case noob.total:case noob.talking:default:}out.push(new twttr.components.GettingStarted(noobLevel));return out},noAutoRender:true}).addOnSwitchAway(function(){if(twttr.admin){twttr.admin.removeTools()}twttr.API.User.unbind("block",this.userWasBlocked)}).addAfterRender(function(){if(!twttr.loggedIn&&twttr.profileUser){trackClient({section:"",component:"",action:"impression"},{profile_id:twttr.profileUser.id,context:"profile"})}this.addDashboardComponent(new twttr.components.JapaneseAd());if(!twttr.loggedIn){this.addDashboardComponent(new twttr.components.SignupCallOut("profile",twttr.profileUser))}var noobLevel=twttr.helpers.userNoobLevel(twttr.currentUser),isOwnProfile=twttr.helpers.isCurrentUser(twttr.profileUser),components;if(isOwnProfile&&noobLevel>=twttr.constants.noob.total){components=this.getNoobDashboardComponents(noobLevel)}else{components=[new twttr.components.DashboardProfileStats(twttr.profileUser,this.dashStatsTitle())];if(this._isSocialContextAvailable()){components.push(new twttr.components.SocialContext())}var recentActivity=new twttr.components.RecentProfileActivity(twttr.profileUser);if(!twttr.isNarrow){components.push(recentActivity)}if(twttr.loggedIn&&twttr.decider.isAvailable("whotofollow_similarities")){components.push(new twttr.components.UserRecommendations(twttr.profileUser.screenName))}if(twttr.isNarrow){components.push(recentActivity)}twttr.API.User.bind("block",this.userWasBlocked)}this.addDashboardComponents(components);this.addDashboardComponents([new twttr.components.Footer()])});twttr.klass("twttr.components.pages.List").subclassOf(twttr.components.Page).mixin(twttr.mixins.streamablePage).view(twttr.views.ListPage).methods(twttr.EventProvider).methods({list:function(params){params=twttr.util.camelizeObject(params);this.updatePageTitle(_("Twitter / @{{{screenName}}}/{{{listSlug}}}",params));this.switchToStream(twttr.streams.List,params);this.focusStreamTab("tweets")},members:function(params){params=twttr.util.camelizeObject(params);this.updatePageTitle(_("Twitter / @{{{screenName}}}/{{{listSlug}}} - Following",params));this.switchToStream(twttr.streams.ListMembers,params);this.focusStreamTab("members")},followers:function(params){params=twttr.util.camelizeObject(params);this.updatePageTitle(_("Twitter / @{{{screenName}}}/{{{listSlug}}} - Followers",params));this.switchToStream(twttr.streams.ListFollowers,params);this.focusStreamTab("followers")},noAutoRender:true,listDeleted:function(list){twttr.router.routeTo(twttr.router.userListsPath({screen_name:twttr.currentUser.screenName}))},listUpdated:function(list){twttr.router.routeTo(twttr.router.userListPath({screen_name:twttr.currentUser.screenName,list_slug:list.slug}))},_getList:function(cb){var that=this;if(!this.listOwnerName||!this.listId){throw"You tried to use _getList before defining .listOwnerName and .listId"}twttr.API.User.find(this.listOwnerName,function(user){user.lists.find(that.listId,function(list){cb(list,user)})})},switchToStream:function(Stream,params){var that=this;var errorCb=function(){that.trigger("notFound")};this.loading(params.screenName,params.listSlug);twttr.API.User.find(params.screenName,{success:function(user){twttr.profileUser=user;user.lists.find(params.listSlug,{success:function(list){that.listId=list.id;that.listOwnerName=list.user.screenName;that._listSlug=list.slug;that.fullName=list.fullName;var listView=new twttr.views.List(list);twttr.themes.loadUserStyleFor(list.user);that.render({list:listView});that.streamManager.switchTo(Stream,params)},error:errorCb})},error:errorCb})},loading:function(screenName,listSlug){this.unfocusStreamItem();if(this._listSlug!==listSlug&&this.listOwnerName!==screenName){this.$node.children().empty()}},renderListInfo:function(){if(twttr.loggedIn){this._getList(twttr.bind(this,function(list){new twttr.views.ListActions(list).render(this.$node.find(".list-actions-component"),"append");this.profiler.done()}))}},onListFollowingChange:function(){this.$node.find(".list-actions").remove();this.renderListInfo()}}).addAfterRender(function(){var that=this;this._getList(function(list,owner){that.owner=owner;if(!twttr.loggedIn&&that.owner){trackClient({section:"",component:"",action:"impression"},{profile_id:that.owner.id})}if(!twttr.loggedIn){that.addDashboardComponent(new twttr.components.SignupCallOut("list",owner))}that.addDashboardComponents([new twttr.components.NewestListMembers(list),new twttr.components.MoreLists(list),new twttr.components.Footer()])});this.renderListInfo()});twttr.klass("twttr.components.pages.Permalink").subclassOf(twttr.components.Page).view(twttr.views.PermalinkPage).methods({permalink:function(params){var that=this;this.tweetId=params.id;this.loading();twttr.API.Status.find(params.id,{success:function(tweet){that.updatePageTitle(_("Twitter / @{{{fullName}}}: {{{truncatedText}}} ...",{fullName:tweet.user.name,truncatedText:tweet.text.slice(0,26)}));twttr.themes.loadUserStyleFor(tweet.user);that.render();that.tweetComponent=new twttr.components.PermalinkTweet(tweet);that.tweetComponent.$node.appendTo(that.$find(".components-middle"));that.tweetComponent.bind("deleted",function(){if(that===twttr.app.currentPage()){twttr.router.routeTo(twttr.router.homePath())}});var inReplyTo=new twttr.components.InReplyTo(tweet);if(params.photo_index&&!twttr.decider.isAvailable("phoenix_photo_permalink")){that.trigger("notFound")}new twttr.components.Media(tweet,that.$find(".permalink").width(),parseInt(params.photo_index,10)).$node.appendTo(that.$find(".tweet-media-container"));var tweetGeoSmall=new twttr.components.TweetGeoSmall(tweet);var retweeters=new twttr.components.Retweeters(tweet);var mentionedInTweet=new twttr.components.MentionedInTweet(tweet);mentionedInTweet.$node.appendTo(that.$find(".components-below"));retweeters.$node.appendTo(that.$find(".components-below"));inReplyTo.$node.appendTo(that.$find(".components-above"));tweetGeoSmall.$node.appendTo(that.$find(".components-below"));that.profiler.waitFor(inReplyTo);that.profiler.waitFor(retweeters);that.profiler.waitFor(mentionedInTweet);that.profiler.done()},error:function(e){if(e.status==403){twttr.router.one("routed",function(){twttr.showError(_("Sorry, you are not authorized to see this status."))});twttr.router.routeTo(twttr.router.profilePath({screen_name:params.screen_name}))}else{that.trigger("notFound")}that.profiler.done()}})},loading:function(){this.$find(".permalink").empty()}}).methods({noAutoRender:true}).containerCssClass("permalink-container").click({".geo_map_tweets_at_this_place_link":function(event,$target){var placeId=$target.attr("data-place-id");var placeName=$target.attr("data-place-name");if(placeId&&placeName){twttr.router.routeTo(twttr.router.placeTweetSearchPath({place_id:placeId,place_name:placeName}))}event.stopPropagation();event.preventDefault();return false},".tweet-geo-text":function(event,$target){var placeId=$target.attr("data-place-id");if(placeId){twttr.router.routeTo(twttr.router.placePath({place_id:placeId}))}event.stopPropagation();event.preventDefault();return false}}).keydown({f:function(e){if($(e.target).is(":not(input)")){this.tweetComponent.faveTweet("keyboard")}},r:function(e){if($(e.target).is(":not(input)")){this.tweetComponent.replyTweet("keyboard");e.preventDefault()}},t:function(e){if($(e.target).is(":not(input)")){this.tweetComponent.retweetTweet("keyboard")}}});twttr.klass.page("twttr.components.pages.WhoToFollow",function(){twttr.components.Page.apply(this,arguments);this.dashboardNeedsToBeCreated=false}).mixin(twttr.mixins.streamablePage).mixin(twttr.mixins.discoveryHelper).view(twttr.views.WhoToFollow).addAfterRender(function(){var that=this;this._createDashboard(true);twttr.helpers.addFormEvents(this.$find(".who-to-follow-header form"),function(){var v=this.q.value;if(v!=""){that.routePageTo(that.PATH_ROOT,"Search",{query:v})}});twttr.API.User.bind("follow follow_request",twttr.bind(this,function(event,user){var step,audit=twttr.audit.trail(),route=audit[0];if(route.action=="profile"){route=audit[1]}if(route&&route.type=="route"&&(step=twttr.components.pages.WhoToFollow.ROUTES_TO_STEP[route.action])){var data={step:step,followed_user_id:user.id,experiment_name:route.page=="welcome"?"new_signup_flow":"find_people",followed_in_this_action:1};if(twttr.constants.regexps.suggestionCategoryPath.test(route.path)){data.category_slug=decodeURIComponent(RegExp.$2)}if(twttr.constants.regexps.userSearchPath.test(route.path)){data.query=decodeURIComponent(RegExp.$2)}scribble("find_users_follow_user",data,"www_ab_tests")}}));this.profiler.done()}).addOnSwitchTo(function(){this._createDashboard();this.highlightGlobalNav("whotofollow");trackClient({section:"",component:"",action:"impression"})}).addOnSwitchAway(function(){twttr.API.User.unbind("follow.RecentlyFollowedComponent");twttr.recentlyViewedUsers.unbind("push.RecentlyViewedComponent");this.dashboardNeedsToBeCreated=true;this.$find(".dashboard > .component").remove()}).statics({ROUTES_TO_STEP:{whoToFollow:"suggestions",suggestions:"suggestions",interests:"interests",category:"interests","import":"import",matches:"import",search:"search"}}).methods({switchToStream:function(){var stream=this.streamManager.switchTo.apply(this.streamManager,arguments);this.profiler.done();return stream},search:function(params,queryString){if(!twttr.loggedIn){return this.trigger("loginRequired")}var query=params.query||queryString.q;if(!query){return this.routePageTo(this.PATH_ROOT)}this._switchTabAndRender(null,query);this.updatePageTitle(_("Twitter / User Search"));trackClient({action:"impression"},{context:"search",query:query});var scribbler=twttr.Scribbler.clientEvent.spawn({context:"search",query:query});this.switchToStream(twttr.streams.PeopleSearch,{query:query,scribbler:scribbler,pathRoot:this.PATH_ROOT})},suggestions:function(params,queryString){if(!twttr.loggedIn){return this.trigger("loginRequired")}this._switchTabAndRender("suggestions");this.updatePageTitle(_("Twitter / Who to follow / Suggestions"));trackClient({action:"impression"},"suggestions");var scribbler=twttr.Scribbler.clientEvent.spawn({context:"suggestions"});if(twttr.decider.isAvailable("whotofollow_recommendations")){var stream=this.switchToStream(twttr.streams.UserRecommendationsStream,{scribbler:scribbler,pathRoot:this.PATH_ROOT});if(stream){stream.setStreamManager(this.streamManager)}}else{twttr.Router.redirectTo(twttr.router.findUsersInterestsPath())}},interests:function(params,queryString){if(!twttr.loggedIn&&this.PATH_ROOT=="welcome"){return this.trigger("loginRequired")}this._switchTabAndRender("interests");this.updatePageTitle(_("Twitter / Who to follow / Interests"));trackClient({action:"impression"},"interests");var scribbler=twttr.Scribbler.clientEvent.spawn({context:"interests"});var opts={scribbler:scribbler,pathRoot:this.PATH_ROOT};this.switchToStream(twttr.streams.SuggestionCategoriesStream,this.localizeQuery(opts,queryString))},category:function(params,queryString){if(!twttr.loggedIn&&this.PATH_ROOT=="welcome"){return this.trigger("loginRequired")}var that=this;var switchToCategoryStream=function(categoryObj){if(!categoryObj){return that.routePageTo(that.PATH_ROOT,"Interests")}var scribbler=twttr.Scribbler.clientEvent.spawn({context:"interests",query:categoryObj.slug});that._switchTabAndRender("interests");that.updatePageTitle(_("Twitter / Who to follow / Interests / {{{category}}}",{category:categoryObj.name}));that.switchToStream(twttr.streams.SuggestionCategoryMembersStream,that.localizeQuery({category:category,suggestionCategory:categoryObj,scribbler:scribbler,pathRoot:that.PATH_ROOT},queryString))};var category=params.category||queryString.category;trackClient({action:"impression"},{query:category,context:"interests"});var catMap=twttr.streams.SuggestionCategoriesStream.CATEGORY_MAP;if(catMap){switchToCategoryStream(catMap[category])}else{twttr.API.SuggestionCategory.getAll(this.localizeQuery({success:function(categories){categories=twttr.streams.SuggestionCategoriesStream.filterTopTweetsCategories(categories);twttr.streams.SuggestionCategoriesStream.cacheCategories(categories);var catObj=twttr.streams.SuggestionCategoriesStream.CATEGORY_MAP[category];switchToCategoryStream(catObj)}},queryString))}},"import":function(params,queryString){if(!twttr.loggedIn){return this.trigger("loginRequired")}this._switchTabAndRender("import","","services");this.updatePageTitle(_("Twitter / Who to follow / Find friends"));trackClient({action:"impression"},"import");var scribbler=twttr.Scribbler.clientEvent.spawn({context:"import"});var opts=this.localizeQuery({scribbler:scribbler,pathRoot:this.PATH_ROOT},queryString);var stream=this.switchToStream(twttr.streams.ContactImportServices,opts);if(stream){stream.setStreamManager(this.streamManager)}},matches:function(){if(!twttr.loggedIn){return this.trigger("loginRequired")}this._switchTabAndRender("import","","matches");this.updatePageTitle(_("Twitter / Who to follow / Find friends / Results"));trackClient({action:"impression"},"import");var scribbler=twttr.Scribbler.clientEvent.spawn({context:"import"});this.switchToStream(twttr.streams.ContactImportMatches,{scribbler:scribbler,pathRoot:this.PATH_ROOT})},localizeQuery:function(options,queryString){if(queryString.lang){options.lang=queryString.lang}if(queryString.country){options.country=queryString.country}if(queryString.city){options.city=queryString.city}options.top_tweets=true;return options},PATH_ROOT:"whoToFollow",noAutoRender:true,_createDashboard:function(force){if(force||this.dashboardNeedsToBeCreated){var scribbler=twttr.Scribbler.clientEvent.spawn({context:function(){var action=twttr.audit.currentAction();if(twttr.audit.currentPage()=="welcome"){return twttr.components.pages.Welcome.ROUTES_TO_STEP[action]}else{return twttr.components.pages.WhoToFollow.ROUTES_TO_STEP[action]}}});if(!twttr.loggedIn){this.addDashboardComponents([new twttr.components.SignupCallOut("who_to_follow"),new twttr.components.Footer()])}else{this.addDashboardComponents([new twttr.components.RecentlyFollowed(),new twttr.components.RecentlyViewed(),new twttr.components.InviteFriends(scribbler),new twttr.components.RelatedServices(),new twttr.components.Footer()])}this.dashboardNeedsToBeCreated=false}},_switchTabAndRender:function(tab,query,opt_version){if(!twttr.is.def(this._activeTab)){this.render()}var $searchField=this.$find(".who-to-follow-header form input");if(query){$searchField.val(query).addClass("actasfocused").focus()}else{$searchField.val("").removeClass("actasfocused").blur()}this.focusStreamTab(tab,opt_version);this.$find(".who-to-follow-stream").removeClass().addClass("who-to-follow-stream who-to-follow-"+tab+"-stream");twttr.themes.loadDefaultTheme()}});twttr.klass.page("twttr.components.pages.SimilarTo",function(){twttr.components.Page.apply(this,arguments)}).mixin(twttr.mixins.streamablePage).mixin(twttr.mixins.profileHelper).view(twttr.views.SimilarToPage).methods({index:function(params){var that=this;var screenName=params.screen_name;this.getUserInfo(screenName,function(){that.updatePageTitle(_("Twitter / Similar to @{{{screenName}}}",{screenName:screenName}));twttr.themes.loadUserStyleFor(that.profileUser);that.render();var scribbler=twttr.Scribbler.clientEvent.spawn({context:"similar_to",profile_id:that.profileUser.id});scribbler.scribe({section:"",component:"",action:"impression"});if(twttr.decider.isAvailable("whotofollow_similarities")){that.streamManager.switchTo(twttr.streams.UserRecommendationsStream,{screenName:screenName,scribbler:scribbler});var $stream=that.$find(".stream").addClass("user-similarities-stream")}else{twttr.router.routeTo(twttr.router.profilePath({screen_name:screenName}))}that.profiler.done()})}}).addAfterRender(function(){if(twttr.currentUser&&twttr.currentUser.lang==="ja"){this.addDashboardComponent(new twttr.components.JapaneseAd())}this.addDashboardComponents([new twttr.components.DashboardProfileStats(twttr.profileUser,_("About @{{screen_name}}",{screen_name:twttr.profileUser.screenName})),new twttr.components.RecentProfileActivity(twttr.profileUser)]);this.addDashboardComponents([new twttr.components.Footer()])});twttr.klass("twttr.components.pages.404").subclassOf(twttr.components.Page).view(twttr.views["404Page"]).containerCssClass("error-page").methods({loginRequired:function(params){this.render();this.updatePageTitle(_("Twitter / Login Required"));twttr.themes.loadDefaultTheme()},notFound:function(params){this.render();this.updatePageTitle(_("Twitter / ?"));twttr.themes.loadDefaultTheme()}}).methods({noAutoRender:true}).addAfterRender(function(){twttr.helpers.addFormEvents(this.$find(".user-search-form"),function(){var v=this.q.value;if(v!=""){twttr.router.routeTo(twttr.router.whoToFollowSearchPath({query:v}))}});this.profiler.done()});twttr.klass("twttr.components.pages.Suspended").subclassOf(twttr.components.Page).view(twttr.views.SuspendedPage).containerCssClass("error-page").methods({noAutoRender:true,suspended:function(params){this.render();this.updatePageTitle(_("Twitter / Suspended"));twttr.themes.loadDefaultTheme()}}).addAfterRender(function(){this.profiler.done()});(function(){twttr.klass.page("twttr.components.pages.Place",function(){twttr.components.Page.apply(this,arguments)}).mixin(twttr.mixins.streamablePage).view(twttr.views.PlacePage).addOnSwitchAway(function(){twttr.search.clear()}).addOnSwitchTo(function(){twttr.themes.loadCurrentUserStyle()}).addAfterRender(function(){var that=this;var components=[new twttr.components.PlaceBusiness(that.place),new twttr.components.PlacePeople(that.place),new twttr.components.Footer()];that.addDashboardComponents(components)}).methods({drawMap:function($canvas,place){var that=this;twttr.geo.loadMaps(function(){that.geoMap=new twttr.geo.Map($canvas,{});var marker=null;if(place.geometry){var coordinates=place.geometry.coordinates;if(place.geometry.type=="Polygon"){that.geoMap.addPlacePolygon(coordinates)}else{if(place.geometry.type=="MultiPolygon"){twttr.each(coordinates,function(polygonCoordinates){that.geoMap.addPlacePolygon(polygonCoordinates)})}else{if(place.geometry.type=="Point"){marker=that.geoMap.addPoi(coordinates)}}}}else{if(place.bounding_box){var coordinates=place.bounding_box.coordinates;if(coordinates[0][0]==coordinates[0][2]){marker=that.geoMap.addPoi(coordinates[0][0])}else{that.geoMap.addPlacePolygon(coordinates)}}}if(marker){marker.setZIndex(10)}that.geoMap.adjustBounds(15);$canvas.bind("refreshMap",function(){that.geoMap.resize()});that.addNearbyPoints($canvas)})},addNearbyPoints:function($canvas){var that=this;var center=that.geoMap.getCenter();that.geoMap.createOverlay();twttr.API.Place.search({lat:center.lat(),lon:center.lng(),require_activity:true,granularity:"poi",max_results:15,success:function(apiPlaces){var mapPos=$canvas.position();var $geoMapPlaceBubble=that.$node.find(".geo-map-place-bubble");apiPlaces.reverse().each(function(apiPlace){var place=apiPlace.data();if(place.place_type!="poi"||place.id==that.place.id){return }var coords=place.bounding_box.coordinates[0][0];var turnOn;var onHover=function(isHovering,point){turnOn(isHovering);if(isHovering&&point){$geoMapPlaceBubble.find(".geo-place-title").text(place.name);$geoMapPlaceBubble.find(".geo-place-details").text(twttr.geo.getPlaceDetails(place));$geoMapPlaceBubble.show().css({left:mapPos.left+point.x-$geoMapPlaceBubble.width()/2,top:mapPos.top+point.y,opacity:0.8})}else{$geoMapPlaceBubble.hide()}};var onClick=function(){twttr.router.routeTo(twttr.router.placePath({place_id:place.id}))};turnOn=that.geoMap.addFocusablePoint(coords,onHover,onClick)});that.geoMap.adjustBounds(15,center)}})},enterModeComplete:function(placeId,titleTemplate,mode,place){var that=this;that.place=place;that.updatePageTitle(new titleTemplate({placeName:place.name,poi:place.place_type=="poi"}).html());place.show_map=!!(place.geometry||place.bounding_box);that.render(place);if(place.show_map){that.drawMap($("#geo_place_page_map_canvas"),place)}that.streamManager.switchTo(twttr.streams.Search,{query:"place:"+placeId,pretty_query:place.name,mode:mode,hideTitle:true});that.profiler.done();that.focusStreamTab(mode)},enterMode:function(placeId,titleTemplate,mode){var that=this;twttr.API.Place.find(placeId,{success:function(apiPlace){that.enterModeComplete(placeId,titleTemplate,mode,twttr.geo.getFullPlace(apiPlace.data()))},error:function(req){if(req.status===404){that.profiler.done();that.trigger("notFound")}else{that.enterModeComplete(placeId,titleTemplate,mode,{name:_("this place"),place_type:"poi",id:placeId,place_id:placeId,location_service_down:true})}}})},tweets:function(params){this.enterMode(params.place_id,twttr.views.PlacePageTweetsTitle,"tweets")},links:function(params){this.enterMode(params.place_id,twttr.views.PlacePageLinksTitle,"links")},noAutoRender:true})}());(function(){twttr.klass.page("twttr.components.pages.PlaceUsers",function(){twttr.components.Page.apply(this,arguments)}).mixin(twttr.mixins.streamablePage).view(twttr.views.PlaceUsersPage).addOnSwitchAway(function(){twttr.search.clear()}).addOnSwitchTo(function(){twttr.themes.loadCurrentUserStyle()}).addAfterRender(function(){var that=this;var components=[new twttr.components.PlaceBusiness(that.place),new twttr.components.Footer()];that.addDashboardComponents(components)}).methods({enterModeComplete:function(placeId,titleTemplate,mode,place){var that=this;that.place=place;that.updatePageTitle(new titleTemplate({placeName:place.name,poi:place.place_type=="poi"}).html());place.show_map=!!(place.geometry||place.bounding_box);place.place_id=place.id;that.render(place);that.streamManager.switchTo(twttr.streams.PlaceUsers,{placeId:placeId,onlyFollowing:(mode==="following")});that.focusStreamTab(mode);that.profiler.done()},enterMode:function(placeId,titleTemplate,mode){var that=this;twttr.API.Place.find(placeId,{success:function(apiPlace){that.enterModeComplete(placeId,titleTemplate,mode,twttr.geo.getFullPlace(apiPlace.data()))},error:function(req){if(req.status===404){that.trigger("notFound")}else{that.enterModeComplete(placeId,titleTemplate,mode,{name:_("this place"),place_type:"poi",id:placeId,place_id:placeId,location_service_down:true})}}})},all:function(params){this.enterMode(params.place_id,twttr.views.PlacePageUsersTitle,"all")},following:function(params){this.enterMode(params.place_id,twttr.views.PlacePageUsersFollowingTitle,"following")},noAutoRender:true})}());twttr.klass("twttr.components.pages.RateLimit").subclassOf(twttr.components.Page).view(twttr.views.RateLimitPage).methods({tooMuch:function(params){this.render();this.updatePageTitle(_("Twitter / Error"));twttr.themes.loadDefaultTheme()}}).methods({noAutoRender:true}).addAfterRender(function(){this.profiler.done()}).containerCssClass("four-twenty-container");twttr.klass.page("twttr.components.pages.Welcome",function(){twttr.components.Page.apply(this,arguments);this.dashboardNeedsToBeCreated=false;this.warmSignupAvailable=twttr.loggedIn&&twttr.decider.isAvailable("welcome_warm_signup")&&twttr.currentUser.friendsCount}).subclassOf(twttr.components.pages.WhoToFollow).view(twttr.views.Welcome).click({".dashboard a.user-profile-link":function(event,$target){this.loadItemInDetailsPane(twttr.helpers.getUserIdentifier($target),"user");event.stopPropagation();event.preventDefault()}}).addOnSwitchAway(function(){if(this._bannerPaddingTop){$("#page-outer").css("padding-top",this._bannerPaddingTop)}}).addOnSwitchTo(function(){if(twttr.loggedIn){var $pageOuter=$("#page-outer");this._bannerPaddingTop=$pageOuter.css("padding-top");$pageOuter.css({paddingTop:60})}}).addAfterRender(function(){var that=this;this.$find(".welcome-footer, .welcome-header").delegate(".next-step a, .prev-step a","click",function(e){var $link=$(this);var newStep="finished";var route=twttr.router.findMatchingRoute($link.attr("href"));var newAction=route&&route.fn&&route.fn.actionName;if(newAction){newStep=(that.constructor.ROUTES_TO_STEP[newAction]||"finished")}var step=that.constructor.ROUTES_TO_STEP[twttr.audit.currentAction()];var scribeTerms={section:($link.parents(".welcome-footer").length?"footer":"header"),component:($link.parent().hasClass("next-step")?"forward":"backward"),action:"click"};trackClient(scribeTerms,{context:step,event_info:newStep});if(newStep=="finished"){var currentStream=that.streamManager.getCurrent();if(currentStream&&currentStream.showInviteesPopup){currentStream.inviteOthers(true)}else{twttr.router.routeTo(twttr.router.homePath())}}});this.profiler.done()}).statics({ROUTES_TO_STEP:{welcome:"starter",interests:"interests",category:"interests","import":"import",matches:"import",search:"search",starter:"starter"}}).methods({starter:function(params,queryString){if(!twttr.loggedIn){return this.trigger("loginRequired")}if(!this.warmSignupAvailable){return this.routePageTo(this.PATH_ROOT,"Interests")}this._switchTabAndRender("starter");this.updatePageTitle(_("Twitter / Suggestions"));var that=this;twttr.currentUser.friends().first(function(ambassador){var scribeData={profile_id:ambassador.id,context:"starter"};(new twttr.views.WelcomeAmbassador(ambassador)).render(that.$find(".welcome-ambassador"),"html");ambassador.lists(function(lists){that.$find(".who-to-follow-stream").show();var starterList=lists.find(function(list){return list.description.match(/\#WelcomeToTwitter/i)});var opts={screenName:ambassador.screenName,pathRoot:that.PATH_ROOT};if(starterList){opts.scribbler=that._createScribbler("list_stream",scribeData);that.streamManager.switchTo(twttr.streams.StarterList,twttr.merge(opts,{list:starterList}))}else{twttr.profileUser=ambassador;if(ambassador.friendsCount<2||ambassador.friendsCount>50){opts.scribbler=that._createScribbler("similarities_stream",scribeData);that.streamManager.switchTo(twttr.streams.UserRecommendationsStream,opts)}else{opts.scribbler=that._createScribbler("friends_stream",scribeData);that.streamManager.switchTo(twttr.streams.StarterFriends,opts)}}opts.scribbler&&opts.scribbler.scribe({action:"impression"})})})},focusStreamTab:function(tab,opt_version){if(this._activeTab){this._previousTab=this._activeTab}this._activeTab=tab;this.$find(".welcome-ambassador").empty();var $header=this.$find(".welcome-steps ol"),$search=this.$find(".welcome-search").show(),$stream=this.$find(".who-to-follow-stream").show(),footCntxt={};$header.find("li div").removeClass("active");switch(tab){case"starter":$header.find(".starter div").addClass("active");$search.hide();$stream.hide();footCntxt.step_starter=true;break;case"interests":$header.find(".interests div").addClass("active");if(this.warmSignupAvailable){footCntxt.step_backto_starter=true}footCntxt.step_interests=true;break;case"import":$header.find(".import div").addClass("active");footCntxt.step_previous_interests=true;if(opt_version=="services"){footCntxt.step_skip=true}else{footCntxt.step_finish=true}break;default:if(this._previousTab=="import"){footCntxt.step_backto_import=true}else{footCntxt.step_backto_interests=true}}(new twttr.views.WelcomeFooterSteps(footCntxt)).render(this.$find(".welcome-footer"),"html")},PATH_ROOT:"welcome",_createScribbler:function(sectionTerm,data){var prefixer=function(eventTerms){var terms=twttr.Scribbler.clientAppDefaultTerms();eventTerms=twttr.merge({},eventTerms,{component:sectionTerm});return twttr.Scribbler.clientAppEventNameGenerator(eventTerms,terms)};return twttr.Scribbler.clientEvent.spawn(data,prefixer)},_createDashboard:function(force){if(force||this.dashboardNeedsToBeCreated){this.addDashboardComponents([new twttr.components.RecentlyFollowed(true),new twttr.components.RecentlyViewed()]);this.dashboardNeedsToBeCreated=false}}});twttr.klass("twttr.components.pages.MediaGallery").subclassOf(twttr.components.Page).addAfterRender(function(){}).view(twttr.views.SearchPage).addOnSwitchAway(function(){$("#page-container").show();$("body").removeClass("has-media-gallery");this.$gallery.remove();this.$gallery=null;this.$content=null}).addOnSwitchTo(function(){$("#page-container").hide();this.$gallery=$("<div class='media-gallery-overlay'><div class='media-gallery-content' /></div>").appendTo("#doc");this.$content=this.$gallery.find(".media-gallery-content");$("body").addClass("has-media-gallery")}).keydown({left:function(){if(this._grid&&this._grid.showPrev){this._grid.showPrev()}},right:function(){if(this._grid&&this._grid.showNext){this._grid.showNext()}},esc:function(){this._closeGallery()}}).methods({grid:function(params,queryString){this._query=params.query||queryString.q;this._mode=params.mode;if(this._mode!="videos"&&this._mode!="photos"){twttr.router.routeTo(twttr.router.searchFacetsGridPath({query:this._query,mode:"photos"}))}this._renderControls("grid");if(this._grid){this._grid.$node.remove();this._grid=null}var options={type:"search",mode:this._mode,query:this._query};if(this._mode=="videos"){options.imageWidth=218;options.imageHeight=165;options.margin=3}this._grid=new twttr.components.TheGrid(options,this.$content.width(),this.$gallery.height()-this._controls.$node.height());this._grid.$node.appendTo(this.$content);if(this._mode=="videos"){this._grid.$node.addClass("grid-videos")}this._grid.bind("askForDetails",twttr.bind(this,function(e,url){twttr.router.routeTo(twttr.router.searchFacetsSlideshowPath({query:this._query,mode:this._mode})+"?firstUrl="+encodeURIComponent(url));scribble("facets_grid_click",{url:url,mode:this._mode,query:this._query,userId:(twttr.currentUser)?twttr.currentUser.id:null})}));this.updatePageTitle(_("Twitter / Gallery - {{{query}}}",{query:this._query}))},slideshow:function(params,queryString){var that=this;var firstUrl=queryString.firstUrl||null;this._query=params.query||queryString.q;this._mode=params.mode;if(this._mode!="videos"&&this._mode!="photos"){var url=twttr.router.searchFacetsSlideshowPath({query:this._query,mode:"photos"});if(firstUrl){url=url+"?firstUrl="+encodeURIComponent(firstUrl)}twttr.router.routeTo(url)}this._renderControls("detail");this._displayMode="slideshow";if(this._grid){this._grid.$node.remove();this._grid=null}var mediaSlideshowOptions={type:"search",width:that.$content.width(),height:$(window).height()-300,thumbContainerWidth:880,firstUrl:firstUrl,mediaType:this._mode,mode:this._mode,query:this._query};if(this._mode=="videos"){twttr.merge(mediaSlideshowOptions,{thumbHeight:55,thumbWidth:75,thumbDisplayWidth:77,thumbDisplayHeight:55})}this._grid=new twttr.components.MediaSlideshow(mediaSlideshowOptions);this._grid.$node.appendTo(this.$content);$(window).bind("resize",twttr.bind(this,this.resizeSlideshow));this._grid.bind("mediaRendered",twttr.bind(this,this.resizeSlideshow));this.updatePageTitle(_("Twitter / Gallery - {{{query}}}",{query:this._query}));scribble("facets_slideshow_impression",{mode:this._mode,query:this._query,userId:(twttr.currentUser)?twttr.currentUser.id:null})},resizeSlideshow:function(){if(this._displayMode!="slideshow"||!this.$content){return }var h=$(window).height()-300,w=this.$content.width();if(h<340){h=340}this._grid.resizePicture(h,w)},_renderControls:function(view){var that=this;if(this._controls){this._controls.$node.remove();this._controls=null}this._controls=new twttr.components.MediaGalleryControls({type:"search",query:this._query,mode:this._mode,view:view});this._controls.$node.appendTo(this.$content);this._controls.bind("close",function(){twttr.router.routeTo(twttr.router.searchResultsPath({query:that._query}));scribble("facets_gallery_close",{mode:that._mode,query:that._query,userId:(twttr.currentUser)?twttr.currentUser.id:null});that._closeGallery()});this._controls.bind("detailViewSelected",function(e){twttr.router.routeTo(twttr.router.searchFacetsSlideshowPath({query:that._query,mode:that._mode}));scribble("facets_gallery_mode_switch",{switchedTo:"slideshow",mode:that._mode,query:that._query,userId:(twttr.currentUser)?twttr.currentUser.id:null})});this._controls.bind("gridViewSelected",function(e){twttr.router.routeTo(twttr.router.searchFacetsGridPath({query:that._query,mode:that._mode}));scribble("facets_gallery_mode_switch",{switchedTo:"grid",mode:that._mode,query:that._query,userId:(twttr.currentUser)?twttr.currentUser.id:null})})},_closeGallery:function(){twttr.router.routeTo(twttr.router.searchResultsPath({query:this._query}))}});twttr.klass("twttr.widget.Banner",function(options){this.$node=$("<div/>");this.view=new twttr.views[options.view](options);this.$pageOuter=$("#page-outer");this.$topStuff=$("#top-stuff");this.$node.delegate(".pane-close","click",twttr.bind(this,this.remove))}).methods(twttr.EventProvider).methods({insert:function(){this.view.render(this.$node);$("#banners").append(this.$node);this.$pageOuter.css({"padding-top":this.$topStuff.height()+20});twttr.banners.trigger("resize",[this.$topStuff.height()]);var cp=twttr.app.currentPage();if(cp&&cp.resizeDetailsPane){cp.resizeDetailsPane()}},remove:function(){this.$node.remove();this.$pageOuter.css({"padding-top":this.$topStuff.height()+20});this.trigger("closed");twttr.banners.trigger("resize",[this.$topStuff.height()]);var cp=twttr.app.currentPage();if(cp&&cp.resizeDetailsPane){cp.resizeDetailsPane()}}});twttr.provide("twttr.banners",twttr.augmentObject({pendingNew:0,pendingChanged:1,pendingBouncing:2,stacked:3,nonStacked:4,display:function(){if(twttr.currentUser&&twttr.currentUser.states){var bouncingEmails=[],pendingType=false,states=twttr.currentUser.states;if(!twttr.is.falsy(states.pending_email)){pendingType=this.pendingNew}if(states.bouncing_email){bouncingEmails=twttr.is.array(states.bouncing_email)?states.bouncing_email:[states.bouncing_email]}if(pendingType!==false&&twttr.currentUser.emailAddress){pendingType=this.pendingChanged}if(pendingType!==false&&$.inArray(states.pending_email,bouncingEmails)>=0){pendingType=this.pendingBouncing}if(twttr.currentUser.emailAddress&&$.inArray(twttr.currentUser.emailAddress,bouncingEmails)>=0){var bouncingType=pendingType!==false?this.stacked:this.nonStacked;this.bouncingEmail(bouncingType,twttr.currentUser.emailAddress).insert()}if(pendingType!==false){var bucket=twttr.abdecider.choose("email_verification-18",true);if(!bucket||bucket=="control"){this.verifyEmail(pendingType,states.pending_email).insert()}}if(states.detached_email){this.detachedEmail().insert()}if(states.suspended){this.suspended().insert()}}},detachedEmail:function(){return new twttr.widget.Banner({view:"DetachedEmailBanner"})},verifyEmail:function(pendingType,email){var banner=new twttr.widget.Banner({view:"VerifyEmailBanner",email:email,pendingNew:pendingType==this.pendingNew,pendingChanged:pendingType==this.pendingChanged,pendingBouncing:pendingType==this.pendingBouncing});banner.$node.delegate(".resend-confirmation-email-link","click",function(e){twttr.currentUser.emailResendConfirmation({success:function(data){twttr.showMessage(data.messageForFlash)},error:function(data){twttr.showError(_("Oops!  There was an error sending the confirmation email."))}})});return banner},bouncingEmail:function(bounceType,email){var banner=new twttr.widget.Banner({view:"BouncingEmailBanner",email:email,stacked:bounceType==this.stacked});banner.$node.delegate(".reset-bounce-link","click",function(e){twttr.currentUser.emailBounceReset(function(data){twttr.showMessage(_("Your email notifications should resume shortly."));banner.$node.fadeOut("fast",function(){banner.remove()})})});return banner},suspended:function(){return new twttr.widget.Banner({view:"SuspendedBanner"})},emailAlreadyVerified:twttr.memoizing(function(){var currentEmail;for(var i=0;i<twttr.currentUser.email.length;i++){if(twttr.currentUser.email[i].current){currentEmail=twttr.currentUser.email[i]}}return new twttr.widget.Banner({view:"EmailAlreadyVerifiedBanner",already_verified_message:_("Someone has already confirmed the email {{email}}",{email:currentEmail.address})})}),welcomeToPhoenix:twttr.memoizing(function(){var banner=new twttr.widget.Banner({view:"WelcomeToPhoenixBanner",welcome_search_results_path:twttr.router.searchResultsPath({query:"#NewTwitter"})});return banner}),becameUser:twttr.memoizing(function(){return new twttr.widget.Banner({view:"BecameUserBanner"})})},twttr.EventProvider));twttr.klass.component("twttr.components.Promo").initializer(function(){twttr.API.Promo.random({promo_type:"",limit:1},twttr.bind(this,function(result){if(!$.isEmptyObject(result)){new twttr.views.DashboardPromo({promo:result[0]}).render(this.$node,"append");this.hasRendered()}}))}).click({".promo .definition":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"promo",target:"definition",definition:$target.find("strong").html()};scribble("dashboard_click",logData)}}).statics({shouldProfile:false}).deciderKey("promo_component");twttr.klass.component("twttr.components.RelatedServices").initializer(function(){var that=this;twttr.API.Promo.random({promo_type:"related_service",limit:2},function(result){if(!$.isEmptyObject(result)){new twttr.views.DashboardRelatedServices({promos:result}).render(that.$node,"append");that.hasRendered();that.profiler.done()}})}).deciderKey("promo_component");twttr.klass("twttr.TrendLocations",function(callback){var that=this;twttr.API.Trend.locations(function(locations){that.all=locations;for(i=0;i<that.all.length();i++){that.all.array[i].name=_(that.all.array[i].name)}twttr.currentUser.trendLocation().first(function(location){if(location){that.current=location}else{that.current=that.worldwide()}callback()})})}).statics({install:function(callback){twttr.trendLocations=new twttr.TrendLocations(callback)}}).methods({allLocations:function(){return this.all.array},ancestorsOf:function(location){if(!location.parentid){return[]}else{var parent=this.locationForWoeid(location.parentid);return[parent].concat(this.ancestorsOf(parent))}},withAncestorsOf:function(location){return[location].concat(this.ancestorsOf(location))},currentAncestors:function(){return this.ancestorsOf(this.current)},withCurrentAncestors:function(){return this.withAncestorsOf(this.current)},withFilterAncestors:function(){return this.withAncestorsOf(this.currentFilter())},childrenOf:function(location){return twttr.filter(this.allLocations(),function(ea){return ea.parentid===location.woeid})},currentChildren:function(){return this.childrenOf(this.currentFilter())},locationForWoeid:function(woeid){return twttr.filter(this.allLocations(),function(ea){return ea.woeid==woeid})[0]},locationsForWoeids:function(woeids){var that=this;return twttr.map(woeids,function(ea){return that.locationForWoeid(ea)})},worldwide:function(){return this.locationForWoeid(1)},currentFilter:function(){var location=this.current;if(location.placeType.code===twttr.constants.placeTypes.city||this.childrenOf(location).length===0){this._currentFilterWoeid=location.parentid}else{this._currentFilterWoeid=location.woeid}return this.locationForWoeid(this._currentFilterWoeid)},setCurrent:function(woeid,origin){this.current=this.locationForWoeid(woeid);twttr.currentUser.setTrendLocation(woeid);scribble("switch-trend-location",{woeid:woeid,input:"click",origin:origin})}});twttr.klass.component("twttr.components.Trends").initializer(function(options){new twttr.views.DashboardTrends().render(this.$node,"append");if(options&&options.wide){this.$find(".trends-inner").addClass("wide-trends")}this.updateTrends();this.hasRendered();this.$find(".trend-toggle").click(function(e){if(twttr.decider.isAvailable("local_trends")){twttr.dialogs.trends().open();scribble("open-trend-dialog",{input:"click"})}});this.$node.delegate(".trend-link","mousedown",function(e){scribble("show-trend",{component:"dashboard",input:"click",trend:$(this).text()})});this.setupTrendUpdateInterval();twttr.API.CurrentUser.bind("changedLocation",twttr.bind(this,this.updateTrends));return this}).deciderKey("local_trends").statics({trendUpdateTime:300*1000}).methods({setupTrendUpdateInterval:function(){var that=this;that.trendUpdateInterval=setInterval(function(){that.updateTrends(true)},twttr.components.Trends.trendUpdateTime)},updateTrends:function(autoRefresh){this.$node.addClass("loading");var that=this,$trends=this.$find(".trends").empty(),options={pc:twttr.loggedIn,success:function(trends){that.trendProfiler.done();var trendScribbleObjects=[];trends.each(function(trend,index){var $trendView=new twttr.views.TrendItem(trend).$html();if(trend.promotedContent){if(!autoRefresh){twttr.anywhere.api.util.PromotedContent.logTrendImpression(trend.promotedContent.id)}$trendView.bind("click",function(e){twttr.anywhere.api.util.PromotedContent.logTrendClick(trend.promotedContent.id)})}$trendView.appendTo($trends);var trendScribbleObject={trend:trend.name,rank:index};if(trend.promotedContent){trendScribbleObject.promoted_content_id=trend.promotedContent.id}var trendHoverScribbleObject=$.extend({component:"dashboard",input:"hover"},trendScribbleObject);$trendView.one("mouseover",function(e){scribble("hover-trend",trendHoverScribbleObject)});trendScribbleObjects.push(trendScribbleObject)});that.$node.removeClass("loading");scribble("trend-impression",{component:"dashboard",trends:trendScribbleObjects});that.profiler.done()},error:function(){that.profiler.done();that.trendProfiler.done()}};if(twttr.loggedIn){var trendLocationProfiler=new twttr.util.Profiler(this.constructor._namespace+".TrendLocation");this.profiler.waitFor(trendLocationProfiler);twttr.currentUser.trendLocation().first(twttr.bind(this,function(location){trendLocationProfiler.done();that.trendProfiler=new twttr.util.Profiler(this.constructor._namespace+".Trend");that.profiler.waitFor(that.trendProfiler);if(location){this.$find(".trend-location").text(_(location.name));location.trends(options)}else{twttr.API.Trend.current(options)}}))}else{that.trendProfiler=new twttr.util.Profiler(this.constructor._namespace+".Trend");that.profiler.waitFor(that.trendProfiler);twttr.API.Trend.current(options)}}});twttr.klass.component("twttr.components.NewTrends").initializer(function(options){var that=this;twttr.TrendLocations.install(function(){new twttr.views.DashboardTrends().render(that.$node,"append");if(options&&options.wide){that.$find(".trends-inner").addClass("wide-trends")}that.updateTrends();that.hasRendered();var $trendToggle=that.$find(".trend-toggle");$trendToggle.click(function(e){scribble("open-trend-dialog",{input:"click",woeid:that.currentWoeid()});that.dialog().open()});$trendToggle.hover(function(e){scribble("trend-location-selector-hover",{input:"hover",woeid:that.currentWoeid()})});that.setupTrendUpdateInterval();twttr.API.CurrentUser.bind("changedLocation",twttr.bind(that,that.updateTrends))})}).deciderKey("local_trends").statics({shouldProfile:function(){return !!twttr.loggedIn},trendUpdateTime:300*1000}).methods({currentWoeid:function(){return twttr.trendLocations.current.woeid},dialog:function(){return this._dialog?this._dialog:this._dialog=twttr.dialogs.newTrends()},setupTrendUpdateInterval:function(){var that=this;that.trendUpdateInterval=setInterval(function(){that.updateTrends(true)},twttr.components.NewTrends.trendUpdateTime)},updateTrends:function(autoRefresh){this.$node.addClass("loading");var that=this,$trends=this.$find(".trends").empty(),trendOptions={pc:twttr.loggedIn,success:function(trends){var trendScribbleObjects=[];trends.each(function(trend,index){var $trendView=new twttr.views.TrendItem(trend).$html();if(trend.promotedContent){if(!autoRefresh){twttr.anywhere.api.util.PromotedContent.logTrendImpression(trend.promotedContent.id)}$trendView.bind("click",function(e){twttr.anywhere.api.util.PromotedContent.logTrendClick(trend.promotedContent.id)})}var scribeData={rank:index,woeid:that.currentWoeid(),component:"dashboard",input:"click",trend:trend.name,dialog_open:that._dialog&&that._dialog.isOpen()};if(trend.promotedContent){scribeData.promoted_content_id=trend.promotedContent.id}$trendView.bind("click",function(e){scribble("show-trend",scribeData)});$trendView.appendTo($trends);trendScribbleObjects.push(scribeData)});that.$node.removeClass("loading");scribble("trend-impression",{component:"dashboard",trends:trendScribbleObjects});that.profiler.done()}};if(twttr.loggedIn){var location=twttr.trendLocations.current;this.$find(".trend-location").text(_(location.name)).attr("woeid",location.woeid);if(that._dialog){that.dialog().rerender()}location.trends(trendOptions)}}}).deciderKey("local_trends");twttr.klass.component("twttr.components.UserRecommendations").initializer(function(screenName){this.refreshCounter=0;this.screenName=screenName;this.fetcher=screenName?twttr.profileUser.similarUsers:twttr.currentUser.recommendedUsers;this.currentRecommendations=[];if(twttr.isNarrow&&screenName){this.noSpacer=true}this.bind("addedToPage",twttr.bind(this,function(){if(this.userRecommendationsAvailable()){this.loadRecommendations()}else{this.trigger("notRendered","darkmoded")}}))}).mixin(twttr.mixins.userRecommendationsHelper).click({".title-link":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"who_to_follow",target:"dashboard_title",item:$target.find(".dashboard-component-title").html()};scribble("dashboard_click",logData)},".user-rec-inner h3 a":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"who_to_follow",target:"view_all_recommendations",recommendations:this.currentRecommendations};scribble("dashboard_click",logData)},".user-rec-links a":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"who_to_follow",target:$target.html(),target_type:"recommendation_link",recommendations:this.currentRecommendations};scribble("dashboard_click",logData)}}).methods({loadRecommendations:function(){this.fetch({limit:twttr.isNarrow?3:4,pc:this.screenName?false:true,connections:twttr.isNarrow&&!this.screenName,success:twttr.bind(this,function(userRecs){var users=this.recsToUsers(userRecs);if(users.length()>0){var evtName,trackingContext;if(this.screenName){evtName="whotofollow_view_similar_users";trackingContext="profile"}else{evtName="whotofollow_view_recommended_users";trackingContext="home"}this.trackImpressions(users,evtName,{tracking_context:trackingContext});this.initRotation();this.logPromotedImpressions(users);var viewOptions=this.screenName?{screen_name:this.screenName,self_sims:twttr.helpers.isCurrentUser(this.screenName),similar_to_link:twttr.router.similarToPath({screen_name:this.screenName})}:{};(new twttr.views.DashboardUserRecommendations(viewOptions).subview("recommended_followers",new twttr.views.UserSmallList(users)).render(this.$node,"append"));if(twttr.isNarrow){twttr.helpers.ellipsify(this.$node.find(".user-screen-and-full-name"))}this.attachUserRecommendationProfileEvents("whotofollow_sidebar_profile_click",this.$node);this.attachUserRecommendationFollowEvents("whotofollow_sidebar_follow",this.$node);this.attachUserRecommendationDismissEvents("whotofollow_sidebar_block",this.$node);this.attachUserRecommendationRefreshEvents();if(twttr.isNarrow){twttr.helpers.ellipsify(this.$find("div.bio"))}this.hasRendered()}else{this.trigger("notRendered","noMoreRecommendations")}this.profiler.done()}),error:twttr.bind(this,function(err){this.profiler.done();this.trigger("notRendered",err)})})},initRotation:function(){if(this.screenName||!this.userRecommendationsAvailable(false)){return }var that=this;var bucket=twttr.abdecider.choose("wtf_rotation-28");this.rotateRecommendations=bucket&&bucket!="control";if(this.rotateRecommendations){if(bucket=="timer"){this.startTimer()}twttr.router.bind("routeFollowed",function(e,route,path){var otherBucket=twttr.abdecider.choose("wtf_rotation-28",true);if(route.fn.pageName=="home"){otherBucket=="timer"?that.startTimer():that.refreshRecommendations(true)}else{if(otherBucket=="timer"){that.pauseTimer()}}})}},startTimer:function(){if(!this.timer){var that=this;this.timer=setInterval(function(){if(that.refreshCounter>3){that.pauseTimer()}else{if(window.scrollY<750){that.refreshCounter=that.refreshCounter+1;that.refreshRecommendations(true)}}},300000)}},pauseTimer:function(){if(this.timer){clearInterval(this.timer);this.timer=false}this.refreshCounter=0},refreshRecommendations:function(showPromotedContent){var $oldList=this.$find(".recommended-followers");$oldList.animate({opacity:0},200);this.fetch({limit:twttr.isNarrow?3:4,excluded:this.currentRecommendations.join(","),pc:showPromotedContent,connections:twttr.isNarrow,success:twttr.bind(this,function(userRecs){var users=this.recsToUsers(userRecs);if(users.length()>0){this.trackImpressions(users,this.screenName?"whotofollow_refresh_similar_users":"whotofollow_refresh_recommended_users");if(showPromotedContent){this.logPromotedImpressions(users)}var $newList=$('<ul class="recommended-followers user-rec-component">'+(new twttr.views.UserSmallList(users)).html()+"</ul>");$newList.css({opacity:0});$oldList.replaceWith($newList);if(twttr.isNarrow){twttr.helpers.ellipsify($newList.find(".user-screen-and-full-name"))}$newList.animate({opacity:1},200)}else{twttr.showMessage(_("You have no more recommendations today!"));this.$find(".refresh-suggestions").remove();$oldList.css({opacity:1})}this.profiler.done()}),error:function(){twttr.showError(_("Whoops! Something went wrong. Please try again!"));$oldList.css({opacity:1});this.profiler.done()}})},attachUserRecommendationRefreshEvents:function(){var that=this;this.$find(".refresh-suggestions").click(twttr.bind(this,function(e){this.refreshRecommendations(false)}))}});twttr.klass.component("twttr.components.MentionedInTweet").initializer(function(tweet){if(!twttr.loggedIn){return }var screenNames=this.extractAtMentions(tweet.text);var placeIds=this.extractPlaceIds(tweet.entities);var that=this;if(screenNames.length||placeIds.length){twttr.API.User.findAll(screenNames,{success:twttr.bind(this,function(users){new twttr.views.MentionedInTweet().subview("mentioned_users",new twttr.views.UserDetailedList(users)).render(this.$node,"append");twttr.each(placeIds,twttr.bind(this,function(placeId){var $li=$("<li/>").appendTo(this.$node.find(".mentioned-in-tweet ul"));new twttr.geo.TweetGeo(tweet,placeId,$li,{viewName:"GeoMapSmall",mapOptions:{draggable:false,disableDoubleClickZoom:true,navigationControl:false}})}));this.hasRendered();that.profiler.done()}),error:function(){that.profiler.done()}})}else{this.profiler.done()}}).methods({extractAtMentions:function(text){var output=[];$("<div>"+twttr.util.linkify(text)+"</div>").children("a.twitter-atreply").each(function(){var u=$(this).attr("data-screen-name");if(!twttr.helpers.isCurrentUser(u)&&!twttr.is.inArray(u,output)){output.push(u)}});return output},extractPlaceIds:function(entities){var output=[];var seen={};if(entities&&entities.places){twttr.each(entities.places,function(place){var id=place.id;if(!(id in seen)){seen[id]=true;output.push(id)}})}return output}});twttr.klass.component("twttr.components.YourProfile").initializer(function(){new twttr.views.DashboardYourProfile(twttr.currentUser).render(this.$node,"append");this.hasRendered();if(twttr.currentUser&&twttr.currentUser["protected"]){twttr.currentUser.friends.pending({success:twttr.bind(this,function(users){this.pendingFriendRequests=users;this.renderRequestButton()}),error:function(e){}})}twttr.API.Status.bind("update retweet",twttr.bind(this,this.tweetHandler));twttr.API.Status.bind("delete unretweet",twttr.bind(this,this.deleteTweetHandler))}).mixin(twttr.mixins.commonDashboardClickHandlers).click({".latest-tweet-timestamp":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"your_profile",target:"latest_tweet_timestamp",status_id:$target.attr("href").split("/").pop(),time:$target.attr("title")};scribble("dashboard_click",logData)}}).statics({shouldProfile:false}).methods({reloadDashboard:function(){this.$node.empty();new twttr.views.DashboardYourProfile(twttr.currentUser).render(this.$node,"append");this.renderRequestButton()},deleteTweetHandler:function(e,status){var that=this;twttr.currentUser.sync("statusesCount",twttr.currentUser.statusesCount-1);if(status.id!==twttr.currentUser.status.id){that.reloadDashboard();return }twttr.currentUser.timeline({include_rts:true,count:2,success:function(statuses){var latestStatus=null;if(!statuses.isEmpty()){statuses=statuses.toArray();for(var i=0,len=statuses.length;i<len;++i){if(statuses[i].id!==status.id){latestStatus=statuses[i];break}}}if(latestStatus){var statusAttributes=twttr.merge({},latestStatus.attributes);delete statusAttributes.user;twttr.currentUser.sync("status",new twttr.API.Status(statusAttributes))}else{twttr.currentUser.sync("status",null)}that.reloadDashboard()}})},tweetHandler:function(e,status){twttr.currentUser.sync("statusesCount",twttr.currentUser.statusesCount+1);var statusAttributes=twttr.merge({},status.attributes);delete statusAttributes.user;twttr.currentUser.sync("status",new twttr.API.Status(statusAttributes));this.reloadDashboard()},renderRequestButton:function(){if(!this.pendingFriendRequests||this.pendingFriendRequests.length===0){return }var requestString;if(this.pendingFriendRequests.length===1){requestString=_("{{num}} new follower request",{num:this.pendingFriendRequests.length})}else{requestString=_("{{num}} new follower requests",{num:this.pendingFriendRequests.length})}var requestView=new twttr.views.DashboardFriendRequests({button_label:requestString,screen_name:twttr.currentUser.screenName});var requestViewContainer=this.$find(".follower-request");requestView.render(requestViewContainer,"append")}});twttr.klass.component("twttr.components.RecentProfileActivity").initializer(function(user){this.cacheExpiry=24*60*60*60;this.profileUser=user||twttr.currentUser;if(twttr.isNarrow){this.FOLLOWERS_KEY+="Narrow";this.FOLLOWING_KEY+="Narrow"}if(!twttr.helpers.canViewUser(this.profileUser)){this.profiler.done();return }var isOwnProfile=twttr.helpers.isCurrentUser(user),isHomePage=twttr.app.isOnPage("home");if(isHomePage){this.subcomponents=twttr.isNarrow?this.homeSubcomponentsNarrow:this.homeSubcomponents}else{if(isOwnProfile){this.subcomponents=twttr.isNarrow?this.yourProfileSubcomponentsNarrow:this.yourProfileSubcomponents}else{this.subcomponents=twttr.isNarrow?this.profileSubcomponentsNarrow:this.profileSubcomponents}}this.noobLevel=twttr.helpers.userNoobLevel();if(this.noobLevel>=0){this.subcomponents.lists=false;this.subcomponents.favorite=false;if((isOwnProfile||isHomePage)&&!twttr.currentUser.followersCount){this.subcomponents.followers=false}}this.addActivityListeners();this.renderComponent()}).mixin(twttr.mixins.commonDashboardClickHandlers).click({".user-stat-link":function(e,$target){var logData={input:"click",component:"dashboard",subcomponent:"recent_profile_activity",target:"dashboard_stat",item:$target.siblings(".dashboard-component-title").html(),value:$target.html()};scribble("dashboard_click",logData)}}).methods({FOLLOWERS_KEY:"recentFollowers",FOLLOWING_KEY:"recentlyFollowed",FAVORITES_KEY:"latestFavorite",LISTS_KEY:"recentLists",homeSubcomponentsNarrow:{following:true,followers:true,wtfLinks:true,_shouldBeCached:true},profileSubcomponentsNarrow:{following15:true,_followingCurrentUser:true},yourProfileSubcomponentsNarrow:{wtfLinks:true,following15:true,_shouldBeCached:true},homeSubcomponents:{following:true,followers:true,lists:true,favorite:true,wtfLinks:true,_shouldBeCached:true},profileSubcomponents:{following15:true},yourProfileSubcomponents:{following:true,followers:true,wtfLinks:true,_shouldBeCached:true},addActivityListeners:function(){if(this.subcomponents.followers){this.addFollowerListeners()}if(this.subcomponents.following){this.addFollowingListeners()}if(this.subcomponents.favorite){this.addFavoriteListeners()}},addFollowingListeners:function(){var that=this;twttr.API.User.bind("follow.YourActivity",function(e,user){that.updateCount(that.FOLLOWING_KEY,".following-activity",true,user)});twttr.API.User.bind("unfollow.YourActivity",function(e,user){that.updateCount(that.FOLLOWING_KEY,".following-activity",false,user)});twttr.API.User.bind("block.YourActivity",function(e,user){that.updateCount(that.FOLLOWING_KEY,".following-activity",false,user)})},addFollowerListeners:function(){var that=this;twttr.API.User.bind("acceptFollow.YourActivity",function(e,user){that.updateCount(that.FOLLOWERS_KEY,".new-followers-activity",true,user)});twttr.API.User.bind("block.YourActivity",function(e,user){that.updateCount(that.FOLLOWERS_KEY,".new-followers-activity",false,user)})},updateCount:function(cacheKey,selector,added,user){var $el=this.$find(selector+" .user-stat-link"),newCount=parseInt($el.html().split(",").join(""),10)+(added?1:-1);$el.html(twttr.util.formatNumber(newCount,twttr.pageLocale));if(added){if(selector==".following-activity"){var $noob=this.$find(selector+" p.wtf-links");if($noob.size()){(new twttr.views.FollowList()).render($noob.parent(),"append");$noob.detach().insertBefore(this.$find("hr.component-spacer"))}}var $list=this.$find(selector+" .inline-list");(new twttr.views.UserThumbListItem(user)).$html().prependTo($list);$list.remove("li:gt(6)");var $fakeContainer=$("<div/>");$fakeContainer.append($list.clone());var html=$fakeContainer.html();twttr.caches.User.set(cacheKey,html,this.cacheExpiry)}else{var $userItem=this.$find(selector+" .user-profile-link[data-user-id="+user.id+"]").parent();$userItem.remove();twttr.caches.User.remove(cacheKey)}},addFavoriteListeners:function(){var that=this;twttr.API.Status.bind("favorite",function(event,tweet){var html=new twttr.views.LatestFavorite(tweet).html();twttr.caches.User.set("latestFavorite",html,that.cacheExpiry);twttr.currentUser.sync("favouritesCount",twttr.currentUser.favouritesCount+1);that.renderComponent()});twttr.API.Status.bind("unfavorite",function(event,tweet){var latestFavorite=twttr.caches.User.get("latestFavorite"),latestId=$(latestFavorite).attr("data-item-id");if(latestId==tweet.id){twttr.currentUser.favorites().first(function(favorite){var html=favorite?new twttr.views.LatestFavorite(favorite).html():"";twttr.caches.User.set("latestFavorite",html,that.cacheExpiry);twttr.currentUser.sync("favouritesCount",Math.max(twttr.currentUser.favouritesCount-1,0));that.renderComponent()})}})},renderComponent:function(){new twttr.views.RecentProfileActivity(this.profileUser,this.subcomponents,this.noobLevel).render(this.$node,"html");this.hasRendered();if(this.subcomponents.following&&twttr.decider.isAvailable("dashboard_activity_following")){this.renderRecentlyFollowed()}else{if(this.subcomponents.following15&&twttr.decider.isAvailable("dashboard_activity_following")){this.renderRecentlyFollowedFull()}}if(this.subcomponents.followers&&twttr.decider.isAvailable("dashboard_activity_followers")){this.renderRecentFollowers()}if(this.subcomponents.favorite&&twttr.decider.isAvailable("dashboard_activity_favorites")){this.renderFavorite()}if(this.subcomponents.lists&&twttr.decider.isAvailable("dashboard_activity_listed")){this.renderLists()}this.profiler.done()},renderRecentlyFollowedFull:function(){var that=this;var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderRecentlyFollowedFull");var displayCount=twttr.isNarrow?10:15;var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderRecentlyFollowedFull");this.$find(".following-activity").addClass("following15");this._getRecentlyFollowed(displayCount,function(users){if(that.subcomponents._followingCurrentUser){that._prependCurrentUserIfFollowedByProfileUser(users,function(currentAndUsers){that._renderFollowList(currentAndUsers.slice(0,displayCount),".following-activity",this.FOLLOWING_KEY);profiler.done()})}else{that._renderFollowList(users,".following-activity",this.FOLLOWING_KEY);profiler.done()}})},renderRecentlyFollowed:function(){var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderRecentlyFollowed");var displayCount=twttr.isNarrow?5:7;var recentlyFollowed=twttr.caches.User.get(this.FOLLOWING_KEY);if(twttr.is.def(recentlyFollowed)){this.$find(".following-activity").append(recentlyFollowed);profiler.done()}else{this._getRecentlyFollowed(displayCount,twttr.bind(this,function(users,details){this._renderFollowList(users.slice(0,displayCount),".following-activity",this.FOLLOWING_KEY);profiler.done()}))}},renderRecentFollowers:function(){var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderRecentFollowers");var displayCount=twttr.isNarrow?5:7;var recentFollowers=twttr.caches.User.get(this.FOLLOWERS_KEY);if(twttr.is.def(recentFollowers)){this.$find(".new-followers-activity").append(recentFollowers);profiler.done()}else{this._getRecentFollowers(displayCount,twttr.bind(this,function(users){this._renderFollowList(users,".new-followers-activity",this.FOLLOWERS_KEY);profiler.done()}))}},renderFavorite:function(){var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderFavorite");var latestFavorite=twttr.caches.User.get(this.FAVORITES_KEY);var $latestFavDiv=this.$find("div.latest-favorite");if(twttr.is.def(latestFavorite)){$latestFavDiv.append(latestFavorite);profiler.done()}else{twttr.currentUser.favorites().first(twttr.bind(this,function(favorite){var html="";if(favorite){html=new twttr.views.LatestFavorite(favorite).html()}$latestFavDiv.append(html);twttr.caches.User.set(this.FAVORITES_KEY,html,this.cacheExpiry);profiler.done()}))}},renderLists:function(){var profiler=new twttr.util.Profiler(this.constructor._namespace+".renderLists");this.profiler.waitFor(profiler);var recentLists=twttr.caches.User.get(this.LISTS_KEY);if(twttr.is.def(recentLists)){this.$find(".lists-activity").append(recentLists);profiler.done()}else{twttr.currentUser.memberships().first(5,twttr.bind(this,function(lists){var html="";if(!lists.isEmpty()){html=new twttr.views.RecentLists(lists).html()}this.$find(".lists-activity").append(html);twttr.caches.User.set(this.LISTS_KEY,html,this.cacheExpiry);profiler.done()}))}},_getRecentlyFollowed:function(count,cb){this.profileUser.friends({count:count,success:cb})},_getRecentFollowers:function(count,cb){this.profileUser.followers({count:count,success:cb})},_renderFollowList:function(peeps,selector,cacheKey){var html="",$node=this.$find(selector);if(!peeps.isEmpty()){html=new twttr.views.FollowList({users:peeps}).html();$node.removeClass("empty")}else{$node.addClass("empty")}$node.append(html);if(this.subcomponents._shouldBeCached){twttr.caches.User.set(cacheKey,html,this.cacheExpiry)}},_prependCurrentUserIfFollowedByProfileUser:function(users,cb){if(twttr.loggedIn&&!twttr.helpers.isCurrentUser(twttr.profileUser)){twttr.currentUser.relationshipWith(this.profileUser,function(relationship){if(relationship.followedBy){users=users.filter(function(u){return u.id!==twttr.currentUser.id}).unshift(twttr.currentUser)}cb(users)})}else{cb(users)}}});twttr.klass.component("twttr.components.WebSearchResults").initializer(function(query){$.ajax({url:"http://api.bing.net/json.aspx?",dataType:"jsonp",jsonp:"JsonCallback",data:{Query:query,Sources:"Web",AppId:"9EF7B62614F07F5029E42D0A9D69730058B1393E",JsonType:"callback","Web.Count":4},success:twttr.bind(this,function(results){if(results.SearchResponse.Web.Total>0){new twttr.views.WebSearchResults({query:query,results:results.SearchResponse.Web.Results}).render(this.$node,"append");this.hasRendered()}})})}).deciderKey("web_search_results_component");twttr.klass.component("twttr.components.PeopleResults").initializer(function(query){query=query.replace(/(^|\b)(from\:|to\:|near\:|source\:)/g,"");if(query.indexOf(":")!=-1){return }twttr.API.User.search(query,{reputable:true}).first(4,twttr.bind(this,function(users){if(users.length()>0){new twttr.views.PeopleResults({query:query}).subview("found_people",new twttr.views.UserSmallList(users)).render(this.$node,"append").delegate(".people-results .user-profile-link","click",function(e){var scribeTerms={section:"onebox",component:"user",action:"profile_click"};trackClient(scribeTerms,{query:query,context:"user_search",item_ids:[parseInt($(this).parents("li:first").attr("data-user-id"))],item_count:1})}).delegate(".people-results .user-follow-link","click",function(e){var scribeTerms={section:"onebox",component:"user",action:"follow"};trackClient(scribeTerms,{query:query,context:"user_search",item_ids:[parseInt($(this).parents("li:first").attr("data-user-id"))],item_count:1})});this.$find("a.more-people-results").click(function(e){var scribeTerms={section:"onebox",component:"more_results_link",action:"click"};trackClient(scribeTerms,{query:query,context:"user_search"})});if(twttr.isNarrow){twttr.helpers.ellipsify(this.$find("div.bio"))}this.hasRendered()}trackClient({section:"onebox",component:"",action:"results"},{query:query,context:"user_search",item_ids:users.map(function(u){return u.id}).toArray(),item_count:users.length()});this.profiler.done()}))}).deciderKey("onebox_user_search");twttr.klass.component("twttr.components.ProfileActions").initializer(function(user){var that=this;this.profileUser=user;this.similarUser=user;this.screenName=user.screenName;this.currentRecommendations=[];twttr.recentlyViewedUsers.push(user);if(twttr.loggedIn){twttr.currentUser.relationshipWith(this.profileUser,twttr.bind(this,function(relationship){this._data={user:user,id:user.id,screen_name:user.screenName,notifications:relationship.notifications,following:relationship.following,followed_by:relationship.followedBy,blocking:relationship.blocking,follow_request_sent:user.followRequestSent,want_retweets:relationship.wantRetweets,can_dm:relationship.canDM&&twttr.currentUser.id!=user.id,reported:false};this._applyMuteMethods(relationship,user);this._renderActions();this.registerEvents()}))}else{this._data={user:user,id:user.id,screen_name:user.screenName};this._renderActions();this._registerFollowEvents()}}).mixin(twttr.mixins.userRecommendationsHelper).methods({_renderActions:function(){this._deregisterTipsy();this.$node.empty();new twttr.views.ProfileActions(this._data).render(this.$node,"append");this.$profileActionController=this.$find(".profile-actions-button");this.$userProfileActionController=this.$find(".user-profile-actions-button");this.$listController=this.$find(".list-action-button");this.userProfileActionsDropdown=null;this.profileActionsDropdown=null;this.listActionsDropdown=null;this._registerTipsy();this.profiler.done()},_applyMuteMethods:function(relationship,user){var that=this;if(!twttr.decider.isAvailable("muteUsers")){return }this.$node.delegate(".mute-action","click",function(e){var $this=$(this);if($this.hasClass("is-muted")){$this.removeClass("is-muted");$this.text(_("Mute"));$(".stream-tweet[data-user-id="+user.id+"]").parent().show();that._removeFromMuteList(user.id)}else{$this.addClass("is-muted");$this.text(_("Unmute"));$(".stream-tweet[data-user-id="+user.id+"]").parent().hide();that._addToMuteList(user)}});twttr.merge(this._data,{show_mute:function(){return relationship.following&&twttr.decider.isAvailable("muteUsers")},is_muted:function(){var users=twttr.caches.User.get("muted");if(users){for(var u in users){if(user.id==u){return true}}}else{return false}}})},_addToMuteList:function(u){var o={screenName:u.screenName,userId:u.id,profileImageUrl:twttr.helpers.transformProfileImageUrl(u.profileImageUrl,"mini")};var users=twttr.caches.User.get("muted")||{};users[u.id]=o;twttr.caches.User.set("muted",users)},_removeFromMuteList:function(id){var users=twttr.caches.User.get("muted")||{};delete users[id];twttr.caches.User.set("muted",users)},renderSimilarUsers:function(){if(!twttr.decider.isAvailable("whotofollow_similarities")){return }var that=this;that.profileUser.similarUsers({limit:2,success:function(userRecs){var users=that.recsToUsers(userRecs);if(users.length()){var $view=(new twttr.views.UserRecommendationsDropdown({user:that.profileUser.name}).subview("recommended_followers",new twttr.views.UserSmallList(users)).render(that.$find(".profile-actions"),"after"));that.trackImpressions(users,"whotofollow_post_follow_similar_users",{tracking_context:"profile",profile_user:that.profileUser.id});that.attachUserRecommendationProfileEvents("whotofollow_dropdown_profile_click",$view);that.attachUserRecommendationFollowEvents("whotofollow_dropdown_follow",$view);that.attachUserRecommendationHideEvents("whotofollow_dropdown_hide",$view);if(twttr.isNarrow){twttr.helpers.ellipsify(that.$find(".profile-actions div.bio"))}$view.slideDown(300)}}})},registerEvents:function(){this.$node.delegate(".direct-message-action","click",twttr.bind(this,function(e){e.preventDefault();twttr.dialogs.dmSingle({user:{screenName:this.profileUser.screenName,user_id:this.profileUser.attributes.id,name:this.profileUser.attributes.name,profile_image_url:this.profileUser.attributes.profile_image_url},origin:"profile-actions-direct-message"}).open()}));this._registerDropdownEvents();this._registerDeviceEvents();this._registerRetweetEvents();this._registerFollowEvents();this._registerUnblockEvents();this._registerAPIListeners()},_registerTipsy:function(){this.$find(".mute-action").tipsy({gravity:"s",delayIn:150,delayOut:500,fade:true});this.$find(".device-notifications").tipsy({gravity:"s",html:true,title:function(){var title=$(this).hasClass("notifying")?_("Tweets from this user are sent to your mobile phone."):_("Tweets from this user are not sent to your mobile phone.");return new twttr.views.Tipsy({title:title}).html()}});this.$find(".retweet-setting").tipsy({gravity:"s",html:true,title:function(){var title=$(this).hasClass("including")?_("Retweets from this user will appear in your timeline."):_("Retweets from this user won't appear in your timeline.");return new twttr.views.Tipsy({title:title}).html()}})},_deregisterTipsy:function(){this.$find(".device-notifications").tipsy({stopThat:true});this.$find(".retweet-setting").tipsy({stopThat:true});this.$find(".mute-action").tipsy({stopThat:true})},_registerDropdownEvents:function(){if(twttr.isNarrow){this.$node.delegate(".user-profile-actions-button","click",twttr.bind(this,function(e){e.preventDefault();if(this.userProfileActionsDropdown){return }this.userProfileActionsDropdown=twttr.app.currentPage()._getUserActionsDropdown(this.profileUser,this.$userProfileActionController,this._data);this.userProfileActionsDropdown.render(this.$userProfileActionController,"after").open()}))}else{this.$node.delegate(".profile-actions-button","click",twttr.bind(this,function(e){e.preventDefault();if(this.profileActionsDropdown){return }this.profileActionsDropdown=this._getActionsDropdown(this.$profileActionController);this.profileActionsDropdown.render(this.$profileActionController,"after").open()}));this.$node.delegate(".list-action-button","click",twttr.bind(this,function(e){e.preventDefault();if(this.listActionsDropdown){return }var cacheId=this.profileUser.id;twttr.viewHelpers.openListDropDown(this.profileUser,this.$listController,twttr.bind(this,function(dropdown){this.listActionsDropdown=dropdown;dropdown.render(this.$listController,"after",{id:cacheId,key:"lists"}).open()}))}))}},_registerDeviceEvents:function(){var that=this;this.$node.delegate(".device-notifications","click",function(e){e.preventDefault();if(!twttr.currentUser.deviceSetup){var prompt=new twttr.widget.Prompt({modal:true,callback:function(ok){if(ok){twttr.router.routeTo(twttr.router.devicesPath())}},template:{title:_("Activate your phone?"),content:(new twttr.views.PhoneSetupPrompt({screen_name:that._data.screen_name,ok:_("Ok"),cancel:_("Cancel")})).html()}}).open();prompt.bind("close",function(){prompt.remove()});return }var $this=$(this);var method=$this.hasClass("notifying")?"setNotificationsOff":"setNotificationsOn";that.profileUser[method]()})},_registerRetweetEvents:function(){var that=this;this.$node.delegate(".retweet-setting","click",function(e){var $this=$(this);e.preventDefault();var on=$this.hasClass("including");var method=on?"setWantRetweetsOff":"setWantRetweetsOn";that.profileUser[method]()})},_registerFollowEvents:function(){var that=this;this.$node.delegate(".profile-follow-button","click",function(e){var impressionId=that.profileUser.impressionId;if(twttr.loggedIn){that.profileUser.follow({before:function(){that._showTweetsFromUserOnHome()},success:function(){that.renderSimilarUsers()},error:function(e){that._hideTweetsFromUserOnHome();twttr.showError(JSON.parse(e.reason).error)},impression_id:impressionId})}else{twttr.dialogs.signinOrSignup({follow:that.profileUser}).open()}e.preventDefault()});this.$node.delegate(".profile-unfollow-link","click",function(e){var impressionId=that.profileUser.impressionId;that.profileUser.unfollow({before:function(){that._hideTweetsFromUserOnHome()},error:function(e){that._showTweetsFromUserOnHome();twttr.showError(JSON.parse(e.reason).error)},impression_id:impressionId});e.preventDefault()})},_registerUnblockEvents:function(){var that=this;this.$node.delegate(".profile-unblock-link","click",function(e){that.profileUser.unblock({before:twttr.bind(that,that._showStreamForBlockedUser),error:function(e){that._hideStreamForBlockedUser();twttr.showError(JSON.parse(e.reason).error)}});e.preventDefault()})},_updateDisplay:function(action,undoing){var that=this,_true=!undoing,_false=!!undoing;switch(action){case"follow":that._data.following=_true;that._data.want_retweets=_true;break;case"unfollow":case"cancel_request":that._data.following=_false;that._data.follow_request_sent=_false;break;case"follow_request":that._data.follow_request_sent=_true;break;case"block":that._data.following=_false;that._data.blocking=_true;that._data.reported=_false;break;case"unblock":that._data.following=_false;that._data.blocking=_false;that._data.reported=_false;that._data.followed_by=false;break;case"report":that._data.following=_false;that._data.blocking=_true;that._data.reported=_true;break;case"subscribe":that._data.notifications=_true;break;case"unsubscribe":that._data.notifications=_false;break;case"does_want_retweets":that._data.want_retweets=_true;break;case"doesnt_want_retweets":that._data.want_retweets=_false;break}$(["following","blocking","followRequestSent","reported","notifications","wantRetweet"]).each(function(i,key){that._data.user.sync(key,that._data[key])});that._renderActions()},_registerAPIListeners:function(){var that=this;var options={before:function(event,request){var requestParameters=request.requestParameters[0],userId=requestParameters.user_id||requestParameters.user_ids;if(userId===that._data.id){that._updateDisplay(event.type,false)}},error:function(event,response,request){var requestParameters=request.requestParameters[0],userId=requestParameters.user_id||requestParameters.user_ids;if(userId===that._data.id){that._updateDisplay(event.type,true)}}};twttr.API.User.bind("follow",options);twttr.API.User.bind("unfollow",options);twttr.API.User.bind("follow_request",options);twttr.API.User.bind("cancel_request",options);twttr.API.User.bind("block",options);twttr.API.User.bind("unblock",options);twttr.API.User.bind("report",options);twttr.API.User.bind("subscribe",options);twttr.API.User.bind("unsubscribe",options);twttr.API.User.bind("does_want_retweets",options);twttr.API.User.bind("doesnt_want_retweets",options)},getHomeTimeline:function(){var homePage=twttr.app.getPage("home");var homeStream=homePage?homePage.streamManager.getStream(twttr.streams.Home):null;return homeStream?homeStream.$node:null},_streamItemsForUserId:function($parent,id){return $parent.find('.stream .stream-item[data-item-type="user"][data-item-id="'+id+'"]').add('.stream .stream-tweet[data-user-id="'+id+'"]',$parent).add('.stream .stream-tweet[data-retweeter-id="'+id+'"]',$parent).closest(".stream-item")},_hideTweetsFromUserOnHome:function(){var $home=this.getHomeTimeline();if($home){this._streamItemsForUserId($home,this.profileUser.id).hide()}},_showTweetsFromUserOnHome:function(){var $home=this.getHomeTimeline();if($home){this._streamItemsForUserId($home,this.profileUser.id).show()}},_hideStreamForBlockedUser:function(){this._streamItemsForUserId($(document.body),this.profileUser.id).hide()},_showStreamForBlockedUser:function(){this._streamItemsForUserId($(document.body),this.profileUser.id).show()},_getActionsDropdown:function(element){var that=this;var items=[];items.push({label:_("Mention {{screen_name}}",this._data),icon:"mention",handlers:{click:function(){new twttr.widget.TweetDialog({template:{title:"Mention "+that.profileUser.screenName},draggable:true,defaultContent:"@"+that.profileUser.screenName+" ",origin:"profile-actions-dropdown-metion"}).open().focus()}}});if(this._data.blocking){items.push({label:_("Unblock {{screen_name}}",this._data),icon:"block",handlers:{click:function(){that.profileUser.unblock({before:function(){$('.stream .stream-tweet[data-user-id="'+that.profileUser.id+'"]').closest(".stream-item").show()}})}}})}else{items.push({label:_("Block {{screen_name}}",this._data),icon:"block",handlers:{click:function(){that.profileUser.block({timeout:function(request){request.retry()},before:twttr.bind(that,that._hideStreamForBlockedUser),error:function(){that._showStreamForBlockedUser();twttr.showError(_("Whoops! We weren't able to block that user. Try again in a minute"))}})}}})}if(!this._data.blocking){items.push({label:_('Report <span class="truncate">{{screen_name}}</span> for spam',this._data),icon:"spam",handlers:{click:function(){that.profileUser.report({before:function(){$('.stream .stream-tweet[data-user-id="'+that.profileUser.id+'"]').closest(".stream-item").hide()}})}}})}return new twttr.control.Dropdown(element,{items:items,direction:"right"})}});twttr.control.Dropdown.createCache("lists");twttr.klass.component("twttr.components.RecentTweets").mixin(twttr.mixins.tweetActionable,twttr.mixins.i18nTweet).initializer(function(user){var that=this;user.timeline().first(3,function(result){if(result.length()>0){new twttr.views.RecentTweets(result).render(that.$node,"append");that.registerTweetActionEvents();that.updateI18nDisplay();that.hasRendered()}that.profiler.done()})}).deciderKey("recent_tweets_component");twttr.klass.component("twttr.components.RecentlyFollowed").mixin(twttr.mixins.userRecommendationsHelper).initializer(function(inWelcomeFlow){if(!twttr.loggedIn){return }this.inWelcomeFlow=inWelcomeFlow;this._maxFollowersCount=10;this._maxSimilarsCount=2;var that=this;twttr.currentUser.friends({count:this._maxFollowersCount,error:function(){that.profiler.done()},success:function(users){that._userCollection=users;if(inWelcomeFlow||!users.isEmpty()){that.createView()}else{that.profiler.done()}}});this.$node.delegate(".followed li a.dynsims","click",function(){var $this=$(this);if($this.parent().hasClass("active")){return }var selectedId=$this.attr("data-user-id"),selectedUser=that._userCollection.find(function(u,i){if(u.id.toString()==selectedId){return u}});if(selectedUser&&twttr.decider.isAvailable("whotofollow_similarities")){that.rememberHeight();that.showSimilarUsers(selectedUser)}});twttr.API.User.bind("follow.RecentlyFollowedComponent",function(e,user){var cond=function(item){return(item.screenName==user.screenName)};if(that._userCollection&&!that._userCollection.find(cond)){that._userCollection.unshift(user);that.rememberHeight();setTimeout(function(){that.createView()},1)}});twttr.API.User.bind("unfollow.RecentlyFollowedComponent",function(e,user){var cond=function(item){return(item.screenName!=user.screenName)};if(that._userCollection){that._userCollection=that._userCollection.filter(cond);that.rememberHeight();setTimeout(function(){that.createView()},1)}})}).methods({rememberHeight:function(){var $container=this.$find(".recently-followed-users");$container.css("height",$container.height()+"px")},autoHeight:function(){this.$find(".recently-followed-users").css("height","")},createView:function(){var latestFriend=this._userCollection.first();new twttr.views.RecentlyFollowed({user:new twttr.views.BaseStats(twttr.currentUser),latest_friends:new twttr.views.UserThumbList(this._userCollection.slice(0,this._maxFollowersCount)),latest_friend:latestFriend?latestFriend.screenName:false,welcome_flow:!!this.inWelcomeFlow,screen_name:twttr.currentUser.screenName,following_count:twttr.currentUser.friendsCount,following_10:twttr.currentUser.friendsCount>=10}).render(this.$node,"html");var $followedList=this.$find(".followed ul");if(latestFriend&&twttr.decider.isAvailable("whotofollow_similarities")){$followedList.find("li a").addClass("dynsims").removeClass("user-profile-link").attr("href","#");var $similaritiesList=this.$find(".recently-followed-users .suggestions");this.attachUserRecommendationProfileEvents("recently_followed_profile_click",$similaritiesList);this.attachUserRecommendationFollowEvents("recently_followed_follow",$similaritiesList);this.showSimilarUsers(latestFriend)}else{this.autoHeight()}if(this.inWelcomeFlow){var followedListEnd=$followedList.find("li").length+1;for(var i=followedListEnd;i<=10;i++){$followedList.append('<li><span class="welcome-placeholder">'+i+"</span></li>")}}this.hasRendered();this.profiler.done()},showSimilarUsers:function(similarToUser){var $followedList=this.$find(".followed ul"),$sugg=this.$find(".suggestions").css({opacity:0});$followedList.find("li").removeClass("active");similarToUser.similarUsers({limit:this._maxSimilarsCount,complete:twttr.bind(this,function(){this.autoHeight()}),success:twttr.bind(this,function(userRecs){this.similarUser=similarToUser;this.screenName=similarToUser.screenName;var users=this.recsToUsers(userRecs).slice(0,this._maxSimilarsCount);if("florian"==similarToUser.screenName){users=new twttr.anywhere.api.util.BaseCollection()}if(users.length()){this.trackImpressions(users,"recently_followed_view_similarities",{to_user_id:similarToUser.id,tracking_context:"recently_followed",similar_to_user:similarToUser.id});new twttr.views.UserDetailedList(users).render($sugg.find("ul"),"html");$followedList.find("li a[data-user-id="+similarToUser.id+"]").parent("li").addClass("active");$sugg.find("p span").text(similarToUser.name);$sugg.animate({opacity:1},200,function(){$(this).show()})}else{$sugg.hide()}})})}});twttr.klass.component("twttr.components.RecentlyViewed").initializer(function(){this.createView();this.registerEvents()}).methods({registerEvents:function(){var that=this;this.$node.delegate("h2 .clear-all","click",function(e){e.preventDefault();twttr.recentlyViewedUsers.clear();that.$node.slideUp("fast",function(){that.$node.empty().show()})});twttr.recentlyViewedUsers.bind("push.RecentlyViewedComponent",function(e,userId){if(!that.$find('li[data-user-id="'+userId+'"]').size()){that.createView()}});that.$node.delegate(".user-profile-link, .follow-action","click",function(){var $link=$(this);var evtName=$link.hasClass("user-profile-link")?"profile_click":"follow";trackClient({section:"dashboard",component:"recently_viewed",action:evtName},{item_ids:[parseInt($link.attr("data-user-id"))],item_count:1})})},createView:function(){var that=this;twttr.recentlyViewedUsers.findAll({success:function(users){users=users.filter(function(q){return !q.following}).slice(0,6);if(users.length()){trackClient({section:"dashboard",component:"recently_viewed",action:"results"},{item_ids:users.map(function(user){return user.id}),item_count:users.length()});new twttr.views.RecentlyViewed(users).render(that.$node,"html");if(twttr.isNarrow){twttr.helpers.ellipsify(that.$find("div.bio"))}that.hasRendered()}else{that.trigger("notRendered","noRecentlyViewedUsers")}that.profiler.done()},error:function(){that.profiler.done()}})}});twttr.klass.component("twttr.components.InviteContacts").initializer(function(contactsResponse,options){options=options||{};this.scribbler=options.scribbler||new twttr.Scribbler();for(var i=0;i<contactsResponse.contacts.length;++i){contactsResponse.contacts[i].index=i}new twttr.views.InviteContacts(contactsResponse).render(this.$node,"append");twttr.helpers.handlePopupLinks(this.$node);var $selectAll=this.$node.find("#select-all-contacts");var $checkboxes=this.$node.find(".contacts .checkbox input");$selectAll.change(function(event){$checkboxes.attr("checked",this.checked);return true});$checkboxes.change(function(event){var allChecked=true;$checkboxes.each(function(){allChecked=allChecked&&this.checked});$selectAll.attr("checked",allChecked);return true});var onSuccess=options.onSuccess||function(){};var that=this;this.$node.find(".invite-contacts-button").click(function(event){$button=$(this);if($button.hasClass("disabled")){return }$button.addClass("disabled");var emails=$checkboxes.filter(":checked").map(function(){return this.value}).get();var options={success:twttr.bind(this,function(){twttr.showMessage(_("We let {{count}} of your contacts know about Twitter.",{count:emails.length}));that.scribbler.scribe({component:"invite_contacts",action:"invited"},{event_value:emails.length,item_count:emails.length});that.scribbler.scribe({component:"invite_contacts",action:"invitable"},{item_count:$checkboxes.length});onSuccess()}),error:function(){twttr.showError(_("There was an error emailing your contacts."));$button.removeClass("disabled")}};twttr.API.AddressBook.sendInvitesByEmail(emails,options)});this.hasRendered();this.profiler.done()});twttr.klass.component("twttr.components.InviteFriends").initializer(function(scribbler){scribbler=scribbler||new twttr.Scribbler();new twttr.views.InviteFriends().render(this.$node,"append");twttr.helpers.handlePopupLinks(this.$node);var $textarea=this.$find("textarea");$textarea.bind("keyup",function(event){var $this=$(this);if(event.which==twttr.constants.keyCodes.enter||$this.val().indexOf(",")>0){$this.addClass("expanded")}});twttr.helpers.addFormEvents(this.$find("form"),function(){if($textarea.attr("disabled")){return }var addresses=twttr.helpers.extractEmailAddresses(this.addresses.value);if(addresses.length){$textarea.attr("disabled","disabled").val(addresses.join(", "));twttr.API.AddressBook.sendInvitesByEmail(addresses,{success:function(res){var count=res.invited&&res.invited.length;if(count){scribbler.scribe({section:"dashboard",component:"invite_friends",action:"invited"},{event_value:count,item_count:count});twttr.showMessage(count>1?_("OK, we will send invites to your {{count}} friends!",{count:count}):_("OK, we will send an invite to {{email}}!",{email:res.invited[0]}));$textarea.val("")}else{twttr.showError(_("Something is wrong, nobody was invited :-("))}$textarea.removeAttr("disabled").blur()},error:function(request){var errors=request.response.errors;if(errors&&errors.length){twttr.showError(errors[0].message)}else{twttr.showError(_("Something is wrong, nobody was invited :-("))}$textarea.removeAttr("disabled").focus()}})}else{twttr.showError(_("Please check the address you entered."))}});this.hasRendered();this.profiler.done()});twttr.klass.component("twttr.components.Retweeters").initializer(function(tweet,count){var that=this;tweet.retweeters({count:count||15,success:function(retweeters){if(retweeters.length()){new twttr.views.Retweeters({tweet:tweet,count:tweet.retweetCount,retweeters:retweeters}).render(that.$node,"append");that.hasRendered()}that.profiler.done()},error:function(){that.profiler.done()}})}).deciderKey("retweeters_component");twttr.klass.component("twttr.components.MessageThread").statics({shouldProfile:false}).initializer(function(thread){var that=this;new twttr.views.MessageThread(thread.messages).render(this.$node,"append");twttr.messageManager.bind("newMessage."+thread.threadId,function(event,message){new twttr.views.Message(message).render(that.$find(".messages-pane"),"prepend")});twttr.messageManager.bind("deletedMessage."+thread.threadId,function(event,messageId){that.$find(".message[data-message-id="+messageId+"]").remove()});this.hasRendered()});twttr.klass.component("twttr.components.SendMessageBox").statics({shouldProfile:false}).initializer(function(screenName,width){var that=this;var tweetBox=new twttr.TweetBox(this.$node,{id:"send-message-box-"+screenName,condensed:true,width:width-60,statusAction:"directMessage",origin:"direct_message_stream_box",template:{title:_("Send {{screen_name}} a message",{screen_name:screenName}),show_geo:false,button_text:_("Send")},data:{getUser:function(){return screenName}}});tweetBox.bind("dmError",function(event,data){if(data===twttr.constants.errorCodes.notFollowing){tweetBox.close()}});tweetBox.bind("dmSuccess",function(event,tweet){that.trigger("sentMessage",[tweet])});this.$node.addClass("gray-component").addClass("send-message-box");this.hasRendered()});twttr.klass.component("twttr.components.InReplyTo").mixin(twttr.mixins.tweetActionable,twttr.mixins.i18nTweet).initializer(function(tweet){var that=this;if(tweet.isReply){tweet.inReplyTo(function(repliedToTweet){new twttr.views.InReplyTo(repliedToTweet).render(that.$node,"append");that.registerTweetActionEvents();that.updateI18nDisplay();that.hasRendered();this.profiler.done()})}else{this.profiler.done()}}).deciderKey("in_reply_to_component").methods({noSpacer:true});twttr.klass.component("twttr.components.Conversation").mixin(twttr.mixins.tweetActionable,twttr.mixins.usesRelatedResults,twttr.mixins.i18nTweet).initializer(function(tweet,currentStream,afterRenderFn){var that=this;that._tweetId=tweet.id;var scrollToTweet=function(ancestors){if(ancestors.length>1){var $pane=$("div.inner-pane").filter("div.active").find("div.pane-components");var $lastAncestor=$pane.find("div.conversation-last-ancestor-tweet");$pane.animate({scrollTop:$lastAncestor.position().top-50},800)}};var renderWith=function(ancestors){new twttr.views.Conversation(that.conversationGroup,tweet,ancestors).render(that.$node,"append");that.registerTweetActionEvents();that.updateI18nDisplay();that.hasRendered();that.profiler.done();afterRenderFn(that);scrollToTweet(ancestors)};that.withRelatedResults(tweet,currentStream,{success:function(resultGroups){that.resultGroups=resultGroups;that.conversationGroup=that.conversationGroupFor(resultGroups);if(that.conversationGroup){renderWith(that.tweetsForConversationRole(that.conversationGroup,"Ancestor"))}else{tweet.inReplyTo({success:function(repliedToTweet){renderWith(repliedToTweet?[repliedToTweet]:[])},error:function(){renderWith([])}})}},error:function(){renderWith([])}})}).methods({onTweetActionDelete:function(tweetId){if(tweetId===this._tweetId){this.trigger("deleted")}},noSpacer:true});twttr.klass.component("twttr.components.Replies").mixin(twttr.mixins.tweetActionable,twttr.mixins.usesRelatedResults,twttr.mixins.i18nTweet).initializer(function(tweet,currentStream,resultGroups){if(!resultGroups){return }var that=this;var renderWith=function(descendants,forks,resultGroup){new twttr.views.Replies(resultGroup,descendants,forks).render(that.$node,"append");that.registerTweetActionEvents();that.updateI18nDisplay();that.hasRendered();that.profiler.done()};var descendants=[];var forks=[];var repliesGroup=that.conversationGroupFor(resultGroups);if(repliesGroup){descendants=that.tweetsForConversationRole(repliesGroup,"Descendant");forks=that.tweetsForConversationRole(repliesGroup,"Fork")}else{repliesGroup=that.repliesGroupFor(resultGroups);if(repliesGroup){forks=twttr.map(repliesGroup.results.array,function(ea){return ea.value})}}renderWith(descendants,forks,repliesGroup)}).deciderKey("conversations");twttr.klass.component("twttr.components.MoreLists").initializer(function(list){var that=this;list.user.lists(function(lists){if(lists.length()){new twttr.views.MoreLists({user:new twttr.views.BaseUser(list.user),lists:new twttr.views.ListOfLists(lists)}).render(that.$node,"append");that.hasRendered()}that.profiler.done()})}).deciderKey("more_lists_component");twttr.klass("twttr.components.MachineTranslationBackend",function(){}).statics({getBackend:function(){if(twttr.decider&&twttr.decider.isAvailable("mt_tweet_backend_bing")){return new twttr.components.BingMTBackend()}else{return new twttr.components.GoogleMTBackend()}}}).methods({translationTextEqual:function(original,translation){if(original==translation){return true}else{if(original.toLowerCase().replace(/[^a-zA-Z]+/g,"")==translation.toLowerCase().replace(/[^a-zA-Z]+/g,"")){return true}}return false},shouldShowTranslation:function(tweetText,translation,sourceLocale,destLocale){if(sourceLocale==destLocale){return false}else{if(this.translationTextEqual(tweetText,translation)){return false}}return true}});twttr.klass("twttr.components.GoogleMTBackend",function(){}).subclassOf(twttr.components.MachineTranslationBackend).methods({attribution:function(){return _('Translation powered by <a href="http://translate.google.com">Google Translate</a>')},translate:function(sourceText,destLocale,cb){var that=this;$.ajax({url:window.location.protocol+"//ajax.googleapis.com/ajax/services/language/translate",dataType:"jsonp",data:{v:"1.0",key:"AIzaSyBKURrEEZ6nsiPDPCowKkymg3ZW14D05p0",q:sourceText,langpair:"|"+destLocale},success:twttr.bind(this,function(result){if(result&&result.responseStatus&&result.responseStatus==200&&result.responseData){var translation=result.responseData["translatedText"];var sourceLocale=result.responseData["detectedSourceLanguage"];if(this.shouldShowTranslation(sourceText,translation,sourceLocale,that.destLocale)){cb(translation,sourceLocale)}}})})}});twttr.klass("twttr.components.BingMTBackend",function(){}).subclassOf(twttr.components.MachineTranslationBackend).methods({attribution:function(){return _('Translation powered by <a href="http://www.microsofttranslator.com/">Bing Translator</a>')},translate:function(sourceText,destLocale,cb){var that=this;$.ajax({url:window.location.protocol+"//api.microsofttranslator.com/v2/ajax.svc/TranslateArray?oncomplete=?",dataType:"jsonp",data:{appId:"EAF2F28EA6356E2638DA8ABD4BC0965D9D9756CA",texts:'["'+sourceText+'"]',from:"",to:destLocale},success:twttr.bind(this,function(result){if(result&&result[0]&&result[0]["TranslatedText"]&&result[0]["From"]){var translation=result[0]["TranslatedText"];var sourceLocale=result[0]["From"];if(this.shouldShowTranslation(sourceText,translation,sourceLocale,that.destLocale)){cb(translation,sourceLocale)}}})})}});twttr.klass.component("twttr.components.MachineTranslatedTweet").initializer(function(tweet){this._initTranslation(tweet,(twttr.pageLocale||$("html").attr("lang")||"en"))}).deciderKey("machine_translated_tweets").statics({languageNames:{de:"German",fr:"French",es:"Spanish",it:"Italian",ja:"Japanese",en:"English"},shouldProfile:false}).methods({languageName:function(languageCode){return _(twttr.components.MachineTranslatedTweet.languageNames[languageCode])},_initTranslation:function(tweet,locale){if(!tweet.user["protected"]){this.destLocale=locale;this.fetchTranslation(tweet,this.destLocale)}},_preProcessTweetText:function(text){var i=0;var j=0;var k=0;var mentions=[];var hashtags=[];var links=[];var cleaned=text.replace(/\B[@]([a-zA-Z0-9_]{1,20})/g,function(m,username){mentions.push("@"+username);return("_u"+(i++)+"_")});this._mentions=mentions;cleaned=cleaned.replace(/\B[#]([0-9A-Z_]*[A-Z_]+[A-Z0-9_]*)/ig,function(m,hashtag){hashtags.push("#"+hashtag);return("_h"+(j++)+"_")});this._hashtags=hashtags;cleaned=cleaned.replace(/\b(https?:\/\/[a-z0-9_\.\/\?=&%-]+)/ig,function(m,url){links.push(url);return("_l"+(k++)+"_")});this._links=links;return cleaned},_postProcessTweetText:function(text){var reconstructed=text;if(this._mentions&&this._mentions.length>0){for(var i=0;i<this._mentions.length;i++){reconstructed=reconstructed.replace(new RegExp("_u"+(i)+"s?_","i"),this._mentions[i])}}if(this._hashtags&&this._hashtags.length>0){for(var i=0;i<this._hashtags.length;i++){reconstructed=reconstructed.replace(new RegExp("_h"+(i)+"s?_","i"),this._hashtags[i])}}if(this._links&&this._links.length>0){for(var i=0;i<this._links.length;i++){reconstructed=reconstructed.replace(new RegExp("_l"+(i)+"s?_","i"),this._links[i])}}reconstructed=reconstructed.replace(/&#(\d+);/g,function(m,number){return String.fromCharCode(number)});return twttr.util.linkify(reconstructed)},fetchTranslation:function(tweet,destLocale){var that=this;this.sourceText=this._preProcessTweetText(tweet.text);scribble("machine-translated-tweet",{input:"request"});var backend=twttr.components.MachineTranslationBackend.getBackend();backend.translate(this.sourceText,destLocale,function(translation,detectedLanguage){new twttr.views.MachineTranslatedTweet({translated_text:that._postProcessTweetText(translation),attribution:backend.attribution()}).render(that.$node,"append");scribble("machine-translated-tweet",{input:"display",sourceLocale:detectedLanguage,sourceLen:that.sourceText.length,destLocale:that.destLocale,translationLen:translation.length});that.hasRendered()})}});twttr.klass.component("twttr.components.PlaceTweets").initializer(function(place){var that=this;if(place){twttr.API.Status.search("place:"+place.id,{success:function(tweets){tweets.first(5,function(firstTweets){if(firstTweets.length()>0){var tweetViews=firstTweets.map(function(tweet){return new twttr.views.DetailsPaneTweet(tweet)});var context={place_id:place.id,place_name:place.fullName,tweets:tweetViews.array};new twttr.views.PlaceTweets(context).render(that.$node,"append");that.hasRendered()}})}})}}).deciderKey("place_tweets_component");twttr.klass("twttr.geo.PlaceCreationDialog",function(container,placeName,geoParams,onPlaceCreated){var that=this;that.container=container;if(geoParams.contained_within!==undefined){var location=twttr.geo.getLocationFromPlace(container);if(location){that.lat=location.latitude;that.lon=location.longitude;that.accuracy=location.accuracy}else{that.lat=38.7777;that.lon=-95.1875;that.accuracy=2000000}}else{that.lat=geoParams.lat;that.lon=geoParams.lon;that.accuracy=geoParams.accuracy}that.originalGeoParams=geoParams;that.placeName=placeName;that.onPlaceCreated=onPlaceCreated;that.draggedPin=false;that.streetAddress="";that.markerAccurate=that.accuracy<=100;var dialogOptions={template:{container_id:"geo_place_creation_dialog",title:'<span class="geo-place-creation-dialog-title"></span>',content:'<div class="geo-place-creation-dialog-content"></div>'},css:{width:350},modal:true};that.dialog=new twttr.widget.GeoDialog(dialogOptions);that.$content=$("div.geo-place-creation-dialog-content");that.$title=$("span.geo-place-creation-dialog-title");that.showWhereIsPlace()}).methods({ERROR_REGION_UNAVAILABLE:_("Place creation for that region is not available yet."),ERROR_GENERIC:_("We couldn't add this place. Please try again."),queryMap:function(){var that=this;var query=twttr.geo.helpVal(that.$queryMapInput);if(!that.geoCoder){that.geoCoder=new google.maps.Geocoder()}that.geoCoder.geocode({address:query,location:that.geoMap.getCenter()},function(results,status){var error="";switch(status){case google.maps.GeocoderStatus.OK:that.geoMap.fitBounds(results[0].geometry.viewport,twttr.geo.PLACE_CREATION_DEFAULT_ZOOM_LEVEL);that.$movePinHint.clearQueue().stop().hide();that.updateMap();break;case google.maps.GeocoderStatus.ZERO_RESULTS:error=_("Unable to locate that address or place.");break;default:error=_("Geocoding service temporarily unavailable.")}that.$queryMapError.text(error)})},setContentAndTitle:function(html){var that=this;that.$content.html(html);that.$title.html(that.$content.find("div:first").remove().html())},isPointOnMap:function(x,y){var dead=twttr.geo.POI_MAP_DEAD_ZONE;return x>dead.left&&y>dead.top&&x<this.$mapCanvas.width()-dead.right&&y<this.$mapCanvas.height()-dead.bottom},updateMap:function(){var that=this;that.$queryMapError.empty();var point=that.geoMap.latLngToContainerPoint([that.lon,that.lat]);if(that.markerAccurate&&that.isPointOnMap(point.x,point.y)){that.marker.setVisible(true);that.$dropPinHint.clearQueue().stop().hide();that.$nextButton.removeClass("btn-disabled");that.$droppablePin.hide()}else{that.marker.setVisible(false);that.$movePinHint.clearQueue().stop().hide();that.$dropPinHint.filter(":hidden").clearQueue().fadeTo(0,0).delay(200).show().queue(function(next){var $this=$(this);$this.css("top",that.$mapCanvas.height()-$this.height());next()}).fadeTo(500,0.8);that.$nextButton.addClass("btn-disabled");that.$droppablePin.css({left:that.$mapCanvas.width()-10-twttr.geo.POI_MARKER_SIZE.width,top:that.$mapCanvas.height()+7}).show()}},accuracyFromMapZoomLevel:function(lat,lon){var that=this;var point=that.geoMap.latLngToContainerPoint([lon,lat]);var latLng2=that.geoMap.containerPointToLatLng(point.x+1,point.y+1);return Math.round(1414*twttr.geo.greatCircleDistanceInKm(lat,lon,latLng2.lat(),latLng2.lng()))},showWhereIsPlace:function(){var that=this;that.setContentAndTitle(new twttr.views.GeoWhereIsPlace({place_name:that.placeName}).html());var $content=that.$content;that.$queryMap=$content.find("div.geo-query-map");that.$queryMapInput=that.$queryMap.find("input");that.$queryMapError=that.$queryMap.find("div.geo-query-map-error");twttr.geo.helpText(that.$queryMapInput).keydown(function(e){if(e.keyCode===twttr.constants.keyCodes.enter){that.queryMap();e.stopPropagation();e.preventDefault()}});that.$queryMap.find("span").click(function(e){that.queryMap()});var $whereIsPlace=$content.find("div.geo-where-is-place");that.$mapCanvas=$content.find("div.geo-map-canvas");that.$movePinHint=$content.find("div.geo-move-pin-hint");that.$dropPinHint=$content.find("div.geo-drop-pin-hint");that.$droppablePin=$content.find("div.geo-droppable-pin");that.$nextButton=$content.find("button.geo-submit");if(!that.dialog.isOpen()){that.dialog.open()}that.dialog.$container.attr("tabindex","-1").focus();that.geoMap=new twttr.geo.Map(that.$mapCanvas);that.marker=that.geoMap.addPoi([that.lon,that.lat],function(lat,lon){that.lat=lat;that.lon=lon;that.draggedPin=true;that.accuracy=that.accuracyFromMapZoomLevel(lat,lon);that.markerAccurate=true;that.updateMap()});if(!that.markerAccurate){that.marker.setVisible(false)}that.geoMap.extendBoundsToIncludeCircle([that.lon,that.lat],that.accuracy);that.geoMap.adjustBounds(twttr.geo.PLACE_CREATION_DEFAULT_ZOOM_LEVEL);that.geoMap.createOverlay(function(){if(that.markerAccurate){that.$movePinHint.delay(300).fadeTo(0,0).show().fadeTo(500,0.8);$whereIsPlace.one("mousedown",function(){that.$movePinHint.clearQueue().stop().hide()})}that.geoMap.addListener("dragstart",function(){if(that.markerAccurate){that.marker.setVisible(true)}});that.geoMap.addListener("dragend",function(){that.updateMap()});that.geoMap.addListener("zoom_changed",function(){that.updateMap()});var dead=twttr.geo.POI_MAP_DEAD_ZONE;var hot=twttr.geo.POI_MARKER_HOTSPOT;that.$droppablePin.draggable({containment:[$whereIsPlace.offset().left-hot.x+dead.left+1,$whereIsPlace.offset().top-hot.y+dead.top+1,$whereIsPlace.offset().left+$whereIsPlace.width()-hot.x-dead.right-1,$whereIsPlace.offset().top+$whereIsPlace.height()-hot.y-dead.bottom-1],addClasses:false,start:function(){that.$dropPinHint.clearQueue().stop().hide()},stop:function(e,ui){var x=ui.position.left+hot.x;var y=ui.position.top+hot.y;if(that.isPointOnMap(x,y)){that.marker.setPosition(that.geoMap.containerPointToLatLng(x,y))}else{that.updateMap()}}});that.updateMap();that.$nextButton.bind("click geosubmit",function(e){if($(this).hasClass("btn-disabled")){return }that.determineContainer()})})},determineContainer:function(){var that=this;if(that.inProgress){return }that.setStatus(true);twttr.API.Place.reverseGeocode(that.lat,that.lon,{granularity:"city",success:function(apiPlaces){that.container=twttr.geo.placesFromApi(apiPlaces)[0];that.callSimilarPlaces()},error:function(req){that.setStatus(false,req.status==404?that.ERROR_REGION_UNAVAILABLE:that.ERROR_GENERIC)}})},callSimilarPlaces:function(){var that=this;var params=that.getPlaceCreationParams();twttr.API.Place.similar(params.lat,params.lon,params.name,twttr.merge(params,{success:function(apiPlaces,fullResponse){that.token=fullResponse.response.result.token;that.tokenPlaceName=params.name;that.setStatus(false);that.similarPlaces=fullResponse.response.result.places.slice(0,twttr.geo.MAX_SIMILAR_PLACES);if(that.similarPlaces.length>0&&twttr.decider.isAvailable("geo_show_similar_places")){that.showSimilarPlaces()}else{that.showConfirmPlaceCreation()}},error:function(){that.setStatus(false,that.ERROR_GENERIC);that.scribeCreatePlace("similar_places_error")}}))},callCreatePlace:function(){var that=this;if(that.inProgress){return }if(that.tokenPlaceName!=that.placeName){that.callSimilarPlaces()}that.setStatus(true);var params=that.getPlaceCreationParams();if(twttr.util.params().nocreate!==undefined){params.token="bogus_token"}twttr.API.Place.create(params.token,params.lat,params.lon,params.name,params.contained_within,twttr.merge(params,{success:function(apiPlace){that.dialog.destroy();that.onPlaceCreated(apiPlace.data());that.scribeCreatePlace("success")},error:function(){that.setStatus(false,that.ERROR_GENERIC);that.scribeCreatePlace("create_place_error")}}))},showSimilarPlaces:function(){var that=this;that.setContentAndTitle(new twttr.views.GeoSimilarPlaces().html());that.$content.find("button.geo-submit").bind("click geosubmit",function(){that.showConfirmPlaceCreation()});that.$content.find("a.geo-go-back").click(function(e){e.preventDefault();that.showWhereIsPlace()});var $placesList=that.$content.find("div.geo-similar-places ul");twttr.each(that.similarPlaces,function(place){$placeItem=twttr.geo.renderPlace("GeoSimilarPlaceItem",place);$placeItem.find("a").click(function(e){e.preventDefault();that.dialog.destroy();that.onPlaceCreated(place)});$placesList.append($placeItem)});that.geoMap=new twttr.geo.Map(that.$content.find("div.geo-map-canvas"));that.geoMap.addPoi([that.lon,that.lat]);var $geoMapPlaceBubble=that.$content.find("div.geo-map-place-bubble");var map_pos=that.$content.find("div.geo-map-canvas").position();twttr.each(that.similarPlaces.reverse(),function(place){var center=place.bounding_box.coordinates[0][0];var turnOn=that.geoMap.addFocusablePoint(center,function(isHovering,point){if(isHovering&&point){$geoMapPlaceBubble.find("div.geo-place-title").text(place.name);$geoMapPlaceBubble.find("span.geo-place-details").text(twttr.geo.getPlaceDetails(place));$geoMapPlaceBubble.show().css({left:map_pos.left+point.x-$geoMapPlaceBubble.width()/2,top:map_pos.top+point.y,opacity:0.8})}else{$geoMapPlaceBubble.hide()}});$placesList.find("li.result-place-"+place.id).hover(function(){turnOn(true)},function(){turnOn(false)})});that.geoMap.adjustBounds(twttr.geo.SIMILAR_PLACES_MAX_ZOOM_LEVEL);that.geoMap.createOverlay()},capturePlaceCreationInputs:function(){var that=this;that.placeName=twttr.geo.helpVal(that.$name);that.streetAddress=twttr.geo.helpVal(that.$address);return that.placeName!==""},showConfirmPlaceCreation:function(){var that=this;that.setContentAndTitle(new twttr.views.GeoConfirmPlaceCreation({city_name:that.container.full_name}).html());var $content=that.$content;that.$name=$content.find("input.geo-place-creation-name");twttr.geo.helpText(that.$name.val(that.placeName)).bind("keydown keypress change",function(){setTimeout(function(){$content.find("button.geo-submit").toggleClass("btn-disabled",!that.capturePlaceCreationInputs())},0)});that.$address=$content.find("input.geo-place-creation-address");twttr.geo.helpText(that.$address.val(that.streetAddress||"")).focus();$content.find("button.geo-submit").bind("click geosubmit",function(){if(that.capturePlaceCreationInputs()){that.callCreatePlace()}});$content.find("a.geo-go-back").click(function(e){e.preventDefault();that.capturePlaceCreationInputs();that.showWhereIsPlace()});that.geoMap=new twttr.geo.Map($content.find("div.geo-map-canvas"),{draggable:false,disableDoubleClickZoom:true,navigationControl:false});that.geoMap.addPoi([that.lon,that.lat]);that.geoMap.adjustBounds(twttr.geo.PLACE_CREATION_DEFAULT_ZOOM_LEVEL)},getPlaceCreationParams:function(){var that=this;var placeCreationParams={lat:that.lat,lon:that.lon,name:that.placeName,contained_within:that.container.id,accuracy:that.accuracy};if(that.token){placeCreationParams.token=that.token}if(that.streetAddress){placeCreationParams["attribute:street_address"]=that.streetAddress}return placeCreationParams},scribeCreatePlace:function(status){var that=this;twttr.geo.geoScribe("create_place",$.extend({status:status,original_lat:that.originalGeoParams.lat,original_lon:that.originalGeoParams.lon,original_accuracy:that.originalGeoParams.accuracy,dragged_pin:that.draggedPin},that.getPlaceCreationParams()))},setStatus:function(inProgress,errorMessage){this.inProgress=inProgress;this.$content.find("span.geo-progress").toggleClass("geo-spinner",inProgress);var $error=this.$content.find("div.geo-place-creation-error");if(errorMessage){$error.text(errorMessage).show()}else{$error.hide()}}});twttr.klass("twttr.geo.PlaceSearchDialog",function(placer,onPlaceAccepted,isInlinePlace){var that=this;that.onPlaceAccepted=onPlaceAccepted;that.place=placer.selectedPlace;that.placer=placer;that.city=twttr.geo.getBestCity(that.place);that.originalCity=that.city;that.placeString=(that.place&&that.place.place_type!="city")?that.place.name:"";that.originalPlaceString=that.placeString;that.isInlinePlace=isInlinePlace;if(isInlinePlace){that.placeString=""}var dialogOptions={modal:true,template:{title:'<span class="geo_search_places_title"></span>',content:'<div class="geo_search_places_dialog_content"></div>'},css:{width:450}};that.dialog=new twttr.widget.GeoDialog(dialogOptions);var geoParams=placer.opts.geoParams;that.searchParams={max_results:twttr.geo.MAX_PLACE_SEARCH_RESULTS};if(placer.detectedPlace&&that.city.id==twttr.geo.getBestCity(placer.detectedPlace).id&&geoParams.lat!==undefined&&geoParams.lon!==undefined&&geoParams.accuracy!==undefined){twttr.merge(that.searchParams,{lat:geoParams.lat,lon:geoParams.lon,accuracy:geoParams.accuracy})}else{that.setSearchParamsFromCity()}that.setCityMode(false);var $placeSearchResults=$("#place_search_results").html('<div style="height:250px;">&nbsp;</div>');that.dialog.open();$placeSearchResults.hide();setTimeout(function(){$("#place_search_query").focus().select()},0)}).method("scribeSearch",function(eventName,isCityMode,moreData){var that=this;twttr.geo.geoScribe(eventName,$.extend({query:twttr.geo.helpVal($("#place_search_query")),mode:isCityMode?"city":"place",container_id:that.city.id,place_creation_allowed:that.shouldAllowPlaceCreation(isCityMode)},that.searchParams,moreData))}).method("setCityMode",function(isCityMode){var that=this;var context={city:that.city.full_name,are_poi_allowed:that.placer.getGranularity()==="poi"};if(that.city.full_name==""){$(".geo_search_places_title").text(_("First, give us a city"));$(".geo_search_places_dialog_content").html((new twttr.views.GeoCitySearch(context).html()));isCityMode=true}else{if(isCityMode){$(".geo_search_places_title").text(_("Change City"));$(".geo_search_places_dialog_content").html((new twttr.views.GeoCitySearch(context).html()))}else{$(".geo_search_places_title").text(that.isInlinePlace?_("Search for a place"):_("Where are you?"));$(".geo_search_places_dialog_content").html((new twttr.views.GeoPlaceSearch(context).html()))}}var $placeSearchQuery=$("#place_search_query");if(isCityMode){$placeSearchQuery.val(that.city.full_name)}else{$placeSearchQuery.val(that.placeString)}twttr.geo.selectOnClick(twttr.geo.helpText($placeSearchQuery));if(twttr.decider.isAvailable("geo_ui_autocomplete")){that.placeAutocomplete=new twttr.geo.autocomplete({$input:$placeSearchQuery,$dropdown:$(".place_search_dropdown"),getInputVal:function(){return twttr.geo.helpVal($placeSearchQuery)},fetchMatches:function(inputVal,onSuccess,onError){twttr.API.Place.search(twttr.merge({},that.searchParams,{query:inputVal,autocomplete:"true",max_results:twttr.geo.MAX_PLACE_AUTOCOMPLETE_RESULTS,granularity:isCityMode?"city":that.placer.getGranularity(),success:function(places){onSuccess(twttr.geo.placesFromApi(places))},error:onError}))},renderMatch:function(match,index,matches){return twttr.geo.renderPlace("GeoAutocompleteItem",match).click(function(e){setTimeout(function(){that.placeAccepted(match,isCityMode)},0);var placeIds=[];twttr.each(matches,function(place){placeIds.push(place.id)});that.scribeSearch("place_search_dialog_select_autocomplete",isCityMode,{selected_id:match.id,selected_index:index,place_ids:placeIds})})},delay:twttr.geo.PLACE_SEARCH_AUTOCOMPLETE_DELAY})}var $placeSearchForm=$("#place_search_form");$placeSearchForm.submit(function(e){e.preventDefault();var placeQuery=twttr.geo.helpVal($placeSearchQuery);if(that.placeAutocomplete){that.placeAutocomplete.hide()}if(!placeQuery){that.placeAccepted(that.city,isCityMode);return }if(isCityMode&&placeQuery==that.city.full_name){that.setCityMode(false);return }that.setWaitCursor(true);$("#place_search_done").hide();$("#place_search_cancel").show();$("#place_search_results").html(Mustache.to_html('<div class="geo_search_message">{{_i}}Searching for "{{query}}"...{{/i}}</div>',{query:placeQuery})).show();twttr.API.Place.search(twttr.merge({},that.searchParams,{query:placeQuery,granularity:isCityMode?"city":that.placer.getGranularity(),success:function(places){that.setWaitCursor(false);that.searchResultPlaces=twttr.geo.placesFromApi(places);twttr.geo.loadMaps(function(){that.displayResults(0,isCityMode)})},error:function(request,textStatus,errorCode){that.setWaitCursor(false);that.displaySearchError(request,isCityMode)}}))});$(".place_search_submit").click(function(){that.searchTrigger="click_icon";$placeSearchForm.submit()});$placeSearchQuery.keydown(function(e){if(e.keyCode==13){that.searchTrigger="enter_key";e.preventDefault();$placeSearchForm.submit()}});$("#place_search_done").click(function(){that.searchTrigger="click_done";var placeQuery=twttr.geo.helpVal($placeSearchQuery);if(that.place&&that.place.name==placeQuery&&that.city==that.originalCity){that.placeAccepted(that.place,isCityMode);that.scribeSearch("place_search_dialog_done_no_changes",isCityMode)}else{$placeSearchForm.submit()}});$("#place_search_cancel").click(function(){that.dialog.destroy();that.scribeSearch("place_search_dialog_close",isCityMode,{triggered_by:"click_cancel"})});$("#change_city").click(function(e){e.preventDefault();that.placeString=twttr.geo.helpVal($placeSearchQuery);that.setCityMode(true);that.scribeSearch("place_search_dialog_change_city")});$placeSearchQuery.focus().select()}).method("setWaitCursor",function(onOff){$(".place_search_submit").toggleClass("loading",onOff)}).method("shouldAllowPlaceCreation",function(isCityMode){return !isCityMode&&this.placer.getGranularity()==="poi"&&twttr.decider.isAvailable("geo_place_creation")&&twttr.geo.mapsAvailable()}).method("displayResults",function(pageNumber,isCityMode){var that=this;var firstPlaceIndex=pageNumber*twttr.geo.PLACE_SEARCH_RESULTS_PER_PAGE;var firstNextPagePlaceIndex=firstPlaceIndex+twttr.geo.PLACE_SEARCH_RESULTS_PER_PAGE;var places=that.searchResultPlaces.slice(firstPlaceIndex,firstNextPagePlaceIndex);var $results=$("#place_search_results").empty();var query=twttr.geo.helpVal($("#place_search_query"));if(places.length==0){$results.html(Mustache.to_html('<div class="geo_search_message">{{_i}}We couldn\'t find "{{query}}."{{/i}}</div>',{query:query}))}var placeIds=[];var $resultsList=$("<ul/>").appendTo($results);twttr.each(places,function(place,index){placeIds.push(place.id);var $placeItem=twttr.geo.renderPlace("GeoSearchResultItem",place);$placeItem.find("a").click(function(e){e.preventDefault();that.scribeSearch("place_search_dialog_select_result",isCityMode,{place_ids:placeIds,selected_id:place.id,selected_index:index});that.placeAccepted(place,isCityMode)}).attr("title",twttr.geo.getPlaceDetails(place));$resultsList.append($placeItem)});if(that.searchResultPlaces.length>twttr.geo.PLACE_SEARCH_RESULTS_PER_PAGE){$results.append(Mustache.to_html('<div class="geo_next_prev"><a href="#" id="geo_prev_result">&laquo;&nbsp;{{_i}}Prev{{/i}}</a><a href="#" id="geo_next_result">{{_i}}Next{{/i}}&nbsp;&raquo;</a></div>'),{});that.setNextPrev($("#geo_prev_result"),pageNumber>0,pageNumber-1,isCityMode);that.setNextPrev($("#geo_next_result"),firstNextPagePlaceIndex<that.searchResultPlaces.length,pageNumber+1,isCityMode)}if(that.shouldAllowPlaceCreation(isCityMode)){$results.append(Mustache.to_html("<div class='geo_add_place'>{{#found}}{{_i}}Not what you're looking for?{{/i}}&#32;{{/found}}<a href='#'>{{_i}}Add this place!{{/i}}</a></div>",{found:places.length>0}));$(".geo_add_place a").click(function(e){e.preventDefault();that.dialog.destroy();new twttr.geo.PlaceCreationDialog(that.city,query,that.searchParams,function(place){that.placeAccepted(place,false)});that.scribeSearch("place_search_dialog_add",isCityMode,{place_ids:placeIds})})}that.scribeSearch("place_search_dialog_show_results",isCityMode,{place_ids:placeIds,triggered_by:that.searchTrigger})}).method("setNextPrev",function($link,isEnabled,newPage,isCityMode){var that=this;$link.click(function(e){e.preventDefault();if(isEnabled){that.displayResults(newPage,isCityMode)}});if(!isEnabled){$link.addClass("link-disabled")}}).method("placeAccepted",function(place,isCityMode){var that=this;if(isCityMode){if(!place.id){that.dialog.destroy()}else{if(that.city.id!=place.id){that.city=place;if(that.placeString!=that.originalPlaceString){that.placeString=""}that.setSearchParamsFromCity()}}that.setCityMode(false)}else{that.dialog.destroy();twttr.components.Autocomplete.addRecentPlace(place);that.onPlaceAccepted(place)}}).method("setSearchParamsFromCity",function(){var that=this;if(that.city&&that.city.id){delete that.searchParams.lat;delete that.searchParams.lon;delete that.searchParams.accuracy;that.searchParams.contained_within=that.city.id}}).method("displaySearchError",function(request,isCityMode){$("#place_search_results").text(_("Sorry, search is temporarily unavailable, please try again later."));this.scribeSearch("place_search_dialog_error",isCityMode)});twttr.klass("twttr.geo.PlacesDropdown",function(placer,$container,onPlaceChange){var that=this;that.placer=placer;that.$container=$container;that.onPlaceChange=onPlaceChange;var locationName="<a class='place_link' href='#'><span class='place_name'></span> &#9662;</a><ul class='round places_list'/>";that.$container.find("span.place_content").html(locationName);that.$placesList=that.$container.find("span.place_content ul.places_list");that.buildPlacesDropdown();that.$container.find("a.place_link").click(function(e){e.preventDefault();if(that.$container.find("span.place_content ul.places_list:visible").length>0){that.closeMenu()}else{that.openMenu();e.stopPropagation()}})}).method("buildPlacesDropdown",function(){var that=this;that.$placesList.empty();that.appendPoiPlaces(that.placer.places);that.appendNonPoiPlaces(that.placer.places);that.appendMorePlaces();that.showSelectedPlace()}).method("appendPoiPlaces",function(places){var that=this;var gotOne=false;twttr.each(places,function(place){if(place.place_type=="poi"){that.$placesList.append(that.createPlaceItem(place));gotOne=true}});return gotOne}).method("appendNonPoiPlaces",function(places){var that=this;twttr.each(places,function(place){if(place.place_type!="poi"){that.$placesList.append(that.createPlaceItem(place))}})}).method("createPlaceItem",function(place){var that=this;var $placeItem=twttr.geo.renderPlace("GeoDropdownItem",place);$placeItem.click(function(e){e.preventDefault();that.closeMenu();that.onPlaceChange(place);twttr.geo.geoScribe("click_place_item",that.placer.getState())});return $placeItem}).method("appendMorePlaces",function(){var that=this;if(twttr.decider.isAvailable("geo_more_places")){var morePlacesText=that.placer.getGranularity()==="poi"?_("Search places..."):_("Search neighborhoods and cities...");that.$placesList.append('<li class="geo_more_places"><span class="place_item_icon more_places">&nbsp;</span>'+morePlacesText+"</li>");that.$placesList.find("li.geo_more_places").click(function(e){e.preventDefault();new twttr.geo.PlaceSearchDialog(that.placer,function(place){that.onPlaceChange(place)});twttr.geo.geoScribe("click_search_places")})}}).method("showSelectedPlace",function(){var place=this.placer.selectedPlace;twttr.geo.currentLocation.place_id=place.id;this.$container.find(".place_name").html(Mustache.to_html(_("from {{full_name}}"),place));this.$placesList.children("li.selected").removeClass("selected");this.$placesList.find(".place_"+place.id).addClass("selected")}).method("openMenu",function(){var that=this;var $placeLink=that.$container.find("a.place_link");var pos=$placeLink.position();that.$placesList.css({left:pos.left,top:pos.top+$placeLink.outerHeight()}).show();$("html").one("click",function(){that.closeMenu()});twttr.geo.geoScribe("open_places_dropdown",that.placer.getState())}).method("closeMenu",function(){this.$placesList.hide()});twttr.klass("twttr.geo.TweetGeo",function(tweet,placeId,$target,opts){this.opts=opts;this.placeId=placeId;this.render(tweet,$target)}).methods({render:function(tweet,$target){var that=this;that.$target=$target;var context=$.extend({},tweet.data());context.tweet_id=tweet.id;that.avatarUrl=tweet.user.profileImageUrl.replace(/(.+)(?:_normal)\.(\w+)$/,"$1_mini.$2");if(context.coordinates){that.coordinates=context.coordinates.coordinates}context.is_from=!that.placeId;var placeId=that.placeId||tweet.place&&tweet.place.id;if(placeId){if(!context.place||context.place.id!=placeId){context.place={id:placeId,name:_("A Place")}}twttr.API.Place.find(placeId,{success:function(apiPlace){var place=apiPlace.data();context.place=twttr.geo.getFullPlace(place);that.finishRendering(context)},error:function(){context.place.place_id=placeId;that.finishRendering(context)}})}else{delete context.place;that.finishRendering(context)}},finishRendering:function(context){var that=this;var tweetHasCoordinates=!!that.coordinates;var placeHasGeometry=!!(context.place&&(context.place.geometry||context.place.bounding_box));context.show_map=tweetHasCoordinates||placeHasGeometry;if(context.show_map||context.place){var $content=(new twttr.views[that.opts.viewName](context)).$html();if($.browser.safari&&!navigator.userAgent.match(/Chrome/)){$content.find(".map_canvas").addClass("notransform");that.opts.mapOptions.draggable=false}that.$target.append($content)}if(context.show_map){that.drawMap($content.find(".map_canvas"),context.place)}},drawMap:function($canvas,place){var that=this;twttr.geo.loadMaps(function(){that.geoMap=new twttr.geo.Map($canvas,that.opts.mapOptions);if(!that.geoMap.initialized){return }var isPoint=false;if(place){if(place.geometry){var coordinates=place.geometry.coordinates;if(place.geometry.type=="Polygon"){that.geoMap.addPlacePolygon(coordinates)}else{if(place.geometry.type=="MultiPolygon"){twttr.each(coordinates,function(polygonCoordinates){that.geoMap.addPlacePolygon(polygonCoordinates)})}else{if(place.geometry.type=="Point"){that.geoMap.addPoi(coordinates);isPoint=true}}}}else{var coordinates=place.bounding_box.coordinates;var sw=coordinates[0][0];var ne=coordinates[0][2];if(sw[0]==ne[0]&&sw[1]==ne[1]){that.geoMap.addPoi(coordinates[0][0]);isPoint=true}else{that.geoMap.addPlacePolygon(coordinates)}}}if(!isPoint&&that.coordinates){that.geoMap.addPoint(that.coordinates,that.avatarUrl)}that.geoMap.adjustBounds(13,!isPoint&&that.coordinates);$canvas.bind("refreshMap",function(){that.geoMap.resize()})})}});twttr.klass.component("twttr.components.TweetGeoBig").initializer(function(tweet,placeId){if(tweet.geo||placeId||tweet.coordinates){new twttr.geo.TweetGeo(tweet,placeId,this.$node,{viewName:"GeoMapBig",mapOptions:{}})}this.hasRendered()}).statics({shouldProfile:false}).deciderKey("tweet_geo_component");twttr.klass.component("twttr.components.TweetGeoSmall").statics({shouldProfile:false}).initializer(function(tweet,placeId){if(!placeId&&!tweet.showGeoMap){return }if(tweet.geo||(tweet.place&&tweet.place.id)||placeId||tweet.coordinates){new twttr.geo.TweetGeo(tweet,placeId,this.$node,{viewName:"GeoMapSmall",mapOptions:{draggable:false,disableDoubleClickZoom:true,navigationControl:false}});this.hasRendered()}}).deciderKey("tweet_geo_component");twttr.klass.component("twttr.components.NewestListMembers").initializer(function(list){var that=this;list.members().first(4,function(members){if(members.length()){new twttr.views.NewestListMembers({list:list.attributes,members:new twttr.views.UserSmallList(members)}).render(that.$node,"append");if(twttr.isNarrow){twttr.helpers.ellipsify(that.$find("div.bio"))}that.hasRendered()}that.profiler.done()})}).deciderKey("newest_list_members_component");twttr.klass.component("twttr.components.StreamEnd").statics({shouldProfile:false}).initializer(function(text){new twttr.views.StreamEnd({end_text:text}).render(this.$node,"append")});twttr.klass.component("twttr.components.StreamWhaleEnd").statics({shouldProfile:false}).initializer(function(text){var that=this;new twttr.views.StreamWhaleEnd({text:text}).render(this.$node,"append");this.$node.delegate(".try-again-after-whale","click",function(e){that.trigger("tryAgain")})});twttr.klass.component("twttr.components.ContactImportErrorEnd").initializer(function(){var that=this,text=_("There was an error loading your contacts.");new twttr.views.StreamWhaleEnd({text:text}).render(this.$node,"append");this.$node.delegate(".try-again-after-whale","click",function(e){that.trigger("tryImportAgain")});this.profiler.done()});twttr.klass.component("twttr.components.EmptyHome").initializer(function(){this._render();this.hasRendered()}).statics({shouldProfile:false}).methods({_render:function(){var user=twttr.currentUser;new twttr.views.EmptyHome({screen_name:user.screenName,protected_account:user["protected"]}).render(this.$node.empty(),"append")}});twttr.klass.component("twttr.components.GettingStarted").initializer(function(noobLevel){this.noobLevel=parseInt(noobLevel,10);this.createView();this.$node.delegate("a","click",function(e){var $link=$(this);if(!$link.attr("class")){trackClient({section:"dashboard",component:"getting_started",action:"click"},{url:$link.attr("href"),context:"noob"})}});this.$node.delegate("a.new-tweet","click",function(e){e.preventDefault();new twttr.widget.TweetDialog({modal:false,draggable:true,template:{title:_("@{{screen_name}}'s first Tweet",{screen_name:twttr.currentUser.screenName})},origin:"new-tweet-getting-started"}).open().focus();trackClient({section:"dashboard",component:"getting_started",action:"compose_tweet"},"noob")});var that=this;this.$node.delegate("a.hidenextsteps","click",function(e){e.preventDefault();that.$node.slideUp("fast",function(){that.constructor.prototype.trigger("dismiss")});trackClient({section:"dashboard",component:"getting_started",action:"dismiss"},"noob")});this.constructor.prototype.bind("dismiss",function(){twttr.caches.User.set("noobLevel",that.noobLevel=twttr.constants.noob.dismissed);that.refreshView()});function onNoobChange(){setTimeout(function(){that.noobLevel=twttr.helpers.userNoobLevel(twttr.currentUser);that.refreshView()},1)}twttr.API.User.bind("follow.GettingStartedComponent",onNoobChange);twttr.API.User.bind("unfollow.GettingStartedComponent",onNoobChange);twttr.TweetBox.bind("tweetSuccess.GettingStartedComponent",onNoobChange)}).statics({shouldProfile:false}).methods({refreshView:function(){this.$node.empty();if(this.noobLevel>=0){this.createView()}else{twttr.API.User.unbind("follow.GettingStartedComponent");twttr.API.User.unbind("unfollow.GettingStartedComponent");twttr.TweetBox.unbind("tweetSuccess.GettingStartedComponent")}},createView:function(){new twttr.views.DashboardGettingStarted(this.noobLevel).render(this.$node,"append");twttr.helpers.addFormEvents(this.$find("form.who-to-follow-search"),function(event,values){if(values.q!=""){trackClient({section:"dashboard",component:"getting_started",action:"search"},{query:values.q,context:"noob"});twttr.router.routeTo(twttr.router.whoToFollowSearchPath({query:values.q}))}});this.hasRendered()}});twttr.klass.component("twttr.components.AddPeople").initializer(function(){new twttr.views.AddPeople().render(this.$node.empty(),"append");twttr.helpers.addFormEvents(this.$find("form.search-for-list-people"),function(){var v=this.q.value;if(v!=""){twttr.router.routeTo(twttr.router.whoToFollowSearchPath({query:v}));scribble("search-for-people",{input:"click"})}});this.hasRendered();this.profiler.done()});twttr.klass.component("twttr.components.NoListMembers").initializer(function(){var that=this;this._render();this.hasRendered()}).statics({shouldProfile:false}).methods({_render:function(){new twttr.views.NoListMembers().render(this.$node.empty(),"append")}});twttr.klass.component("twttr.components.Media").initializer(function(tweet,width,photoId){this.hasSlideshow=(!!photoId||false)&&twttr.decider.isAvailable("phoenix_photo_permalink");this.photoId=photoId;this.tweet=tweet;this.urls=twttr.media.extractUrls(tweet);this.$node.prepend($('<div class="tweet-media"/>'));this.$mediaNode=this.$node.find(".tweet-media");this.width=width;this.hasCalledHasRendered=false;var that=this;this.checkForMedia(function(hasMedia){if(hasMedia){if(that.restrictedMedia()){twttr.loggedIn?that.loggedInBehavior():that.loggedOutBehavior()}else{that.renderMedia()}}})}).deciderKey("inline_media_component").statics({restrictedCategories:{photo:true,video:true}}).methods({checkForMedia:function(cb){var that=this;if(twttr.util.objKeys(this.urls).length===0){this.profiler.done();cb(false);return }twttr.media.mediaTypes(this.urls,function(mediaTypes){that.mediaTypes=mediaTypes;if(twttr.util.objKeys(that.mediaTypes).length===0){that.profiler.done();cb(false);return }cb(true)})},onProfilePage:function(){return twttr.profileUser&&(twttr.profileUser.id==this.tweet.user.id)},restrictedMedia:function(){var restricted=false;$.each(this.mediaTypes,function(index,mediaType){var iconType=twttr.media.iconType(index,mediaType);if(!!twttr.components.Media.restrictedCategories[iconType]){restricted=true}});return restricted},loggedInBehavior:function(){var user=this.tweet.retweetingStatus?this.tweet.retweetingStatus.user:this.tweet.user;var that=this;if(twttr.helpers.isCurrentUser(user)){this.renderMedia();return }twttr.currentUser.relationshipWith(user,function(relationship){user.sync("following",relationship.following);relationship.following?that.renderMedia():that.notFollowingBehavior()})},notFollowingBehavior:function(){var that=this;twttr.currentUser.showAllInlineMedia({success:function(show){show?that.renderMedia():that.renderBlockedMessage()},error:function(e){twttr.showError(_("Couldn't get inline media settings: {{error_msg}}",{error_msg:e.statusText}))}})},loggedOutBehavior:function(){this.onProfilePage()?this.renderMedia():this.renderBlockedMessage()},createSlideshow:function(){this.slideshow=new twttr.components.MediaSlideshow({defaultMediaIndex:this.photoId,thumbHeight:32,thumbWidth:32,thumbDisplayHeight:32,thumbDisplayWidth:32,clickToShowGallery:true});this.slideshow.$node.prependTo(this.$mediaNode)},renderMedia:function(){var that=this;var embed=new twttr.media.Embedder(this.tweet,{DOMContainer:that.$mediaNode,preProcess:function(mediaInstance,cb){if(mediaInstance.icon()=="photo"&&that.hasSlideshow){if(!that.slideshow){that.createSlideshow()}that.slideshow.addMedia(mediaInstance.url)}else{cb({maxwidth:that.width})}},afterRender:function(mediaInstance,renderOptions){if(!that.hasCalledHasRendered){that.profiler.done();that.hasRendered();that.hasCalledHasRendered=true}}}).render(function(){if(that.slideshow){that.slideshow.addMediaComplete()}})},renderBlockedMessage:function(){var that=this;if(!that.hasCalledHasRendered){that.profiler.done();that.hasRendered();that.hasCalledHasRendered=true}if(this.$node.find(".media-not-displayed:visible").get(0)){return }new twttr.views.MediaNotDisplayed().render(this.$node,"prepend");var showMediaOnClick=twttr.bind(this,function(e){this.renderMedia();this.$node.find(".media-not-displayed").hide()});this.$node.find(".display-this-media").click(showMediaOnClick);this.$node.find(".always-display-media").click(function(e){twttr.currentUser.updateShowAllInlineMedia(true,{success:function(){showMediaOnClick(e)},error:function(e){twttr.showError(_("Couldn't set inline media settings."))}})})}});twttr.klass.component("twttr.components.Footer").initializer(function(){this.view=new twttr.views.DashboardFooter({year:2011}).render(this.$node,"append");if(!twttr.loggedIn){this.$node.delegate("a","click",function(evt){var scribeData={url:$(this).attr("href"),context:twttr.audit.currentPage()};var scribeTerms={section:"footer",component:"link",action:"click"};trackClient(scribeTerms,scribeData)})}this.hasRendered();this.registerEvents()}).statics({shouldProfile:false}).methods({registerEvents:function(){this.view.delegate("a","mousedown",function(e){var link=$(this);scribble("footer",{input:"click",name:link.text(),href:link.attr("href")})})}});twttr.klass.component("twttr.components.TweetPane").mixin(twttr.mixins.tweetActionable,twttr.mixins.i18nTweet).initializer(function(tweet){new twttr.views.TweetPane({tweet:new twttr.views.BaseTweet(tweet)}).render(this.$node,"append");this._tweetId=tweet.id;this.registerTweetActionEvents();this.updateI18nDisplay();this.hasRendered()}).methods({onTweetActionDelete:function(tweetId){if(tweetId===this._tweetId){this.trigger("deleted")}}});twttr.klass.component("twttr.components.ProfilePane").statics({shouldProfile:false}).initializer(function(user){var profilePaneView=new twttr.views.ProfilePane(user);profilePaneView.render(this.$node,"append");twttr.viewHelpers.addMapLink(user.location,this.$find(".user-info .location"));if(twttr.loggedIn){this.$node.append(new twttr.components.ProfileActions(user).$node)}this.hasRendered()});twttr.klass.component("twttr.components.DashboardProfileStats").statics({shouldProfile:false}).initializer(function(user,title){var that=this;new twttr.views.DashboardProfileStats(user,title).render(this.$node,"append");this.hasRendered();var profileUser=user;function updateFollowCount(didFollow){var val=didFollow?1:-1;profileUser.attributes.friends_count+=val;new twttr.views.DashboardProfileStats(profileUser,title).render(that.$node,"html")}twttr.API.User.bind("follow.YourActivity",function(e,user){if(profileUser.id===twttr.currentUser.id){updateFollowCount(true)}});twttr.API.User.bind("unfollow.YourActivity",function(e,user){if(profileUser.id===twttr.currentUser.id){updateFollowCount(false)}})});twttr.klass.component("twttr.components.RSSFeeds").initializer(function(type,user){type=type||"home";user=user||twttr.currentUser;this.view=new twttr.views.RssFeeds({feeds:[{href:"/statuses/friends_timeline/"+user.id+".rss",title:type==="home"?_("RSS Feed"):_("RSS Feed of {{username}}'s tweets",{username:user.screenName})}]}).render(this.$node,"append");this.hasRendered();this.registerEvents()}).methods({registerEvents:function(){}});twttr.klass.component("twttr.components.JapaneseAd").initializer(function(){if(twttr.pageLocale!=="ja"){this.$node.hide();return }var profiler=new twttr.util.Profiler(this.constructor._namespace);new twttr.views.JapaneseAd().render(this.$node,"append");if(!this.constructor.loadedOnce){this.constructor.loadedOnce=true;var randomCallbackName="loadedJsCallBack"+parseInt(Math.random()*100000,10);twttr.components.JapaneseAd.callbacks[randomCallbackName]=function(adSrc){delete twttr.components.JapaneseAd.callbacks[randomCallbackName];twttr.components.JapaneseAd.loadedJsCallback(adSrc,profiler)};$.getScript(window.location.protocol+twttr.constants.japaneseAdUrl+randomCallbackName)}else{this.constructor.refreshAds()}}).statics({shouldProfile:false,callbacks:{},loadedJsCallback:function(adSrc,profiler){this.etologyAdSrc=adSrc[0];if(typeof renderAd==="function"){var oldRenderAd=renderAd;renderAd=function(adData){if(document.getElementById(adData.spaceTag)){oldRenderAd.apply(this,arguments)}}}this.refreshAds(profiler)},refreshAds:function(profiler){if(this.etologyAdSrc){scribble("japanese-ad-refresh",{adSource:this.etologyAdSrc});var cacheBuster="?t="+new Date().getTime();$.getScript(this.etologyAdSrc+cacheBuster)}if(profiler){profiler.done()}}}).deciderKey("japanese_ad_component");twttr.klass.component("twttr.components.ProtectedUser").statics({shouldProfile:false}).initializer(function(user){new twttr.views.ProtectedUser(user).render(this.$node,"append")});twttr.klass.component("twttr.components.PermalinkTweet").mixin(twttr.mixins.tweetActionable,twttr.mixins.i18nTweet).initializer(function(tweet){new twttr.views.PermalinkTweet(tweet).render(this.$node,"append");this._tweetId=tweet.id;this.registerTweetActionEvents();this.updateI18nDisplay();this.hasRendered();this.profiler.done()}).methods({faveTweet:function(action){this.tweetActionFavorite(this.$find(".tweet"),action)},replyTweet:function(action){this.tweetActionReply(this.$find(".tweet"),action)},retweetTweet:function(action){this.tweetActionRetweet(this.$find(".tweet"),action)},onTweetActionDelete:function(tweetId){if(tweetId===this._tweetId){this.trigger("deleted")}}});twttr.klass.component("twttr.components.PlacePeople").initializer(function(place){var that=this;if(place){twttr.API.Status.search("place:"+place.id,{success:function(tweetCollection){var userIds={};var users=[];tweetCollection.some(function(tweet){if(tweet.user&&!(tweet.user.id in userIds)){userIds[tweet.user.id]=true;users.push(tweet.user)}return users.length>=10});if(users.length>0){var context=$.extend({},place,{user_thumbs:new twttr.views.UserThumbList(new twttr.anywhere.api.util.BaseCollection(users))});new twttr.views.PlacePeople(context).render(that.$node,"append");that.hasRendered()}that.profiler.done()},error:function(){that.profiler.done()}})}}).deciderKey("place_people_component");twttr.klass.component("twttr.components.PlaceBusiness").initializer(function(place){var that=this;if(place&&place.poi){var context={place_name:place.name};var ownerName=twttr.geo.getPlaceAttribute(place,"twitter");if(ownerName){twttr.API.User.find(ownerName,function(owner){context.user_list=new twttr.views.UserSmallList(new twttr.anywhere.api.util.BaseCollection([owner]));if(owner.status){context.tweet=new twttr.views.BaseTweet(owner.status)}new twttr.views.PlaceBusinessClaimed(context).render(that.$node,"append");that.hasRendered();that.profiler.done()})}else{that.profiler.done()}}}).deciderKey("place_business_component");twttr.klass.component("twttr.components.NoUserExists").statics({shouldProfile:false}).initializer(function(){this.$node.append("<p class='no-user tweet-text tweet-text-large'>"+_("This user does not exist.")+"</p>");this.hasRendered()});twttr.klass.component("twttr.components.SignupCallOut").initializer(function(page,profileUser){var view;if(profileUser){view=new twttr.views.ProfileSignupCallOut(twttr.merge({signup_source:page},profileUser.attributes))}else{view=new twttr.views.NewSignupCallOut({signup_source:page})}view.render(this.$node.empty(),"append");this.$node.delegate("form.signup-btn","submit",function(evt){trackClient({section:"signup_callout",component:"form",action:"signup_click"})});this.hasRendered();this.profiler.done()});twttr.klass.component("twttr.components.SuggestionCategoriesList").statics({shouldProfile:false}).initializer(function(categories,pathRoot,slug){var links=this.categoriesToLinks(categories,pathRoot,slug);new twttr.views.LinkList(links,"&middot;").render(this.$node,"append");this.$find("ul").addClass("categories-list")}).mixin(twttr.mixins.discoveryHelper).methods({categoriesToLinks:function(categories,pathRoot,slug){var that=this;if(!categories){return[]}return categories.map(function(category,i){var data={text:category.localeType?_(category.name):category.name};if(slug==category.slug){return data}else{var href=that.pagePathFor(pathRoot,"InterestsCategory",{category:category.slug});return twttr.merge(data,{href:href})}}).array}});twttr.klass.component("twttr.components.ContactImportMatchesStats").initializer(function(stream,data){new twttr.views.ContactImportMatchesStats(data).render(this.$node,"append");this.$node.delegate(".follow-all-button","click",function(e){stream._followAll($(this));e.preventDefault()});this.$node.delegate(".save-as-list","click",function(e){stream._saveAsList($(this));e.preventDefault()});this.$node.delegate(".invite-contacts","click",function(e){stream.inviteOthers();e.preventDefault()});this.profiler.done()});twttr.klass.component("twttr.components.SocialContext").initializer(function(){var that=this;var viewOptions={screen_name:twttr.profileUser.screenName};var resultsIds=[];function makeScreenNameList(users){return users.map(function(user){return(new twttr.views.UserLink(user.attributes)).html()})}function makeCaption(text,urlFunction,users){if(twttr.isNarrow){var count=users.length();return count?(new twttr.views.SocialContextNarrow({is_plural:count!==1,following_followers_of:text==="following_followers_of",screen_name:twttr.profileUser.screenName,view_all:urlFunction({screen_name:twttr.profileUser.screenName})})).html():""}var screenNames=users.map(function(user){return(new twttr.views.UserLink(user.attributes)).html()});var caption="";function getPrefix(){if(text=="following_followers_of"&&twttr.profileUser.following){return"Also f"}else{return"F"}}switch(users.length()){case 0:break;case 1:if(text=="following_followers_of"){caption=_(getPrefix()+"ollowed by {{{first}}}.",{first:screenNames.get(0)})}else{caption=_("You both follow {{{first}}}.",{first:screenNames.get(0)})}break;case 2:if(text=="following_followers_of"){caption=_(getPrefix()+"ollowed by {{{first}}} and {{{second}}}.",{first:screenNames.get(0),second:screenNames.get(1)})}else{caption=_("You both follow {{{first}}} and {{{second}}}.",{first:screenNames.get(0),second:screenNames.get(1)})}break;case 3:if(text=="following_followers_of"){caption=_(getPrefix()+"ollowed by {{{first}}}, {{{second}}}, and {{{third}}}.",{first:screenNames.get(0),second:screenNames.get(1),third:screenNames.get(2)})}else{caption=_("You both follow {{{first}}}, {{{second}}}, and {{{third}}}.",{first:screenNames.get(0),second:screenNames.get(1),third:screenNames.get(2)})}break;default:if(text=="following_followers_of"){caption=_(getPrefix()+'ollowed by {{{first}}}, {{{second}}}, {{{third}}}, and <a href="{{{more}}}">more</a>.',{first:screenNames.get(0),second:screenNames.get(1),third:screenNames.get(2),more:urlFunction({screen_name:twttr.profileUser.screenName})})}else{caption=_('You both follow {{{first}}}, {{{second}}}, {{{third}}}, and <a href="{{{more}}}">more</a>.',{first:screenNames.get(0),second:screenNames.get(1),third:screenNames.get(2),more:urlFunction({screen_name:twttr.profileUser.screenName})})}}return caption}this.$node.delegate(".user-profile-link","click",function(e){var $target=$(e.target);var eventInfo=null;if($($target.closest("div")).attr("class").indexOf("you-both-follow")!=-1){eventInfo="following_social_context"}else{eventInfo="followers_social_context"}trackClient({section:"dashboard",component:"social_context",action:"profile_click"},{profile_id:twttr.profileUser.id,context:"dashboard",item_ids:[parseInt($(this).attr("data-user-id"))],item_count:1,eventInfo:eventInfo})});var componentRendered=false;that.bind("socialContextResults",function(event,key,results,users){viewOptions[key]=results;resultsIds=resultsIds.concat(users.map(function(user){return user.id}).array);if(!componentRendered&&viewOptions.followers_you_follow&&viewOptions.you_both_follow){trackClient({section:"dashboard",component:"social_context",action:"results"},{profile_id:twttr.profileUser.id,item_ids:resultsIds,item_count:resultsIds.length,context:"dashboard"});componentRendered=true;if(twttr.isNarrow){viewOptions.accounts_in_common=$.isEmptyObject(viewOptions.followers_you_follow)?viewOptions.you_both_follow:viewOptions.followers_you_follow}var view=new twttr.views.DashboardSocialContext(viewOptions);if(!$.isEmptyObject(viewOptions.followers_you_follow)||!$.isEmptyObject(viewOptions.you_both_follow)){view.render(that.$node,"append");that.hasRendered();that.profiler.done()}}});twttr.currentUser.followingFollowersOf(twttr.profileUser.id,{success:function(users){var followingFollowersResults={};if(!users.isEmpty()){followingFollowersResults={caption:makeCaption("following_followers_of",twttr.router.followersYouFollowPath,users),avatar_list:(new twttr.views.UserThumbList(users.slice(0,10))).html()}}that.trigger("socialContextResults",["followers_you_follow",followingFollowersResults,users])}});twttr.currentUser.followsInCommonWith(twttr.profileUser.id,{success:function(users){var followsInCommonResults={};if(!users.isEmpty()){followsInCommonResults={caption:makeCaption("follows_in_common_with",twttr.router.youBothFollowPath,users),avatar_list:(new twttr.views.UserThumbList(users.slice(0,10))).html()}}that.trigger("socialContextResults",["you_both_follow",followsInCommonResults,users])}})}).deciderKey("social_context");twttr.klass.component("twttr.components.LanguageLinks").statics({shouldProfile:false}).initializer(function(){this.view=new twttr.views.LanguageLinks().render(this.$node,"append");this.$find("div.language form").submit(function(){trackClient({section:"footer",component:"language_selector",action:"select"},{event_info:this.lang.value})});this.hasRendered();this.registerEvents()}).methods({registerEvents:function(){this.view.delegate("a","click",function(e){e.preventDefault();var $this=$(this),$form=$this.parents("form");$form.find('input[name="lang"]').val($this.attr("hreflang"));$form.submit()})}});twttr.klass.component("twttr.components.facets.Base").initializer(function(queryManager,options){options=options||{};this.options=options;this.size=options.size||"medium";this.count=this.count||options.count||100;this.offset=this.offset||options.offset||0;this.score=options.score||true;this._itemCache={};if(queryManager&&this._type){var that=this;queryManager.facetBind(this._type,{count:this.count,score:this.score},function(e,data){that.dataReady(data)})}}).methods(twttr.EventProvider).methods({QUALITY_THRESHOLD:0,render:function(){throw new Error("You should implement this.")},dataReady:function(data){this._data=data;if(data.scoreQuality>this.QUALITY_THRESHOLD){this.render()}}});twttr.klass.component("twttr.components.facets.Media").subclassOf(twttr.components.facets.Base).methods({render:function(){var that=this;var urls=$.map(this._data.topFacets,function(item){that._itemCache[item.name]=item;return item.name});this.trigger("urlsLoaded",urls);if(urls.length>0){var $facetNode=new this.viewTemplate({title:this.title}).$html();this.$node.append($facetNode);var options={imageSize:this.imageSize,cacheSize:this.cacheSize,width:340,itemWidth:this.itemWidth||83,itemHeight:this.itemHeight||83,itemDisplayWidth:this.itemDisplayWidth||85};this.thumbnailViewer=new twttr.components.ThumbnailViewer(urls,options);this.thumbnailViewer.bind("select",function(e,url){twttr.router.routeTo(twttr.router.searchFacetsSlideshowPath({query:that.options.query,mode:that._type==="images"?"photos":that._type})+"?firstUrl="+encodeURIComponent(url))});this.thumbnailViewer.bind("pagedTo",function(e,page){scribble("search_facets_thumbnail_page",{mode:that._type==="images"?"photos":that._type,query:that.options.query,page:page})});this.$find(".facets-media-thumb-container").replaceWith(this.thumbnailViewer.$node)}this.afterRender();this.hasRendered();this.profiler.done()},afterRender:function(){},viewTemplate:twttr.views.FacetMedia});twttr.klass.component("twttr.components.facets.Images").subclassOf(twttr.components.facets.Media).initializer(function(queryManager){var that=this;this.title=_("Popular photos");this._type="images";this._superInitializer(arguments);this.$node.delegate(".view-all","click",function(){twttr.router.routeTo(twttr.router.searchFacetsGridPath({query:that.options.query,mode:"photos"}));scribble("facets_view_all_click",{mode:"photos",query:that.options.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})})}).deciderKey("phoenix_facets_images");twttr.klass.component("twttr.components.facets.Videos").subclassOf(twttr.components.facets.Media).initializer(function(queryManager){var that=this;this.itemWidth=112;this.itemDisplayWidth=114;this.title=_("Popular videos");this._type="videos";this._superInitializer(arguments);this.$node.delegate(".view-all","click",function(){twttr.router.routeTo(twttr.router.searchFacetsGridPath({query:that.options.query,mode:"videos"}));scribble("facets_view_all_click",{mode:"videos",query:that.options.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})})}).deciderKey("phoenix_facets_videos");twttr.klass.component("twttr.components.ThumbnailViewer").initializer(function(urls,options){if(options){this.imageSize=options.imageSize||this.imageSize;this.cacheSize=options.cacheSize||this.cacheSize;this.itemWidth=options.itemWidth||60;this.itemHeight=options.itemHeight||60;this.itemDisplayWidth=options.itemDisplayWidth||this.itemWidth;this.itemDisplayHeight=options.itemDisplayHeight||this.itemHeight;this.width=options.width||304;if(!twttr.is.def(options.fadeOutNav)){this.fadeOutNav=true}else{this.fadeOutNav=options.fadeOutNav}}this.urls=urls;new twttr.views.ThumbnailViewer().render(this.$node,"append");this.thumbSetup();this._registerEventHandlers();this.profiler.done()}).methods({_animateTo:function(page){var pos=0;if(page<1){page=1}else{if(page>this.pages){page=this.pages}}if(page==this.currentPage){return }if(page==this.pages){pos=this.thumbsWidth-this.width}else{pos=(page-1)*this.thumbsPerPage*this.itemDisplayWidth}var animate=Modernizr.csstransitions?"animateWithCss":"animate";this.$thumbs[animate]({left:-pos},400,"swing");this.currentPage=page;this.updatePageNavigation();this.trigger("pagedTo",page)},thumbSetup:function(){var that=this;this.$thumbs=this.$find(".thumbnail-viewer-images");this.$container=this.$find(".thumbnail-viewer-container");this.thumbsWidth=this.urls.length*this.itemDisplayWidth;this.$thumbs.width(this.thumbsWidth);this.$thumbs.css("left",0);this._calculatePaging();var $divs=twttr.images.renderMediaUrls(this.urls,{width:this.itemWidth,height:this.itemHeight,size:twttr.constants.imageSizes.small,scalingMode:"trim"}).addClass("thumbnail-image-wrapper").bind("failedToResolve failedToLoad",function(e,reason){$(this).remove();that.thumbsWidth-=that.itemDisplayWidth;that.$thumbs.width(that.thumbsWidth)}).bind("loaded",function(){twttr.images.animateImageFadeIn($(this).find("img"),500,0.75)});$divs.append('<div class="thumbnail-active-border"><div class="thumbnail-active-border-inner"></div></div>');this.$thumbs.append($divs);this.trigger("pagedTo",this.currentPage)},_calculatePaging:function(){var that=this;this.currentPage=1;this.thumbsPerPage=Math.floor(this.width/this.itemDisplayWidth);this.pages=Math.ceil(this.urls.length/this.thumbsPerPage);if(this.thumbsWidth-this.width<=this.itemDisplayWidth-this.itemWidth&&this.thumbsWidth-this.width>0){this.pages--}if(this.pages==1){this.$find(".thumbnail-viewer-nav").hide()}else{this.$node.delegate(".thumbnail-viewer-prev","click",function(e){that.prevPage()});this.$node.delegate(".thumbnail-viewer-next","click",function(e){that.nextPage()})}this.updatePageNavigation()},prevPage:function(){this._animateTo(this.currentPage-1)},nextPage:function(){this._animateTo(this.currentPage+1)},updatePageNavigation:function(){if(this.currentPage==1){this.$find(".thumbnail-viewer-prev").addClass("disabled")}else{this.$find(".thumbnail-viewer-prev").removeClass("disabled")}if(this.currentPage==this.pages){this.$find(".thumbnail-viewer-next").addClass("disabled")}else{this.$find(".thumbnail-viewer-next").removeClass("disabled")}},selectedIndex:function(){return this.$thumbs.index(".media-thumbail-active")+1},selectByIndex:function(i){var $children=this.$thumbs.children();if(i>$children.length){i=1}this.select($children.eq(i-1))},select:function($elem){if($elem.length===0){return }this.$node.find(".media-thumbnail").removeClass("media-thumbnail-active");$elem.addClass("media-thumbnail-active");this.trigger("select",[$elem.attr("data-url"),$elem.prev().length>0,$elem.next().length>0,$elem.prevAll().length+1]);this._checkPage($elem)},prev:function(){this.select(this.$find(".media-thumbnail-active").prev())},next:function(){this.select(this.$find(".media-thumbnail-active").next())},_checkPage:function($elem){var i=$elem.prevAll().length+1;var page=Math.ceil(i/this.thumbsPerPage);this._animateTo(page)},_registerEventHandlers:function(){var that=this;this.$node.delegate(".media-thumbnail","click",function(e){that.select($(this))});if(this.fadeOutNav){this.$nav=this.$find(".thumbnail-viewer-nav").css("opacity",0);var animate=Modernizr.csstransitions?"animateWithCss":"animate";this.$node.hover(function(){if(that.fadeTimer){clearTimeout(that.fadeTimer)}that.$nav[animate]({opacity:1},400,"swing")},function(){that.fadeTimer=window.setTimeout(function(){that.$nav[animate]({opacity:0},400,"swing")},1500)})}}});twttr.klass.component("twttr.components.TheGrid").initializer(function(options,width){new twttr.views.TheGrid().render(this.$node,"append");this.urls=[];this.imageWidth=options.imageWidth||174;this.imageHeight=options.imageHeight||174;this.margin=options.margin||2;this.chunksize=options.chunksize||15;if(options.type==="search"){this.type="search";this.query=options.query;this.mode=options.mode;twttr.SearchAPI.getFacetMediaUrls({count:100,score:true,query:options.query,mode:options.mode,success:twttr.bind(this,this.loadUrls)})}this.$node.width(width)}).methods({doLoad:function(urls){var that=this;var total=urls.length;var $divs=twttr.images.renderMediaUrls(urls,{width:this.imageWidth,height:this.imageHeight,size:twttr.constants.imageSizes.medium,scalingMode:"trim"}).addClass("grid-square").bind("failedToResolve failedToLoad",function(e,reason){$(this).remove();total--;if(total==0){that.renderAndResolve()}});$divs.bind("loaded",function(){total--;if(total==0){that.renderAndResolve()}twttr.images.animateImageFadeIn($(this).find("img"))});this.$find(".the-grid").append($divs)},renderAndResolve:function(){var that=this;var urlSet=this.urls.splice(0,this.chunksize);if(urlSet.length>0){this.doLoad(urlSet)}},loadUrls:function(urls){var that=this;this.urls=urls;this.renderAndResolve();this.$node.delegate("a","click",function(){that.trigger("askForDetails",[this.href,urls]);return false});this.profiler.done();if(this.type=="search"){scribble("facets_grid_impression",{mode:this.mode,query:this.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})}},_howManyFit:function(width,height){var perRow=Math.floor((width+this.margin)/(this.imageWidth+this.margin));var rows=Math.ceil(height/(this.imageHeight+this.margin));return rows*perRow}});twttr.klass.component("twttr.components.MediaGalleryControls").initializer(function(options){this._options=options||{};this._type=options.type||"search";this._view=options.view||"grid";this._mode=options.mode||"photos";this._query=options.query||"";this._render();this._registerEvents()}).methods({_registerEvents:function(){var that=this;this.$node.delegate(".media-gallery-close","click",function(e){that.trigger("close")});this.$detailView=this.$find(".toggle-button.detailview");this.$gridView=this.$find(".toggle-button.gridview");this.$detailView.bind("click",function(e){that.setMode("detail")});this.$gridView.bind("click",function(e){that.setMode("grid")})},setMode:function(view){if(this._view==view){return }if(view=="grid"){this.$gridView.addClass("selected");this.$detailView.removeClass("selected");this.trigger("gridViewSelected")}else{this.$gridView.removeClass("selected");this.$detailView.addClass("selected");this.trigger("detailViewSelected")}this._view=view},_render:function(){new twttr.views.MediaGalleryControls({is_search:this._type==="search",is_grid_view:this._view==="grid",is_detail_view:this._view==="detail",mode:this._mode,query:this._query}).render(this.$node,"append")}});twttr.klass.component("twttr.components.MediaSlideshow").mixin(twttr.mixins.tweetActionable).initializer(function(options){var that=this;options=options||{};this._urls=[];this.options=options;this.width=options.width||530;this.height=options.height||530;this.thumbContainerWidth=options.thumbContainerWidth||494;this.thumbHeight=options.thumbHeight||55;this.thumbWidth=options.thumbWidth||55;this.thumbDisplayWidth=options.thumbDisplayWidth||57;this.thumbDisplayHeight=options.thumbDisplayHeight||55;this.mediaType=options.mediaType||"photos";this.type=options.type;this.render();this.registerTweetActionEvents();if(this.type==="search"){this._query=options.query;var facetsOptions={count:100,mode:options.mode,query:options.query,kittens:options.kittens,score:true,error:function(){},success:function(urls){var idx=$.inArray(options.firstUrl,urls)+1;if(idx==0){idx=1}that.options.defaultMediaIndex=idx;that.addMedia(urls);that.addMediaComplete();scribble("facets_slideshow_impression",{mode:options.mode,query:options.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})}};twttr.SearchAPI.getFacetMediaUrls(facetsOptions)}else{if(this.type==="permalink"){var idx=$.inArray(options.firstUrl,options.urls)+1;if(idx==0){idx=1}that.options.defaultMediaIndex=idx;that.addMedia(options.urls);that.addMediaComplete()}}}).methods(twttr.EventProvider).methods({render:function(){var that=this;new twttr.views.MediaSlideshow().render(this.$node,"append");this.$thumbnails=this.$find(".media-slideshow-thumbnails");this.$bigPicture=this.$find(".media-slideshow-picture");this.$prevButton=this.$find(".media-control-button.prev");this.$nextButton=this.$find(".media-control-button.next");this.$bigPicture.css({height:this.height,width:this.width});this._registerEventHandlers()},addMediaComplete:function(){var that=this;if(this._urls.length>1){var options={itemWidth:this.thumbWidth,itemHeight:this.thumbHeight,itemDisplayWidth:this.thumbDisplayWidth,itemDisplayHeight:this.thumbDisplayHeight,width:this.thumbContainerWidth};this._thumbnailViewer=new twttr.components.ThumbnailViewer(this._urls,options);this._thumbnailViewer.$node.appendTo(this.$thumbnails);this._thumbnailViewer.bind("select",function(e,url,hasPrev,hasNext,idx){that.showPicture(url,hasPrev,hasNext,idx)});this._thumbnailViewer.bind("pagedTo",function(e,page){scribble("search_gallery_thumbnail_page",{mode:that.mediaType,query:that._query,page:page,userId:(twttr.currentUser)?twttr.currentUser.id:null})});this._thumbnailViewer.selectByIndex(that.options.defaultMediaIndex)}else{this.showPicture(that._urls[0],false,false,1)}},_registerEventHandlers:function(){var that=this;if(this.options.clickToAdvance){this.$bigPicture.bind("click",twttr.bind(this,this.showNext))}this.$nextButton.bind("click",twttr.bind(this,this.showNext));this.$prevButton.bind("click",twttr.bind(this,this.showPrev))},addMedia:function(urls){this._urls=this._urls.concat(urls)},showPicture:function(url,hasPrev,hasNext,idx){this.currentUrl=url;if(this.mediaType=="photos"){this.renderPicture()}else{this.renderVideo()}this.renderTweet(url);if(hasPrev){this.$prevButton.addClass("enabled")}else{this.$prevButton.removeClass("enabled")}if(hasNext){this.$nextButton.addClass("enabled")}else{this.$nextButton.removeClass("enabled")}scribble("facets_slideshow_view",{url:url,mode:this.mediaType,query:this._query,index:idx,userId:(twttr.currentUser)?twttr.currentUser.id:null})},removeTweet:function(){this.$find(".media-slideshow-tweet").empty()},renderTweet:function(url){var that=this;this.removeTweet();var searchOptions={success:function(statuses,resp){that.removeTweet();if(statuses.length()>0){var done=false;statuses.each(function(tweet){if(done){return }if(!tweet.isPromoted()&&(tweet.resultCategory=="recent"||tweet.resultCategory=="relevance")){new twttr.views.SlideshowTweet(tweet).render(that.$find(".media-slideshow-tweet"),"append");done=true;scribble("facets_slideshow_tweet_impression",{url:url,mode:that.mediaType,query:that._query,statusId:tweet.id,userId:(twttr.currentUser)?twttr.currentUser.id:null});return }})}},error:function(){}};twttr.API.Status.search(url,searchOptions)},renderVideo:function(){var that=this;var mediaInstance=twttr.media.matchInstance(this.currentUrl);this.$bigPicture.empty();this.$bigPicture.addClass("video");mediaInstance.process(function(){mediaInstance.render(that.$bigPicture);that.resizePicture();setTimeout(function(){that.trigger("mediaRendered")},1)})},renderPicture:function(){var that=this;var $div=twttr.images.renderMediaUrl(this.currentUrl,{width:this.width,height:this.height,size:twttr.constants.imageSizes.large,scalingMode:"fit"}).bind("failedToResolve failedToLoad",function(e,reason){$(this).remove()}).bind("loaded",function(){that.trigger("mediaRendered")});this.$bigPicture.empty().append($div)},resizePicture:function(h,w){this.$bigPicture.css({height:h,width:w});if(this.mediaType=="photos"){twttr.images.resizeImageInDiv(this.$bigPicture,{width:w,height:h,size:"large",scalingMode:"fit"})}else{twttr.images.resizeVideoInDiv(this.$bigPicture)}},showNext:function(){if(this._thumbnailViewer){this._thumbnailViewer.next()}},showPrev:function(){if(this._thumbnailViewer){this._thumbnailViewer.prev()}}});twttr.klass.component("twttr.components.SearchFacets").initializer(function(query,options){this.query=query;this.showBlockMessage=true;this.darkMode=false;if((twttr.loggedIn&&(twttr.decider.isAvailable("phoenix_facets_dark")||twttr.decider.isAvailable("phoenix_facets")))||(!twttr.loggedIn&&twttr.decider.isAvailable("phoenix_facets_logged_out"))){if(twttr.loggedIn&&!twttr.decider.isAvailable("phoenix_facets")&&twttr.decider.isAvailable("phoenix_facets_dark")){this.darkMode=true}this.renderFacets()}}).methods({renderFacets:function(){var that=this;this.queryManager=new twttr.facets.QueryManager();this.facetsImages=new twttr.components.facets.Images(this.queryManager,{query:this.query});this.facetsVideos=new twttr.components.facets.Videos(this.queryManager,{query:this.query});this.facetsImages.bind("urlsLoaded",function(e,urls){if(urls.length>0&&that.showBlockMessage){that.showBlockedMessage();scribble("search_facets_impression",{mode:"photos",query:that.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})}});this.facetsVideos.bind("urlsLoaded",function(e,urls){if(urls.length>0&&that.showBlockMessage){that.showBlockedMessage();scribble("search_facets_impression",{mode:"videos",query:that.query,userId:(twttr.currentUser)?twttr.currentUser.id:null})}});if(twttr.loggedIn){twttr.currentUser.showAllInlineMedia({success:function(show){if(show){that.showBlockMessage=false;that.renderFacetsMedia()}else{that.showBlockMessage=true;that.renderBlockedMessage()}that.profiler.done()},error:function(e){twttr.showError(_("Couldn't get inline media settings: {{error_msg}}",{error_msg:e.statusText}))}})}else{that.showBlockMessage=true;that.renderBlockedMessage()}var qs=twttr.Router.getCurrentQueryStringParams();this.queryManager.query(this.query,{experimentId:qs.experimentId})},renderFacetsMedia:function(){if(this.darkMode){return }this.facetsImages.$node.appendTo(this.$node);this.facetsVideos.$node.appendTo(this.$node)},showBlockedMessage:function(){this.$node.find(".media-not-displayed").show()},renderBlockedMessage:function(){var that=this;if(this.$notDisplayed||this.darkMode){return }this.$notDisplayed=$('<div class="component facets-media"/>');new twttr.views.MediaNotDisplayed().render(this.$notDisplayed);this.$notDisplayed.prependTo(this.$node);this.$node.find(".media-not-displayed").hide();var showMediaOnClick=twttr.bind(this,function(){this.renderFacetsMedia();this.$node.find(".media-not-displayed").hide()});this.$node.find(".display-this-media").click(showMediaOnClick);this.$node.find(".always-display-media").click(function(){if(twttr.currentUser){twttr.currentUser.updateShowAllInlineMedia(true,{success:function(){showMediaOnClick()},error:function(){twttr.showError(_("Couldn't set inline media settings."))}})}})}});twttr.images={renderMediaUrls:function(urls,scalingOptions){var $divs=twttr.images.generateDivs(urls,scalingOptions);var callbacks={success:function($div,resolvedUrl){twttr.images.scaleImageIntoDiv($div,resolvedUrl,scalingOptions)},error:function($div,reason){setTimeout(function(){$div.trigger("failedToResolve",[reason])},0)}};twttr.images.resolveDataUrls($divs,scalingOptions,callbacks);return $divs},animateImageFadeIn:function($img,ms,val){var animate=Modernizr.csstransitions?"animateWithCss":"animate";$img.css("opacity",0);$img[animate]({opacity:(val||1)},ms||500,"swing")},renderMediaUrl:function(url,scalingOptions){return this.renderMediaUrls([url],scalingOptions)},generateDivs:function(urls,scalingOptions){var $divs=$();for(var i=0;i<urls.length;i++){var $div=$(new twttr.views.Thumbnail({url:urls[i],width:scalingOptions.width,height:scalingOptions.height,lineHeight:scalingOptions.height}).html()).click(function(e){e.preventDefault()});$divs=$divs.add($div)}return $divs},resolveDataUrls:function($divs,scalingOptions,callbacks){$divs.each(function(index,div){var $div=$(div);var url=div.href;twttr.media.resolveImageUrl(url,scalingOptions.size,{success:function(resolvedUrl){callbacks.success&&callbacks.success($div,resolvedUrl)},error:function(reason){callbacks.error&&callbacks.error($div,reason)}})})},scaleImageIntoDiv:function($div,resolvedUrl,scalingOptions){var $img=$("<img class='scaled-image' />").bind("load",function(){var dimensions=twttr.images.calculateScaleDimensions({containerWidth:scalingOptions.width,containerHeight:scalingOptions.height,itemWidth:this.width,itemHeight:this.height,scalingMode:scalingOptions.scalingMode});$img.attr({origHeight:this.height,origWidth:this.width});$img.attr(dimensions).css({top:Math.floor(scalingOptions.height/2-dimensions.height/2),left:Math.floor(scalingOptions.width/2-dimensions.width/2)});$img.appendTo($div.find("div.thumbnail-wrapper"));$div.trigger("loaded")}).bind("error",function(){$div.trigger("failedToLoad")}).attr("src",resolvedUrl)},resizeImageInDiv:function($div,scalingOptions){var $img=$div.find("img.scaled-image");if($img.length==0){return }var dimensions=twttr.images.calculateScaleDimensions({containerWidth:scalingOptions.width,containerHeight:scalingOptions.height,itemWidth:$img.attr("origWidth"),itemHeight:$img.attr("origHeight"),scalingMode:scalingOptions.scalingMode});$img.attr(dimensions).css({top:Math.floor(scalingOptions.height/2-dimensions.height/2),left:Math.floor(scalingOptions.width/2-dimensions.width/2)})},resizeVideoInDiv:function($div){var $video=$div.find("iframe").length>0?$div.find("iframe"):$div.find("embed");if($video.length==0){return }var dimensions=twttr.images.calculateScaleDimensions({containerWidth:$div.width(),containerHeight:$div.height(),itemWidth:880,itemHeight:660,scalingMode:"fit"});$video.attr("style","height: "+dimensions.height+"px !important; width: "+dimensions.width+"px !important; margin-top: "+-dimensions.height/2+"px !important;")},calculateScaleDimensions:function(options){var containerHeight=options.containerHeight,containerWidth=options.containerWidth,itemHeight=options.itemHeight,itemWidth=options.itemWidth,scalingMode=options.scalingMode,widthFraction=itemWidth/containerWidth,heightFraction=itemHeight/containerHeight;function noScaling(){return{width:itemWidth,height:itemHeight}}function scaleWidthToContainer(){return{width:containerWidth,height:itemHeight/widthFraction}}function scaleHeightToContainer(){return{width:itemWidth/heightFraction,height:containerHeight}}switch(scalingMode){case"fit":if(widthFraction<1&&heightFraction<1){return noScaling()}else{return widthFraction>heightFraction?scaleWidthToContainer():scaleHeightToContainer()}break;case"trim":if(widthFraction<1||heightFraction<1){return noScaling()}else{return widthFraction>heightFraction?scaleHeightToContainer():scaleWidthToContainer()}break;default:return{width:containerWidth,height:containerHeight}}}};twttr.klass.component("twttr.components.ContactImportLauncher").initializer(function(compact){var that=this;this.bind("addedToPage",function(){twttr.API.AddressBook.contactsServices({success:function(services){if(!services||!services.length){that.trigger("notRendered","no_items");return }(new twttr.views.DashboardContactImport({services:services,compact:compact})).render(that.$node,"append");that.$node.delegate(".service-link","click",function(evt){that.launchService($(this))})},error:function(){that.trigger("notRendered","darkmoded")}})})}).methods({launchService:function($button){var url=$button.attr("data-url");if(url){var newWindow;if($button.attr("data-popup")=="true"){var sep=url.indexOf("?")==-1?"?":"&";url+=sep+"callback_hash="+encodeURIComponent(twttr.router.whoToFollowImportMatchesPath());var options=["width=500","height=500","toolbar=no","location=yes"];var $window=$(window),parentTop=window.screenY||window.screenTop||0,parentLeft=window.screenX||window.screenLeft||0;var popupTop=($window.height()-500)/2+parentTop,popupLeft=($window.width()-500)/2+parentLeft;options.push("top="+popupTop,"left="+popupLeft);newWindow=window.open(url,"twitter_oauth",options.join(","));newWindow.focus();var serviceName=$button.find("strong.service-name").attr("data-service-id");trackClient({section:"dashboard",component:"contact_import_launcher",action:"launch_service"},{event_info:serviceName,context:"import"})}else{newWindow=window.open(url,"_blank")}newWindow.focus()}}});twttr.stream("twttr.streams.ListStream",function(params,initialItems){this._cursor=-1;twttr.streams.Stream.apply(this,arguments)}).subclassOf(twttr.streams.Stream).methods({itemViewClass:"StreamList",streamItemType:"list",streamItemId:function(item){return item.uri},afterFirstSwitchingTo:function(callback){this.getMoreOldItems(callback)},_fetchItems:function(cb){var that=this;if(!twttr.decider.isAvailable("list_streams")||(this.constructor._deciderKey&&!twttr.decider.isAvailable(this.constructor._deciderKey))){cb(this,twttr.streams.DECIDER);return }twttr.API.User.find(this.screenName)[this.API_METHOD]({cursor:this._cursor,success:function(lists,data){that._cursor=data.response.next_cursor;that.push(lists.array);cb(that,twttr.streams.SUCCESS);if(!that._cursor){that.reachedTheEnd()}},error:function(e){if(e.status===502){cb(that,twttr.streams.WHALE)}else{cb(that,twttr.streams.ERROR)}},timeout:function(request){request.retry()},cancel:function(){cb(that,twttr.streams.TIMEOUT)}})}});twttr.stream("twttr.streams.OwnLists",function(params,initialItems){twttr.streams.ListStream.apply(this,arguments)}).subclassOf(twttr.streams.ListStream).methods({API_METHOD:"lists",_setTitle:function(cb){if(this.stream_user_is_current_user()){cb(_("Your lists"))}else{cb(_("{{username}}'s lists",{username:this.screenName}))}},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You haven't created any lists yet.")}else{return _("@{{screen_name}} hasn't created any lists yet.",{screen_name:this.screenName})}}}).statics({_deciderKey:"list_stream_own_lists"});twttr.stream("twttr.streams.Memberships",function(params,initialItems){twttr.streams.ListStream.apply(this,arguments)}).subclassOf(twttr.streams.ListStream).methods({API_METHOD:"memberships",_setTitle:function(cb){cb(_("Lists following {{username}}",{username:this.screenName}))},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You aren't listed yet.")}else{return _("@{{screen_name}} isn't listed yet.",{screen_name:this.screenName})}}}).statics({_deciderKey:"list_stream_memberships"});twttr.stream("twttr.streams.Subscriptions",function(params,initialItems){twttr.streams.ListStream.apply(this,arguments)}).subclassOf(twttr.streams.ListStream).methods({API_METHOD:"subscriptions",_setTitle:function(cb){cb(_("Lists {{username}} follows",{username:this.screenName}))},_getEmptyStreamHtml:function(){if(this.stream_user_is_current_user()){return _("You aren't following any lists yet.")}else{return _("@{{screen_name}} isn't following any lists yet.",{screen_name:this.screenName})}}}).statics({_deciderKey:"list_stream_subscriptions"});twttr.klass.component("twttr.components.ContactImportLauncher").initializer(function(compact){var that=this;this.bind("addedToPage",function(){twttr.API.AddressBook.contactsServices({success:function(services){if(!services||!services.length){that.trigger("notRendered","no_items");return }(new twttr.views.DashboardContactImport({services:services,compact:compact})).render(that.$node,"append");that.$node.delegate(".service-link","click",function(evt){that.launchService($(this))})},error:function(){that.trigger("notRendered","darkmoded")}})})}).methods({launchService:function($button){var url=$button.attr("data-url");if(url){var newWindow;if($button.attr("data-popup")=="true"){var sep=url.indexOf("?")==-1?"?":"&";url+=sep+"callback_hash="+encodeURIComponent(twttr.router.whoToFollowImportMatchesPath());var options=["width=500","height=500","toolbar=no","location=yes"];var $window=$(window),parentTop=window.screenY||window.screenTop||0,parentLeft=window.screenX||window.screenLeft||0;var popupTop=($window.height()-500)/2+parentTop,popupLeft=($window.width()-500)/2+parentLeft;options.push("top="+popupTop,"left="+popupLeft);newWindow=window.open(url,"twitter_oauth",options.join(","));newWindow.focus();var serviceName=$button.find("strong.service-name").attr("data-service-id");trackClient({section:"dashboard",component:"contact_import_launcher",action:"launch_service"},{event_info:serviceName,context:"import"})}else{newWindow=window.open(url,"_blank")}newWindow.focus()}}});twttr.klass("twttr.streams.SuggestionCategoriesStream",function(params,initialItems){params.pathRoot=params.pathRoot||"whoToFollow";twttr.streams.Stream.apply(this,arguments);this.$node.addClass("suggestion-categories");var ab_bucket=twttr.abdecider.choose("wtf_interest_design-29");if(ab_bucket){this.$node.addClass("wtf-interest-design-29");if(ab_bucket=="control"){this.$node.addClass("wtf-interest-design-29-control")}else{if(ab_bucket=="two_column"){this.$node.addClass("wtf-interest-design-29-two-column")}else{if(ab_bucket=="two_column_w_follow"){this.$node.addClass("wtf-interest-design-29-two-column-w-follow")}}}}var that=this;this.$node.delegate("div[data-item-type=suggestion_category]","click",function(e){if(e.target&&$(e.target).parent().andSelf().is(".follow-button, .unfollow-button")){return }var category=$(this).attr("data-item-id");if(category){that.routePageTo(that.params.pathRoot,"InterestsCategory",{category:category})}});twttr.API.User.bind("follow",function(event,user){var $button=that.$find(".follow-button[data-user-id="+user.id+"]");$button.removeClass("follow-button").addClass("unfollow-button");$button.html(_("Unfollow"));if($button.hasClass("top-tweets-topic-button")){twttr.abdecider.track("wtf_interest_design-29","wtf_topic_follow",{followed_user_id:user.id})}});twttr.API.User.bind("unfollow",function(event,user){var $button=that.$find(".unfollow-button[data-user-id="+user.id+"]");$button.removeClass("unfollow-button").addClass("follow-button");$button.html('<span class="plus"></span> <b>'+_("Follow")+"</b>");if($button.hasClass("top-tweets-topic-button")){twttr.abdecider.track("wtf_interest_design-29","wtf_topic_unfollow",{unfollowed_user_id:user.id})}})}).subclassOf(twttr.streams.Stream).mixin(twttr.mixins.userRecommendationsHelper).mixin(twttr.mixins.discoveryHelper).statics({cacheCategories:function(categories){this.CATEGORIES=categories;this.CATEGORY_MAP=this.buildCategoryMap(categories)},buildCategoryMap:function(categories){return categories.reduce({},function(hash,category){hash[category.slug]=category;return hash})},filterTopTweetsCategories:function(categories){var categoryMap=this.buildCategoryMap(categories);return categories.filter(function(category){if(category.slug.match(/^(.+)[_-]top-tweets$/i)){var parentCat=categoryMap[RegExp.$1];if(parentCat){parentCat.topTweetsCategory=category}return false}return true})}}).methods({itemViewClass:"StreamSuggestionCategory",streamItemType:"suggestion_category",streamItemId:function(item){return item.slug},afterFirstSwitchingTo:function(callback){this.getMoreOldItems(callback)},_fetchItems:function(cb){var that=this;if(!twttr.decider.isAvailable("suggestion_categories_streams")){cb(this,twttr.streams.DECIDER);return }var opts={samples:true,success:function(categories){categories=that.constructor.filterTopTweetsCategories(categories);that.constructor.cacheCategories(categories);var contextualCategories=categories.map(function(category){var ttUserId,sample;if(category.topTweetsCategory&&category.topTweetsCategory.sample&&(sample=category.topTweetsCategory.sample.shift())){ttUserId=sample.id}return category.clone({category_link:that.pagePathFor(that.params.pathRoot,"InterestsCategory",{category:category.slug}),category_top_tweets_user_id:ttUserId,category_top_tweets_is_current_user:!!(twttr.currentUser&&twttr.currentUser.id==ttUserId),following_category_top_tweets:category.topTweetsCategory?category.topTweetsCategory.followingTopTweets:null})});that.push(contextualCategories.array);cb(that,twttr.streams.SUCCESS);that.reachedTheEnd();var categoryNames=categories.map(function(category,i){return category.name});that.scribbler.scribe({component:"stream",action:"results"},{item_names:categoryNames,item_count:categoryNames.length()})},error:function(){cb(that,twttr.streams.ERROR)}};if(that.params.lang){opts.lang=that.params.lang}if(that.params.country){opts.country=that.params.country}if(that.params.city){opts.city=that.params.city}opts.top_tweets=true;twttr.API.SuggestionCategory.getAll(opts)},_setTitle:function(cb){cb(_("Select the topics you are interested in. Find a few people you want to hear from, then follow them."))},_getHeaderComponent:function(){return new twttr.components.SuggestionCategoriesList(this.constructor.CATEGORIES,this.params.pathRoot)},_getStreamEndComponent:function(){return this._getHeaderComponent()}});twttr.klass("twttr.streams.SuggestionCategoryMembersStream",function(params,initialItems){params.pathRoot=params.pathRoot||"whoToFollow";twttr.streams.UserStream.apply(this,arguments);this.category=params.suggestionCategory}).subclassOf(twttr.streams.UserStream).statics({_deciderKey:"suggestion_categories_streams"}).methods({update:function(options){if(this.params.lang){options.lang=this.params.lang}if(this.params.country){options.country=this.params.country}if(this.params.city){options.city=this.params.city}this.category.members(options)},isCursorPagination:function(){return false},_setTitle:function(cb){cb(_("View {{category}} ({{size}})",{category:this.category.name,size:this.category.size}))},_getHeaderComponent:function(){return new twttr.components.SuggestionCategoriesList(twttr.streams.SuggestionCategoriesStream.CATEGORIES,this.params.pathRoot,this.category.slug)},_getStreamEndComponent:function(){return this._getHeaderComponent()}});twttr.themes={loadUserStyleFor:function(user){if(twttr.helpers.isCurrentUser(user)){user=twttr.currentUser}if(user&&!this._hasBrokenDefaults(user)){if($("style#user-style-"+user.screenName).length===0){new twttr.views.UserCss(user).render("head","append")}if($("style#user-style-"+user.screenName+"-bg-img").length===0){new twttr.views.BgImgCss(user).render("head","append")}this._setTheme("user-style-"+user.screenName)}else{this.loadDefaultTheme()}},loadCurrentUserStyle:function(){if(twttr.loggedIn){this.loadUserStyleFor(twttr.currentUser)}else{this.loadDefaultTheme()}},loadDefaultTheme:function(){this._setTheme("user-style-twttr")},loadFrontPageTheme:function(){this._setTheme("front-page")},loadStaticPageTheme:function(){this._setTheme("static-page")},loadLoadingTheme:function(){this._setTheme("loading-body")},clear:function(){this._setTheme(false)},_setTheme:function(theme){var $body=$("body");$body.removeClass("loading-body");this._clearExistingTheme();if(theme){$body.addClass(theme)}},_brokenTheme:{profileBackgroundColor:"9ae4e8",profileBackgroundImageUrl:/\/images\/themes\/theme1\/bg.png$/i,profileBackgroundTile:false,profileLinkColor:"0000ff",profileSidebarBorderColor:"87bc44",profileSidebarFillColor:"e0ff92",profileTextColor:"000000",profileUseBackgroundImage:true},_hasBrokenDefaults:function(user){for(var key in this._brokenTheme){var borked=this._brokenTheme[key],users=user[key],matches=false;if(twttr.is.regex(borked)){matches=!!users.match(borked)}else{matches=borked===users}if(!matches){return false}}return true},_clearExistingTheme:function(){var $body=$("body");$("style[id^=user-style]").each(function(){$body.removeClass(this.id)});$body.removeClass("user-style-twttr front-page static-page")}};twttr.app.bind("init",function(event){var ab_bucket=twttr.abdecider.choose("wtf_interest_design-29");if(ab_bucket){twttr.API.User.bind("follow",function(event,user){var action=twttr.audit.currentAction();if(action=="whoToFollowInterestsCategory"||action=="welcomeInterestsCategory"){twttr.abdecider.track("wtf_interest_design-29","wtf_page_follow")}})}});twttr.klass("twttr.widget.VerifyEmailDialog",function(bucket,user){this.bucket=bucket;twttr.widget.Dialog.call(this,twttr.merge({modal:true,draggable:false,css:{width:530},email:(user.email_address||user.attributes.states.pending_email)},user.attributes))}).subclassOf(twttr.widget.Dialog).methods({registerEvents:function(){twttr.widget.Dialog.prototype.registerEvents.call(this);this.$container.find(".button.ok-thanks").bind("click",twttr.bind(this,function(e){twttr.abdecider.track("email_verification-18","dialog_dismissed");e.preventDefault();e.stopPropagation();$.cookie("abtest_email_verification_18","1",{expires:0.0417});this.destroy()}));this.$container.find(".send-verify-email").bind("click",twttr.bind(this,function(e){twttr.abdecider.track("email_verification-18","resend_verification_email");$.ajax({url:"/account/resend_confirmation_email",dataType:"json",success:twttr.bind(this,function(data){var $dialogContent=this.$container.find(".twttr-dialog-verify-email");if($dialogContent.length){$dialogContent.fadeOut(300,function(){$dialogContent.find("h2").html(_("Confirmation email sent!"));$dialogContent.find(".verify-email-text").html(_("Please take this time to check your email for the confirmation message and to verify your email address by <strong>clicking the link in the email</strong>."));$dialogContent.fadeIn()})}else{twttr.showMessage(data.messageForFlash)}}),error:function(data){twttr.showError(_("Oops!  There was an error sending the confirmation email."))}});e.preventDefault();e.stopPropagation()}));this.$container.find(".change-email").bind("click",twttr.bind(this,function(e){twttr.abdecider.track("email_verification-18","change_email");this.destroy()}))}});(function(){twttr.provide("twttr.facets");twttr.facets.URL="/search/facets.json";twttr.klass("twttr.facets.QueryManager",function(options){this._components={}}).methods(twttr.EventProvider).methods({validCategories:["images","videos"],isValidCategory:function(category){return $.inArray(category,this.validCategories)!==-1},includeScore:function(category){if(!this._components[category]){this._components[category]={}}this._components[category].score=true},includeCount:function(category,count){if(!this._components[category]){this._components[category]={}}var prevCount=this._components[category].count;this._components[category].count=prevCount&&prevCount>count?prevCount:count},facetBind:function(eventName,options,callback){if(!this.isValidCategory(eventName)){return }if(options.count){this.includeCount(eventName,options.count)}if(options.score){this.includeScore(eventName)}this.bind(eventName,callback)},query:function(query,options){var that=this;options=options||{};twttr.SearchAPI.getFacets({query:query,experimentId:options.experimentId,facets:this._components,success:function(data){for(var facet in data){that.trigger(facet,[data[facet],data])}}})}})})();twttr.SearchAPI={_generateFacetsQuery:function(options){var query=options.query;var facets=options.facets;var req={q:query,imageResults:facets.images?facets.images.count:null,videoResults:facets.videos?facets.videos.count:null};if(options.experimentId){req.experimentId=options.experimentId}return req},getFacets:function(options){var that=this;var cacheKey=JSON.stringify(options);if(this._facetsCache[cacheKey]){if(options.success){options.success(this._facetsCache[cacheKey].top_entities)}}else{twttr.API.Search.getFacets(twttr.merge(this._generateFacetsQuery(options),{success:function(data){that._facetsCache[cacheKey]=data;if(options.success){options.success(data.top_entities)}},error:function(){if(options.error){options.error()}}}))}},_facetsCache:{},flushCache:function(){this._facetsCache={}},getFacetMediaUrls:function(options){var config;if(options.mode==="photos"){config={images:{count:options.count,score:options.score}}}else{config={videos:{count:options.count,score:options.score}}}twttr.SearchAPI.getFacets({query:options.query,facets:config,success:function(data){var items;var result=[];if(options.mode==="photos"){items=data.images.topFacets}else{items=data.videos.topFacets}for(var i=0;i<items.length;i++){result.push(items[i].name)}options.success(result)},error:function(){options.error?options.error():$.noop}})}};(function(){var id=0;var verboseProfiling=twttr.util.params()["profiling"];twttr.klass("twttr.util.Profiler",function(description){if(!twttr.util.Profiler.isEnabled()){this.waypoint=$.noop;this.waitFor=$.noop;this.done=$.noop;this.addBeforeScribbleFilter=$.noop;this.doneAfterCallback=function(options){return options};return }this.id=++id;this.description=description;this.pendingProfilers=0;this.subProfilers=[];this.startTime=new Date();this.endTime=null;this.isDone=false;this.isComplete=false;this.runawayProfilerTimeout=setTimeout(twttr.bind(this,this._giveUp),twttr.util.Profiler.timeoutAfter);this.timedOut=false;this.timedOutSubProfilers=[];this.beforeScribbleFilters=[];this.profilerType=twttr.util.Profiler.types.GENERIC;if(verboseProfiling){console.log("%s started",this.description)}}).methods(twttr.EventProvider).statics({isEnabled:function(){return !!(twttr.payload.profiling||verboseProfiling)},logPreviousEvent:function(description,startTime,endTime){var profiler=new twttr.util.Profiler(description);profiler.addBeforeScribbleFilter(function(data){data.start_time_ms=startTime;data.end_time_ms=endTime;data.duration_ms=endTime-startTime;return data});profiler.done()},timeoutAfter:15000,types:{GENERIC:0,FIRST_PAGE_LOAD:1}}).methods({addBeforeScribbleFilter:function(fn){this.beforeScribbleFilters.push(fn)},doneAfterCallback:function(options){var profiler=this;var finishProfilingAfterCalling=function(fn){return function(){var rv=fn.apply(this,arguments);profiler.done();return rv}};if(twttr.is.fn(options)){return finishProfilingAfterCalling(options)}options.cancel=finishProfilingAfterCalling(options.cancel);options.complete=finishProfilingAfterCalling(options.complete);return options},waitFor:function(){if(this.isDone){console.warn(".waitFor called on a profiler that's already complete",this)}var that=this;$(arguments).each(function(i,profiler){if(!profiler||!(profiler instanceof twttr.util.Profiler)){if(!twttr.is.def(profiler.profiler)){console.error("Non-profiler passed in, and it doesn't have a .profiler property");return }profiler=profiler.profiler}if(profiler.isComplete){return }if(verboseProfiling){console.log("%s waiting for %o",that.description,profiler)}that.pendingProfilers++;that.subProfilers.push(profiler);profiler.bind("complete",function(e,profiler,timedOut){if(verboseProfiling){if(timedOut){console.log("%s noticed that %o timed out",that.description,profiler)}else{console.log("%s noticed that %o finished",that.description,profiler)}}that.pendingProfilers--;if(timedOut){that.timedOutSubProfilers.push(profiler)}if(that.pendingProfilers===0&&that.isDone){that._complete()}})})},done:function(){if(this.isDone){return }if(verboseProfiling){console.log("%s is done",this.description)}this.isDone=true;clearTimeout(this.runawayProfilerTimeout);this.runawayProfilerTimeout=null;if(this.pendingProfilers===0&&!this.isComplete){this._complete()}else{}},_complete:function(){if(verboseProfiling){console.log("%s is complete",this.description)}this.isComplete=true;this.endTime=new Date();this.waypoint("complete");this.trigger("complete",[this,this.timedOut])},_giveUp:function(){console.warn("Runaway profiler detected!",this);this.timedOut=true;this.done()},waypoint:function(key){var data={profiler_type:this.profilerType,product:"webclient",start_time_ms:twttr.appStartTime,impression_id:(twttr.session&&twttr.session.impressionId)?twttr.session.impressionId.toString():null,id:this.id,description:this.description};if(this.isComplete){data.end_time_ms=this.endTime.getTime();data.duration_ms=this.endTime-this.startTime}else{data.waypoint_time_ms=(new Date()).getTime();data.duration_ms=data.waypoint_time_ms-this.startTime;data.waypoint_key=key}if(this.timedOut){data.timed_out=true}var that=this;$.each(["subProfilers","timedOutSubProfilers"],function(which,type){if(that[type].length>0){data[twttr.util.underscore(type)]=twttr.map(that[type],function(profiler){return profiler.description})}});$.each(this.beforeScribbleFilters,function(i,filter){data=filter.call(that,data)});scribble("profiler_waypoint",data,"perftown");if(verboseProfiling){if(this.isComplete){console.log("%s: complete after %d ms; data %o",this.description,data.duration_ms,data)}else{console.log("%s: %s waypoint after %d ms; data %o",this.description,key,data.waypoint_time_ms-this.startTime,data)}}}});twttr.util.Profiler.verboseProfiling=verboseProfiling}());provide(">phoenix_bundle_evaled")});